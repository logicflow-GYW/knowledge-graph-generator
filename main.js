/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => KnowledgeGraphPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian5 = require("obsidian");

// settings.ts
var import_obsidian2 = require("obsidian");

// QueueModal.ts
var import_obsidian = require("obsidian");
var QueueManagementModal = class extends import_obsidian.Modal {
  constructor(app, plugin) {
    super(app);
    // 用于保存搜索词
    this.searchTerms = {
      gen: "",
      rev: "",
      rep: "",
      dis: ""
    };
    // 默认全部折叠
    this.collapseStates = {
      gen: false,
      // 默认折叠
      rev: false,
      // 默认折叠
      rep: false,
      // 默认折叠
      dis: false
      // 默认折叠
    };
    this.plugin = plugin;
    this.refreshContent = this.onOpen.bind(this);
  }
  onOpen() {
    const { contentEl } = this;
    this.app.workspace.off("kg-data-updated", this.refreshContent);
    contentEl.empty();
    contentEl.addClass("kg-modal");
    contentEl.createEl("h2", { text: "\u961F\u5217\u7BA1\u7406\u4EEA\u8868\u76D8" });
    const status = this.plugin.data.status;
    const statusText = `\u72B6\u6001: ${status.toUpperCase()} | ${this.plugin.statusBarEl.getText()}`;
    new import_obsidian.Setting(contentEl).setName(status === "running" ? "\u5F15\u64CE\u8FD0\u884C\u4E2D" : "\u5F15\u64CE\u5DF2\u6682\u505C").setDesc(statusText).addButton(
      (button) => button.setButtonText(status === "running" ? "\u6682\u505C\u5F15\u64CE" : "\u542F\u52A8\u5F15\u64CE").setCta(status !== "running").onClick(() => {
        this.plugin.engine.toggleEngineState();
        this.onOpen();
      })
    );
    this.renderQueueSection(
      contentEl,
      "gen",
      "\u5F85\u751F\u6210 (Generation)",
      this.plugin.data.generationQueue,
      this.renderGenerationItem.bind(this)
    );
    this.renderQueueSection(
      contentEl,
      "rev",
      "\u5F85\u5BA1\u6838 (Review)",
      this.plugin.data.reviewQueue,
      this.renderReviewItem.bind(this)
    );
    this.renderQueueSection(
      contentEl,
      "rep",
      "\u5F85\u4FEE\u6B63 (Revision)",
      this.plugin.data.revisionQueue,
      this.renderRevisionItem.bind(this)
    );
    this.renderQueueSection(
      contentEl,
      "dis",
      "\u5DF2\u4E22\u5F03 (Discarded)",
      this.plugin.data.discardedPile,
      this.renderDiscardedItem.bind(this)
    );
    this.app.workspace.on("kg-data-updated", this.refreshContent);
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
    this.app.workspace.off("kg-data-updated", this.refreshContent);
  }
  /**
   * 渲染一个队列区域 (带搜索和展开/折叠)
   */
  renderQueueSection(containerEl, key, title, data, renderFn) {
    const displayLimit = 100;
    const filter = this.searchTerms[key];
    const filteredData = data.filter((item) => {
      if (!filter)
        return true;
      const needle = filter.toLowerCase();
      if (typeof item === "string") {
        return item.toLowerCase().includes(needle);
      }
      return item.idea.toLowerCase().includes(needle);
    });
    const total = data.length;
    const filteredTotal = filteredData.length;
    const titleText = `${title} (${filteredTotal}${total !== filteredTotal ? " / " + total : ""} \u9879)`;
    const details = containerEl.createEl("details");
    details.open = this.collapseStates[key];
    const summary = details.createEl("summary", { text: titleText });
    summary.style.fontWeight = "bold";
    summary.style.fontSize = "var(--font-ui-large)";
    summary.style.cursor = "pointer";
    summary.style.padding = "5px 0";
    details.addEventListener("toggle", () => {
      this.collapseStates[key] = details.open;
    });
    new import_obsidian.Setting(details).setDesc(`\u641C\u7D22 ${title}...`).addText((text) => {
      text.setPlaceholder("\u8F93\u5165\u5173\u952E\u8BCD...").setValue(this.searchTerms[key]).onChange((value) => {
        this.searchTerms[key] = value;
        this.onOpen();
      });
    });
    const truncatedData = filteredData.slice(0, displayLimit);
    if (truncatedData.length === 0) {
      const desc = details.createEl("p", { text: "\u6B64\u961F\u5217\u4E3A\u7A7A\uFF0C\u6216\u672A\u627E\u5230\u5339\u914D\u9879\u3002", cls: "setting-item-description" });
      desc.style.paddingLeft = "10px";
      return;
    }
    const listContainer = details.createDiv("kg-list-container");
    listContainer.style.maxHeight = "200px";
    listContainer.style.overflowY = "auto";
    listContainer.style.border = "1px solid var(--background-modifier-border)";
    listContainer.style.padding = "5px";
    listContainer.style.marginLeft = "10px";
    truncatedData.forEach((item, index) => {
      renderFn(listContainer, item, index);
    });
    if (filteredData.length > displayLimit) {
      const truncatedInfo = details.createEl("p", {
        text: `... \u4EC5\u663E\u793A\u524D ${displayLimit} \u9879 (\u5171 ${filteredData.length} \u9879)\uFF0C\u8BF7\u4F7F\u7528\u641C\u7D22\u67E5\u627E\u66F4\u591A\u3002`,
        cls: "setting-item-description"
      });
      truncatedInfo.style.paddingLeft = "10px";
    }
  }
  // --- 单项渲染函数 ---
  renderGenerationItem(container, item) {
    new import_obsidian.Setting(container).setName(item).addButton(
      (btn) => btn.setIcon("trash").setTooltip("\u5220\u9664\u6B64\u6982\u5FF5").onClick(async () => {
        const queue = this.plugin.data.generationQueue;
        const index = queue.indexOf(item);
        if (index > -1) {
          queue.splice(index, 1);
          await this.plugin.savePluginData();
          this.plugin.engine.updateStatusBar();
          this.onOpen();
        }
      })
    );
  }
  renderReviewItem(container, item) {
    const task = item;
    new import_obsidian.Setting(container).setName(`[\u5BA1\u6838] ${task.idea}`).addButton(
      (btn) => btn.setIcon("trash").setTooltip("\u4E22\u5F03\u6B64\u4EFB\u52A1").onClick(async () => {
        this.plugin.data.reviewQueue.splice(this.plugin.data.reviewQueue.indexOf(task), 1);
        this.plugin.data.discardedPile.push(task);
        await this.plugin.savePluginData();
        this.plugin.engine.updateStatusBar();
        this.onOpen();
      })
    );
  }
  renderRevisionItem(container, item) {
    const task = item;
    new import_obsidian.Setting(container).setName(`[\u4FEE\u6B63] ${task.idea}`).setDesc(`\u539F\u56E0: ${task.reason || "\u672A\u77E5"}`).addButton(
      (btn) => btn.setIcon("trash").setTooltip("\u4E22\u5F03\u6B64\u4EFB\u52A1").onClick(async () => {
        this.plugin.data.revisionQueue.splice(this.plugin.data.revisionQueue.indexOf(task), 1);
        this.plugin.data.discardedPile.push(task);
        await this.plugin.savePluginData();
        this.plugin.engine.updateStatusBar();
        this.onOpen();
      })
    );
  }
  renderDiscardedItem(container, item) {
    const task = item;
    new import_obsidian.Setting(container).setName(`[\u5DF2\u4E22\u5F03] ${task.idea}`).setDesc(`\u6700\u540E\u539F\u56E0: ${task.reason || "\u672A\u77E5"}`).addButton(
      (btn) => btn.setIcon("refresh-cw").setTooltip("\u91CD\u65B0\u6392\u961F (\u653E\u56DE\u751F\u6210\u961F\u5217)").onClick(async () => {
        this.plugin.data.discardedPile.splice(this.plugin.data.discardedPile.indexOf(task), 1);
        this.plugin.engine.addConceptsToQueue([task.idea]);
        this.onOpen();
      })
    );
  }
};

// settings.ts
var PROMPT_GENERATOR_DEFAULT = `# Role: \u77E5\u8BC6\u7CFB\u7EDF\u6784\u5EFA\u4E13\u5BB6...`;
var PROMPT_CRITIC_DEFAULT = `# Role: \u77E5\u8BC6\u56FE\u8C31\u8D28\u91CF\u5BA1\u6838\u5458...`;
var PROMPT_REVISER_DEFAULT = `# \u89D2\u8272: \u8D44\u6DF1\u77E5\u8BC6\u7F16\u8F91\u4E0E\u5185\u5BB9\u4F18\u5316\u4E13\u5BB6...`;
var DEFAULT_SETTINGS = {
  // API
  openai_api_keys: "",
  openai_base_url: "https://api.openai.com/v1",
  openai_model: "gpt-4-turbo-preview",
  openai_backup_model: "",
  google_api_keys: "",
  google_model: "gemini-1.5-pro-latest",
  google_backup_model: "",
  failover_cooldown_seconds: 300,
  // 参数
  generation_temperature: 0.7,
  generation_max_tokens: 4096,
  // 路径
  output_dir: "KnowledgeGraphNotes",
  // 系统
  generation_batch_size: 5,
  request_delay: 5,
  // Critic
  critic_mode: "heuristic",
  critic_required_headers: "# \u{1F9E0}\n> \n## \u{1F4A1} \u6838\u5FC3\u601D\u60F3\n## \u{1F3AF} \u9002\u7528\u573A\u666F\n## \u{1F6E0}\uFE0F \u4F7F\u7528\u6B65\u9AA4/\u6784\u6210\u8981\u7D20\n## \u{1F680} \u6848\u4F8B\u5206\u6790\n## \u{1F44D} \u4F18\u70B9 & \u{1F44E} \u7F3A\u70B9\n## \u{1F517} \u5173\u8054\u6A21\u578B",
  critic_min_content_length: 400,
  // Reviser
  max_revision_retries: 2,
  // Prompts
  prompt_generator: PROMPT_GENERATOR_DEFAULT,
  prompt_critic: PROMPT_CRITIC_DEFAULT,
  prompt_reviser: PROMPT_REVISER_DEFAULT,
  // 播种箱
  seedConcepts: "",
  // 新概念提取
  extract_new_concepts: false
};
async function getDefaultPrompts() {
  return {
    prompt_generator: PROMPT_GENERATOR_DEFAULT,
    prompt_critic: PROMPT_CRITIC_DEFAULT,
    prompt_reviser: PROMPT_REVISER_DEFAULT
  };
}
var KGsSettingTab = class extends import_obsidian2.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "\u77E5\u8BC6\u56FE\u8C31\u751F\u6210\u5668 - \u8BBE\u7F6E" });
    new import_obsidian2.Setting(containerEl).setName("\u5F15\u64CE\u4EEA\u8868\u76D8").setDesc("\u7BA1\u7406\u5F85\u751F\u6210\u3001\u5F85\u5BA1\u6838\u548C\u5DF2\u4E22\u5F03\u7684\u4EFB\u52A1\u3002").addButton(
      (button) => button.setButtonText("\u6253\u5F00\u961F\u5217\u7BA1\u7406\u5668").setCta().onClick(() => {
        new QueueManagementModal(this.app, this.plugin).open();
      })
    );
    new import_obsidian2.Setting(containerEl).setName("API \u8BBE\u7F6E").setHeading();
    containerEl.createEl("h3", { text: "OpenAI" });
    new import_obsidian2.Setting(containerEl).setName("OpenAI API Keys").setDesc("\u6BCF\u884C\u4E00\u4E2A Key\u3002\u63D2\u4EF6\u5C06\u81EA\u52A8\u8F6E\u6362\u548C\u51B7\u5374\u4F7F\u7528\u3002").addTextArea((text) => text.setPlaceholder("sk-...").setValue(this.plugin.settings.openai_api_keys).onChange(async (value) => {
      this.plugin.settings.openai_api_keys = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("OpenAI Base URL").setDesc("\u5982\u679C\u4F7F\u7528\u7B2C\u4E09\u65B9\u4EE3\u7406\uFF0C\u8BF7\u5728\u6B64\u5904\u586B\u5165\u4EE3\u7406\u5730\u5740\u3002").addText((text) => text.setPlaceholder("https://api.openai.com/v1").setValue(this.plugin.settings.openai_base_url).onChange(async (value) => {
      this.plugin.settings.openai_base_url = value.trim();
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("OpenAI Model (\u4E3B\u6A21\u578B)").setDesc("\u8F93\u5165\u4F60\u60F3\u4F7F\u7528\u7684 OpenAI \u4E3B\u8981\u6A21\u578B\u540D\u79F0\u3002").addText((text) => text.setPlaceholder("gpt-4-turbo-preview").setValue(this.plugin.settings.openai_model).onChange(async (value) => {
      this.plugin.settings.openai_model = value.trim();
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("OpenAI \u5907\u7528\u6A21\u578B (Backup Model)").setDesc("(\u53EF\u9009) \u5F53\u4E3B\u6A21\u578B\u989D\u5EA6\u8017\u5C3D\u6216\u5931\u8D25\u65F6\uFF0C\u5C06\u81EA\u52A8\u5C1D\u8BD5\u6B64\u5907\u7528\u6A21\u578B\u3002").addText((text) => text.setPlaceholder("gpt-3.5-turbo").setValue(this.plugin.settings.openai_backup_model).onChange(async (value) => {
      this.plugin.settings.openai_backup_model = value.trim();
      await this.plugin.saveSettings();
    }));
    containerEl.createEl("h3", { text: "Google Gemini" });
    new import_obsidian2.Setting(containerEl).setName("Google Gemini API Keys").setDesc("\u6BCF\u884C\u4E00\u4E2A Key\u3002").addTextArea((text) => text.setPlaceholder("AIzaSy...").setValue(this.plugin.settings.google_api_keys).onChange(async (value) => {
      this.plugin.settings.google_api_keys = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("Google Gemini Model (\u4E3B\u6A21\u578B)").setDesc("\u8F93\u5165\u4F60\u60F3\u4F7F\u7528\u7684 Google \u4E3B\u8981\u6A21\u578B\u540D\u79F0\u3002").addText((text) => text.setPlaceholder("gemini-1.5-pro-latest").setValue(this.plugin.settings.google_model).onChange(async (value) => {
      this.plugin.settings.google_model = value.trim();
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("Google Gemini \u5907\u7528\u6A21\u578B (Backup Model)").setDesc("(\u53EF\u9009) \u5F53\u4E3B\u6A21\u578B\u989D\u5EA6\u8017\u5C3D\u6216\u5931\u8D25\u65F6\uFF0C\u5C06\u81EA\u52A8\u5C1D\u8BD5\u6B64\u5907\u7528\u6A21\u578B\u3002").addText((text) => text.setPlaceholder("gemini-1.0-pro").setValue(this.plugin.settings.google_backup_model).onChange(async (value) => {
      this.plugin.settings.google_backup_model = value.trim();
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("Key \u51B7\u5374\u65F6\u95F4 (\u79D2)").setDesc("API Key \u5931\u8D25\u540E\uFF0C\u9700\u8981\u7B49\u5F85\u591A\u5C11\u79D2\u624D\u80FD\u518D\u6B21\u4F7F\u7528\u3002").addText((text) => text.setValue(String(this.plugin.settings.failover_cooldown_seconds)).onChange(async (value) => {
      const num = parseInt(value, 10);
      if (!isNaN(num) && num >= 0) {
        this.plugin.settings.failover_cooldown_seconds = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("LLM \u53C2\u6570\u8BBE\u7F6E").setHeading();
    new import_obsidian2.Setting(containerEl).setName("\u751F\u6210\u6E29\u5EA6 (Temperature)").setDesc("\u63A7\u5236\u751F\u6210\u5185\u5BB9\u7684\u968F\u673A\u6027\u3002\u8F83\u4F4E\u7684\u503C\uFF08\u5982 0.2\uFF09\u66F4\u5177\u786E\u5B9A\u6027\uFF0C\u8F83\u9AD8\u7684\u503C\uFF08\u5982 0.8\uFF09\u66F4\u5177\u521B\u9020\u6027\u3002").addText((text) => text.setValue(String(this.plugin.settings.generation_temperature)).onChange(async (value) => {
      const num = parseFloat(value);
      if (!isNaN(num) && num >= 0 && num <= 2) {
        this.plugin.settings.generation_temperature = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("\u6700\u5927 Token \u6570 (Max Tokens)").setDesc("API \u4E00\u6B21\u8C03\u7528\u5141\u8BB8\u751F\u6210\u7684\u6700\u5927 Token \u6570\u91CF\u3002").addText((text) => text.setValue(String(this.plugin.settings.generation_max_tokens)).onChange(async (value) => {
      const num = parseInt(value, 10);
      if (!isNaN(num) && num > 0) {
        this.plugin.settings.generation_max_tokens = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("\u5F15\u64CE\u8BBE\u7F6E").setHeading();
    new import_obsidian2.Setting(containerEl).setName("\u8F93\u51FA\u6587\u4EF6\u5939").setDesc("\u6240\u6709\u751F\u6210\u7684\u7B14\u8BB0\u5C06\u4FDD\u5B58\u5230\u6B64\u6587\u4EF6\u5939\u3002").addText((text) => text.setPlaceholder("KnowledgeGraphNotes").setValue(this.plugin.settings.output_dir).onChange(async (value) => {
      this.plugin.settings.output_dir = value.trim().replace(/\/$/, "");
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("\u751F\u6210\u6279\u5904\u7406\u5927\u5C0F").setDesc("\u5F15\u64CE\u6BCF\u4E00\u8F6E\u4ECE\u201C\u5F85\u751F\u6210\u961F\u5217\u201D\u4E2D\u53D6\u51FA\u7684\u4EFB\u52A1\u6570\u91CF\u3002").addText((text) => text.setValue(String(this.plugin.settings.generation_batch_size)).onChange(async (value) => {
      const num = parseInt(value, 10);
      if (!isNaN(num) && num > 0) {
        this.plugin.settings.generation_batch_size = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("\u6BCF\u8F6E\u8BF7\u6C42\u5EF6\u8FDF (\u79D2)").setDesc("\u5F15\u64CE\u5728\u5904\u7406\u5B8C\u4E00\u4E2A\u6279\u6B21\u540E\uFF0C\u7B49\u5F85\u591A\u5C11\u79D2\u518D\u5F00\u59CB\u4E0B\u4E00\u4E2A\u6279\u6B21\u3002").addText((text) => text.setValue(String(this.plugin.settings.request_delay)).onChange(async (value) => {
      const num = parseInt(value, 10);
      if (!isNaN(num) && num >= 0) {
        this.plugin.settings.request_delay = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("\u6700\u5927\u4FEE\u6B63\u6B21\u6570").setDesc("\u4E00\u7BC7\u7B14\u8BB0\u5728\u88AB\u653E\u5F03\uFF08\u79FB\u5165 Discarded Pile\uFF09\u524D\uFF0C\u6700\u591A\u5141\u8BB8\u88AB\u4FEE\u6B63\u7684\u6B21\u6570\u3002").addText((text) => text.setValue(String(this.plugin.settings.max_revision_retries)).onChange(async (value) => {
      const num = parseInt(value, 10);
      if (!isNaN(num) && num >= 0) {
        this.plugin.settings.max_revision_retries = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("\u81EA\u52A8\u63D0\u53D6\u65B0\u6982\u5FF5 (Extract New Concepts)").setDesc("\u5F00\u542F\u540E\uFF0C\u5C06\u81EA\u52A8\u4ECE\u5DF2\u6279\u51C6\u7B14\u8BB0\u7684\u5185\u5BB9\u4E2D\u63D0\u53D6 [[Wikilinks]] \u4F5C\u4E3A\u65B0\u6982\u5FF5\u52A0\u5165\u201C\u5F85\u751F\u6210\u961F\u5217\u201D\u3002(\u9ED8\u8BA4\u5173\u95ED)").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.extract_new_concepts).onChange(async (value) => {
        this.plugin.settings.extract_new_concepts = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian2.Setting(containerEl).setName("\u5BA1\u6838\u6A21\u5F0F (Critic Mode)").setDesc("\u9009\u62E9\u5185\u5BB9\u5BA1\u6838\u7684\u65B9\u5F0F\u3002\u542F\u53D1\u5F0F\u6A21\u5F0F\u901F\u5EA6\u5FEB\u4E14\u514D\u8D39\uFF0C\u4F46\u53EA\u68C0\u67E5\u683C\u5F0F\uFF1BAI\u6A21\u5F0F\u66F4\u667A\u80FD\uFF0C\u4F46\u4F1A\u6D88\u8017API\u989D\u5EA6\u3002").addDropdown((dropdown) => dropdown.addOption("heuristic", "\u542F\u53D1\u5F0F (Heuristic)").addOption("ai", "\u4EBA\u5DE5\u667A\u80FD (AI)").setValue(this.plugin.settings.critic_mode).onChange(async (value) => {
      this.plugin.settings.critic_mode = value;
      await this.plugin.saveSettings();
      this.display();
    }));
    if (this.plugin.settings.critic_mode === "heuristic") {
      new import_obsidian2.Setting(containerEl).setName("\u542F\u53D1\u5F0F\u5BA1\u6838\uFF1A\u5FC5\u987B\u7684\u6807\u9898").setDesc("\u5728\u542F\u53D1\u5F0F\u6A21\u5F0F\u4E0B\uFF0C\u68C0\u67E5\u7B14\u8BB0\u662F\u5426\u5305\u542B\u6240\u6709\u8FD9\u4E9B\u6807\u9898\uFF08\u6BCF\u884C\u4E00\u4E2A\uFF09\u3002").addTextArea((text) => {
        text.setValue(this.plugin.settings.critic_required_headers).onChange(async (value) => {
          this.plugin.settings.critic_required_headers = value;
          await this.plugin.saveSettings();
        });
        text.inputEl.style.height = "150px";
      });
      new import_obsidian2.Setting(containerEl).setName("\u542F\u53D1\u5F0F\u5BA1\u6838\uFF1A\u6700\u5C0F\u5185\u5BB9\u957F\u5EA6").setDesc("\u5728\u542F\u53D1\u5F0F\u6A21\u5F0F\u4E0B\uFF0C\u7B14\u8BB0\u5185\u5BB9\u5FC5\u987B\u8FBE\u5230\u7684\u6700\u5C0F\u5B57\u7B26\u6570\u3002").addText((text) => text.setValue(String(this.plugin.settings.critic_min_content_length)).onChange(async (value) => {
        const num = parseInt(value, 10);
        if (!isNaN(num) && num >= 0) {
          this.plugin.settings.critic_min_content_length = num;
          await this.plugin.saveSettings();
        }
      }));
    }
    new import_obsidian2.Setting(containerEl).setName("\u6982\u5FF5\u64AD\u79CD (Concept Seeding)").setHeading();
    new import_obsidian2.Setting(containerEl).setName("\u6982\u5FF5\u64AD\u79CD\u7BB1").setDesc("\u5728\u6B64\u5904\u7C98\u8D34\u6216\u8F93\u5165\u60A8\u60F3\u8981\u751F\u6210\u521D\u59CB\u7B14\u8BB0\u7684\u6982\u5FF5\u5217\u8868\uFF0C\u6BCF\u884C\u4E00\u4E2A\u6982\u5FF5\u3002").addTextArea((text) => {
      text.setPlaceholder("\u4F8B\u5982\uFF1A\n\u7B2C\u4E00\u6027\u539F\u7406\n\u5965\u5361\u59C6\u5243\u5200\n\u523B\u610F\u7EC3\u4E60\n...").setValue(this.plugin.settings.seedConcepts).onChange(async (value) => {
        this.plugin.settings.seedConcepts = value;
        await this.plugin.saveSettings();
      });
      text.inputEl.style.height = "200px";
    });
    new import_obsidian2.Setting(containerEl).addButton(
      (button) => button.setButtonText("\u64AD\u79CD\u5230\u5F85\u751F\u6210\u961F\u5217").setCta().onClick(async () => {
        const rawText = this.plugin.settings.seedConcepts;
        if (!rawText.trim()) {
          new import_obsidian2.Notice("\u64AD\u79CD\u7BB1\u4E3A\u7A7A\uFF0C\u65E0\u9700\u64CD\u4F5C\u3002");
          return;
        }
        const conceptsToSeed = [...new Set(
          rawText.split("\n").map((line) => line.trim()).filter(Boolean)
        )];
        const addedCount = this.plugin.engine.addConceptsToQueue(conceptsToSeed);
        const ignoredCount = conceptsToSeed.length - addedCount;
        let noticeMessage = `\u6210\u529F\u6DFB\u52A0 ${addedCount} \u4E2A\u65B0\u6982\u5FF5\u5230\u961F\u5217\u3002`;
        if (ignoredCount > 0) {
          noticeMessage += `
${ignoredCount} \u4E2A\u6982\u5FF5\u56E0\u5DF2\u5B58\u5728\u6216\u91CD\u590D\u800C\u88AB\u5FFD\u7565\u3002`;
        }
        new import_obsidian2.Notice(noticeMessage, 5e3);
        this.plugin.settings.seedConcepts = "";
        await this.plugin.saveSettings();
        this.display();
      })
    );
    new import_obsidian2.Setting(containerEl).setName("Prompts \u8BBE\u7F6E").setHeading();
    new import_obsidian2.Setting(containerEl).setName("\u751F\u6210 Prompt").setDesc("\u7528\u4E8E\u751F\u6210\u65B0\u6982\u5FF5\u5185\u5BB9\u7684 Prompt\u3002").addTextArea((text) => {
      text.setValue(this.plugin.settings.prompt_generator).onChange(async (value) => {
        this.plugin.settings.prompt_generator = value;
        await this.plugin.saveSettings();
      });
      text.inputEl.style.height = "300px";
    });
    if (this.plugin.settings.critic_mode === "ai") {
      new import_obsidian2.Setting(containerEl).setName("\u5BA1\u6838 Prompt (Critic)").setDesc("\u7528\u4E8E AI \u6A21\u5F0F\u4E0B\u5BA1\u6838\u751F\u6210\u5185\u5BB9\u7684 Prompt\u3002").addTextArea((text) => {
        text.setValue(this.plugin.settings.prompt_critic).onChange(async (value) => {
          this.plugin.settings.prompt_critic = value;
          await this.plugin.saveSettings();
        });
        text.inputEl.style.height = "300px";
      });
    }
    new import_obsidian2.Setting(containerEl).setName("\u4FEE\u6B63 Prompt (Reviser)").setDesc("\u7528\u4E8E\u4FEE\u6B63\u88AB\u5BA1\u6838\u5458\u62D2\u7EDD\u5185\u5BB9\u7684 Prompt\u3002").addTextArea((text) => {
      text.setValue(this.plugin.settings.prompt_reviser).onChange(async (value) => {
        this.plugin.settings.prompt_reviser = value;
        await this.plugin.saveSettings();
      });
      text.inputEl.style.height = "300px";
    });
  }
};

// engine.ts
var import_obsidian4 = require("obsidian");

// apiHandler.ts
var import_obsidian3 = require("obsidian");
var ApiKeyExhaustedError = class extends Error {
  constructor(message) {
    super(message);
    this.name = "ApiKeyExhaustedError";
  }
};
var AllModelsFailedError = class extends Error {
  constructor(message) {
    super(message);
    this.name = "AllModelsFailedError";
  }
};
var APIHandler = class {
  constructor(plugin) {
    this.openai_keys = [];
    this.google_keys = [];
    this.keyUsageOpenAI = /* @__PURE__ */ new Map();
    this.keyUsageGoogle = /* @__PURE__ */ new Map();
    // 用于跟踪是否已经通知过故障切换
    this.hasNotifiedFailover = false;
    this.plugin = plugin;
    this.settings = plugin.settings;
    this.updateKeys();
  }
  updateKeys() {
    this.openai_keys = this.settings.openai_api_keys.split("\n").map((k) => k.trim()).filter(Boolean);
    this.google_keys = this.settings.google_api_keys.split("\n").map((k) => k.trim()).filter(Boolean);
    this.openai_keys.forEach((key) => {
      if (!this.keyUsageOpenAI.has(key)) {
        this.keyUsageOpenAI.set(key, { fails: 0, cooldown_until: 0 });
      }
    });
    this.google_keys.forEach((key) => {
      if (!this.keyUsageGoogle.has(key)) {
        this.keyUsageGoogle.set(key, { fails: 0, cooldown_until: 0 });
      }
    });
  }
  _selectKey(keys, provider) {
    const keyUsageMap = provider === "openai" ? this.keyUsageOpenAI : this.keyUsageGoogle;
    const currentTime = Date.now() / 1e3;
    for (const key of keys) {
      const usage = keyUsageMap.get(key);
      if (usage && currentTime >= usage.cooldown_until) {
        return key;
      }
    }
    return null;
  }
  /**
   * 实际执行 OpenAI API 请求
   */
  async _makeOpenAIRequest(key, prompt, modelName) {
    const response = await (0, import_obsidian3.requestUrl)({
      url: `${this.settings.openai_base_url}/chat/completions`,
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${key}`
      },
      body: JSON.stringify({
        model: modelName,
        messages: [{ role: "user", content: prompt }],
        temperature: this.settings.generation_temperature,
        max_tokens: this.settings.generation_max_tokens
      })
    });
    return response.json.choices[0].message.content.trim();
  }
  /**
   * 实际执行 Google Gemini API 请求
   */
  async _makeGoogleAPIRequest(key, prompt, modelName) {
    const url = `https://generativelanguage.googleapis.com/v1beta/models/${modelName}:generateContent?key=${key}`;
    const response = await (0, import_obsidian3.requestUrl)({
      url,
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        contents: [{ parts: [{ text: prompt }] }],
        generationConfig: {
          temperature: this.settings.generation_temperature,
          maxOutputTokens: this.settings.generation_max_tokens
        }
      })
    });
    const data = response.json;
    if (!data.candidates || data.candidates.length === 0) {
      throw new Error("API response is missing candidates. Full response: " + JSON.stringify(data));
    }
    return data.candidates[0].content.parts[0].text.trim();
  }
  /**
   * 检查是否是额度/权限类错误
   */
  _isQuotaError(error) {
    var _a;
    const httpStatus = error.status;
    const errorMessage = ((_a = error.message) == null ? void 0 : _a.toLowerCase()) || "";
    if (httpStatus === 401 || httpStatus === 403 || httpStatus === 429) {
      return true;
    }
    if (errorMessage.includes("insufficient_quota") || errorMessage.includes("rate limit") || errorMessage.includes("quota") || errorMessage.includes("permission") || errorMessage.includes("429")) {
      return true;
    }
    return false;
  }
  /**
   * 冷却一个 Key
   */
  _cooldownKey(key, provider) {
    const keyUsageMap = provider === "openai" ? this.keyUsageOpenAI : this.keyUsageGoogle;
    const keyUsage = keyUsageMap.get(key);
    if (keyUsage) {
      console.warn(`Key ...${key.slice(-4)} (${provider}) failed due to quota/auth error. Applying cooldown.`);
      keyUsage.cooldown_until = Date.now() / 1e3 + this.settings.failover_cooldown_seconds;
    }
  }
  /**
   * 重置一个 Key 的冷却 (调用成功时)
   */
  _resetCooldown(key, provider) {
    const keyUsageMap = provider === "openai" ? this.keyUsageOpenAI : this.keyUsageGoogle;
    const keyUsage = keyUsageMap.get(key);
    if (keyUsage) {
      keyUsage.cooldown_until = 0;
    }
    this.hasNotifiedFailover = false;
  }
  async _callOpenAI(key, prompt) {
    const primaryModel = this.settings.openai_model;
    const backupModel = this.settings.openai_backup_model;
    try {
      const result = await this._makeOpenAIRequest(key, prompt, primaryModel);
      this._resetCooldown(key, "openai");
      return result;
    } catch (primaryError) {
      console.warn(`OpenAI primary model '${primaryModel}' failed for key ...${key.slice(-4)}:`, primaryError.message);
      if (backupModel) {
        try {
          const backupResult = await this._makeOpenAIRequest(key, prompt, backupModel);
          this._resetCooldown(key, "openai");
          return backupResult;
        } catch (backupError) {
          console.error(`OpenAI backup model '${backupModel}' also failed for key ...${key.slice(-4)}:`, backupError.message);
          if (this._isQuotaError(primaryError) || this._isQuotaError(backupError)) {
            this._cooldownKey(key, "openai");
          }
          throw new ApiKeyExhaustedError(`OpenAI key failed (both primary and backup models).`);
        }
      }
      if (this._isQuotaError(primaryError)) {
        this._cooldownKey(key, "openai");
      }
      throw new ApiKeyExhaustedError(`OpenAI key failed (primary model failed, no backup): ${primaryError.message}`);
    }
  }
  async _callGoogleAPI(key, prompt) {
    const primaryModel = this.settings.google_model;
    const backupModel = this.settings.google_backup_model;
    try {
      const result = await this._makeGoogleAPIRequest(key, prompt, primaryModel);
      this._resetCooldown(key, "google");
      return result;
    } catch (primaryError) {
      console.warn(`Google primary model '${primaryModel}' failed for key ...${key.slice(-4)}:`, primaryError.message);
      if (backupModel) {
        try {
          const backupResult = await this._makeGoogleAPIRequest(key, prompt, backupModel);
          this._resetCooldown(key, "google");
          return backupResult;
        } catch (backupError) {
          console.error(`Google backup model '${backupModel}' also failed for key ...${key.slice(-4)}:`, backupError.message);
          if (this._isQuotaError(primaryError) || this._isQuotaError(backupError)) {
            this._cooldownKey(key, "google");
          }
          throw new ApiKeyExhaustedError(`Google key failed (both primary and backup models).`);
        }
      }
      if (this._isQuotaError(primaryError)) {
        this._cooldownKey(key, "google");
      }
      throw new ApiKeyExhaustedError(`Google key failed (primary model failed, no backup): ${primaryError.message}`);
    }
  }
  async call(prompt) {
    this.updateKeys();
    let lastError = null;
    let openAIKeysAttempted = false;
    const openAIEnabled = this.openai_keys.length > 0 && !!(this.settings.openai_model || this.settings.openai_backup_model);
    const googleEnabled = this.google_keys.length > 0 && !!(this.settings.google_model || this.settings.google_backup_model);
    if (openAIEnabled) {
      openAIKeysAttempted = true;
      for (let i = 0; i < this.openai_keys.length; i++) {
        const key = this._selectKey(this.openai_keys, "openai");
        if (key) {
          try {
            console.log(`Trying OpenAI key ...${key.slice(-4)}`);
            return await this._callOpenAI(key, prompt);
          } catch (e) {
            lastError = e;
            new import_obsidian3.Notice(`OpenAI key ...${key.slice(-4)} failed. Trying next.`);
          }
        }
      }
    } else if (this.openai_keys.length > 0) {
      openAIKeysAttempted = true;
      lastError = new Error("OpenAI: \u63D0\u4F9B\u4E86 Key \u4F46\u672A\u6307\u5B9A\u6A21\u578B\u3002");
      console.warn(lastError.message);
    }
    if (googleEnabled) {
      if (openAIKeysAttempted && !this.hasNotifiedFailover) {
        new import_obsidian3.Notice("All OpenAI keys failed or unavailable. Switching to Google Gemini...");
        this.hasNotifiedFailover = true;
      }
      for (let i = 0; i < this.google_keys.length; i++) {
        const key = this._selectKey(this.google_keys, "google");
        if (key) {
          try {
            console.log(`Trying Google Gemini key ...${key.slice(-4)}`);
            return await this._callGoogleAPI(key, prompt);
          } catch (e) {
            lastError = e;
            new import_obsidian3.Notice(`Google Gemini key ...${key.slice(-4)} failed. Trying next.`);
          }
        }
      }
    } else if (this.google_keys.length > 0) {
      lastError = lastError || new Error("Google: \u63D0\u4F9B\u4E86 Key \u4F46\u672A\u6307\u5B9A\u6A21\u578B\u3002");
      console.warn(lastError.message);
    }
    if (!openAIEnabled && !googleEnabled && (this.openai_keys.length > 0 || this.google_keys.length > 0)) {
      new import_obsidian3.Notice("\u8BF7\u5728\u8BBE\u7F6E\u4E2D\u63D0\u4F9BAPI Key\u548C\u81F3\u5C11\u4E00\u4E2A\u6A21\u578B\u540D\u79F0\u3002");
      throw new AllModelsFailedError("\u63D0\u4F9B\u4E86 Key \u4F46\u672A\u6307\u5B9A\u6A21\u578B\u3002");
    }
    throw new AllModelsFailedError(`All API providers failed. Last error: ${lastError == null ? void 0 : lastError.message}`);
  }
};

// critic.ts
var Critic = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.apiHandler = new APIHandler(plugin);
  }
  async judge(content) {
    if (this.plugin.settings.critic_mode === "ai") {
      return this._judgeByAI(content);
    }
    return this._judgeByHeuristic(content);
  }
  _judgeByHeuristic(content) {
    const reasons = [];
    const contentLower = content.toLowerCase();
    const requiredHeaders = this.plugin.settings.critic_required_headers.split("\n").map((h) => h.trim().toLowerCase()).filter(Boolean);
    const missingHeaders = requiredHeaders.filter((h) => !contentLower.includes(h));
    if (missingHeaders.length > 0) {
      reasons.push(`\u7F3A\u5C11\u5FC5\u9700\u7684\u6807\u9898: ${missingHeaders.join(", ")}`);
    }
    if (content.length < this.plugin.settings.critic_min_content_length) {
      reasons.push(`\u5185\u5BB9\u8FC7\u77ED (\u5F53\u524D: ${content.length}, \u8981\u6C42: ${this.plugin.settings.critic_min_content_length})`);
    }
    const refusalPatterns = ["\u4F5C\u4E3A\u4E00?\u4E2AAI", "\u4F5C\u4E3A\u8BED\u8A00\u6A21\u578B", "\u6211\u4E0D\u80FD", "\u6211\u65E0\u6CD5", "\u5F88\u62B1\u6B49"];
    for (const pattern of refusalPatterns) {
      if (new RegExp(pattern, "i").test(content)) {
        reasons.push(`\u5305\u542BAI\u62D2\u7EDD\u8BED (\u5339\u914D: '${pattern}')`);
        break;
      }
    }
    return {
      isApproved: reasons.length === 0,
      reason: reasons.length > 0 ? reasons.join("; ") : "\u901A\u8FC7\u6240\u6709\u542F\u53D1\u5F0F\u89C4\u5219\u68C0\u67E5\u3002"
    };
  }
  async _judgeByAI(content) {
    const prompt = this.plugin.settings.prompt_critic.replace("{content}", content);
    try {
      const response = await this.apiHandler.call(prompt);
      const decisionMatch = response.match(/DECISION:\s*(KEEP|DISCARD)/i);
      const reasonMatch = response.match(/\[REASON:\s*([^\]]+)\]/i);
      const isApproved = decisionMatch ? decisionMatch[1].toUpperCase() === "KEEP" : false;
      const reason = reasonMatch ? reasonMatch[1].trim() : isApproved ? "AI \u6279\u51C6" : "AI \u62D2\u7EDD\uFF0C\u672A\u63D0\u4F9B\u660E\u786E\u7406\u7531";
      return { isApproved, reason };
    } catch (error) {
      console.error("AI Critic call failed:", error);
      return { isApproved: false, reason: `AI \u5BA1\u6838\u5668\u8C03\u7528\u5931\u8D25: ${error.message}` };
    }
  }
};

// reviser.ts
var Reviser = class {
  constructor(plugin) {
    this.plugin = plugin;
  }
  createRevisionPrompt(idea, originalContent, rejectionReason) {
    let prompt = this.plugin.settings.prompt_reviser;
    prompt = prompt.replace("{concept}", idea);
    prompt = prompt.replace("{original_content}", originalContent);
    prompt = prompt.replace("{rejection_reason}", rejectionReason);
    return prompt;
  }
};

// utils.ts
function sanitizeFilename(name) {
  let cleanName = name.replace(/\s*\(.*\)/g, "").trim();
  cleanName = cleanName.replace(/[\\/*?:"<>|]/g, "");
  return cleanName.slice(0, 100);
}
function extractNewIdeas(content) {
  const matches = content.match(/\[\[([^\]]+)\]\]/g);
  if (!matches) {
    return [];
  }
  const ideas = matches.map((match) => {
    return match.slice(2, -2).split("|")[0].trim();
  });
  return [...new Set(ideas)];
}
function cleanMarkdownOutput(content) {
  const trimmed = content.trim();
  if (trimmed.startsWith("```markdown") && trimmed.endsWith("```")) {
    let cleaned = trimmed.substring("```markdown".length, trimmed.length - "```".length);
    return cleaned.trim();
  }
  return trimmed;
}

// engine.ts
var Engine = class {
  constructor(plugin) {
    this.isRunning = false;
    this.timerId = null;
    this.plugin = plugin;
    this.app = plugin.app;
    this.apiHandler = new APIHandler(plugin);
    this.critic = new Critic(plugin);
    this.reviser = new Reviser(plugin);
  }
  // --- Public Controls ---
  /**
   * 切换引擎的运行/暂停状态
   */
  toggleEngineState() {
    if (this.isRunning) {
      this.stop();
    } else {
      this.start();
    }
  }
  /**
   * 添加单个概念到队列，并显示通知
   * @returns {boolean} 是否成功添加
   */
  addConceptToQueue(concept) {
    const added = this.addConceptsToQueue([concept]);
    if (added > 0) {
      new import_obsidian4.Notice(`'${concept}' \u5DF2\u6DFB\u52A0\u5230\u751F\u6210\u961F\u5217\u3002`);
      this.updateStatusBar();
      return true;
    }
    new import_obsidian4.Notice(`'${concept}' \u5DF2\u5B58\u5728\u4E8E\u961F\u5217\u6216\u4ED3\u5E93\u4E2D\uFF0C\u672A\u6DFB\u52A0\u3002`);
    return false;
  }
  /**
   * 添加多个概念到生成队列，会进行去重和检查文件是否存在
   * @param {string[]} concepts - 要添加的概念列表
   * @returns {number} 实际添加的新概念数量
   */
  addConceptsToQueue(concepts) {
    const currentQueue = new Set(this.plugin.data.generationQueue);
    const existingFiles = new Set(this.app.vault.getMarkdownFiles().map((f) => f.basename));
    let addedCount = 0;
    for (const concept of concepts) {
      const sanitized = sanitizeFilename(concept);
      if (!currentQueue.has(concept) && !existingFiles.has(sanitized)) {
        this.plugin.data.generationQueue.push(concept);
        currentQueue.add(concept);
        addedCount++;
      }
    }
    if (addedCount > 0) {
      this.plugin.savePluginData();
      this.updateStatusBar();
    }
    return addedCount;
  }
  // --- Core Loop ---
  /**
   * 启动引擎
   */
  async start() {
    if (this.isRunning)
      return;
    this.isRunning = true;
    this.plugin.data.status = "running";
    new import_obsidian4.Notice("\u77E5\u8BC6\u56FE\u8C31\u5F15\u64CE\u5DF2\u542F\u52A8\uFF01");
    this.updateStatusBar();
    this.tick();
  }
  /**
   * 停止引擎
   */
  stop() {
    if (!this.isRunning)
      return;
    this.isRunning = false;
    this.plugin.data.status = "paused";
    if (this.timerId) {
      clearTimeout(this.timerId);
      this.timerId = null;
    }
    new import_obsidian4.Notice("\u77E5\u8BC6\u56FE\u8C31\u5F15\u64CE\u5DF2\u6682\u505C\u3002");
    this.updateStatusBar();
    this.plugin.savePluginData();
  }
  /**
   * 安排下一个 tick
   */
  scheduleNextTick() {
    if (!this.isRunning)
      return;
    const delay = this.plugin.settings.request_delay * 1e3;
    this.timerId = setTimeout(() => this.tick(), delay);
  }
  /**
   * 引擎的核心“心跳”
   * 它会按优先级（修正 > 审核 > 生成）处理一个批次的任务
   */
  async tick() {
    if (!this.isRunning)
      return;
    try {
      let taskProcessed = false;
      if (this.plugin.data.revisionQueue.length > 0) {
        taskProcessed = await this.runRevisionPhase();
      } else if (this.plugin.data.reviewQueue.length > 0) {
        taskProcessed = await this.runCriticPhase();
      } else if (this.plugin.data.generationQueue.length > 0) {
        taskProcessed = await this.runGenerationPhase();
      }
      if (!taskProcessed && this.plugin.data.generationQueue.length === 0 && this.plugin.data.reviewQueue.length === 0 && this.plugin.data.revisionQueue.length === 0) {
        new import_obsidian4.Notice("\u{1F389} \u6240\u6709\u4EFB\u52A1\u5B8C\u6210\uFF01\u5F15\u64CE\u5DF2\u505C\u6B62\u3002");
        this.isRunning = false;
        this.plugin.data.status = "idle";
        this.updateStatusBar();
        await this.plugin.savePluginData();
        return;
      }
    } catch (error) {
      console.error("\u5F15\u64CE Tick \u53D1\u751F\u4E25\u91CD\u9519\u8BEF:", error);
      new import_obsidian4.Notice("\u5F15\u64CE\u9047\u5230\u9519\u8BEF\uFF0C\u5DF2\u6682\u505C\u3002\u8BF7\u68C0\u67E5\u63A7\u5236\u53F0\u3002");
      this.stop();
      return;
    }
    this.scheduleNextTick();
  }
  // --- Phases ---
  /**
   * 运行“生成”阶段
   * @returns {Promise<boolean>} 是否处理了任务
   */
  async runGenerationPhase() {
    const queue = this.plugin.data.generationQueue;
    if (queue.length === 0)
      return false;
    const batchSize = this.plugin.settings.generation_batch_size;
    const batch = queue.splice(0, Math.min(queue.length, batchSize));
    this.updateStatusBar();
    await this.plugin.savePluginData();
    const tasks = batch.map((idea) => this.generationTask(idea));
    await Promise.allSettled(tasks);
    await this.plugin.savePluginData();
    return true;
  }
  /**
   * 单个生成任务
   */
  async generationTask(idea) {
    const prompt = this.plugin.settings.prompt_generator.replace("{concept}", idea);
    try {
      const content = await this.apiHandler.call(prompt);
      const cleanedContent = cleanMarkdownOutput(content);
      this.plugin.data.reviewQueue.push({ idea, content: cleanedContent });
      console.log(`\u2705 [\u751F\u6210\u6210\u529F]: ${idea}`);
    } catch (e) {
      if (e instanceof AllModelsFailedError) {
        console.error(`\u274C [\u751F\u6210\u5931\u8D25]: ${idea} - ${e.message}`);
        this.plugin.data.generationQueue.unshift(idea);
      }
    }
  }
  /**
   * 运行“审核”阶段
   * @returns {Promise<boolean>} 是否处理了任务
   */
  async runCriticPhase() {
    const queue = this.plugin.data.reviewQueue;
    if (queue.length === 0)
      return false;
    const batchSize = this.plugin.settings.generation_batch_size;
    const tasksToReview = queue.splice(0, Math.min(queue.length, batchSize));
    this.updateStatusBar();
    await this.plugin.savePluginData();
    let newIdeasFound = /* @__PURE__ */ new Set();
    for (const task of tasksToReview) {
      const { isApproved, reason } = await this.critic.judge(task.content);
      if (isApproved) {
        await this.saveNote(task.idea, task.content);
        if (this.plugin.settings.extract_new_concepts) {
          const ideas = extractNewIdeas(task.content);
          ideas.forEach((idea) => newIdeasFound.add(idea));
        }
        console.log(`\u{1F44D} [\u5BA1\u6838\u901A\u8FC7]: ${task.idea}`);
      } else {
        task.reason = reason;
        task.retries = (task.retries || 0) + 1;
        this.plugin.data.revisionQueue.push(task);
        console.warn(`\u{1F44E} [\u5BA1\u6838\u62D2\u7EDD]: ${task.idea} - ${reason}`);
      }
    }
    if (newIdeasFound.size > 0) {
      this.addConceptsToQueue(Array.from(newIdeasFound));
    }
    await this.plugin.savePluginData();
    return true;
  }
  /**
   * 运行“修正”阶段
   * @returns {Promise<boolean>} 是否处理了任务
   */
  async runRevisionPhase() {
    const queue = this.plugin.data.revisionQueue;
    if (queue.length === 0)
      return false;
    const batchSize = this.plugin.settings.generation_batch_size;
    const tasksToRevise = queue.splice(0, Math.min(queue.length, batchSize));
    this.updateStatusBar();
    await this.plugin.savePluginData();
    for (const task of tasksToRevise) {
      if ((task.retries || 0) >= this.plugin.settings.max_revision_retries) {
        this.plugin.data.discardedPile.push(task);
        console.error(`\u{1F480} [\u653E\u5F03\u4FEE\u6B63]: ${task.idea} \u5DF2\u8FBE\u6700\u5927\u91CD\u8BD5\u6B21\u6570\u3002`);
        continue;
      }
      await this.revisionTask(task);
    }
    await this.plugin.savePluginData();
    return true;
  }
  /**
   * 单个修正任务
   */
  async revisionTask(task) {
    const prompt = this.reviser.createRevisionPrompt(task.idea, task.content, task.reason || "\u672A\u77E5\u539F\u56E0");
    try {
      const newContent = await this.apiHandler.call(prompt);
      const cleanedContent = cleanMarkdownOutput(newContent);
      const revisedTask = { ...task, content: cleanedContent };
      this.plugin.data.reviewQueue.push(revisedTask);
      console.log(`\u{1F504} [\u4FEE\u6B63\u5B8C\u6210]: ${task.idea}`);
    } catch (e) {
      console.error(`\u274C [\u4FEE\u6B63\u5931\u8D25]: ${task.idea} - ${e.message}`);
      this.plugin.data.revisionQueue.unshift(task);
    }
  }
  // --- File & UI ---
  /**
   * 保存笔记到文件系统
   */
  async saveNote(idea, content) {
    const filename = sanitizeFilename(idea);
    const folderPath = this.plugin.settings.output_dir;
    if (!(this.app.vault.getAbstractFileByPath(folderPath) instanceof import_obsidian4.TFolder)) {
      try {
        await this.app.vault.createFolder(folderPath);
      } catch (error) {
        console.error(`\u521B\u5EFA\u6587\u4EF6\u5939\u5931\u8D25: ${folderPath}`, error);
        new import_obsidian4.Notice(`\u65E0\u6CD5\u521B\u5EFA\u8F93\u51FA\u6587\u4EF6\u5939: ${folderPath}`);
        return;
      }
    }
    const filePath = (0, import_obsidian4.normalizePath)(`${folderPath}/${filename}.md`);
    const file = this.app.vault.getAbstractFileByPath(filePath);
    try {
      if (file instanceof import_obsidian4.TFile) {
        await this.app.vault.modify(file, content);
        new import_obsidian4.Notice(`\u7B14\u8BB0\u5DF2\u66F4\u65B0: ${filename}`);
      } else {
        await this.app.vault.create(filePath, content);
        new import_obsidian4.Notice(`\u7B14\u8BB0\u5DF2\u521B\u5EFA: ${filename}`);
      }
    } catch (error) {
      console.error(`\u4FDD\u5B58\u7B14\u8BB0\u5931\u8D25: ${filePath}`, error);
      new import_obsidian4.Notice(`\u65E0\u6CD5\u4FDD\u5B58\u7B14\u8BB0: ${filename}`);
    }
  }
  /**
   * 更新状态栏显示
   */
  updateStatusBar() {
    if (!this.plugin.statusBarEl)
      return;
    const { generationQueue, reviewQueue, revisionQueue } = this.plugin.data;
    const total = generationQueue.length + reviewQueue.length + revisionQueue.length;
    this.plugin.statusBarEl.setText(
      `KG: ${this.plugin.data.status} | G:${generationQueue.length} | C:${reviewQueue.length} | R:${revisionQueue.length} | Total:${total}`
    );
    this.app.workspace.trigger("kg-data-updated");
  }
};

// main.ts
var DEFAULT_PLUGIN_DATA = {
  status: "idle",
  generationQueue: [],
  reviewQueue: [],
  revisionQueue: [],
  discardedPile: []
};
var KnowledgeGraphPlugin = class extends import_obsidian5.Plugin {
  async onload() {
    await this.loadSettings();
    await this.loadPluginData();
    this.engine = new Engine(this);
    const ribbonIconEl = this.addRibbonIcon("brain-circuit", "\u77E5\u8BC6\u56FE\u8C31\u751F\u6210\u5668", (evt) => {
      this.engine.toggleEngineState();
    });
    ribbonIconEl.addClass("knowledge-graph-plugin-ribbon-class");
    this.statusBarEl = this.addStatusBarItem();
    this.engine.updateStatusBar();
    this.addSettingTab(new KGsSettingTab(this.app, this));
    this.addCommand({
      id: "toggle-knowledge-graph-engine",
      name: "\u542F\u52A8/\u6682\u505C \u77E5\u8BC6\u56FE\u8C31\u751F\u6210",
      callback: () => {
        this.engine.toggleEngineState();
      }
    });
    this.addCommand({
      id: "add-current-note-to-queue",
      name: "\u5C06\u5F53\u524D\u7B14\u8BB0\u6807\u9898\u6DFB\u52A0\u5230\u751F\u6210\u961F\u5217",
      checkCallback: (checking) => {
        const file = this.app.workspace.getActiveFile();
        if (file) {
          if (!checking) {
            this.engine.addConceptToQueue(file.basename);
          }
          return true;
        }
        return false;
      }
    });
    console.log("\u77E5\u8BC6\u56FE\u8C31\u63D2\u4EF6\u5DF2\u52A0\u8F7D\uFF01");
  }
  onunload() {
    console.log("\u77E5\u8BC6\u56FE\u8C31\u63D2\u4EF6\u5DF2\u5378\u8F7D\u3002");
  }
  /**
   * 加载插件的配置。
   * 它会合并默认设置、默认提示和用户保存的设置。
   * 这个方法需要兼容旧版本的数据结构。
   */
  async loadSettings() {
    const defaultPrompts = await getDefaultPrompts();
    const savedData = await this.loadData();
    const savedSettings = savedData || {};
    this.settings = Object.assign({}, DEFAULT_SETTINGS, defaultPrompts, savedSettings);
  }
  /**
   * 保存插件的配置和状态。
   * 这是唯一一个直接写入文件的方法，它将所有数据打包在一起。
   */
  async saveSettings() {
    const dataToSave = { ...this.settings, pluginState: this.data };
    await this.saveData(dataToSave);
  }
  /**
   * 加载插件的运行时状态。
   * 它会从保存的数据中提取 pluginState 部分。
   */
  async loadPluginData() {
    const savedData = await this.loadData();
    const savedState = (savedData == null ? void 0 : savedData.pluginState) || {};
    this.data = Object.assign({}, DEFAULT_PLUGIN_DATA, savedState);
  }
  /**
   * 保存插件的运行时状态。
   * 这个方法只是一个方便的别名，它实际上调用 saveSettings。
   * 这保证了状态和配置总是在一起被原子性地保存。
   */
  async savePluginData() {
    await this.saveSettings();
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzZXR0aW5ncy50cyIsICJRdWV1ZU1vZGFsLnRzIiwgImVuZ2luZS50cyIsICJhcGlIYW5kbGVyLnRzIiwgImNyaXRpYy50cyIsICJyZXZpc2VyLnRzIiwgInV0aWxzLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBBcHAsIFBsdWdpbiwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZywgTm90aWNlLCBURmlsZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IEtub3dsZWRnZUdyYXBoUGx1Z2luU2V0dGluZ3MsIFBsdWdpbkRhdGEgfSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7IEtHc1NldHRpbmdUYWIsIERFRkFVTFRfU0VUVElOR1MsIGdldERlZmF1bHRQcm9tcHRzIH0gZnJvbSAnLi9zZXR0aW5ncyc7XG5pbXBvcnQgeyBFbmdpbmUgfSBmcm9tICcuL2VuZ2luZSc7XG5cbmNvbnN0IERFRkFVTFRfUExVR0lOX0RBVEE6IFBsdWdpbkRhdGEgPSB7XG4gICAgc3RhdHVzOiAnaWRsZScsXG4gICAgZ2VuZXJhdGlvblF1ZXVlOiBbXSxcbiAgICByZXZpZXdRdWV1ZTogW10sXG4gICAgcmV2aXNpb25RdWV1ZTogW10sXG4gICAgZGlzY2FyZGVkUGlsZTogW10sXG59O1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBLbm93bGVkZ2VHcmFwaFBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG4gICAgc2V0dGluZ3M6IEtub3dsZWRnZUdyYXBoUGx1Z2luU2V0dGluZ3M7XG4gICAgZGF0YTogUGx1Z2luRGF0YTtcbiAgICBlbmdpbmU6IEVuZ2luZTtcbiAgICBzdGF0dXNCYXJFbDogSFRNTEVsZW1lbnQ7XG5cbiAgICBhc3luYyBvbmxvYWQoKSB7XG4gICAgICAgIC8vIDEuIFx1OTk5Nlx1NTE0OFx1NTJBMFx1OEY3RFx1OEJCRVx1N0Y2RSAoc2V0dGluZ3MpXG4gICAgICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cbiAgICAgICAgLy8gMi4gXHU3MTM2XHU1NDBFXHU1MkEwXHU4RjdEXHU2M0QyXHU0RUY2XHU3MkI2XHU2MDAxXG4gICAgICAgIGF3YWl0IHRoaXMubG9hZFBsdWdpbkRhdGEoKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMuZW5naW5lID0gbmV3IEVuZ2luZSh0aGlzKTtcblxuICAgICAgICAvLyBcdTdGMEVcdTVFMjZcdTU2RkVcdTY4MDdcbiAgICAgICAgY29uc3QgcmliYm9uSWNvbkVsID0gdGhpcy5hZGRSaWJib25JY29uKCdicmFpbi1jaXJjdWl0JywgJ1x1NzdFNVx1OEJDNlx1NTZGRVx1OEMzMVx1NzUxRlx1NjIxMFx1NTY2OCcsIChldnQ6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZW5naW5lLnRvZ2dsZUVuZ2luZVN0YXRlKCk7XG4gICAgICAgIH0pO1xuICAgICAgICByaWJib25JY29uRWwuYWRkQ2xhc3MoJ2tub3dsZWRnZS1ncmFwaC1wbHVnaW4tcmliYm9uLWNsYXNzJyk7XG5cbiAgICAgICAgLy8gXHU3MkI2XHU2MDAxXHU2ODBGXG4gICAgICAgIHRoaXMuc3RhdHVzQmFyRWwgPSB0aGlzLmFkZFN0YXR1c0Jhckl0ZW0oKTtcbiAgICAgICAgdGhpcy5lbmdpbmUudXBkYXRlU3RhdHVzQmFyKCk7XG5cbiAgICAgICAgLy8gXHU4QkJFXHU3RjZFXHU5MDA5XHU5ODc5XHU1MzYxXG4gICAgICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgS0dzU2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xuXG4gICAgICAgIC8vIFx1NTQ3RFx1NEVFNFxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICd0b2dnbGUta25vd2xlZGdlLWdyYXBoLWVuZ2luZScsXG4gICAgICAgICAgICBuYW1lOiAnXHU1NDJGXHU1MkE4L1x1NjY4Mlx1NTA1QyBcdTc3RTVcdThCQzZcdTU2RkVcdThDMzFcdTc1MUZcdTYyMTAnLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmVuZ2luZS50b2dnbGVFbmdpbmVTdGF0ZSgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAnYWRkLWN1cnJlbnQtbm90ZS10by1xdWV1ZScsXG4gICAgICAgICAgICBuYW1lOiAnXHU1QzA2XHU1RjUzXHU1MjREXHU3QjE0XHU4QkIwXHU2ODA3XHU5ODk4XHU2REZCXHU1MkEwXHU1MjMwXHU3NTFGXHU2MjEwXHU5NjFGXHU1MjE3JyxcbiAgICAgICAgICAgIGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICAgICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghY2hlY2tpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW5naW5lLmFkZENvbmNlcHRUb1F1ZXVlKGZpbGUuYmFzZW5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zb2xlLmxvZygnXHU3N0U1XHU4QkM2XHU1NkZFXHU4QzMxXHU2M0QyXHU0RUY2XHU1REYyXHU1MkEwXHU4RjdEXHVGRjAxJyk7XG4gICAgfVxuXG4gICAgb251bmxvYWQoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdcdTc3RTVcdThCQzZcdTU2RkVcdThDMzFcdTYzRDJcdTRFRjZcdTVERjJcdTUzNzhcdThGN0RcdTMwMDInKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBcdTUyQTBcdThGN0RcdTYzRDJcdTRFRjZcdTc2ODRcdTkxNERcdTdGNkVcdTMwMDJcbiAgICAgKiBcdTVCODNcdTRGMUFcdTU0MDhcdTVFNzZcdTlFRDhcdThCQTRcdThCQkVcdTdGNkVcdTMwMDFcdTlFRDhcdThCQTRcdTYzRDBcdTc5M0FcdTU0OENcdTc1MjhcdTYyMzdcdTRGRERcdTVCNThcdTc2ODRcdThCQkVcdTdGNkVcdTMwMDJcbiAgICAgKiBcdThGRDlcdTRFMkFcdTY1QjlcdTZDRDVcdTk3MDBcdTg5ODFcdTUxN0NcdTVCQjlcdTY1RTdcdTcyNDhcdTY3MkNcdTc2ODRcdTY1NzBcdTYzNkVcdTdFRDNcdTY3ODRcdTMwMDJcbiAgICAgKi9cbiAgICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG4gICAgICAgIGNvbnN0IGRlZmF1bHRQcm9tcHRzID0gYXdhaXQgZ2V0RGVmYXVsdFByb21wdHMoKTtcbiAgICAgICAgLy8gbG9hZERhdGEoKSBcdTRGMUFcdThCRkJcdTUzRDZcdTY1NzRcdTRFMkEgZGF0YS5qc29uIFx1NjU4N1x1NEVGNlxuICAgICAgICBjb25zdCBzYXZlZERhdGEgPSBhd2FpdCB0aGlzLmxvYWREYXRhKCk7XG4gICAgICAgIC8vIFx1NEVDRVx1NEZERFx1NUI1OFx1NzY4NFx1NjU3MFx1NjM2RVx1NEUyRFx1NjNEMFx1NTNENlx1OEJCRVx1N0Y2RVx1OTBFOFx1NTIwNlxuICAgICAgICBjb25zdCBzYXZlZFNldHRpbmdzID0gc2F2ZWREYXRhIHx8IHt9O1xuICAgICAgICBcbiAgICAgICAgLy8gXHU1NDA4XHU1RTc2XHU2MjQwXHU2NzA5XHU4QkJFXHU3RjZFXHVGRjBDXHU3ODZFXHU0RkREXHU2MjQwXHU2NzA5XHU5MTREXHU3RjZFXHU5ODc5XHU5MEZEXHU2NzA5XHU1MDNDXG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBkZWZhdWx0UHJvbXB0cywgc2F2ZWRTZXR0aW5ncyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogXHU0RkREXHU1QjU4XHU2M0QyXHU0RUY2XHU3Njg0XHU5MTREXHU3RjZFXHU1NDhDXHU3MkI2XHU2MDAxXHUzMDAyXG4gICAgICogXHU4RkQ5XHU2NjJGXHU1NTJGXHU0RTAwXHU0RTAwXHU0RTJBXHU3NkY0XHU2M0E1XHU1MTk5XHU1MTY1XHU2NTg3XHU0RUY2XHU3Njg0XHU2NUI5XHU2Q0Q1XHVGRjBDXHU1QjgzXHU1QzA2XHU2MjQwXHU2NzA5XHU2NTcwXHU2MzZFXHU2MjUzXHU1MzA1XHU1NzI4XHU0RTAwXHU4RDc3XHUzMDAyXG4gICAgICovXG4gICAgYXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuICAgICAgICBjb25zdCBkYXRhVG9TYXZlID0geyAuLi50aGlzLnNldHRpbmdzLCBwbHVnaW5TdGF0ZTogdGhpcy5kYXRhIH07XG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEoZGF0YVRvU2F2ZSk7XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIFx1NTJBMFx1OEY3RFx1NjNEMlx1NEVGNlx1NzY4NFx1OEZEMFx1ODg0Q1x1NjVGNlx1NzJCNlx1NjAwMVx1MzAwMlxuICAgICAqIFx1NUI4M1x1NEYxQVx1NEVDRVx1NEZERFx1NUI1OFx1NzY4NFx1NjU3MFx1NjM2RVx1NEUyRFx1NjNEMFx1NTNENiBwbHVnaW5TdGF0ZSBcdTkwRThcdTUyMDZcdTMwMDJcbiAgICAgKi9cbiAgICBhc3luYyBsb2FkUGx1Z2luRGF0YSgpIHtcbiAgICAgICAgLy8gbG9hZERhdGEoKSBcdTRGMUFcdThCRkJcdTUzRDZcdTY1NzRcdTRFMkEgZGF0YS5qc29uIFx1NjU4N1x1NEVGNlxuICAgICAgICBjb25zdCBzYXZlZERhdGEgPSBhd2FpdCB0aGlzLmxvYWREYXRhKCk7XG4gICAgICAgIC8vIFx1NEVDRVx1NEZERFx1NUI1OFx1NzY4NFx1NjU3MFx1NjM2RVx1NEUyRFx1NjNEMFx1NTNENlx1NzJCNlx1NjAwMVx1OTBFOFx1NTIwNlxuICAgICAgICBjb25zdCBzYXZlZFN0YXRlID0gc2F2ZWREYXRhPy5wbHVnaW5TdGF0ZSB8fCB7fTtcbiAgICAgICAgXG4gICAgICAgIC8vIFx1NTQwOFx1NUU3Nlx1OUVEOFx1OEJBNFx1NzJCNlx1NjAwMVx1NTQ4Q1x1NzUyOFx1NjIzN1x1NEZERFx1NUI1OFx1NzY4NFx1NzJCNlx1NjAwMVxuICAgICAgICB0aGlzLmRhdGEgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1BMVUdJTl9EQVRBLCBzYXZlZFN0YXRlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBcdTRGRERcdTVCNThcdTYzRDJcdTRFRjZcdTc2ODRcdThGRDBcdTg4NENcdTY1RjZcdTcyQjZcdTYwMDFcdTMwMDJcbiAgICAgKiBcdThGRDlcdTRFMkFcdTY1QjlcdTZDRDVcdTUzRUFcdTY2MkZcdTRFMDBcdTRFMkFcdTY1QjlcdTRGQkZcdTc2ODRcdTUyMkJcdTU0MERcdUZGMENcdTVCODNcdTVCOUVcdTk2NDVcdTRFMEFcdThDMDNcdTc1Mjggc2F2ZVNldHRpbmdzXHUzMDAyXG4gICAgICogXHU4RkQ5XHU0RkREXHU4QkMxXHU0RTg2XHU3MkI2XHU2MDAxXHU1NDhDXHU5MTREXHU3RjZFXHU2MDNCXHU2NjJGXHU1NzI4XHU0RTAwXHU4RDc3XHU4OEFCXHU1MzlGXHU1QjUwXHU2MDI3XHU1NzMwXHU0RkREXHU1QjU4XHUzMDAyXG4gICAgICovXG4gICAgYXN5bmMgc2F2ZVBsdWdpbkRhdGEoKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZVNldHRpbmdzKCk7XG4gICAgfVxufVxuIiwgIi8vIHNldHRpbmdzLnRzIChcdTVERjJcdTkxQ0RcdTY3ODRcdTRFM0EgVHlwZVNjcmlwdClcblxuaW1wb3J0IHsgQXBwLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nLCBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgS25vd2xlZGdlR3JhcGhQbHVnaW4gZnJvbSAnLi9tYWluJztcbmltcG9ydCB7IEtub3dsZWRnZUdyYXBoUGx1Z2luU2V0dGluZ3MgfSBmcm9tICcuL3R5cGVzJztcbi8vIFx1NUJGQ1x1NTE2NVx1NURGMlx1NkUwNVx1NzQwNlx1NzY4NCBNb2RhbFxuaW1wb3J0IHsgUXVldWVNYW5hZ2VtZW50TW9kYWwgfSBmcm9tICcuL1F1ZXVlTW9kYWwnO1xuXG4vLyAtLS0gXHU5RUQ4XHU4QkE0IFByb21wdHMgLS0tXG5jb25zdCBQUk9NUFRfR0VORVJBVE9SX0RFRkFVTFQgPSBgIyBSb2xlOiBcdTc3RTVcdThCQzZcdTdDRkJcdTdFREZcdTY3ODRcdTVFRkFcdTRFMTNcdTVCQjYuLi5gO1xuY29uc3QgUFJPTVBUX0NSSVRJQ19ERUZBVUxUID0gYCMgUm9sZTogXHU3N0U1XHU4QkM2XHU1NkZFXHU4QzMxXHU4RDI4XHU5MUNGXHU1QkExXHU2ODM4XHU1NDU4Li4uYDtcbmNvbnN0IFBST01QVF9SRVZJU0VSX0RFRkFVTFQgPSBgIyBcdTg5RDJcdTgyNzI6IFx1OEQ0NFx1NkRGMVx1NzdFNVx1OEJDNlx1N0YxNlx1OEY5MVx1NEUwRVx1NTE4NVx1NUJCOVx1NEYxOFx1NTMxNlx1NEUxM1x1NUJCNi4uLmA7XG5cbi8vIC0tLSBcdTlFRDhcdThCQTRcdThCQkVcdTdGNkUgLS0tXG5leHBvcnQgY29uc3QgREVGQVVMVF9TRVRUSU5HUzogS25vd2xlZGdlR3JhcGhQbHVnaW5TZXR0aW5ncyA9IHtcbiAgICAvLyBBUElcbiAgICBvcGVuYWlfYXBpX2tleXM6IFwiXCIsXG4gICAgb3BlbmFpX2Jhc2VfdXJsOiBcImh0dHBzOi8vYXBpLm9wZW5haS5jb20vdjFcIixcbiAgICBvcGVuYWlfbW9kZWw6IFwiZ3B0LTQtdHVyYm8tcHJldmlld1wiLFxuICAgIG9wZW5haV9iYWNrdXBfbW9kZWw6IFwiXCIsXG4gICAgZ29vZ2xlX2FwaV9rZXlzOiBcIlwiLFxuICAgIGdvb2dsZV9tb2RlbDogXCJnZW1pbmktMS41LXByby1sYXRlc3RcIixcbiAgICBnb29nbGVfYmFja3VwX21vZGVsOiBcIlwiLFxuICAgIGZhaWxvdmVyX2Nvb2xkb3duX3NlY29uZHM6IDMwMCxcbiAgICBcbiAgICAvLyBcdTUzQzJcdTY1NzBcbiAgICBnZW5lcmF0aW9uX3RlbXBlcmF0dXJlOiAwLjcsXG4gICAgZ2VuZXJhdGlvbl9tYXhfdG9rZW5zOiA0MDk2LFxuICAgIFxuICAgIC8vIFx1OERFRlx1NUY4NFxuICAgIG91dHB1dF9kaXI6IFwiS25vd2xlZGdlR3JhcGhOb3Rlc1wiLFxuICAgIFxuICAgIC8vIFx1N0NGQlx1N0VERlxuICAgIGdlbmVyYXRpb25fYmF0Y2hfc2l6ZTogNSxcbiAgICByZXF1ZXN0X2RlbGF5OiA1LFxuICAgIFxuICAgIC8vIENyaXRpY1xuICAgIGNyaXRpY19tb2RlOiBcImhldXJpc3RpY1wiLFxuICAgIGNyaXRpY19yZXF1aXJlZF9oZWFkZXJzOiBcIiMgXHVEODNFXHVEREUwXFxuPiBcXG4jIyBcdUQ4M0RcdURDQTEgXHU2ODM4XHU1RkMzXHU2MDFEXHU2MEYzXFxuIyMgXHVEODNDXHVERkFGIFx1OTAwMlx1NzUyOFx1NTczQVx1NjY2RlxcbiMjIFx1RDgzRFx1REVFMFx1RkUwRiBcdTRGN0ZcdTc1MjhcdTZCNjVcdTlBQTQvXHU2Nzg0XHU2MjEwXHU4OTgxXHU3RDIwXFxuIyMgXHVEODNEXHVERTgwIFx1Njg0OFx1NEY4Qlx1NTIwNlx1Njc5MFxcbiMjIFx1RDgzRFx1REM0RCBcdTRGMThcdTcwQjkgJiBcdUQ4M0RcdURDNEUgXHU3RjNBXHU3MEI5XFxuIyMgXHVEODNEXHVERDE3IFx1NTE3M1x1ODA1NFx1NkEyMVx1NTc4QlwiLFxuICAgIGNyaXRpY19taW5fY29udGVudF9sZW5ndGg6IDQwMCxcbiAgICBcbiAgICAvLyBSZXZpc2VyXG4gICAgbWF4X3JldmlzaW9uX3JldHJpZXM6IDIsXG4gICAgXG4gICAgLy8gUHJvbXB0c1xuICAgIHByb21wdF9nZW5lcmF0b3I6IFBST01QVF9HRU5FUkFUT1JfREVGQVVMVCxcbiAgICBwcm9tcHRfY3JpdGljOiBQUk9NUFRfQ1JJVElDX0RFRkFVTFQsXG4gICAgcHJvbXB0X3JldmlzZXI6IFBST01QVF9SRVZJU0VSX0RFRkFVTFQsXG4gICAgXG4gICAgLy8gXHU2NEFEXHU3OUNEXHU3QkIxXG4gICAgc2VlZENvbmNlcHRzOiBcIlwiLFxuICAgIFxuICAgIC8vIFx1NjVCMFx1Njk4Mlx1NUZGNVx1NjNEMFx1NTNENlxuICAgIGV4dHJhY3RfbmV3X2NvbmNlcHRzOiBmYWxzZVxufTtcblxuLy8gLS0tIFx1OUVEOFx1OEJBNCBQcm9tcHRzIFx1ODNCN1x1NTNENlx1NTFGRFx1NjU3MCAtLS1cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXREZWZhdWx0UHJvbXB0cygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBwcm9tcHRfZ2VuZXJhdG9yOiBQUk9NUFRfR0VORVJBVE9SX0RFRkFVTFQsXG4gICAgICAgIHByb21wdF9jcml0aWM6IFBST01QVF9DUklUSUNfREVGQVVMVCxcbiAgICAgICAgcHJvbXB0X3JldmlzZXI6IFBST01QVF9SRVZJU0VSX0RFRkFVTFRcbiAgICB9O1xufVxuXG4vLyAtLS0gXHU4QkJFXHU3RjZFXHU5MDA5XHU5ODc5XHU1MzYxIC0tLVxuZXhwb3J0IGNsYXNzIEtHc1NldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcbiAgICBwbHVnaW46IEtub3dsZWRnZUdyYXBoUGx1Z2luO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogS25vd2xlZGdlR3JhcGhQbHVnaW4pIHtcbiAgICAgICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICB9XG5cbiAgICBkaXNwbGF5KCk6IHZvaWQge1xuICAgICAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbChcImgyXCIsIHsgdGV4dDogXCJcdTc3RTVcdThCQzZcdTU2RkVcdThDMzFcdTc1MUZcdTYyMTBcdTU2NjggLSBcdThCQkVcdTdGNkVcIiB9KTtcblxuICAgICAgICAvLyAtLS0gXHU5NjFGXHU1MjE3XHU3QkExXHU3NDA2IC0tLVxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKFwiXHU1RjE1XHU2NENFXHU0RUVBXHU4ODY4XHU3NkQ4XCIpXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlx1N0JBMVx1NzQwNlx1NUY4NVx1NzUxRlx1NjIxMFx1MzAwMVx1NUY4NVx1NUJBMVx1NjgzOFx1NTQ4Q1x1NURGMlx1NEUyMlx1NUYwM1x1NzY4NFx1NEVGQlx1NTJBMVx1MzAwMlwiKVxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXG4gICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoXCJcdTYyNTNcdTVGMDBcdTk2MUZcdTUyMTdcdTdCQTFcdTc0MDZcdTU2NjhcIilcbiAgICAgICAgICAgICAgICAuc2V0Q3RhKClcbiAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFx1NEY3Rlx1NzUyOFx1NUJGQ1x1NTE2NVx1NzY4NFx1MzAwMVx1NUU3Mlx1NTFDMFx1NzY4NCBNb2RhbFxuICAgICAgICAgICAgICAgICAgICBuZXcgUXVldWVNYW5hZ2VtZW50TW9kYWwodGhpcy5hcHAsIHRoaXMucGx1Z2luKS5vcGVuKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgLy8gLS0tIEFQSSBcdThCQkVcdTdGNkUgLS0tXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKS5zZXROYW1lKFwiQVBJIFx1OEJCRVx1N0Y2RVwiKS5zZXRIZWFkaW5nKCk7XG5cbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoXCJoM1wiLCB7IHRleHQ6IFwiT3BlbkFJXCIgfSk7XG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJPcGVuQUkgQVBJIEtleXNcIilcbiAgICAgICAgICAgIC5zZXREZXNjKFwiXHU2QkNGXHU4ODRDXHU0RTAwXHU0RTJBIEtleVx1MzAwMlx1NjNEMlx1NEVGNlx1NUMwNlx1ODFFQVx1NTJBOFx1OEY2RVx1NjM2Mlx1NTQ4Q1x1NTFCN1x1NTM3NFx1NEY3Rlx1NzUyOFx1MzAwMlwiKVxuICAgICAgICAgICAgLmFkZFRleHRBcmVhKHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcInNrLS4uLlwiKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5vcGVuYWlfYXBpX2tleXMpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5vcGVuYWlfYXBpX2tleXMgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJPcGVuQUkgQmFzZSBVUkxcIilcbiAgICAgICAgICAgIC5zZXREZXNjKFwiXHU1OTgyXHU2NzlDXHU0RjdGXHU3NTI4XHU3QjJDXHU0RTA5XHU2NUI5XHU0RUUzXHU3NDA2XHVGRjBDXHU4QkY3XHU1NzI4XHU2QjY0XHU1OTA0XHU1ODZCXHU1MTY1XHU0RUUzXHU3NDA2XHU1NzMwXHU1NzQwXHUzMDAyXCIpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoXCJodHRwczovL2FwaS5vcGVuYWkuY29tL3YxXCIpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm9wZW5haV9iYXNlX3VybClcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm9wZW5haV9iYXNlX3VybCA9IHZhbHVlLnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICBcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZShcIk9wZW5BSSBNb2RlbCAoXHU0RTNCXHU2QTIxXHU1NzhCKVwiKVxuICAgICAgICAgICAgLnNldERlc2MoXCJcdThGOTNcdTUxNjVcdTRGNjBcdTYwRjNcdTRGN0ZcdTc1MjhcdTc2ODQgT3BlbkFJIFx1NEUzQlx1ODk4MVx1NkEyMVx1NTc4Qlx1NTQwRFx1NzlGMFx1MzAwMlwiKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKFwiZ3B0LTQtdHVyYm8tcHJldmlld1wiKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5vcGVuYWlfbW9kZWwpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5vcGVuYWlfbW9kZWwgPSB2YWx1ZS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJPcGVuQUkgXHU1OTA3XHU3NTI4XHU2QTIxXHU1NzhCIChCYWNrdXAgTW9kZWwpXCIpXG4gICAgICAgICAgICAuc2V0RGVzYyhcIihcdTUzRUZcdTkwMDkpIFx1NUY1M1x1NEUzQlx1NkEyMVx1NTc4Qlx1OTg5RFx1NUVBNlx1ODAxN1x1NUMzRFx1NjIxNlx1NTkzMVx1OEQyNVx1NjVGNlx1RkYwQ1x1NUMwNlx1ODFFQVx1NTJBOFx1NUMxRFx1OEJENVx1NkI2NFx1NTkwN1x1NzUyOFx1NkEyMVx1NTc4Qlx1MzAwMlwiKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKFwiZ3B0LTMuNS10dXJib1wiKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5vcGVuYWlfYmFja3VwX21vZGVsKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Mub3BlbmFpX2JhY2t1cF9tb2RlbCA9IHZhbHVlLnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiaDNcIiwgeyB0ZXh0OiBcIkdvb2dsZSBHZW1pbmlcIiB9KTtcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZShcIkdvb2dsZSBHZW1pbmkgQVBJIEtleXNcIilcbiAgICAgICAgICAgIC5zZXREZXNjKFwiXHU2QkNGXHU4ODRDXHU0RTAwXHU0RTJBIEtleVx1MzAwMlwiKVxuICAgICAgICAgICAgLmFkZFRleHRBcmVhKHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcIkFJemFTeS4uLlwiKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nb29nbGVfYXBpX2tleXMpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5nb29nbGVfYXBpX2tleXMgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJHb29nbGUgR2VtaW5pIE1vZGVsIChcdTRFM0JcdTZBMjFcdTU3OEIpXCIpXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlx1OEY5M1x1NTE2NVx1NEY2MFx1NjBGM1x1NEY3Rlx1NzUyOFx1NzY4NCBHb29nbGUgXHU0RTNCXHU4OTgxXHU2QTIxXHU1NzhCXHU1NDBEXHU3OUYwXHUzMDAyXCIpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoXCJnZW1pbmktMS41LXByby1sYXRlc3RcIilcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZ29vZ2xlX21vZGVsKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ29vZ2xlX21vZGVsID0gdmFsdWUudHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZShcIkdvb2dsZSBHZW1pbmkgXHU1OTA3XHU3NTI4XHU2QTIxXHU1NzhCIChCYWNrdXAgTW9kZWwpXCIpXG4gICAgICAgICAgICAuc2V0RGVzYyhcIihcdTUzRUZcdTkwMDkpIFx1NUY1M1x1NEUzQlx1NkEyMVx1NTc4Qlx1OTg5RFx1NUVBNlx1ODAxN1x1NUMzRFx1NjIxNlx1NTkzMVx1OEQyNVx1NjVGNlx1RkYwQ1x1NUMwNlx1ODFFQVx1NTJBOFx1NUMxRFx1OEJENVx1NkI2NFx1NTkwN1x1NzUyOFx1NkEyMVx1NTc4Qlx1MzAwMlwiKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKFwiZ2VtaW5pLTEuMC1wcm9cIilcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZ29vZ2xlX2JhY2t1cF9tb2RlbClcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmdvb2dsZV9iYWNrdXBfbW9kZWwgPSB2YWx1ZS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKFwiS2V5IFx1NTFCN1x1NTM3NFx1NjVGNlx1OTVGNCAoXHU3OUQyKVwiKVxuICAgICAgICAgICAgLnNldERlc2MoXCJBUEkgS2V5IFx1NTkzMVx1OEQyNVx1NTQwRVx1RkYwQ1x1OTcwMFx1ODk4MVx1N0I0OVx1NUY4NVx1NTkxQVx1NUMxMVx1NzlEMlx1NjI0RFx1ODBGRFx1NTE4RFx1NkIyMVx1NEY3Rlx1NzUyOFx1MzAwMlwiKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKFN0cmluZyh0aGlzLnBsdWdpbi5zZXR0aW5ncy5mYWlsb3Zlcl9jb29sZG93bl9zZWNvbmRzKSlcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG51bSA9IHBhcnNlSW50KHZhbHVlLCAxMCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNOYU4obnVtKSAmJiBudW0gPj0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZmFpbG92ZXJfY29vbGRvd25fc2Vjb25kcyA9IG51bTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIC8vIC0tLSBMTE0gXHU1M0MyXHU2NTcwXHU4QkJFXHU3RjZFIC0tLVxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbCkuc2V0TmFtZShcIkxMTSBcdTUzQzJcdTY1NzBcdThCQkVcdTdGNkVcIikuc2V0SGVhZGluZygpO1xuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKFwiXHU3NTFGXHU2MjEwXHU2RTI5XHU1RUE2IChUZW1wZXJhdHVyZSlcIilcbiAgICAgICAgICAgIC5zZXREZXNjKFwiXHU2M0E3XHU1MjM2XHU3NTFGXHU2MjEwXHU1MTg1XHU1QkI5XHU3Njg0XHU5NjhGXHU2NzNBXHU2MDI3XHUzMDAyXHU4RjgzXHU0RjRFXHU3Njg0XHU1MDNDXHVGRjA4XHU1OTgyIDAuMlx1RkYwOVx1NjZGNFx1NTE3N1x1Nzg2RVx1NUI5QVx1NjAyN1x1RkYwQ1x1OEY4M1x1OUFEOFx1NzY4NFx1NTAzQ1x1RkYwOFx1NTk4MiAwLjhcdUZGMDlcdTY2RjRcdTUxNzdcdTUyMUJcdTkwMjBcdTYwMjdcdTMwMDJcIilcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZShTdHJpbmcodGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhdGlvbl90ZW1wZXJhdHVyZSkpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBudW0gPSBwYXJzZUZsb2F0KHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc05hTihudW0pICYmIG51bSA+PSAwICYmIG51bSA8PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW5lcmF0aW9uX3RlbXBlcmF0dXJlID0gbnVtO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZShcIlx1NjcwMFx1NTkyNyBUb2tlbiBcdTY1NzAgKE1heCBUb2tlbnMpXCIpXG4gICAgICAgICAgICAuc2V0RGVzYyhcIkFQSSBcdTRFMDBcdTZCMjFcdThDMDNcdTc1MjhcdTUxNDFcdThCQjhcdTc1MUZcdTYyMTBcdTc2ODRcdTY3MDBcdTU5MjcgVG9rZW4gXHU2NTcwXHU5MUNGXHUzMDAyXCIpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUoU3RyaW5nKHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYXRpb25fbWF4X3Rva2VucykpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBudW0gPSBwYXJzZUludCh2YWx1ZSwgMTApO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzTmFOKG51bSkgJiYgbnVtID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhdGlvbl9tYXhfdG9rZW5zID0gbnVtO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgLy8gLS0tIFx1NUYxNVx1NjRDRVx1OEJCRVx1N0Y2RSAtLS1cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpLnNldE5hbWUoXCJcdTVGMTVcdTY0Q0VcdThCQkVcdTdGNkVcIikuc2V0SGVhZGluZygpO1xuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKFwiXHU4RjkzXHU1MUZBXHU2NTg3XHU0RUY2XHU1OTM5XCIpXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlx1NjI0MFx1NjcwOVx1NzUxRlx1NjIxMFx1NzY4NFx1N0IxNFx1OEJCMFx1NUMwNlx1NEZERFx1NUI1OFx1NTIzMFx1NkI2NFx1NjU4N1x1NEVGNlx1NTkzOVx1MzAwMlwiKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKFwiS25vd2xlZGdlR3JhcGhOb3Rlc1wiKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5vdXRwdXRfZGlyKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Mub3V0cHV0X2RpciA9IHZhbHVlLnRyaW0oKS5yZXBsYWNlKC9cXC8kLywgXCJcIik7IC8vIFx1NzlGQlx1OTY2NFx1NjcyQlx1NUMzRVx1NzY4NCAvXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKFwiXHU3NTFGXHU2MjEwXHU2Mjc5XHU1OTA0XHU3NDA2XHU1OTI3XHU1QzBGXCIpXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlx1NUYxNVx1NjRDRVx1NkJDRlx1NEUwMFx1OEY2RVx1NEVDRVx1MjAxQ1x1NUY4NVx1NzUxRlx1NjIxMFx1OTYxRlx1NTIxN1x1MjAxRFx1NEUyRFx1NTNENlx1NTFGQVx1NzY4NFx1NEVGQlx1NTJBMVx1NjU3MFx1OTFDRlx1MzAwMlwiKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKFN0cmluZyh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW5lcmF0aW9uX2JhdGNoX3NpemUpKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbnVtID0gcGFyc2VJbnQodmFsdWUsIDEwKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc05hTihudW0pICYmIG51bSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYXRpb25fYmF0Y2hfc2l6ZSA9IG51bTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJcdTZCQ0ZcdThGNkVcdThCRjdcdTZDNDJcdTVFRjZcdThGREYgKFx1NzlEMilcIilcbiAgICAgICAgICAgIC5zZXREZXNjKFwiXHU1RjE1XHU2NENFXHU1NzI4XHU1OTA0XHU3NDA2XHU1QjhDXHU0RTAwXHU0RTJBXHU2Mjc5XHU2QjIxXHU1NDBFXHVGRjBDXHU3QjQ5XHU1Rjg1XHU1OTFBXHU1QzExXHU3OUQyXHU1MThEXHU1RjAwXHU1OUNCXHU0RTBCXHU0RTAwXHU0RTJBXHU2Mjc5XHU2QjIxXHUzMDAyXCIpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUoU3RyaW5nKHRoaXMucGx1Z2luLnNldHRpbmdzLnJlcXVlc3RfZGVsYXkpKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbnVtID0gcGFyc2VJbnQodmFsdWUsIDEwKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc05hTihudW0pICYmIG51bSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZXF1ZXN0X2RlbGF5ID0gbnVtO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgIFxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKFwiXHU2NzAwXHU1OTI3XHU0RkVFXHU2QjYzXHU2QjIxXHU2NTcwXCIpXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlx1NEUwMFx1N0JDN1x1N0IxNFx1OEJCMFx1NTcyOFx1ODhBQlx1NjUzRVx1NUYwM1x1RkYwOFx1NzlGQlx1NTE2NSBEaXNjYXJkZWQgUGlsZVx1RkYwOVx1NTI0RFx1RkYwQ1x1NjcwMFx1NTkxQVx1NTE0MVx1OEJCOFx1ODhBQlx1NEZFRVx1NkI2M1x1NzY4NFx1NkIyMVx1NjU3MFx1MzAwMlwiKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKFN0cmluZyh0aGlzLnBsdWdpbi5zZXR0aW5ncy5tYXhfcmV2aXNpb25fcmV0cmllcykpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBudW0gPSBwYXJzZUludCh2YWx1ZSwgMTApO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzTmFOKG51bSkgJiYgbnVtID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm1heF9yZXZpc2lvbl9yZXRyaWVzID0gbnVtO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgIFxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKFwiXHU4MUVBXHU1MkE4XHU2M0QwXHU1M0Q2XHU2NUIwXHU2OTgyXHU1RkY1IChFeHRyYWN0IE5ldyBDb25jZXB0cylcIilcbiAgICAgICAgICAgIC5zZXREZXNjKFwiXHU1RjAwXHU1NDJGXHU1NDBFXHVGRjBDXHU1QzA2XHU4MUVBXHU1MkE4XHU0RUNFXHU1REYyXHU2Mjc5XHU1MUM2XHU3QjE0XHU4QkIwXHU3Njg0XHU1MTg1XHU1QkI5XHU0RTJEXHU2M0QwXHU1M0Q2IFtbV2lraWxpbmtzXV0gXHU0RjVDXHU0RTNBXHU2NUIwXHU2OTgyXHU1RkY1XHU1MkEwXHU1MTY1XHUyMDFDXHU1Rjg1XHU3NTFGXHU2MjEwXHU5NjFGXHU1MjE3XHUyMDFEXHUzMDAyKFx1OUVEOFx1OEJBNFx1NTE3M1x1OTVFRClcIilcbiAgICAgICAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5leHRyYWN0X25ld19jb25jZXB0cylcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmV4dHJhY3RfbmV3X2NvbmNlcHRzID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuXG4gICAgICAgIC8vIC0tLSBDcml0aWMgXHU4QkJFXHU3RjZFIC0tLVxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKFwiXHU1QkExXHU2ODM4XHU2QTIxXHU1RjBGIChDcml0aWMgTW9kZSlcIilcbiAgICAgICAgICAgIC5zZXREZXNjKFwiXHU5MDA5XHU2MkU5XHU1MTg1XHU1QkI5XHU1QkExXHU2ODM4XHU3Njg0XHU2NUI5XHU1RjBGXHUzMDAyXHU1NDJGXHU1M0QxXHU1RjBGXHU2QTIxXHU1RjBGXHU5MDFGXHU1RUE2XHU1RkVCXHU0RTE0XHU1MTREXHU4RDM5XHVGRjBDXHU0RjQ2XHU1M0VBXHU2OEMwXHU2N0U1XHU2ODNDXHU1RjBGXHVGRjFCQUlcdTZBMjFcdTVGMEZcdTY2RjRcdTY2N0FcdTgwRkRcdUZGMENcdTRGNDZcdTRGMUFcdTZEODhcdTgwMTdBUElcdTk4OURcdTVFQTZcdTMwMDJcIilcbiAgICAgICAgICAgIC5hZGREcm9wZG93bihkcm9wZG93biA9PiBkcm9wZG93blxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oXCJoZXVyaXN0aWNcIiwgXCJcdTU0MkZcdTUzRDFcdTVGMEYgKEhldXJpc3RpYylcIilcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKFwiYWlcIiwgXCJcdTRFQkFcdTVERTVcdTY2N0FcdTgwRkQgKEFJKVwiKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jcml0aWNfbW9kZSlcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiAnaGV1cmlzdGljJyB8ICdhaScpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3JpdGljX21vZGUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpOyAvLyBcdTUyMzdcdTY1QjBcdThCQkVcdTdGNkVcdTk4NzVcdTk3NjJcdTRFRTVcdTY2M0VcdTc5M0EvXHU5NjkwXHU4NUNGXHU3NkY4XHU1MTczXHU5MDA5XHU5ODc5XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jcml0aWNfbW9kZSA9PT0gXCJoZXVyaXN0aWNcIikge1xuICAgICAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAgICAgLnNldE5hbWUoXCJcdTU0MkZcdTUzRDFcdTVGMEZcdTVCQTFcdTY4MzhcdUZGMUFcdTVGQzVcdTk4N0JcdTc2ODRcdTY4MDdcdTk4OThcIilcbiAgICAgICAgICAgICAgICAuc2V0RGVzYyhcIlx1NTcyOFx1NTQyRlx1NTNEMVx1NUYwRlx1NkEyMVx1NUYwRlx1NEUwQlx1RkYwQ1x1NjhDMFx1NjdFNVx1N0IxNFx1OEJCMFx1NjYyRlx1NTQyNlx1NTMwNVx1NTQyQlx1NjI0MFx1NjcwOVx1OEZEOVx1NEU5Qlx1NjgwN1x1OTg5OFx1RkYwOFx1NkJDRlx1ODg0Q1x1NEUwMFx1NEUyQVx1RkYwOVx1MzAwMlwiKVxuICAgICAgICAgICAgICAgIC5hZGRUZXh0QXJlYSh0ZXh0ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGV4dC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jcml0aWNfcmVxdWlyZWRfaGVhZGVycylcbiAgICAgICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jcml0aWNfcmVxdWlyZWRfaGVhZGVycyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRleHQuaW5wdXRFbC5zdHlsZS5oZWlnaHQgPSBcIjE1MHB4XCI7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgICAgIC5zZXROYW1lKFwiXHU1NDJGXHU1M0QxXHU1RjBGXHU1QkExXHU2ODM4XHVGRjFBXHU2NzAwXHU1QzBGXHU1MTg1XHU1QkI5XHU5NTdGXHU1RUE2XCIpXG4gICAgICAgICAgICAgICAgLnNldERlc2MoXCJcdTU3MjhcdTU0MkZcdTUzRDFcdTVGMEZcdTZBMjFcdTVGMEZcdTRFMEJcdUZGMENcdTdCMTRcdThCQjBcdTUxODVcdTVCQjlcdTVGQzVcdTk4N0JcdThGQkVcdTUyMzBcdTc2ODRcdTY3MDBcdTVDMEZcdTVCNTdcdTdCMjZcdTY1NzBcdTMwMDJcIilcbiAgICAgICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKFN0cmluZyh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jcml0aWNfbWluX2NvbnRlbnRfbGVuZ3RoKSlcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbnVtID0gcGFyc2VJbnQodmFsdWUsIDEwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNOYU4obnVtKSAmJiBudW0gPj0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmNyaXRpY19taW5fY29udGVudF9sZW5ndGggPSBudW07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIC0tLSBcdTY5ODJcdTVGRjVcdTY0QURcdTc5Q0QgLS0tXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKS5zZXROYW1lKFwiXHU2OTgyXHU1RkY1XHU2NEFEXHU3OUNEIChDb25jZXB0IFNlZWRpbmcpXCIpLnNldEhlYWRpbmcoKTtcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZShcIlx1Njk4Mlx1NUZGNVx1NjRBRFx1NzlDRFx1N0JCMVwiKVxuICAgICAgICAgICAgLnNldERlc2MoXCJcdTU3MjhcdTZCNjRcdTU5MDRcdTdDOThcdThEMzRcdTYyMTZcdThGOTNcdTUxNjVcdTYwQThcdTYwRjNcdTg5ODFcdTc1MUZcdTYyMTBcdTUyMURcdTU5Q0JcdTdCMTRcdThCQjBcdTc2ODRcdTY5ODJcdTVGRjVcdTUyMTdcdTg4NjhcdUZGMENcdTZCQ0ZcdTg4NENcdTRFMDBcdTRFMkFcdTY5ODJcdTVGRjVcdTMwMDJcIilcbiAgICAgICAgICAgIC5hZGRUZXh0QXJlYSh0ZXh0ID0+IHtcbiAgICAgICAgICAgICAgICB0ZXh0LnNldFBsYWNlaG9sZGVyKFwiXHU0RjhCXHU1OTgyXHVGRjFBXFxuXHU3QjJDXHU0RTAwXHU2MDI3XHU1MzlGXHU3NDA2XFxuXHU1OTY1XHU1MzYxXHU1OUM2XHU1MjQzXHU1MjAwXFxuXHU1MjNCXHU2MTBGXHU3RUMzXHU0RTYwXFxuLi4uXCIpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWVkQ29uY2VwdHMpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnNlZWRDb25jZXB0cyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRleHQuaW5wdXRFbC5zdHlsZS5oZWlnaHQgPSBcIjIwMHB4XCI7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXG4gICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoXCJcdTY0QURcdTc5Q0RcdTUyMzBcdTVGODVcdTc1MUZcdTYyMTBcdTk2MUZcdTUyMTdcIilcbiAgICAgICAgICAgICAgICAuc2V0Q3RhKClcbiAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJhd1RleHQgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWVkQ29uY2VwdHM7XG4gICAgICAgICAgICAgICAgICAgIGlmICghcmF3VGV4dC50cmltKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJcdTY0QURcdTc5Q0RcdTdCQjFcdTRFM0FcdTdBN0FcdUZGMENcdTY1RTBcdTk3MDBcdTY0Q0RcdTRGNUNcdTMwMDJcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29uY2VwdHNUb1NlZWQgPSBbLi4ubmV3IFNldChcbiAgICAgICAgICAgICAgICAgICAgICAgIHJhd1RleHQuc3BsaXQoXCJcXG5cIikubWFwKGxpbmUgPT4gbGluZS50cmltKCkpLmZpbHRlcihCb29sZWFuKVxuICAgICAgICAgICAgICAgICAgICApXTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGFkZGVkQ291bnQgPSB0aGlzLnBsdWdpbi5lbmdpbmUuYWRkQ29uY2VwdHNUb1F1ZXVlKGNvbmNlcHRzVG9TZWVkKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaWdub3JlZENvdW50ID0gY29uY2VwdHNUb1NlZWQubGVuZ3RoIC0gYWRkZWRDb3VudDtcblxuICAgICAgICAgICAgICAgICAgICBsZXQgbm90aWNlTWVzc2FnZSA9IGBcdTYyMTBcdTUyOUZcdTZERkJcdTUyQTAgJHthZGRlZENvdW50fSBcdTRFMkFcdTY1QjBcdTY5ODJcdTVGRjVcdTUyMzBcdTk2MUZcdTUyMTdcdTMwMDJgO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaWdub3JlZENvdW50ID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm90aWNlTWVzc2FnZSArPSBgXFxuJHtpZ25vcmVkQ291bnR9IFx1NEUyQVx1Njk4Mlx1NUZGNVx1NTZFMFx1NURGMlx1NUI1OFx1NTcyOFx1NjIxNlx1OTFDRFx1NTkwRFx1ODAwQ1x1ODhBQlx1NUZGRFx1NzU2NVx1MzAwMmA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZShub3RpY2VNZXNzYWdlLCA1MDAwKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBcdTZFMDVcdTdBN0FcdTY0QURcdTc5Q0RcdTdCQjFcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VlZENvbmNlcHRzID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpOyAvLyBcdTUyMzdcdTY1QjBcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAvLyAtLS0gUHJvbXB0cyBcdThCQkVcdTdGNkUgLS0tXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKS5zZXROYW1lKFwiUHJvbXB0cyBcdThCQkVcdTdGNkVcIikuc2V0SGVhZGluZygpO1xuICAgICAgICBcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZShcIlx1NzUxRlx1NjIxMCBQcm9tcHRcIilcbiAgICAgICAgICAgIC5zZXREZXNjKFwiXHU3NTI4XHU0RThFXHU3NTFGXHU2MjEwXHU2NUIwXHU2OTgyXHU1RkY1XHU1MTg1XHU1QkI5XHU3Njg0IFByb21wdFx1MzAwMlwiKVxuICAgICAgICAgICAgLmFkZFRleHRBcmVhKHRleHQgPT4ge1xuICAgICAgICAgICAgICAgIHRleHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvbXB0X2dlbmVyYXRvcilcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvbXB0X2dlbmVyYXRvciA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRleHQuaW5wdXRFbC5zdHlsZS5oZWlnaHQgPSBcIjMwMHB4XCI7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuY3JpdGljX21vZGUgPT09IFwiYWlcIikge1xuICAgICAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAgICAgLnNldE5hbWUoXCJcdTVCQTFcdTY4MzggUHJvbXB0IChDcml0aWMpXCIpXG4gICAgICAgICAgICAgICAgLnNldERlc2MoXCJcdTc1MjhcdTRFOEUgQUkgXHU2QTIxXHU1RjBGXHU0RTBCXHU1QkExXHU2ODM4XHU3NTFGXHU2MjEwXHU1MTg1XHU1QkI5XHU3Njg0IFByb21wdFx1MzAwMlwiKVxuICAgICAgICAgICAgICAgIC5hZGRUZXh0QXJlYSh0ZXh0ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGV4dC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9tcHRfY3JpdGljKVxuICAgICAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnByb21wdF9jcml0aWMgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB0ZXh0LmlucHV0RWwuc3R5bGUuaGVpZ2h0ID0gXCIzMDBweFwiO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKFwiXHU0RkVFXHU2QjYzIFByb21wdCAoUmV2aXNlcilcIilcbiAgICAgICAgICAgIC5zZXREZXNjKFwiXHU3NTI4XHU0RThFXHU0RkVFXHU2QjYzXHU4OEFCXHU1QkExXHU2ODM4XHU1NDU4XHU2MkQyXHU3RUREXHU1MTg1XHU1QkI5XHU3Njg0IFByb21wdFx1MzAwMlwiKVxuICAgICAgICAgICAgLmFkZFRleHRBcmVhKHRleHQgPT4ge1xuICAgICAgICAgICAgICAgIHRleHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvbXB0X3JldmlzZXIpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnByb21wdF9yZXZpc2VyID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGV4dC5pbnB1dEVsLnN0eWxlLmhlaWdodCA9IFwiMzAwcHhcIjtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cbn1cbiIsICIvLyBRdWV1ZU1vZGFsLnRzIChWMS4zIC0gXHU1NDA4XHU1RTc2XHU1QjlFXHU2NUY2XHU1MjM3XHU2NUIwXHU1MjlGXHU4MEZEKVxuXG5pbXBvcnQgeyBBcHAsIE1vZGFsLCBTZXR0aW5nLCBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgS25vd2xlZGdlR3JhcGhQbHVnaW4gZnJvbSAnLi9tYWluJztcbmltcG9ydCB7IFRhc2tEYXRhIH0gZnJvbSAnLi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBRdWV1ZU1hbmFnZW1lbnRNb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgICBwbHVnaW46IEtub3dsZWRnZUdyYXBoUGx1Z2luO1xuXG4gICAgLy8gXHU3NTI4XHU0RThFXHU0RkREXHU1QjU4XHU2NDFDXHU3RDIyXHU4QkNEXG4gICAgcHJpdmF0ZSBzZWFyY2hUZXJtczogeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfSA9IHtcbiAgICAgICAgZ2VuOiAnJyxcbiAgICAgICAgcmV2OiAnJyxcbiAgICAgICAgcmVwOiAnJyxcbiAgICAgICAgZGlzOiAnJyxcbiAgICB9O1xuICAgIFxuICAgIC8vIFx1OUVEOFx1OEJBNFx1NTE2OFx1OTBFOFx1NjI5OFx1NTNFMFxuICAgIHByaXZhdGUgY29sbGFwc2VTdGF0ZXM6IHsgW2tleTogc3RyaW5nXTogYm9vbGVhbiB9ID0ge1xuICAgICAgICBnZW46IGZhbHNlLCAvLyBcdTlFRDhcdThCQTRcdTYyOThcdTUzRTBcbiAgICAgICAgcmV2OiBmYWxzZSwgLy8gXHU5RUQ4XHU4QkE0XHU2Mjk4XHU1M0UwXG4gICAgICAgIHJlcDogZmFsc2UsIC8vIFx1OUVEOFx1OEJBNFx1NjI5OFx1NTNFMFxuICAgICAgICBkaXM6IGZhbHNlLCAvLyBcdTlFRDhcdThCQTRcdTYyOThcdTUzRTBcbiAgICB9O1xuXG4gICAgLy8gXHUzMDEwXHUzMDEwXHUzMDEwIFx1NjVCMFx1NTg5RVx1RkYxQVx1NzUyOFx1NEU4RVx1N0VEMVx1NUI5QVx1NzY4NFx1NTIzN1x1NjVCMFx1NTFGRFx1NjU3MCBcdTMwMTFcdTMwMTFcdTMwMTFcbiAgICBwcml2YXRlIHJlZnJlc2hDb250ZW50OiAoKSA9PiB2b2lkO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogS25vd2xlZGdlR3JhcGhQbHVnaW4pIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cbiAgICAgICAgLy8gXHUzMDEwXHUzMDEwXHUzMDEwIFx1NUI5RVx1NjVGNlx1NTIzN1x1NjVCMFx1NEZFRVx1NjUzOVx1RkYxQVx1NTIxQlx1NUVGQVx1NEUwMFx1NEUyQVx1N0VEMVx1NUI5QVx1NzY4NFx1NTFGRFx1NjU3MFx1NUYxNVx1NzUyOFx1RkYwQ1x1NzUyOFx1NEU4RVx1NTIzN1x1NjVCMCBcdTMwMTFcdTMwMTFcdTMwMTFcbiAgICAgICAgLy8gXHU2MjExXHU0RUVDXHU1QzA2XHU1OTBEXHU3NTI4IG9uT3BlbigpIFx1Njc2NVx1NTIzN1x1NjVCMFx1RkYwQ1x1NTZFMFx1NEUzQVx1NUI4M1x1NEYxQVx1NEZERFx1NzU1OSB0aGlzLnNlYXJjaFRlcm1zIFx1NTQ4QyB0aGlzLmNvbGxhcHNlU3RhdGVzIFx1NzY4NFx1NzJCNlx1NjAwMVxuICAgICAgICB0aGlzLnJlZnJlc2hDb250ZW50ID0gdGhpcy5vbk9wZW4uYmluZCh0aGlzKTtcbiAgICB9XG5cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuXG4gICAgICAgIC8vIFx1MzAxMFx1MzAxMFx1MzAxMCBcdTVCOUVcdTY1RjZcdTUyMzdcdTY1QjBcdTRGRUVcdTY1MzlcdUZGMUFcdTRFM0FcdTRFODZcdTVCODlcdTUxNjhcdUZGMENcdTUxNDhcdTZDRThcdTk1MDBcdTY1RTdcdTc2ODRcdTc2RDFcdTU0MkNcdTU2NjggXHUzMDExXHUzMDExXHUzMDExXG4gICAgICAgIC8vIFx1OTYzMlx1NkI2Mlx1OTFDRFx1NTkwRFx1NjI1M1x1NUYwMFx1NjVGNlx1NkNFOFx1NTE4Q1x1NTkxQVx1NEUyQVx1NzZEMVx1NTQyQ1x1NTY2OFxuICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub2ZmKFwia2ctZGF0YS11cGRhdGVkXCIsIHRoaXMucmVmcmVzaENvbnRlbnQpO1xuXG4gICAgICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xuICAgICAgICBjb250ZW50RWwuYWRkQ2xhc3MoJ2tnLW1vZGFsJyk7IFxuICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnXHU5NjFGXHU1MjE3XHU3QkExXHU3NDA2XHU0RUVBXHU4ODY4XHU3NkQ4JyB9KTtcblxuICAgICAgICBjb25zdCBzdGF0dXMgPSB0aGlzLnBsdWdpbi5kYXRhLnN0YXR1cztcbiAgICAgICAgY29uc3Qgc3RhdHVzVGV4dCA9IGBcdTcyQjZcdTYwMDE6ICR7c3RhdHVzLnRvVXBwZXJDYXNlKCl9IHwgJHt0aGlzLnBsdWdpbi5zdGF0dXNCYXJFbC5nZXRUZXh0KCl9YDtcbiAgICAgICAgXG4gICAgICAgIC8vIDEuIFx1NzJCNlx1NjAwMVx1NTQ4Q1x1NTQyRlx1NTA1Q1x1NjMwOVx1OTRBRVxuICAgICAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXG4gICAgICAgICAgICAuc2V0TmFtZShzdGF0dXMgPT09ICdydW5uaW5nJyA/ICdcdTVGMTVcdTY0Q0VcdThGRDBcdTg4NENcdTRFMkQnIDogJ1x1NUYxNVx1NjRDRVx1NURGMlx1NjY4Mlx1NTA1QycpXG4gICAgICAgICAgICAuc2V0RGVzYyhzdGF0dXNUZXh0KVxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXG4gICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoc3RhdHVzID09PSAncnVubmluZycgPyAnXHU2NjgyXHU1MDVDXHU1RjE1XHU2NENFJyA6ICdcdTU0MkZcdTUyQThcdTVGMTVcdTY0Q0UnKVxuICAgICAgICAgICAgICAgIC5zZXRDdGEoc3RhdHVzICE9PSAncnVubmluZycpXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5lbmdpbmUudG9nZ2xlRW5naW5lU3RhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbk9wZW4oKTsgLy8gXHU1MjM3XHU2NUIwIE1vZGFsIFx1NTE4NVx1OTBFOFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuXG4gICAgICAgIC8vIDIuIFx1NkUzMlx1NjdEM1x1NTZEQlx1NEUyQVx1OTYxRlx1NTIxN1xuICAgICAgICB0aGlzLnJlbmRlclF1ZXVlU2VjdGlvbihcbiAgICAgICAgICAgIGNvbnRlbnRFbCwgXG4gICAgICAgICAgICAnZ2VuJywgXG4gICAgICAgICAgICAnXHU1Rjg1XHU3NTFGXHU2MjEwIChHZW5lcmF0aW9uKScsIFxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5nZW5lcmF0aW9uUXVldWUsXG4gICAgICAgICAgICB0aGlzLnJlbmRlckdlbmVyYXRpb25JdGVtLmJpbmQodGhpcylcbiAgICAgICAgKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMucmVuZGVyUXVldWVTZWN0aW9uKFxuICAgICAgICAgICAgY29udGVudEVsLFxuICAgICAgICAgICAgJ3JldicsXG4gICAgICAgICAgICAnXHU1Rjg1XHU1QkExXHU2ODM4IChSZXZpZXcpJyxcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLmRhdGEucmV2aWV3UXVldWUsXG4gICAgICAgICAgICB0aGlzLnJlbmRlclJldmlld0l0ZW0uYmluZCh0aGlzKVxuICAgICAgICApO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5yZW5kZXJRdWV1ZVNlY3Rpb24oXG4gICAgICAgICAgICBjb250ZW50RWwsXG4gICAgICAgICAgICAncmVwJyxcbiAgICAgICAgICAgICdcdTVGODVcdTRGRUVcdTZCNjMgKFJldmlzaW9uKScsXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLnJldmlzaW9uUXVldWUsXG4gICAgICAgICAgICB0aGlzLnJlbmRlclJldmlzaW9uSXRlbS5iaW5kKHRoaXMpXG4gICAgICAgICk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLnJlbmRlclF1ZXVlU2VjdGlvbihcbiAgICAgICAgICAgIGNvbnRlbnRFbCxcbiAgICAgICAgICAgICdkaXMnLFxuICAgICAgICAgICAgJ1x1NURGMlx1NEUyMlx1NUYwMyAoRGlzY2FyZGVkKScsXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLmRpc2NhcmRlZFBpbGUsXG4gICAgICAgICAgICB0aGlzLnJlbmRlckRpc2NhcmRlZEl0ZW0uYmluZCh0aGlzKVxuICAgICAgICApO1xuXG4gICAgICAgIC8vIFx1MzAxMFx1MzAxMFx1MzAxMCBcdTVCOUVcdTY1RjZcdTUyMzdcdTY1QjBcdTRGRUVcdTY1MzlcdUZGMUFcdTU3Mjggb25PcGVuIFx1NzY4NFx1NjcyQlx1NUMzRSwgXHU2Q0U4XHU1MThDXHU2NUIwXHU3Njg0XHU3NkQxXHU1NDJDXHU1NjY4IFx1MzAxMVx1MzAxMVx1MzAxMVxuICAgICAgICAvLyBcdTVGNTNcdTVGMTVcdTY0Q0VcdTUzRDFcdTkwMDEgJ2tnLWRhdGEtdXBkYXRlZCcgXHU0RkUxXHU1M0Y3XHU2NUY2LCBcdTgxRUFcdTUyQThcdThDMDNcdTc1MjggdGhpcy5yZWZyZXNoQ29udGVudCAoXHU0RTVGXHU1QzMxXHU2NjJGIG9uT3BlbilcbiAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLm9uKFwia2ctZGF0YS11cGRhdGVkXCIsIHRoaXMucmVmcmVzaENvbnRlbnQpO1xuICAgIH1cblxuICAgIG9uQ2xvc2UoKSB7XG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFx1MzAxMFx1MzAxMFx1MzAxMCBcdTVCOUVcdTY1RjZcdTUyMzdcdTY1QjBcdTRGRUVcdTY1MzlcdUZGMUFcdTU3MjggTW9kYWwgXHU1MTczXHU5NUVEXHU2NUY2LCBcdTVGQzVcdTk4N0JcdTZDRThcdTk1MDBcdTc2RDFcdTU0MkNcdTU2NjggXHUzMDExXHUzMDExXHUzMDExXG4gICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5vZmYoXCJrZy1kYXRhLXVwZGF0ZWRcIiwgdGhpcy5yZWZyZXNoQ29udGVudCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogXHU2RTMyXHU2N0QzXHU0RTAwXHU0RTJBXHU5NjFGXHU1MjE3XHU1MzNBXHU1N0RGIChcdTVFMjZcdTY0MUNcdTdEMjJcdTU0OENcdTVDNTVcdTVGMDAvXHU2Mjk4XHU1M0UwKVxuICAgICAqL1xuICAgIHByaXZhdGUgcmVuZGVyUXVldWVTZWN0aW9uKFxuICAgICAgICBjb250YWluZXJFbDogSFRNTEVsZW1lbnQsXG4gICAgICAgIGtleTogJ2dlbicgfCAncmV2JyB8ICdyZXAnIHwgJ2RpcycsXG4gICAgICAgIHRpdGxlOiBzdHJpbmcsXG4gICAgICAgIGRhdGE6IChzdHJpbmcgfCBUYXNrRGF0YSlbXSxcbiAgICAgICAgcmVuZGVyRm46IChjb250YWluZXI6IEhUTUxFbGVtZW50LCBpdGVtOiBzdHJpbmcgfCBUYXNrRGF0YSwgaW5kZXg6IG51bWJlcikgPT4gdm9pZFxuICAgICkge1xuICAgICAgICBjb25zdCBkaXNwbGF5TGltaXQgPSAxMDA7IC8vIFx1NkJDRlx1NkIyMVx1NjcwMFx1NTkxQVx1NkUzMlx1NjdEMyAxMDAgXHU5ODc5XG4gICAgICAgIGNvbnN0IGZpbHRlciA9IHRoaXMuc2VhcmNoVGVybXNba2V5XTtcbiAgICAgICAgXG4gICAgICAgIC8vIDEuIFx1NjI2N1x1ODg0Q1x1OEZDN1x1NkVFNFxuICAgICAgICBjb25zdCBmaWx0ZXJlZERhdGEgPSBkYXRhLmZpbHRlcihpdGVtID0+IHtcbiAgICAgICAgICAgIGlmICghZmlsdGVyKSByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIGNvbnN0IG5lZWRsZSA9IGZpbHRlci50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBpdGVtID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMobmVlZGxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAoaXRlbSBhcyBUYXNrRGF0YSkuaWRlYS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKG5lZWRsZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHRvdGFsID0gZGF0YS5sZW5ndGg7XG4gICAgICAgIGNvbnN0IGZpbHRlcmVkVG90YWwgPSBmaWx0ZXJlZERhdGEubGVuZ3RoO1xuICAgICAgICBjb25zdCB0aXRsZVRleHQgPSBgJHt0aXRsZX0gKCR7ZmlsdGVyZWRUb3RhbH0ke3RvdGFsICE9PSBmaWx0ZXJlZFRvdGFsID8gJyAvICcgKyB0b3RhbCA6ICcnfSBcdTk4NzkpYDtcblxuICAgICAgICAvLyAyLiBcdTRGN0ZcdTc1MjggPGRldGFpbHM+IFx1NTE0M1x1N0QyMFx1NTIxQlx1NUVGQVx1NTNFRlx1NjI5OFx1NTNFMFx1NTMzQVx1NTdERlxuICAgICAgICBjb25zdCBkZXRhaWxzID0gY29udGFpbmVyRWwuY3JlYXRlRWwoJ2RldGFpbHMnKTtcbiAgICAgICAgZGV0YWlscy5vcGVuID0gdGhpcy5jb2xsYXBzZVN0YXRlc1trZXldOyAvLyBcdThCQkVcdTdGNkVcdTUyMURcdTU5Q0JcdTVDNTVcdTVGMDAvXHU2Mjk4XHU1M0UwXHU3MkI2XHU2MDAxXG5cbiAgICAgICAgLy8gMy4gXHU2ODA3XHU5ODk4IChcdTczQjBcdTU3MjhcdTY2MkYgPHN1bW1hcnk+XHVGRjBDXHU1M0VGXHU0RUU1XHU3MEI5XHU1MUZCKVxuICAgICAgICBjb25zdCBzdW1tYXJ5ID0gZGV0YWlscy5jcmVhdGVFbCgnc3VtbWFyeScsIHsgdGV4dDogdGl0bGVUZXh0IH0pO1xuICAgICAgICBzdW1tYXJ5LnN0eWxlLmZvbnRXZWlnaHQgPSAnYm9sZCc7XG4gICAgICAgIHN1bW1hcnkuc3R5bGUuZm9udFNpemUgPSAndmFyKC0tZm9udC11aS1sYXJnZSknO1xuICAgICAgICBzdW1tYXJ5LnN0eWxlLmN1cnNvciA9ICdwb2ludGVyJztcbiAgICAgICAgc3VtbWFyeS5zdHlsZS5wYWRkaW5nID0gJzVweCAwJztcblxuICAgICAgICAvLyA0LiBcdTc2RDFcdTU0MkNcdTcwQjlcdTUxRkJcdTRFOEJcdTRFRjZcdUZGMENcdTRGRERcdTVCNThcdTcyQjZcdTYwMDFcbiAgICAgICAgZGV0YWlscy5hZGRFdmVudExpc3RlbmVyKCd0b2dnbGUnLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNvbGxhcHNlU3RhdGVzW2tleV0gPSBkZXRhaWxzLm9wZW47XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIDUuIFx1NjQxQ1x1N0QyMlx1Njg0NiAoXHU2NTNFXHU1NzI4IGRldGFpbHMgXHU1MTg1XHU5MEU4KVxuICAgICAgICBuZXcgU2V0dGluZyhkZXRhaWxzKVxuICAgICAgICAgICAgLnNldERlc2MoYFx1NjQxQ1x1N0QyMiAke3RpdGxlfS4uLmApXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHtcbiAgICAgICAgICAgICAgICB0ZXh0LnNldFBsYWNlaG9sZGVyKCdcdThGOTNcdTUxNjVcdTUxNzNcdTk1MkVcdThCQ0QuLi4nKVxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5zZWFyY2hUZXJtc1trZXldKVxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWFyY2hUZXJtc1trZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uT3BlbigpOyAvLyBcdTUyMzdcdTY1QjAgTW9kYWxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAvLyA2LiBcdTYyMkFcdTY1QURcdTY1NzBcdTYzNkVcdTVFNzZcdTZFMzJcdTY3RDNcbiAgICAgICAgY29uc3QgdHJ1bmNhdGVkRGF0YSA9IGZpbHRlcmVkRGF0YS5zbGljZSgwLCBkaXNwbGF5TGltaXQpO1xuICAgICAgICBcbiAgICAgICAgaWYgKHRydW5jYXRlZERhdGEubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBjb25zdCBkZXNjID0gZGV0YWlscy5jcmVhdGVFbCgncCcsIHsgdGV4dDogJ1x1NkI2NFx1OTYxRlx1NTIxN1x1NEUzQVx1N0E3QVx1RkYwQ1x1NjIxNlx1NjcyQVx1NjI3RVx1NTIzMFx1NTMzOVx1OTE0RFx1OTg3OVx1MzAwMicsIGNsczogJ3NldHRpbmctaXRlbS1kZXNjcmlwdGlvbicgfSk7XG4gICAgICAgICAgICBkZXNjLnN0eWxlLnBhZGRpbmdMZWZ0ID0gJzEwcHgnO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyA3LiBcdTUyMTdcdTg4NjhcdTVCQjlcdTU2NjggKFx1NjUzRVx1NTcyOCBkZXRhaWxzIFx1NTE4NVx1OTBFOClcbiAgICAgICAgY29uc3QgbGlzdENvbnRhaW5lciA9IGRldGFpbHMuY3JlYXRlRGl2KCdrZy1saXN0LWNvbnRhaW5lcicpO1xuICAgICAgICBsaXN0Q29udGFpbmVyLnN0eWxlLm1heEhlaWdodCA9ICcyMDBweCc7IFxuICAgICAgICBsaXN0Q29udGFpbmVyLnN0eWxlLm92ZXJmbG93WSA9ICdhdXRvJzsgXG4gICAgICAgIGxpc3RDb250YWluZXIuc3R5bGUuYm9yZGVyID0gJzFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlciknO1xuICAgICAgICBsaXN0Q29udGFpbmVyLnN0eWxlLnBhZGRpbmcgPSAnNXB4JztcbiAgICAgICAgbGlzdENvbnRhaW5lci5zdHlsZS5tYXJnaW5MZWZ0ID0gJzEwcHgnOyAvLyBcdTdGMjlcdThGREJcblxuICAgICAgICB0cnVuY2F0ZWREYXRhLmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7XG4gICAgICAgICAgICByZW5kZXJGbihsaXN0Q29udGFpbmVyLCBpdGVtLCBpbmRleCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIDguIFx1NjYzRVx1NzkzQVx1NjIyQVx1NjVBRFx1NjNEMFx1NzkzQVxuICAgICAgICBpZiAoZmlsdGVyZWREYXRhLmxlbmd0aCA+IGRpc3BsYXlMaW1pdCkge1xuICAgICAgICAgICAgY29uc3QgdHJ1bmNhdGVkSW5mbyA9IGRldGFpbHMuY3JlYXRlRWwoJ3AnLCB7IFxuICAgICAgICAgICAgICAgIHRleHQ6IGAuLi4gXHU0RUM1XHU2NjNFXHU3OTNBXHU1MjREICR7ZGlzcGxheUxpbWl0fSBcdTk4NzkgKFx1NTE3MSAke2ZpbHRlcmVkRGF0YS5sZW5ndGh9IFx1OTg3OSlcdUZGMENcdThCRjdcdTRGN0ZcdTc1MjhcdTY0MUNcdTdEMjJcdTY3RTVcdTYyN0VcdTY2RjRcdTU5MUFcdTMwMDJgLFxuICAgICAgICAgICAgICAgIGNsczogJ3NldHRpbmctaXRlbS1kZXNjcmlwdGlvbidcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdHJ1bmNhdGVkSW5mby5zdHlsZS5wYWRkaW5nTGVmdCA9ICcxMHB4JztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIC0tLSBcdTUzNTVcdTk4NzlcdTZFMzJcdTY3RDNcdTUxRkRcdTY1NzAgLS0tXG5cbiAgICBwcml2YXRlIHJlbmRlckdlbmVyYXRpb25JdGVtKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIGl0ZW06IHN0cmluZyB8IFRhc2tEYXRhKSB7XG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lcilcbiAgICAgICAgICAgIC5zZXROYW1lKGl0ZW0gYXMgc3RyaW5nKVxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidG4gPT4gYnRuXG4gICAgICAgICAgICAgICAgLnNldEljb24oJ3RyYXNoJylcbiAgICAgICAgICAgICAgICAuc2V0VG9vbHRpcCgnXHU1MjIwXHU5NjY0XHU2QjY0XHU2OTgyXHU1RkY1JylcbiAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHF1ZXVlID0gdGhpcy5wbHVnaW4uZGF0YS5nZW5lcmF0aW9uUXVldWU7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gcXVldWUuaW5kZXhPZihpdGVtIGFzIHN0cmluZyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmRleCA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBxdWV1ZS5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVBsdWdpbkRhdGEoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmVuZ2luZS51cGRhdGVTdGF0dXNCYXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25PcGVuKCk7IC8vIFx1NTIzN1x1NjVCMFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZW5kZXJSZXZpZXdJdGVtKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIGl0ZW06IHN0cmluZyB8IFRhc2tEYXRhKSB7XG4gICAgICAgIGNvbnN0IHRhc2sgPSBpdGVtIGFzIFRhc2tEYXRhO1xuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXIpXG4gICAgICAgICAgICAuc2V0TmFtZShgW1x1NUJBMVx1NjgzOF0gJHt0YXNrLmlkZWF9YClcbiAgICAgICAgICAgIC5hZGRCdXR0b24oYnRuID0+IGJ0blxuICAgICAgICAgICAgICAgIC5zZXRJY29uKCd0cmFzaCcpXG4gICAgICAgICAgICAgICAgLnNldFRvb2x0aXAoJ1x1NEUyMlx1NUYwM1x1NkI2NFx1NEVGQlx1NTJBMScpXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLnJldmlld1F1ZXVlLnNwbGljZSh0aGlzLnBsdWdpbi5kYXRhLnJldmlld1F1ZXVlLmluZGV4T2YodGFzayksIDEpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLmRpc2NhcmRlZFBpbGUucHVzaCh0YXNrKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVBsdWdpbkRhdGEoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uZW5naW5lLnVwZGF0ZVN0YXR1c0JhcigpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uT3BlbigpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuICAgIH1cbiAgICBcbiAgICBwcml2YXRlIHJlbmRlclJldmlzaW9uSXRlbShjb250YWluZXI6IEhUTUxFbGVtZW50LCBpdGVtOiBzdHJpbmcgfCBUYXNrRGF0YSkge1xuICAgICAgICBjb25zdCB0YXNrID0gaXRlbSBhcyBUYXNrRGF0YTtcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyKVxuICAgICAgICAgICAgLnNldE5hbWUoYFtcdTRGRUVcdTZCNjNdICR7dGFzay5pZGVhfWApXG4gICAgICAgICAgICAuc2V0RGVzYyhgXHU1MzlGXHU1NkUwOiAke3Rhc2sucmVhc29uIHx8ICdcdTY3MkFcdTc3RTUnfWApXG4gICAgICAgICAgICAuYWRkQnV0dG9uKGJ0biA9PiBidG5cbiAgICAgICAgICAgICAgICAuc2V0SWNvbigndHJhc2gnKVxuICAgICAgICAgICAgICAgIC5zZXRUb29sdGlwKCdcdTRFMjJcdTVGMDNcdTZCNjRcdTRFRkJcdTUyQTEnKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5yZXZpc2lvblF1ZXVlLnNwbGljZSh0aGlzLnBsdWdpbi5kYXRhLnJldmlzaW9uUXVldWUuaW5kZXhPZih0YXNrKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmRhdGEuZGlzY2FyZGVkUGlsZS5wdXNoKHRhc2spO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlUGx1Z2luRGF0YSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5lbmdpbmUudXBkYXRlU3RhdHVzQmFyKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25PcGVuKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG4gICAgfVxuICAgIFxuICAgIHByaXZhdGUgcmVuZGVyRGlzY2FyZGVkSXRlbShjb250YWluZXI6IEhUTUxFbGVtZW50LCBpdGVtOiBzdHJpbmcgfCBUYXNrRGF0YSkge1xuICAgICAgICBjb25zdCB0YXNrID0gaXRlbSBhcyBUYXNrRGF0YTtcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyKVxuICAgICAgICAgICAgLnNldE5hbWUoYFtcdTVERjJcdTRFMjJcdTVGMDNdICR7dGFzay5pZGVhfWApXG4gICAgICAgICAgICAuc2V0RGVzYyhgXHU2NzAwXHU1NDBFXHU1MzlGXHU1NkUwOiAke3Rhc2sucmVhc29uIHx8ICdcdTY3MkFcdTc3RTUnfWApXG4gICAgICAgICAgICAuYWRkQnV0dG9uKGJ0biA9PiBidG5cbiAgICAgICAgICAgICAgICAuc2V0SWNvbigncmVmcmVzaC1jdycpXG4gICAgICAgICAgICAgICAgLnNldFRvb2x0aXAoJ1x1OTFDRFx1NjVCMFx1NjM5Mlx1OTYxRiAoXHU2NTNFXHU1NkRFXHU3NTFGXHU2MjEwXHU5NjFGXHU1MjE3KScpXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLmRpc2NhcmRlZFBpbGUuc3BsaWNlKHRoaXMucGx1Z2luLmRhdGEuZGlzY2FyZGVkUGlsZS5pbmRleE9mKHRhc2spLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uZW5naW5lLmFkZENvbmNlcHRzVG9RdWV1ZShbdGFzay5pZGVhXSk7IC8vIFx1NEY3Rlx1NzUyOCBlbmdpbmUgXHU3Njg0XHU2NUI5XHU2Q0Q1XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25PcGVuKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG4gICAgfVxufVxuIiwgIi8vIGVuZ2luZS50c1xuXG5pbXBvcnQgeyBOb3RpY2UsIFRGaWxlLCBURm9sZGVyLCBub3JtYWxpemVQYXRoLCBBcHAgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBLbm93bGVkZ2VHcmFwaFBsdWdpbiBmcm9tIFwiLi9tYWluXCI7XG5pbXBvcnQgeyBBUElIYW5kbGVyLCBBbGxNb2RlbHNGYWlsZWRFcnJvciB9IGZyb20gXCIuL2FwaUhhbmRsZXJcIjtcbmltcG9ydCB7IENyaXRpYyB9IGZyb20gXCIuL2NyaXRpY1wiO1xuaW1wb3J0IHsgUmV2aXNlciB9IGZyb20gXCIuL3JldmlzZXJcIjtcbmltcG9ydCB7IHNhbml0aXplRmlsZW5hbWUsIGV4dHJhY3ROZXdJZGVhcywgY2xlYW5NYXJrZG93bk91dHB1dCB9IGZyb20gXCIuL3V0aWxzXCI7XG4vLyBcdTVCRkNcdTUxNjUgVGFza0RhdGEgXHU3QzdCXHU1NzhCXG5pbXBvcnQgeyBUYXNrRGF0YSB9IGZyb20gXCIuL3R5cGVzXCI7XG5cbmV4cG9ydCBjbGFzcyBFbmdpbmUge1xuICAgIHBsdWdpbjogS25vd2xlZGdlR3JhcGhQbHVnaW47XG4gICAgYXBwOiBBcHA7XG4gICAgYXBpSGFuZGxlcjogQVBJSGFuZGxlcjtcbiAgICBjcml0aWM6IENyaXRpYztcbiAgICByZXZpc2VyOiBSZXZpc2VyO1xuICAgIHByaXZhdGUgaXNSdW5uaW5nOiBib29sZWFuID0gZmFsc2U7XG4gICAgcHJpdmF0ZSB0aW1lcklkOiBOb2RlSlMuVGltZW91dCB8IG51bGwgPSBudWxsO1xuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBLbm93bGVkZ2VHcmFwaFBsdWdpbikge1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICAgICAgdGhpcy5hcHAgPSBwbHVnaW4uYXBwO1xuICAgICAgICB0aGlzLmFwaUhhbmRsZXIgPSBuZXcgQVBJSGFuZGxlcihwbHVnaW4pO1xuICAgICAgICB0aGlzLmNyaXRpYyA9IG5ldyBDcml0aWMocGx1Z2luKTtcbiAgICAgICAgdGhpcy5yZXZpc2VyID0gbmV3IFJldmlzZXIocGx1Z2luKTtcbiAgICB9XG5cbiAgICAvLyAtLS0gUHVibGljIENvbnRyb2xzIC0tLVxuICAgIC8qKlxuICAgICAqIFx1NTIwN1x1NjM2Mlx1NUYxNVx1NjRDRVx1NzY4NFx1OEZEMFx1ODg0Qy9cdTY2ODJcdTUwNUNcdTcyQjZcdTYwMDFcbiAgICAgKi9cbiAgICBwdWJsaWMgdG9nZ2xlRW5naW5lU3RhdGUoKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLmlzUnVubmluZykge1xuICAgICAgICAgICAgdGhpcy5zdG9wKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0KCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBcdTZERkJcdTUyQTBcdTUzNTVcdTRFMkFcdTY5ODJcdTVGRjVcdTUyMzBcdTk2MUZcdTUyMTdcdUZGMENcdTVFNzZcdTY2M0VcdTc5M0FcdTkwMUFcdTc3RTVcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gXHU2NjJGXHU1NDI2XHU2MjEwXHU1MjlGXHU2REZCXHU1MkEwXG4gICAgICovXG4gICAgcHVibGljIGFkZENvbmNlcHRUb1F1ZXVlKGNvbmNlcHQ6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCBhZGRlZCA9IHRoaXMuYWRkQ29uY2VwdHNUb1F1ZXVlKFtjb25jZXB0XSk7XG4gICAgICAgIGlmIChhZGRlZCA+IDApIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYCcke2NvbmNlcHR9JyBcdTVERjJcdTZERkJcdTUyQTBcdTUyMzBcdTc1MUZcdTYyMTBcdTk2MUZcdTUyMTdcdTMwMDJgKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU3RhdHVzQmFyKCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBuZXcgTm90aWNlKGAnJHtjb25jZXB0fScgXHU1REYyXHU1QjU4XHU1NzI4XHU0RThFXHU5NjFGXHU1MjE3XHU2MjE2XHU0RUQzXHU1RTkzXHU0RTJEXHVGRjBDXHU2NzJBXHU2REZCXHU1MkEwXHUzMDAyYCk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBcdTZERkJcdTUyQTBcdTU5MUFcdTRFMkFcdTY5ODJcdTVGRjVcdTUyMzBcdTc1MUZcdTYyMTBcdTk2MUZcdTUyMTdcdUZGMENcdTRGMUFcdThGREJcdTg4NENcdTUzQkJcdTkxQ0RcdTU0OENcdTY4QzBcdTY3RTVcdTY1ODdcdTRFRjZcdTY2MkZcdTU0MjZcdTVCNThcdTU3MjhcbiAgICAgKiBAcGFyYW0ge3N0cmluZ1tdfSBjb25jZXB0cyAtIFx1ODk4MVx1NkRGQlx1NTJBMFx1NzY4NFx1Njk4Mlx1NUZGNVx1NTIxN1x1ODg2OFxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IFx1NUI5RVx1OTY0NVx1NkRGQlx1NTJBMFx1NzY4NFx1NjVCMFx1Njk4Mlx1NUZGNVx1NjU3MFx1OTFDRlxuICAgICAqL1xuICAgIHB1YmxpYyBhZGRDb25jZXB0c1RvUXVldWUoY29uY2VwdHM6IHN0cmluZ1tdKTogbnVtYmVyIHtcbiAgICAgICAgY29uc3QgY3VycmVudFF1ZXVlID0gbmV3IFNldCh0aGlzLnBsdWdpbi5kYXRhLmdlbmVyYXRpb25RdWV1ZSk7XG4gICAgICAgIC8vIFx1ODNCN1x1NTNENlx1NEUwMFx1NEUyQVNldFx1RkYwQ1x1NTMwNVx1NTQyQlx1NjI0MFx1NjcwOVx1NURGMlx1NUI1OFx1NTcyOFx1N0IxNFx1OEJCMFx1NzY4NCBiYXNlbmFtZSAoXHU2NUUwIC5tZCBcdTU0MEVcdTdGMDApXG4gICAgICAgIGNvbnN0IGV4aXN0aW5nRmlsZXMgPSBuZXcgU2V0KHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKS5tYXAoZiA9PiBmLmJhc2VuYW1lKSk7XG5cbiAgICAgICAgbGV0IGFkZGVkQ291bnQgPSAwO1xuICAgICAgICBmb3IgKGNvbnN0IGNvbmNlcHQgb2YgY29uY2VwdHMpIHtcbiAgICAgICAgICAgIGNvbnN0IHNhbml0aXplZCA9IHNhbml0aXplRmlsZW5hbWUoY29uY2VwdCk7XG4gICAgICAgICAgICAvLyBcdTY4QzBcdTY3RTVcdUZGMUExLiBcdTk2MUZcdTUyMTdcdTRFMkRcdTZDQTFcdTY3MDkgMi4gXHU0RUQzXHU1RTkzXHU0RTJEXHU0RTVGXHU2Q0ExXHU2NzA5XHU1NDBDXHU1NDBEXHU2NTg3XHU0RUY2XG4gICAgICAgICAgICBpZiAoIWN1cnJlbnRRdWV1ZS5oYXMoY29uY2VwdCkgJiYgIWV4aXN0aW5nRmlsZXMuaGFzKHNhbml0aXplZCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLmdlbmVyYXRpb25RdWV1ZS5wdXNoKGNvbmNlcHQpO1xuICAgICAgICAgICAgICAgIGN1cnJlbnRRdWV1ZS5hZGQoY29uY2VwdCk7IC8vIFx1NEZERFx1NjMwMSBTZXQgXHU1NDBDXHU2QjY1XHVGRjBDXHU3NTI4XHU0RThFXHU1MzU1XHU2QjIxXHU4RkQwXHU4ODRDXHU0RTJEXHU3Njg0XHU1M0JCXHU5MUNEXG4gICAgICAgICAgICAgICAgYWRkZWRDb3VudCsrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGFkZGVkQ291bnQgPiAwKSB7XG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zYXZlUGx1Z2luRGF0YSgpOyAvLyBcdTRGRERcdTVCNThcdTVERjJcdTY2RjRcdTY1QjBcdTc2ODRcdTk2MUZcdTUyMTdcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU3RhdHVzQmFyKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFkZGVkQ291bnQ7XG4gICAgfVxuXG4gICAgLy8gLS0tIENvcmUgTG9vcCAtLS1cbiAgICAvKipcbiAgICAgKiBcdTU0MkZcdTUyQThcdTVGMTVcdTY0Q0VcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIHN0YXJ0KCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAodGhpcy5pc1J1bm5pbmcpIHJldHVybjtcbiAgICAgICAgdGhpcy5pc1J1bm5pbmcgPSB0cnVlO1xuICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLnN0YXR1cyA9IFwicnVubmluZ1wiO1xuICAgICAgICBuZXcgTm90aWNlKFwiXHU3N0U1XHU4QkM2XHU1NkZFXHU4QzMxXHU1RjE1XHU2NENFXHU1REYyXHU1NDJGXHU1MkE4XHVGRjAxXCIpO1xuICAgICAgICB0aGlzLnVwZGF0ZVN0YXR1c0JhcigpO1xuICAgICAgICAvLyBcdTdBQ0JcdTUzNzNcdTVGMDBcdTU5Q0JcdTdCMkNcdTRFMDBcdTRFMkEgdGlja1xuICAgICAgICB0aGlzLnRpY2soKTsgXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogXHU1MDVDXHU2QjYyXHU1RjE1XHU2NENFXG4gICAgICovXG4gICAgcHJpdmF0ZSBzdG9wKCk6IHZvaWQge1xuICAgICAgICBpZiAoIXRoaXMuaXNSdW5uaW5nKSByZXR1cm47XG4gICAgICAgIHRoaXMuaXNSdW5uaW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMucGx1Z2luLmRhdGEuc3RhdHVzID0gXCJwYXVzZWRcIjtcbiAgICAgICAgaWYgKHRoaXMudGltZXJJZCkge1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZXJJZCk7XG4gICAgICAgICAgICB0aGlzLnRpbWVySWQgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIG5ldyBOb3RpY2UoXCJcdTc3RTVcdThCQzZcdTU2RkVcdThDMzFcdTVGMTVcdTY0Q0VcdTVERjJcdTY2ODJcdTUwNUNcdTMwMDJcIik7XG4gICAgICAgIHRoaXMudXBkYXRlU3RhdHVzQmFyKCk7XG4gICAgICAgIHRoaXMucGx1Z2luLnNhdmVQbHVnaW5EYXRhKCk7IC8vIFx1NTcyOFx1NjY4Mlx1NTA1Q1x1NjVGNlx1NEZERFx1NUI1OFx1NzJCNlx1NjAwMVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFx1NUI4OVx1NjM5Mlx1NEUwQlx1NEUwMFx1NEUyQSB0aWNrXG4gICAgICovXG4gICAgcHJpdmF0ZSBzY2hlZHVsZU5leHRUaWNrKCk6IHZvaWQge1xuICAgICAgICBpZiAoIXRoaXMuaXNSdW5uaW5nKSByZXR1cm47XG4gICAgICAgIGNvbnN0IGRlbGF5ID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MucmVxdWVzdF9kZWxheSAqIDEwMDA7XG4gICAgICAgIHRoaXMudGltZXJJZCA9IHNldFRpbWVvdXQoKCkgPT4gdGhpcy50aWNrKCksIGRlbGF5KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBcdTVGMTVcdTY0Q0VcdTc2ODRcdTY4MzhcdTVGQzNcdTIwMUNcdTVGQzNcdThERjNcdTIwMURcbiAgICAgKiBcdTVCODNcdTRGMUFcdTYzMDlcdTRGMThcdTUxNDhcdTdFQTdcdUZGMDhcdTRGRUVcdTZCNjMgPiBcdTVCQTFcdTY4MzggPiBcdTc1MUZcdTYyMTBcdUZGMDlcdTU5MDRcdTc0MDZcdTRFMDBcdTRFMkFcdTYyNzlcdTZCMjFcdTc2ODRcdTRFRkJcdTUyQTFcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIHRpY2soKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICghdGhpcy5pc1J1bm5pbmcpIHJldHVybjtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgbGV0IHRhc2tQcm9jZXNzZWQgPSBmYWxzZTtcblxuICAgICAgICAgICAgLy8gMS4gXHU0RjE4XHU1MTQ4XHU1OTA0XHU3NDA2XHU0RkVFXHU2QjYzXHU5NjFGXHU1MjE3XG4gICAgICAgICAgICBpZiAodGhpcy5wbHVnaW4uZGF0YS5yZXZpc2lvblF1ZXVlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICB0YXNrUHJvY2Vzc2VkID0gYXdhaXQgdGhpcy5ydW5SZXZpc2lvblBoYXNlKCk7XG4gICAgICAgICAgICB9IFxuICAgICAgICAgICAgLy8gMi4gXHU1MTc2XHU2QjIxXHU1OTA0XHU3NDA2XHU1QkExXHU2ODM4XHU5NjFGXHU1MjE3XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLnBsdWdpbi5kYXRhLnJldmlld1F1ZXVlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICB0YXNrUHJvY2Vzc2VkID0gYXdhaXQgdGhpcy5ydW5Dcml0aWNQaGFzZSgpO1xuICAgICAgICAgICAgfSBcbiAgICAgICAgICAgIC8vIDMuIFx1NjcwMFx1NTQwRVx1NTkwNFx1NzQwNlx1NzUxRlx1NjIxMFx1OTYxRlx1NTIxN1xuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5wbHVnaW4uZGF0YS5nZW5lcmF0aW9uUXVldWUubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHRhc2tQcm9jZXNzZWQgPSBhd2FpdCB0aGlzLnJ1bkdlbmVyYXRpb25QaGFzZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBcdTY4QzBcdTY3RTVcdTY2MkZcdTU0MjZcdTYyNDBcdTY3MDlcdTk2MUZcdTUyMTdcdTkwRkRcdTVERjJcdTZFMDVcdTdBN0FcbiAgICAgICAgICAgIGlmICghdGFza1Byb2Nlc3NlZCAmJlxuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmRhdGEuZ2VuZXJhdGlvblF1ZXVlLmxlbmd0aCA9PT0gMCAmJlxuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmRhdGEucmV2aWV3UXVldWUubGVuZ3RoID09PSAwICYmXG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5yZXZpc2lvblF1ZXVlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJcdUQ4M0NcdURGODkgXHU2MjQwXHU2NzA5XHU0RUZCXHU1MkExXHU1QjhDXHU2MjEwXHVGRjAxXHU1RjE1XHU2NENFXHU1REYyXHU1MDVDXHU2QjYyXHUzMDAyXCIpO1xuICAgICAgICAgICAgICAgIHRoaXMuaXNSdW5uaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5zdGF0dXMgPSBcImlkbGVcIjsgLy8gXHU4QkJFXHU0RTNBXHU3QTdBXHU5NUYyXHU3MkI2XHU2MDAxXG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVTdGF0dXNCYXIoKTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlUGx1Z2luRGF0YSgpOyAvLyBcdTRGRERcdTVCNThcdTY3MDBcdTdFQzhcdTcyQjZcdTYwMDFcbiAgICAgICAgICAgICAgICByZXR1cm47IC8vIFx1NTA1Q1x1NkI2MiB0aWNrIFx1NUZBQVx1NzNBRlxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiXHU1RjE1XHU2NENFIFRpY2sgXHU1M0QxXHU3NTFGXHU0RTI1XHU5MUNEXHU5NTE5XHU4QkVGOlwiLCBlcnJvcik7XG4gICAgICAgICAgICBuZXcgTm90aWNlKFwiXHU1RjE1XHU2NENFXHU5MDQ3XHU1MjMwXHU5NTE5XHU4QkVGXHVGRjBDXHU1REYyXHU2NjgyXHU1MDVDXHUzMDAyXHU4QkY3XHU2OEMwXHU2N0U1XHU2M0E3XHU1MjM2XHU1M0YwXHUzMDAyXCIpO1xuICAgICAgICAgICAgdGhpcy5zdG9wKCk7IC8vIFx1NTNEMVx1NzUxRlx1NEUyNVx1OTFDRFx1OTUxOVx1OEJFRlx1NjVGNlx1NTA1Q1x1NkI2Mlx1NUYxNVx1NjRDRVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gXHU1OTgyXHU2NzlDXHU1RjE1XHU2NENFXHU0RUNEXHU1NzI4XHU4RkQwXHU4ODRDXHVGRjBDXHU1MjE5XHU1Qjg5XHU2MzkyXHU0RTBCXHU0RTAwXHU2QjIxXHU1RkMzXHU4REYzXG4gICAgICAgIHRoaXMuc2NoZWR1bGVOZXh0VGljaygpO1xuICAgIH1cblxuICAgIC8vIC0tLSBQaGFzZXMgLS0tXG4gICAgLyoqXG4gICAgICogXHU4RkQwXHU4ODRDXHUyMDFDXHU3NTFGXHU2MjEwXHUyMDFEXHU5NjM2XHU2QkI1XG4gICAgICogQHJldHVybnMge1Byb21pc2U8Ym9vbGVhbj59IFx1NjYyRlx1NTQyNlx1NTkwNFx1NzQwNlx1NEU4Nlx1NEVGQlx1NTJBMVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgcnVuR2VuZXJhdGlvblBoYXNlKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgICAgICBjb25zdCBxdWV1ZSA9IHRoaXMucGx1Z2luLmRhdGEuZ2VuZXJhdGlvblF1ZXVlO1xuICAgICAgICBpZiAocXVldWUubGVuZ3RoID09PSAwKSByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgY29uc3QgYmF0Y2hTaXplID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhdGlvbl9iYXRjaF9zaXplO1xuICAgICAgICAvLyBcdTUzRDZcdTUxRkFcdTRFMDBcdTRFMkFcdTYyNzlcdTZCMjFcdTc2ODRcdTRFRkJcdTUyQTFcbiAgICAgICAgY29uc3QgYmF0Y2ggPSBxdWV1ZS5zcGxpY2UoMCwgTWF0aC5taW4ocXVldWUubGVuZ3RoLCBiYXRjaFNpemUpKTtcblxuICAgICAgICB0aGlzLnVwZGF0ZVN0YXR1c0JhcigpO1xuICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlUGx1Z2luRGF0YSgpOyAvLyBcdTRGRERcdTVCNThcdTVERjJcdTUzRDZcdTUxRkFcdTRFRkJcdTUyQTFcdTc2ODRcdTk2MUZcdTUyMTdcblxuICAgICAgICAvLyBcdTVFNzZcdTg4NENcdTU5MDRcdTc0MDZcdThGRDlcdTRFMDBcdTYyNzlcdTZCMjFcdTc2ODRcdTYyNDBcdTY3MDlcdTRFRkJcdTUyQTFcbiAgICAgICAgY29uc3QgdGFza3MgPSBiYXRjaC5tYXAoaWRlYSA9PiB0aGlzLmdlbmVyYXRpb25UYXNrKGlkZWEpKTtcbiAgICAgICAgYXdhaXQgUHJvbWlzZS5hbGxTZXR0bGVkKHRhc2tzKTtcblxuICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlUGx1Z2luRGF0YSgpOyAvLyBcdTRGRERcdTVCNThcdUZGMDhcdTUzRUZcdTgwRkRcdUZGMDlcdTVERjJcdTYzQThcdTUxNjVcdTVCQTFcdTY4MzhcdTk2MUZcdTUyMTdcdTc2ODRcdTY1QjBcdTY1NzBcdTYzNkVcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogXHU1MzU1XHU0RTJBXHU3NTFGXHU2MjEwXHU0RUZCXHU1MkExXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0aW9uVGFzayhpZGVhOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgcHJvbXB0ID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvbXB0X2dlbmVyYXRvci5yZXBsYWNlKFwie2NvbmNlcHR9XCIsIGlkZWEpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuYXBpSGFuZGxlci5jYWxsKHByb21wdCk7XG4gICAgICAgICAgICBjb25zdCBjbGVhbmVkQ29udGVudCA9IGNsZWFuTWFya2Rvd25PdXRwdXQoY29udGVudCk7XG4gICAgICAgICAgICAvLyBcdTYyMTBcdTUyOUZcdTU0MEVcdUZGMENcdTYzQThcdTUxNjVcdTVCQTFcdTY4MzhcdTk2MUZcdTUyMTdcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLmRhdGEucmV2aWV3UXVldWUucHVzaCh7IGlkZWEsIGNvbnRlbnQ6IGNsZWFuZWRDb250ZW50IH0pO1xuICAgICAgICAgICAgY29uc29sZS5sb2coYFx1MjcwNSBbXHU3NTFGXHU2MjEwXHU2MjEwXHU1MjlGXTogJHtpZGVhfWApO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIEFsbE1vZGVsc0ZhaWxlZEVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgXHUyNzRDIFtcdTc1MUZcdTYyMTBcdTU5MzFcdThEMjVdOiAke2lkZWF9IC0gJHtlLm1lc3NhZ2V9YCk7XG4gICAgICAgICAgICAgICAgLy8gXHU1OTMxXHU4RDI1XHU1NDBFXHVGRjBDXHU2NTNFXHU1NkRFXHU5NjFGXHU1MjE3XHU1OTM0XHU5MEU4XHVGRjBDXHU0RUU1XHU0RkJGXHU0RTBCXHU2QjIxXHU5MUNEXHU4QkQ1XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5nZW5lcmF0aW9uUXVldWUudW5zaGlmdChpZGVhKTsgXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBcdThGRDBcdTg4NENcdTIwMUNcdTVCQTFcdTY4MzhcdTIwMURcdTk2MzZcdTZCQjVcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxib29sZWFuPn0gXHU2NjJGXHU1NDI2XHU1OTA0XHU3NDA2XHU0RTg2XHU0RUZCXHU1MkExXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBydW5Dcml0aWNQaGFzZSgpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICAgICAgY29uc3QgcXVldWUgPSB0aGlzLnBsdWdpbi5kYXRhLnJldmlld1F1ZXVlO1xuICAgICAgICBpZiAocXVldWUubGVuZ3RoID09PSAwKSByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgY29uc3QgYmF0Y2hTaXplID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhdGlvbl9iYXRjaF9zaXplO1xuICAgICAgICBjb25zdCB0YXNrc1RvUmV2aWV3ID0gcXVldWUuc3BsaWNlKDAsIE1hdGgubWluKHF1ZXVlLmxlbmd0aCwgYmF0Y2hTaXplKSk7XG5cbiAgICAgICAgdGhpcy51cGRhdGVTdGF0dXNCYXIoKTtcbiAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVBsdWdpbkRhdGEoKTsgLy8gXHU0RkREXHU1QjU4XHU1REYyXHU1M0Q2XHU1MUZBXHU0RUZCXHU1MkExXHU3Njg0XHU5NjFGXHU1MjE3XG5cbiAgICAgICAgbGV0IG5ld0lkZWFzRm91bmQ6IFNldDxzdHJpbmc+ID0gbmV3IFNldCgpO1xuXG4gICAgICAgIGZvciAoY29uc3QgdGFzayBvZiB0YXNrc1RvUmV2aWV3KSB7XG4gICAgICAgICAgICBjb25zdCB7IGlzQXBwcm92ZWQsIHJlYXNvbiB9ID0gYXdhaXQgdGhpcy5jcml0aWMuanVkZ2UodGFzay5jb250ZW50KTtcbiAgICAgICAgICAgIGlmIChpc0FwcHJvdmVkKSB7XG4gICAgICAgICAgICAgICAgLy8gMS4gXHU2Mjc5XHU1MUM2XHVGRjBDXHU0RkREXHU1QjU4XHU3QjE0XHU4QkIwXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5zYXZlTm90ZSh0YXNrLmlkZWEsIHRhc2suY29udGVudCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gXHUzMDEwXHUzMDEwXHUzMDEwIFx1NjVCMFx1NTI5Rlx1ODBGRCBcdTMwMTFcdTMwMTFcdTMwMTFcbiAgICAgICAgICAgICAgICAvLyBcdTRFQzVcdTU3MjhcdTVGMDBcdTU0MkZcdThCQkVcdTdGNkVcdTU0MEVcdTYyNERcdTYzRDBcdTUzRDZcdTY1QjBcdTY5ODJcdTVGRjVcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZXh0cmFjdF9uZXdfY29uY2VwdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaWRlYXMgPSBleHRyYWN0TmV3SWRlYXModGFzay5jb250ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgaWRlYXMuZm9yRWFjaChpZGVhID0+IG5ld0lkZWFzRm91bmQuYWRkKGlkZWEpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gXHUzMDEwXHUzMDEwXHUzMDEwIFx1NjVCMFx1NTI5Rlx1ODBGRFx1N0VEM1x1Njc1RiBcdTMwMTFcdTMwMTFcdTMwMTFcblxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBcdUQ4M0RcdURDNEQgW1x1NUJBMVx1NjgzOFx1OTAxQVx1OEZDN106ICR7dGFzay5pZGVhfWApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyAyLiBcdTYyRDJcdTdFRERcdUZGMENcdThCQkVcdTdGNkVcdTUzOUZcdTU2RTBcdTMwMDFcdTkxQ0RcdThCRDVcdTZCMjFcdTY1NzBcdUZGMENcdTYzQThcdTUxNjVcdTRGRUVcdTZCNjNcdTk2MUZcdTUyMTdcbiAgICAgICAgICAgICAgICB0YXNrLnJlYXNvbiA9IHJlYXNvbjtcbiAgICAgICAgICAgICAgICB0YXNrLnJldHJpZXMgPSAodGFzay5yZXRyaWVzIHx8IDApICsgMTtcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLnJldmlzaW9uUXVldWUucHVzaCh0YXNrKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFx1RDgzRFx1REM0RSBbXHU1QkExXHU2ODM4XHU2MkQyXHU3RUREXTogJHt0YXNrLmlkZWF9IC0gJHtyZWFzb259YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBcdTU5ODJcdTY3OUNcdTYyN0VcdTUyMzBcdTRFODZcdTY1QjBcdTY5ODJcdTVGRjVcdUZGMENcdTVDMDZcdTVCODNcdTRFRUNcdTYyNzlcdTkxQ0ZcdTUyQTBcdTUxNjVcdTc1MUZcdTYyMTBcdTk2MUZcdTUyMTdcbiAgICAgICAgaWYgKG5ld0lkZWFzRm91bmQuc2l6ZSA+IDApIHtcbiAgICAgICAgICAgIHRoaXMuYWRkQ29uY2VwdHNUb1F1ZXVlKEFycmF5LmZyb20obmV3SWRlYXNGb3VuZCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVBsdWdpbkRhdGEoKTsgLy8gXHU0RkREXHU1QjU4XHU1QkExXHU2ODM4L1x1NEZFRVx1NkI2My9cdTc1MUZcdTYyMTBcdTk2MUZcdTUyMTdcdTc2ODRcdTcyQjZcdTYwMDFcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogXHU4RkQwXHU4ODRDXHUyMDFDXHU0RkVFXHU2QjYzXHUyMDFEXHU5NjM2XHU2QkI1XG4gICAgICogQHJldHVybnMge1Byb21pc2U8Ym9vbGVhbj59IFx1NjYyRlx1NTQyNlx1NTkwNFx1NzQwNlx1NEU4Nlx1NEVGQlx1NTJBMVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgcnVuUmV2aXNpb25QaGFzZSgpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICAgICAgY29uc3QgcXVldWUgPSB0aGlzLnBsdWdpbi5kYXRhLnJldmlzaW9uUXVldWU7XG4gICAgICAgIGlmIChxdWV1ZS5sZW5ndGggPT09IDApIHJldHVybiBmYWxzZTtcblxuICAgICAgICBjb25zdCBiYXRjaFNpemUgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW5lcmF0aW9uX2JhdGNoX3NpemU7XG4gICAgICAgIGNvbnN0IHRhc2tzVG9SZXZpc2UgPSBxdWV1ZS5zcGxpY2UoMCwgTWF0aC5taW4ocXVldWUubGVuZ3RoLCBiYXRjaFNpemUpKTtcblxuICAgICAgICB0aGlzLnVwZGF0ZVN0YXR1c0JhcigpO1xuICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlUGx1Z2luRGF0YSgpOyAvLyBcdTRGRERcdTVCNThcdTVERjJcdTUzRDZcdTUxRkFcdTRFRkJcdTUyQTFcdTc2ODRcdTk2MUZcdTUyMTdcblxuICAgICAgICBmb3IgKGNvbnN0IHRhc2sgb2YgdGFza3NUb1JldmlzZSkge1xuICAgICAgICAgICAgLy8gXHU2OEMwXHU2N0U1XHU2NjJGXHU1NDI2XHU4RkJFXHU1MjMwXHU2NzAwXHU1OTI3XHU5MUNEXHU4QkQ1XHU2QjIxXHU2NTcwXG4gICAgICAgICAgICBpZiAoKHRhc2sucmV0cmllcyB8fCAwKSA+PSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5tYXhfcmV2aXNpb25fcmV0cmllcykge1xuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmRhdGEuZGlzY2FyZGVkUGlsZS5wdXNoKHRhc2spOyAvLyBcdTY1M0VcdTUxNjVcdTRFMjJcdTVGMDNcdTU4MDZcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBcdUQ4M0RcdURDODAgW1x1NjUzRVx1NUYwM1x1NEZFRVx1NkI2M106ICR7dGFzay5pZGVhfSBcdTVERjJcdThGQkVcdTY3MDBcdTU5MjdcdTkxQ0RcdThCRDVcdTZCMjFcdTY1NzBcdTMwMDJgKTtcbiAgICAgICAgICAgICAgICBjb250aW51ZTsgLy8gXHU0RTBEXHU1MThEXHU1OTA0XHU3NDA2XHU2QjY0XHU0RUZCXHU1MkExXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBcdTY3MkFcdThGQkVcdTZCMjFcdTY1NzBcdUZGMENcdTYyNjdcdTg4NENcdTRGRUVcdTZCNjNcdTRFRkJcdTUyQTFcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucmV2aXNpb25UYXNrKHRhc2spO1xuICAgICAgICB9XG5cbiAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVBsdWdpbkRhdGEoKTsgLy8gXHU0RkREXHU1QjU4XHU0RkVFXHU2QjYzL1x1NUJBMVx1NjgzOC9cdTRFMjJcdTVGMDNcdTU4MDZcdTc2ODRcdTcyQjZcdTYwMDFcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogXHU1MzU1XHU0RTJBXHU0RkVFXHU2QjYzXHU0RUZCXHU1MkExXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyByZXZpc2lvblRhc2sodGFzazogVGFza0RhdGEpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgcHJvbXB0ID0gdGhpcy5yZXZpc2VyLmNyZWF0ZVJldmlzaW9uUHJvbXB0KHRhc2suaWRlYSwgdGFzay5jb250ZW50LCB0YXNrLnJlYXNvbiB8fCBcIlx1NjcyQVx1NzdFNVx1NTM5Rlx1NTZFMFwiKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IG5ld0NvbnRlbnQgPSBhd2FpdCB0aGlzLmFwaUhhbmRsZXIuY2FsbChwcm9tcHQpO1xuICAgICAgICAgICAgY29uc3QgY2xlYW5lZENvbnRlbnQgPSBjbGVhbk1hcmtkb3duT3V0cHV0KG5ld0NvbnRlbnQpO1xuICAgICAgICAgICAgY29uc3QgcmV2aXNlZFRhc2s6IFRhc2tEYXRhID0geyAuLi50YXNrLCBjb250ZW50OiBjbGVhbmVkQ29udGVudCB9O1xuICAgICAgICAgICAgLy8gXHU0RkVFXHU2QjYzXHU1NDBFXHVGRjBDXHU2NTNFXHU1NkRFXHU1QkExXHU2ODM4XHU5NjFGXHU1MjE3XG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLnJldmlld1F1ZXVlLnB1c2gocmV2aXNlZFRhc2spOyBcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBcdUQ4M0RcdUREMDQgW1x1NEZFRVx1NkI2M1x1NUI4Q1x1NjIxMF06ICR7dGFzay5pZGVhfWApO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBcdTI3NEMgW1x1NEZFRVx1NkI2M1x1NTkzMVx1OEQyNV06ICR7dGFzay5pZGVhfSAtICR7ZS5tZXNzYWdlfWApO1xuICAgICAgICAgICAgLy8gXHU1OTMxXHU4RDI1XHU1NDBFXHVGRjBDXHU2NTNFXHU1NkRFXHU0RkVFXHU2QjYzXHU5NjFGXHU1MjE3XHU1OTM0XHU5MEU4XHVGRjBDXHU0RUU1XHU0RkJGXHU0RTBCXHU2QjIxXHU5MUNEXHU4QkQ1XG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLnJldmlzaW9uUXVldWUudW5zaGlmdCh0YXNrKTsgXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyAtLS0gRmlsZSAmIFVJIC0tLVxuICAgIC8qKlxuICAgICAqIFx1NEZERFx1NUI1OFx1N0IxNFx1OEJCMFx1NTIzMFx1NjU4N1x1NEVGNlx1N0NGQlx1N0VERlxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgc2F2ZU5vdGUoaWRlYTogc3RyaW5nLCBjb250ZW50OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgZmlsZW5hbWUgPSBzYW5pdGl6ZUZpbGVuYW1lKGlkZWEpO1xuICAgICAgICBjb25zdCBmb2xkZXJQYXRoID0gdGhpcy5wbHVnaW4uc2V0dGluZ3Mub3V0cHV0X2RpcjtcblxuICAgICAgICAvLyBcdTY4QzBcdTY3RTVcdTY1ODdcdTRFRjZcdTU5MzlcdTY2MkZcdTU0MjZcdTVCNThcdTU3MjhcdUZGMENcdTRFMERcdTVCNThcdTU3MjhcdTUyMTlcdTUyMUJcdTVFRkFcbiAgICAgICAgaWYgKCEodGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZvbGRlclBhdGgpIGluc3RhbmNlb2YgVEZvbGRlcikpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQuY3JlYXRlRm9sZGVyKGZvbGRlclBhdGgpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBcdTUyMUJcdTVFRkFcdTY1ODdcdTRFRjZcdTU5MzlcdTU5MzFcdThEMjU6ICR7Zm9sZGVyUGF0aH1gLCBlcnJvcik7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShgXHU2NUUwXHU2Q0Q1XHU1MjFCXHU1RUZBXHU4RjkzXHU1MUZBXHU2NTg3XHU0RUY2XHU1OTM5OiAke2ZvbGRlclBhdGh9YCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuOyAvLyBcdTY1RTBcdTZDRDVcdTUyMUJcdTVFRkFcdTY1ODdcdTRFRjZcdTU5MzlcdUZGMENcdTUwNUNcdTZCNjJcdTRGRERcdTVCNThcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgY29uc3QgZmlsZVBhdGggPSBub3JtYWxpemVQYXRoKGAke2ZvbGRlclBhdGh9LyR7ZmlsZW5hbWV9Lm1kYCk7XG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgICAgICAgICAgICAgLy8gXHU2NTg3XHU0RUY2XHU1REYyXHU1QjU4XHU1NzI4XHVGRjBDXHU0RkVFXHU2NTM5XHU1MTg1XHU1QkI5XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIGNvbnRlbnQpO1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYFx1N0IxNFx1OEJCMFx1NURGMlx1NjZGNFx1NjVCMDogJHtmaWxlbmFtZX1gKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gXHU2NTg3XHU0RUY2XHU0RTBEXHU1QjU4XHU1NzI4XHVGRjBDXHU1MjFCXHU1RUZBXHU2NUIwXHU2NTg3XHU0RUY2XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQuY3JlYXRlKGZpbGVQYXRoLCBjb250ZW50KTtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKGBcdTdCMTRcdThCQjBcdTVERjJcdTUyMUJcdTVFRkE6ICR7ZmlsZW5hbWV9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBcdTRGRERcdTVCNThcdTdCMTRcdThCQjBcdTU5MzFcdThEMjU6ICR7ZmlsZVBhdGh9YCwgZXJyb3IpO1xuICAgICAgICAgICAgbmV3IE5vdGljZShgXHU2NUUwXHU2Q0Q1XHU0RkREXHU1QjU4XHU3QjE0XHU4QkIwOiAke2ZpbGVuYW1lfWApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogXHU2NkY0XHU2NUIwXHU3MkI2XHU2MDAxXHU2ODBGXHU2NjNFXHU3OTNBXG4gICAgICovXG4gICAgcHVibGljIHVwZGF0ZVN0YXR1c0JhcigpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLnBsdWdpbi5zdGF0dXNCYXJFbCkgcmV0dXJuO1xuICAgICAgICBjb25zdCB7IGdlbmVyYXRpb25RdWV1ZSwgcmV2aWV3UXVldWUsIHJldmlzaW9uUXVldWUgfSA9IHRoaXMucGx1Z2luLmRhdGE7XG4gICAgICAgIGNvbnN0IHRvdGFsID0gZ2VuZXJhdGlvblF1ZXVlLmxlbmd0aCArIHJldmlld1F1ZXVlLmxlbmd0aCArIHJldmlzaW9uUXVldWUubGVuZ3RoO1xuICAgICAgICAvLyBcdTY2M0VcdTc5M0E6IEtHOiBbXHU3MkI2XHU2MDAxXSB8IEc6W1x1NUY4NVx1NzUxRlx1NjIxMF0gfCBDOltcdTVGODVcdTVCQTFcdTY4MzhdIHwgUjpbXHU1Rjg1XHU0RkVFXHU2QjYzXSB8IFRvdGFsOltcdTYwM0JcdTY1NzBdXG4gICAgICAgIHRoaXMucGx1Z2luLnN0YXR1c0JhckVsLnNldFRleHQoXG4gICAgICAgICAgICBgS0c6ICR7dGhpcy5wbHVnaW4uZGF0YS5zdGF0dXN9IHwgRzoke2dlbmVyYXRpb25RdWV1ZS5sZW5ndGh9IHwgQzoke3Jldmlld1F1ZXVlLmxlbmd0aH0gfCBSOiR7cmV2aXNpb25RdWV1ZS5sZW5ndGh9IHwgVG90YWw6JHt0b3RhbH1gXG4gICAgICAgICk7XG4gICAgICAgIFxuICAgICAgICAvLyBcdTMwMTBcdTMwMTBcdTMwMTAgXHU1QjlFXHU2NUY2XHU1MjM3XHU2NUIwXHU0RkVFXHU2NTM5XHVGRjFBXHU1NzI4XHU2QjY0XHU1OTA0XHU1RTdGXHU2NEFEXHU2NTcwXHU2MzZFXHU1REYyXHU2NkY0XHU2NUIwXHU3Njg0XHU0RkUxXHU1M0Y3IFx1MzAxMVx1MzAxMVx1MzAxMVxuICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2UudHJpZ2dlcihcImtnLWRhdGEtdXBkYXRlZFwiKTtcbiAgICB9XG59XG4iLCAiLy8gYXBpSGFuZGxlci50cyAoXHU1REYyXHU5MUNEXHU2Nzg0XHU0RTNBIFR5cGVTY3JpcHQpXG5cbmltcG9ydCB7IHJlcXVlc3RVcmwsIE5vdGljZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBLbm93bGVkZ2VHcmFwaFBsdWdpbiBmcm9tICcuL21haW4nO1xuaW1wb3J0IHsgS25vd2xlZGdlR3JhcGhQbHVnaW5TZXR0aW5ncywgS2V5VXNhZ2VTdGF0dXMgfSBmcm9tICcuL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIEFwaUtleUV4aGF1c3RlZEVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICAgIGNvbnN0cnVjdG9yKG1lc3NhZ2U6IHN0cmluZykge1xuICAgICAgICBzdXBlcihtZXNzYWdlKTtcbiAgICAgICAgdGhpcy5uYW1lID0gXCJBcGlLZXlFeGhhdXN0ZWRFcnJvclwiO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIEFsbE1vZGVsc0ZhaWxlZEVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICAgIGNvbnN0cnVjdG9yKG1lc3NhZ2U6IHN0cmluZykge1xuICAgICAgICBzdXBlcihtZXNzYWdlKTtcbiAgICAgICAgdGhpcy5uYW1lID0gXCJBbGxNb2RlbHNGYWlsZWRFcnJvclwiO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIEFQSUhhbmRsZXIge1xuICAgIHByaXZhdGUgcGx1Z2luOiBLbm93bGVkZ2VHcmFwaFBsdWdpbjtcbiAgICBwcml2YXRlIHNldHRpbmdzOiBLbm93bGVkZ2VHcmFwaFBsdWdpblNldHRpbmdzO1xuICAgIFxuICAgIHByaXZhdGUgb3BlbmFpX2tleXM6IHN0cmluZ1tdID0gW107XG4gICAgcHJpdmF0ZSBnb29nbGVfa2V5czogc3RyaW5nW10gPSBbXTtcbiAgICBcbiAgICBwcml2YXRlIGtleVVzYWdlT3BlbkFJID0gbmV3IE1hcDxzdHJpbmcsIEtleVVzYWdlU3RhdHVzPigpO1xuICAgIHByaXZhdGUga2V5VXNhZ2VHb29nbGUgPSBuZXcgTWFwPHN0cmluZywgS2V5VXNhZ2VTdGF0dXM+KCk7XG4gICAgXG4gICAgLy8gXHU3NTI4XHU0RThFXHU4RERGXHU4RTJBXHU2NjJGXHU1NDI2XHU1REYyXHU3RUNGXHU5MDFBXHU3N0U1XHU4RkM3XHU2NTQ1XHU5NjlDXHU1MjA3XHU2MzYyXG4gICAgcHJpdmF0ZSBoYXNOb3RpZmllZEZhaWxvdmVyOiBib29sZWFuID0gZmFsc2U7XG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IEtub3dsZWRnZUdyYXBoUGx1Z2luKSB7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gcGx1Z2luLnNldHRpbmdzO1xuICAgICAgICB0aGlzLnVwZGF0ZUtleXMoKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgdXBkYXRlS2V5cygpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5vcGVuYWlfa2V5cyA9IHRoaXMuc2V0dGluZ3Mub3BlbmFpX2FwaV9rZXlzLnNwbGl0KFwiXFxuXCIpLm1hcCgoaykgPT4gay50cmltKCkpLmZpbHRlcihCb29sZWFuKTtcbiAgICAgICAgdGhpcy5nb29nbGVfa2V5cyA9IHRoaXMuc2V0dGluZ3MuZ29vZ2xlX2FwaV9rZXlzLnNwbGl0KFwiXFxuXCIpLm1hcCgoaykgPT4gay50cmltKCkpLmZpbHRlcihCb29sZWFuKTtcblxuICAgICAgICB0aGlzLm9wZW5haV9rZXlzLmZvckVhY2goKGtleSkgPT4ge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmtleVVzYWdlT3BlbkFJLmhhcyhrZXkpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5rZXlVc2FnZU9wZW5BSS5zZXQoa2V5LCB7IGZhaWxzOiAwLCBjb29sZG93bl91bnRpbDogMCB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuZ29vZ2xlX2tleXMuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgICAgICAgICBpZiAoIXRoaXMua2V5VXNhZ2VHb29nbGUuaGFzKGtleSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmtleVVzYWdlR29vZ2xlLnNldChrZXksIHsgZmFpbHM6IDAsIGNvb2xkb3duX3VudGlsOiAwIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIF9zZWxlY3RLZXkoa2V5czogc3RyaW5nW10sIHByb3ZpZGVyOiAnb3BlbmFpJyB8ICdnb29nbGUnKTogc3RyaW5nIHwgbnVsbCB7XG4gICAgICAgIGNvbnN0IGtleVVzYWdlTWFwID0gcHJvdmlkZXIgPT09IFwib3BlbmFpXCIgPyB0aGlzLmtleVVzYWdlT3BlbkFJIDogdGhpcy5rZXlVc2FnZUdvb2dsZTtcbiAgICAgICAgY29uc3QgY3VycmVudFRpbWUgPSBEYXRlLm5vdygpIC8gMTAwMDtcblxuICAgICAgICBmb3IgKGNvbnN0IGtleSBvZiBrZXlzKSB7XG4gICAgICAgICAgICBjb25zdCB1c2FnZSA9IGtleVVzYWdlTWFwLmdldChrZXkpO1xuICAgICAgICAgICAgaWYgKHVzYWdlICYmIGN1cnJlbnRUaW1lID49IHVzYWdlLmNvb2xkb3duX3VudGlsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGtleTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBcdTVCOUVcdTk2NDVcdTYyNjdcdTg4NEMgT3BlbkFJIEFQSSBcdThCRjdcdTZDNDJcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIF9tYWtlT3BlbkFJUmVxdWVzdChrZXk6IHN0cmluZywgcHJvbXB0OiBzdHJpbmcsIG1vZGVsTmFtZTogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0VXJsKHtcbiAgICAgICAgICAgIHVybDogYCR7dGhpcy5zZXR0aW5ncy5vcGVuYWlfYmFzZV91cmx9L2NoYXQvY29tcGxldGlvbnNgLFxuICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgICAgICAgICBcIkF1dGhvcml6YXRpb25cIjogYEJlYXJlciAke2tleX1gXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgIG1vZGVsOiBtb2RlbE5hbWUsXG4gICAgICAgICAgICAgICAgbWVzc2FnZXM6IFt7IHJvbGU6IFwidXNlclwiLCBjb250ZW50OiBwcm9tcHQgfV0sXG4gICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHRoaXMuc2V0dGluZ3MuZ2VuZXJhdGlvbl90ZW1wZXJhdHVyZSxcbiAgICAgICAgICAgICAgICBtYXhfdG9rZW5zOiB0aGlzLnNldHRpbmdzLmdlbmVyYXRpb25fbWF4X3Rva2Vuc1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiByZXNwb25zZS5qc29uLmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50LnRyaW0oKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBcdTVCOUVcdTk2NDVcdTYyNjdcdTg4NEMgR29vZ2xlIEdlbWluaSBBUEkgXHU4QkY3XHU2QzQyXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBfbWFrZUdvb2dsZUFQSVJlcXVlc3Qoa2V5OiBzdHJpbmcsIHByb21wdDogc3RyaW5nLCBtb2RlbE5hbWU6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIGNvbnN0IHVybCA9IGBodHRwczovL2dlbmVyYXRpdmVsYW5ndWFnZS5nb29nbGVhcGlzLmNvbS92MWJldGEvbW9kZWxzLyR7bW9kZWxOYW1lfTpnZW5lcmF0ZUNvbnRlbnQ/a2V5PSR7a2V5fWA7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdFVybCh7XG4gICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgICAgaGVhZGVyczogeyBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIiB9LFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgIGNvbnRlbnRzOiBbeyBwYXJ0czogW3sgdGV4dDogcHJvbXB0IH1dIH1dLFxuICAgICAgICAgICAgICAgIGdlbmVyYXRpb25Db25maWc6IHtcbiAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHRoaXMuc2V0dGluZ3MuZ2VuZXJhdGlvbl90ZW1wZXJhdHVyZSxcbiAgICAgICAgICAgICAgICAgICAgbWF4T3V0cHV0VG9rZW5zOiB0aGlzLnNldHRpbmdzLmdlbmVyYXRpb25fbWF4X3Rva2Vuc1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IGRhdGEgPSByZXNwb25zZS5qc29uO1xuICAgICAgICBpZiAoIWRhdGEuY2FuZGlkYXRlcyB8fCBkYXRhLmNhbmRpZGF0ZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBUEkgcmVzcG9uc2UgaXMgbWlzc2luZyBjYW5kaWRhdGVzLiBGdWxsIHJlc3BvbnNlOiBcIiArIEpTT04uc3RyaW5naWZ5KGRhdGEpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGF0YS5jYW5kaWRhdGVzWzBdLmNvbnRlbnQucGFydHNbMF0udGV4dC50cmltKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogXHU2OEMwXHU2N0U1XHU2NjJGXHU1NDI2XHU2NjJGXHU5ODlEXHU1RUE2L1x1Njc0M1x1OTY1MFx1N0M3Qlx1OTUxOVx1OEJFRlxuICAgICAqL1xuICAgIHByaXZhdGUgX2lzUXVvdGFFcnJvcihlcnJvcjogYW55KTogYm9vbGVhbiB7XG4gICAgICAgIGNvbnN0IGh0dHBTdGF0dXMgPSBlcnJvci5zdGF0dXM7XG4gICAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGVycm9yLm1lc3NhZ2U/LnRvTG93ZXJDYXNlKCkgfHwgXCJcIjtcbiAgICAgICAgXG4gICAgICAgIGlmIChodHRwU3RhdHVzID09PSA0MDEgfHwgaHR0cFN0YXR1cyA9PT0gNDAzIHx8IGh0dHBTdGF0dXMgPT09IDQyOSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmIChlcnJvck1lc3NhZ2UuaW5jbHVkZXMoXCJpbnN1ZmZpY2llbnRfcXVvdGFcIikgfHwgZXJyb3JNZXNzYWdlLmluY2x1ZGVzKFwicmF0ZSBsaW1pdFwiKSB8fCBlcnJvck1lc3NhZ2UuaW5jbHVkZXMoXCJxdW90YVwiKSB8fCBlcnJvck1lc3NhZ2UuaW5jbHVkZXMoXCJwZXJtaXNzaW9uXCIpIHx8IGVycm9yTWVzc2FnZS5pbmNsdWRlcyhcIjQyOVwiKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBcdTUxQjdcdTUzNzRcdTRFMDBcdTRFMkEgS2V5XG4gICAgICovXG4gICAgcHJpdmF0ZSBfY29vbGRvd25LZXkoa2V5OiBzdHJpbmcsIHByb3ZpZGVyOiAnb3BlbmFpJyB8ICdnb29nbGUnKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGtleVVzYWdlTWFwID0gcHJvdmlkZXIgPT09IFwib3BlbmFpXCIgPyB0aGlzLmtleVVzYWdlT3BlbkFJIDogdGhpcy5rZXlVc2FnZUdvb2dsZTtcbiAgICAgICAgY29uc3Qga2V5VXNhZ2UgPSBrZXlVc2FnZU1hcC5nZXQoa2V5KTtcbiAgICAgICAgaWYgKGtleVVzYWdlKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oYEtleSAuLi4ke2tleS5zbGljZSgtNCl9ICgke3Byb3ZpZGVyfSkgZmFpbGVkIGR1ZSB0byBxdW90YS9hdXRoIGVycm9yLiBBcHBseWluZyBjb29sZG93bi5gKTtcbiAgICAgICAgICAgIGtleVVzYWdlLmNvb2xkb3duX3VudGlsID0gKERhdGUubm93KCkgLyAxMDAwKSArIHRoaXMuc2V0dGluZ3MuZmFpbG92ZXJfY29vbGRvd25fc2Vjb25kcztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFx1OTFDRFx1N0Y2RVx1NEUwMFx1NEUyQSBLZXkgXHU3Njg0XHU1MUI3XHU1Mzc0IChcdThDMDNcdTc1MjhcdTYyMTBcdTUyOUZcdTY1RjYpXG4gICAgICovXG4gICAgcHJpdmF0ZSBfcmVzZXRDb29sZG93bihrZXk6IHN0cmluZywgcHJvdmlkZXI6ICdvcGVuYWknIHwgJ2dvb2dsZScpOiB2b2lkIHtcbiAgICAgICAgY29uc3Qga2V5VXNhZ2VNYXAgPSBwcm92aWRlciA9PT0gXCJvcGVuYWlcIiA/IHRoaXMua2V5VXNhZ2VPcGVuQUkgOiB0aGlzLmtleVVzYWdlR29vZ2xlO1xuICAgICAgICBjb25zdCBrZXlVc2FnZSA9IGtleVVzYWdlTWFwLmdldChrZXkpO1xuICAgICAgICBpZiAoa2V5VXNhZ2UpIHtcbiAgICAgICAgICAgIGtleVVzYWdlLmNvb2xkb3duX3VudGlsID0gMDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmhhc05vdGlmaWVkRmFpbG92ZXIgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIF9jYWxsT3BlbkFJKGtleTogc3RyaW5nLCBwcm9tcHQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIGNvbnN0IHByaW1hcnlNb2RlbCA9IHRoaXMuc2V0dGluZ3Mub3BlbmFpX21vZGVsO1xuICAgICAgICBjb25zdCBiYWNrdXBNb2RlbCA9IHRoaXMuc2V0dGluZ3Mub3BlbmFpX2JhY2t1cF9tb2RlbDtcbiAgICAgICAgXG4gICAgICAgIC8vIDEuIFx1NUMxRFx1OEJENVx1NEUzQlx1NkEyMVx1NTc4QlxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5fbWFrZU9wZW5BSVJlcXVlc3Qoa2V5LCBwcm9tcHQsIHByaW1hcnlNb2RlbCk7XG4gICAgICAgICAgICB0aGlzLl9yZXNldENvb2xkb3duKGtleSwgXCJvcGVuYWlcIik7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9IGNhdGNoIChwcmltYXJ5RXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgT3BlbkFJIHByaW1hcnkgbW9kZWwgJyR7cHJpbWFyeU1vZGVsfScgZmFpbGVkIGZvciBrZXkgLi4uJHtrZXkuc2xpY2UoLTQpfTpgLCBwcmltYXJ5RXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFx1NTNFQVx1ODk4MVx1NEUzQlx1NkEyMVx1NTc4Qlx1NTkzMVx1OEQyNSAoXHU2NUUwXHU4QkJBXHU0RjU1XHU3OUNEXHU1MzlGXHU1NkUwKSBcdTVFNzZcdTRFMTRcdTVCNThcdTU3MjhcdTU5MDdcdTc1MjhcdTZBMjFcdTU3OEJcdUZGMENcdTVDMzFcdTVDMURcdThCRDVcdTU5MDdcdTc1MjhcdTZBMjFcdTU3OEJcdTMwMDJcbiAgICAgICAgICAgIGlmIChiYWNrdXBNb2RlbCkgeyBcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAvLyAyLiBcdTVDMURcdThCRDVcdTU5MDdcdTc1MjhcdTZBMjFcdTU3OEJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYmFja3VwUmVzdWx0ID0gYXdhaXQgdGhpcy5fbWFrZU9wZW5BSVJlcXVlc3Qoa2V5LCBwcm9tcHQsIGJhY2t1cE1vZGVsKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVzZXRDb29sZG93bihrZXksIFwib3BlbmFpXCIpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYmFja3VwUmVzdWx0OyAvLyBcdTU5MDdcdTc1MjhcdTZBMjFcdTU3OEJcdTYyMTBcdTUyOUZcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChiYWNrdXBFcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBPcGVuQUkgYmFja3VwIG1vZGVsICcke2JhY2t1cE1vZGVsfScgYWxzbyBmYWlsZWQgZm9yIGtleSAuLi4ke2tleS5zbGljZSgtNCl9OmAsIGJhY2t1cEVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gMy4gXHU0RTNCXHU1OTA3XHU5MEZEXHU1OTMxXHU4RDI1XHU0RTg2XHVGRjBDXHU2QjY0XHU2NUY2XHU2MjREXHU2OEMwXHU2N0U1XHU2NjJGXHU1NDI2XHU5NzAwXHU4OTgxXHU1MUI3XHU1Mzc0IChcdTU3RkFcdTRFOEUgKlx1NEVGQlx1NEY1NSogXHU0RTAwXHU0RTJBXHU5NTE5XHU4QkVGKVxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5faXNRdW90YUVycm9yKHByaW1hcnlFcnJvcikgfHwgdGhpcy5faXNRdW90YUVycm9yKGJhY2t1cEVycm9yKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY29vbGRvd25LZXkoa2V5LCBcIm9wZW5haVwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgQXBpS2V5RXhoYXVzdGVkRXJyb3IoYE9wZW5BSSBrZXkgZmFpbGVkIChib3RoIHByaW1hcnkgYW5kIGJhY2t1cCBtb2RlbHMpLmApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gNC4gXHU0RTNCXHU2QTIxXHU1NzhCXHU1OTMxXHU4RDI1XHVGRjBDXHU0RTE0ICpcdTZDQTFcdTY3MDkqIFx1NTkwN1x1NzUyOFx1NkEyMVx1NTc4QlxuICAgICAgICAgICAgaWYgKHRoaXMuX2lzUXVvdGFFcnJvcihwcmltYXJ5RXJyb3IpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY29vbGRvd25LZXkoa2V5LCBcIm9wZW5haVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRocm93IG5ldyBBcGlLZXlFeGhhdXN0ZWRFcnJvcihgT3BlbkFJIGtleSBmYWlsZWQgKHByaW1hcnkgbW9kZWwgZmFpbGVkLCBubyBiYWNrdXApOiAke3ByaW1hcnlFcnJvci5tZXNzYWdlfWApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBfY2FsbEdvb2dsZUFQSShrZXk6IHN0cmluZywgcHJvbXB0OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgICAgICBjb25zdCBwcmltYXJ5TW9kZWwgPSB0aGlzLnNldHRpbmdzLmdvb2dsZV9tb2RlbDtcbiAgICAgICAgY29uc3QgYmFja3VwTW9kZWwgPSB0aGlzLnNldHRpbmdzLmdvb2dsZV9iYWNrdXBfbW9kZWw7XG4gICAgICAgIFxuICAgICAgICAvLyAxLiBcdTVDMURcdThCRDVcdTRFM0JcdTZBMjFcdTU3OEJcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuX21ha2VHb29nbGVBUElSZXF1ZXN0KGtleSwgcHJvbXB0LCBwcmltYXJ5TW9kZWwpO1xuICAgICAgICAgICAgdGhpcy5fcmVzZXRDb29sZG93bihrZXksIFwiZ29vZ2xlXCIpO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfSBjYXRjaCAocHJpbWFyeUVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oYEdvb2dsZSBwcmltYXJ5IG1vZGVsICcke3ByaW1hcnlNb2RlbH0nIGZhaWxlZCBmb3Iga2V5IC4uLiR7a2V5LnNsaWNlKC00KX06YCwgcHJpbWFyeUVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoYmFja3VwTW9kZWwpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAvLyAyLiBcdTVDMURcdThCRDVcdTU5MDdcdTc1MjhcdTZBMjFcdTU3OEJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYmFja3VwUmVzdWx0ID0gYXdhaXQgdGhpcy5fbWFrZUdvb2dsZUFQSVJlcXVlc3Qoa2V5LCBwcm9tcHQsIGJhY2t1cE1vZGVsKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVzZXRDb29sZG93bihrZXksIFwiZ29vZ2xlXCIpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYmFja3VwUmVzdWx0OyAvLyBcdTU5MDdcdTc1MjhcdTZBMjFcdTU3OEJcdTYyMTBcdTUyOUZcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChiYWNrdXBFcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBHb29nbGUgYmFja3VwIG1vZGVsICcke2JhY2t1cE1vZGVsfScgYWxzbyBmYWlsZWQgZm9yIGtleSAuLi4ke2tleS5zbGljZSgtNCl9OmAsIGJhY2t1cEVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gMy4gXHU0RTNCXHU1OTA3XHU5MEZEXHU1OTMxXHU4RDI1XHU0RTg2XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9pc1F1b3RhRXJyb3IocHJpbWFyeUVycm9yKSB8fCB0aGlzLl9pc1F1b3RhRXJyb3IoYmFja3VwRXJyb3IpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb29sZG93bktleShrZXksIFwiZ29vZ2xlXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBBcGlLZXlFeGhhdXN0ZWRFcnJvcihgR29vZ2xlIGtleSBmYWlsZWQgKGJvdGggcHJpbWFyeSBhbmQgYmFja3VwIG1vZGVscykuYCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyA0LiBcdTRFM0JcdTZBMjFcdTU3OEJcdTU5MzFcdThEMjVcdUZGMENcdTRFMTQgKlx1NkNBMVx1NjcwOSogXHU1OTA3XHU3NTI4XHU2QTIxXHU1NzhCXG4gICAgICAgICAgICBpZiAodGhpcy5faXNRdW90YUVycm9yKHByaW1hcnlFcnJvcikpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jb29sZG93bktleShrZXksIFwiZ29vZ2xlXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhyb3cgbmV3IEFwaUtleUV4aGF1c3RlZEVycm9yKGBHb29nbGUga2V5IGZhaWxlZCAocHJpbWFyeSBtb2RlbCBmYWlsZWQsIG5vIGJhY2t1cCk6ICR7cHJpbWFyeUVycm9yLm1lc3NhZ2V9YCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgY2FsbChwcm9tcHQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIHRoaXMudXBkYXRlS2V5cygpO1xuICAgICAgICBsZXQgbGFzdEVycm9yOiBFcnJvciB8IG51bGwgPSBudWxsO1xuICAgICAgICBsZXQgb3BlbkFJS2V5c0F0dGVtcHRlZCA9IGZhbHNlO1xuXG4gICAgICAgIGNvbnN0IG9wZW5BSUVuYWJsZWQgPSB0aGlzLm9wZW5haV9rZXlzLmxlbmd0aCA+IDAgJiYgISEodGhpcy5zZXR0aW5ncy5vcGVuYWlfbW9kZWwgfHwgdGhpcy5zZXR0aW5ncy5vcGVuYWlfYmFja3VwX21vZGVsKTtcbiAgICAgICAgY29uc3QgZ29vZ2xlRW5hYmxlZCA9IHRoaXMuZ29vZ2xlX2tleXMubGVuZ3RoID4gMCAmJiAhISh0aGlzLnNldHRpbmdzLmdvb2dsZV9tb2RlbCB8fCB0aGlzLnNldHRpbmdzLmdvb2dsZV9iYWNrdXBfbW9kZWwpO1xuXG4gICAgICAgIC8vIDEuIFx1NUMxRFx1OEJENSBPcGVuQUlcbiAgICAgICAgaWYgKG9wZW5BSUVuYWJsZWQpIHtcbiAgICAgICAgICAgIG9wZW5BSUtleXNBdHRlbXB0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm9wZW5haV9rZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qga2V5ID0gdGhpcy5fc2VsZWN0S2V5KHRoaXMub3BlbmFpX2tleXMsIFwib3BlbmFpXCIpO1xuICAgICAgICAgICAgICAgIGlmIChrZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBUcnlpbmcgT3BlbkFJIGtleSAuLi4ke2tleS5zbGljZSgtNCl9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5fY2FsbE9wZW5BSShrZXksIHByb21wdCk7XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGU6IGFueSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGFzdEVycm9yID0gZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYE9wZW5BSSBrZXkgLi4uJHtrZXkuc2xpY2UoLTQpfSBmYWlsZWQuIFRyeWluZyBuZXh0LmApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMub3BlbmFpX2tleXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgb3BlbkFJS2V5c0F0dGVtcHRlZCA9IHRydWU7XG4gICAgICAgICAgICBsYXN0RXJyb3IgPSBuZXcgRXJyb3IoXCJPcGVuQUk6IFx1NjNEMFx1NEY5Qlx1NEU4NiBLZXkgXHU0RjQ2XHU2NzJBXHU2MzA3XHU1QjlBXHU2QTIxXHU1NzhCXHUzMDAyXCIpO1xuICAgICAgICAgICAgY29uc29sZS53YXJuKGxhc3RFcnJvci5tZXNzYWdlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIDIuIFx1NUMxRFx1OEJENSBHb29nbGVcbiAgICAgICAgaWYgKGdvb2dsZUVuYWJsZWQpIHtcbiAgICAgICAgICAgIGlmIChvcGVuQUlLZXlzQXR0ZW1wdGVkICYmICF0aGlzLmhhc05vdGlmaWVkRmFpbG92ZXIpIHtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKFwiQWxsIE9wZW5BSSBrZXlzIGZhaWxlZCBvciB1bmF2YWlsYWJsZS4gU3dpdGNoaW5nIHRvIEdvb2dsZSBHZW1pbmkuLi5cIik7XG4gICAgICAgICAgICAgICAgdGhpcy5oYXNOb3RpZmllZEZhaWxvdmVyID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5nb29nbGVfa2V5cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGtleSA9IHRoaXMuX3NlbGVjdEtleSh0aGlzLmdvb2dsZV9rZXlzLCBcImdvb2dsZVwiKTtcbiAgICAgICAgICAgICAgICBpZiAoa2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgVHJ5aW5nIEdvb2dsZSBHZW1pbmkga2V5IC4uLiR7a2V5LnNsaWNlKC00KX1gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLl9jYWxsR29vZ2xlQVBJKGtleSwgcHJvbXB0KTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZTogYW55KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsYXN0RXJyb3IgPSBlO1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZShgR29vZ2xlIEdlbWluaSBrZXkgLi4uJHtrZXkuc2xpY2UoLTQpfSBmYWlsZWQuIFRyeWluZyBuZXh0LmApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZ29vZ2xlX2tleXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgbGFzdEVycm9yID0gbGFzdEVycm9yIHx8IG5ldyBFcnJvcihcIkdvb2dsZTogXHU2M0QwXHU0RjlCXHU0RTg2IEtleSBcdTRGNDZcdTY3MkFcdTYzMDdcdTVCOUFcdTZBMjFcdTU3OEJcdTMwMDJcIik7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4obGFzdEVycm9yLm1lc3NhZ2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gMy4gXHU2NzAwXHU3RUM4XHU1OTMxXHU4RDI1XG4gICAgICAgIGlmICghb3BlbkFJRW5hYmxlZCAmJiAhZ29vZ2xlRW5hYmxlZCAmJiAodGhpcy5vcGVuYWlfa2V5cy5sZW5ndGggPiAwIHx8IHRoaXMuZ29vZ2xlX2tleXMubGVuZ3RoID4gMCkpIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJcdThCRjdcdTU3MjhcdThCQkVcdTdGNkVcdTRFMkRcdTYzRDBcdTRGOUJBUEkgS2V5XHU1NDhDXHU4MUYzXHU1QzExXHU0RTAwXHU0RTJBXHU2QTIxXHU1NzhCXHU1NDBEXHU3OUYwXHUzMDAyXCIpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFsbE1vZGVsc0ZhaWxlZEVycm9yKFwiXHU2M0QwXHU0RjlCXHU0RTg2IEtleSBcdTRGNDZcdTY3MkFcdTYzMDdcdTVCOUFcdTZBMjFcdTU3OEJcdTMwMDJcIik7XG4gICAgICAgIH1cblxuICAgICAgICB0aHJvdyBuZXcgQWxsTW9kZWxzRmFpbGVkRXJyb3IoYEFsbCBBUEkgcHJvdmlkZXJzIGZhaWxlZC4gTGFzdCBlcnJvcjogJHtsYXN0RXJyb3I/Lm1lc3NhZ2V9YCk7XG4gICAgfVxufVxuIiwgIi8vIGNyaXRpYy50c1xuXG5pbXBvcnQgS25vd2xlZGdlR3JhcGhQbHVnaW4gZnJvbSAnLi9tYWluJztcbmltcG9ydCB7IEFQSUhhbmRsZXIgfSBmcm9tICcuL2FwaUhhbmRsZXInO1xuXG5leHBvcnQgY2xhc3MgQ3JpdGljIHtcbiAgICBwcml2YXRlIHBsdWdpbjogS25vd2xlZGdlR3JhcGhQbHVnaW47XG4gICAgcHJpdmF0ZSBhcGlIYW5kbGVyOiBBUElIYW5kbGVyO1xuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBLbm93bGVkZ2VHcmFwaFBsdWdpbikge1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICAgICAgdGhpcy5hcGlIYW5kbGVyID0gbmV3IEFQSUhhbmRsZXIocGx1Z2luKTsgLy8gQ3JpdGljIGNhbiBoYXZlIGl0cyBvd24gaGFuZGxlciBpZiBuZWVkZWRcbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMganVkZ2UoY29udGVudDogc3RyaW5nKTogUHJvbWlzZTx7IGlzQXBwcm92ZWQ6IGJvb2xlYW4sIHJlYXNvbjogc3RyaW5nIH0+IHtcbiAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmNyaXRpY19tb2RlID09PSAnYWknKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fanVkZ2VCeUFJKGNvbnRlbnQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl9qdWRnZUJ5SGV1cmlzdGljKGNvbnRlbnQpO1xuICAgIH1cblxuICAgIHByaXZhdGUgX2p1ZGdlQnlIZXVyaXN0aWMoY29udGVudDogc3RyaW5nKTogeyBpc0FwcHJvdmVkOiBib29sZWFuLCByZWFzb246IHN0cmluZyB9IHtcbiAgICAgICAgY29uc3QgcmVhc29uczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgY29uc3QgY29udGVudExvd2VyID0gY29udGVudC50b0xvd2VyQ2FzZSgpO1xuXG4gICAgICAgIC8vIDEuIENoZWNrIGZvciByZXF1aXJlZCBoZWFkZXJzXG4gICAgICAgIGNvbnN0IHJlcXVpcmVkSGVhZGVycyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmNyaXRpY19yZXF1aXJlZF9oZWFkZXJzXG4gICAgICAgICAgICAuc3BsaXQoJ1xcbicpLm1hcChoID0+IGgudHJpbSgpLnRvTG93ZXJDYXNlKCkpLmZpbHRlcihCb29sZWFuKTtcbiAgICAgICAgY29uc3QgbWlzc2luZ0hlYWRlcnMgPSByZXF1aXJlZEhlYWRlcnMuZmlsdGVyKGggPT4gIWNvbnRlbnRMb3dlci5pbmNsdWRlcyhoKSk7XG4gICAgICAgIGlmIChtaXNzaW5nSGVhZGVycy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICByZWFzb25zLnB1c2goYFx1N0YzQVx1NUMxMVx1NUZDNVx1OTcwMFx1NzY4NFx1NjgwN1x1OTg5ODogJHttaXNzaW5nSGVhZGVycy5qb2luKCcsICcpfWApO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gMi4gQ2hlY2sgZm9yIG1pbiBsZW5ndGhcbiAgICAgICAgaWYgKGNvbnRlbnQubGVuZ3RoIDwgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3JpdGljX21pbl9jb250ZW50X2xlbmd0aCkge1xuICAgICAgICAgICAgcmVhc29ucy5wdXNoKGBcdTUxODVcdTVCQjlcdThGQzdcdTc3RUQgKFx1NUY1M1x1NTI0RDogJHtjb250ZW50Lmxlbmd0aH0sIFx1ODk4MVx1NkM0MjogJHt0aGlzLnBsdWdpbi5zZXR0aW5ncy5jcml0aWNfbWluX2NvbnRlbnRfbGVuZ3RofSlgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIDMuIENoZWNrIGZvciByZWZ1c2FsIHBhdHRlcm5zXG4gICAgICAgIGNvbnN0IHJlZnVzYWxQYXR0ZXJucyA9IFtcIlx1NEY1Q1x1NEUzQVx1NEUwMD9cdTRFMkFBSVwiLCBcIlx1NEY1Q1x1NEUzQVx1OEJFRFx1OEEwMFx1NkEyMVx1NTc4QlwiLCBcIlx1NjIxMVx1NEUwRFx1ODBGRFwiLCBcIlx1NjIxMVx1NjVFMFx1NkNENVwiLCBcIlx1NUY4OFx1NjJCMVx1NkI0OVwiXTtcbiAgICAgICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIHJlZnVzYWxQYXR0ZXJucykge1xuICAgICAgICAgICAgaWYgKG5ldyBSZWdFeHAocGF0dGVybiwgJ2knKS50ZXN0KGNvbnRlbnQpKSB7XG4gICAgICAgICAgICAgICAgcmVhc29ucy5wdXNoKGBcdTUzMDVcdTU0MkJBSVx1NjJEMlx1N0VERFx1OEJFRCAoXHU1MzM5XHU5MTREOiAnJHtwYXR0ZXJufScpYCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpc0FwcHJvdmVkOiByZWFzb25zLmxlbmd0aCA9PT0gMCxcbiAgICAgICAgICAgIHJlYXNvbjogcmVhc29ucy5sZW5ndGggPiAwID8gcmVhc29ucy5qb2luKCc7ICcpIDogXCJcdTkwMUFcdThGQzdcdTYyNDBcdTY3MDlcdTU0MkZcdTUzRDFcdTVGMEZcdTg5QzRcdTUyMTlcdTY4QzBcdTY3RTVcdTMwMDJcIlxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgX2p1ZGdlQnlBSShjb250ZW50OiBzdHJpbmcpOiBQcm9taXNlPHsgaXNBcHByb3ZlZDogYm9vbGVhbiwgcmVhc29uOiBzdHJpbmcgfT4ge1xuICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9tcHRfY3JpdGljLnJlcGxhY2UoJ3tjb250ZW50fScsIGNvbnRlbnQpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmFwaUhhbmRsZXIuY2FsbChwcm9tcHQpO1xuICAgICAgICAgICAgY29uc3QgZGVjaXNpb25NYXRjaCA9IHJlc3BvbnNlLm1hdGNoKC9ERUNJU0lPTjpcXHMqKEtFRVB8RElTQ0FSRCkvaSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFx1MzAxMFx1MzAxMFx1MzAxMCBcdTVERjJcdTRGRUVcdTU5MERcdUZGMUFcdTZERkJcdTUyQTAgL2kgXHU2ODA3XHU1RkQ3XHVGRjBDXHU0RjdGXHU1MTc2XHU0RTBEXHU1MzNBXHU1MjA2XHU1OTI3XHU1QzBGXHU1MTk5IFx1MzAxMVx1MzAxMVx1MzAxMVxuICAgICAgICAgICAgY29uc3QgcmVhc29uTWF0Y2ggPSByZXNwb25zZS5tYXRjaCgvXFxbUkVBU09OOlxccyooW15cXF1dKylcXF0vaSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IGlzQXBwcm92ZWQgPSBkZWNpc2lvbk1hdGNoID8gZGVjaXNpb25NYXRjaFsxXS50b1VwcGVyQ2FzZSgpID09PSAnS0VFUCcgOiBmYWxzZTtcbiAgICAgICAgICAgIGNvbnN0IHJlYXNvbiA9IHJlYXNvbk1hdGNoID8gcmVhc29uTWF0Y2hbMV0udHJpbSgpIDogKGlzQXBwcm92ZWQgPyBcIkFJIFx1NjI3OVx1NTFDNlwiIDogXCJBSSBcdTYyRDJcdTdFRERcdUZGMENcdTY3MkFcdTYzRDBcdTRGOUJcdTY2MEVcdTc4NkVcdTc0MDZcdTc1MzFcIik7XG5cbiAgICAgICAgICAgIHJldHVybiB7IGlzQXBwcm92ZWQsIHJlYXNvbiB9O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkFJIENyaXRpYyBjYWxsIGZhaWxlZDpcIiwgZXJyb3IpO1xuICAgICAgICAgICAgcmV0dXJuIHsgaXNBcHByb3ZlZDogZmFsc2UsIHJlYXNvbjogYEFJIFx1NUJBMVx1NjgzOFx1NTY2OFx1OEMwM1x1NzUyOFx1NTkzMVx1OEQyNTogJHtlcnJvci5tZXNzYWdlfWAgfTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsICIvLyByZXZpc2VyLnRzXG5cbmltcG9ydCBLbm93bGVkZ2VHcmFwaFBsdWdpbiBmcm9tICcuL21haW4nO1xuXG5leHBvcnQgY2xhc3MgUmV2aXNlciB7XG4gICAgcHJpdmF0ZSBwbHVnaW46IEtub3dsZWRnZUdyYXBoUGx1Z2luO1xuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBLbm93bGVkZ2VHcmFwaFBsdWdpbikge1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICB9XG5cbiAgICBwdWJsaWMgY3JlYXRlUmV2aXNpb25Qcm9tcHQoaWRlYTogc3RyaW5nLCBvcmlnaW5hbENvbnRlbnQ6IHN0cmluZywgcmVqZWN0aW9uUmVhc29uOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBsZXQgcHJvbXB0ID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvbXB0X3JldmlzZXI7XG4gICAgICAgIHByb21wdCA9IHByb21wdC5yZXBsYWNlKCd7Y29uY2VwdH0nLCBpZGVhKTtcbiAgICAgICAgcHJvbXB0ID0gcHJvbXB0LnJlcGxhY2UoJ3tvcmlnaW5hbF9jb250ZW50fScsIG9yaWdpbmFsQ29udGVudCk7XG4gICAgICAgIHByb21wdCA9IHByb21wdC5yZXBsYWNlKCd7cmVqZWN0aW9uX3JlYXNvbn0nLCByZWplY3Rpb25SZWFzb24pO1xuICAgICAgICByZXR1cm4gcHJvbXB0O1xuICAgIH1cbn1cbiIsICIvLyB1dGlscy50cyAoXHU1MzlGXHU1OUNCXHU3QTMzXHU1QjlBXHU3MjQ4KVxuXG5leHBvcnQgZnVuY3Rpb24gc2FuaXRpemVGaWxlbmFtZShuYW1lOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIC8vIFx1NzlGQlx1OTY2NFx1NjJFQ1x1NTNGN1x1NTNDQVx1NTE3Nlx1NTE4NVx1NUJCOVxuICAgIGxldCBjbGVhbk5hbWUgPSBuYW1lLnJlcGxhY2UoL1xccypcXCguKlxcKS9nLCAnJykudHJpbSgpO1xuICAgIC8vIFx1NzlGQlx1OTY2NFx1NjU4N1x1NEVGNlx1N0NGQlx1N0VERlx1NEUwRFx1NTE0MVx1OEJCOFx1NzY4NFx1NUI1N1x1N0IyNlxuICAgIGNsZWFuTmFtZSA9IGNsZWFuTmFtZS5yZXBsYWNlKC9bXFxcXC8qPzpcIjw+fF0vZywgXCJcIik7XG4gICAgLy8gXHU5NjUwXHU1MjM2XHU5NTdGXHU1RUE2XG4gICAgcmV0dXJuIGNsZWFuTmFtZS5zbGljZSgwLCAxMDApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZXh0cmFjdE5ld0lkZWFzKGNvbnRlbnQ6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBtYXRjaGVzID0gY29udGVudC5tYXRjaCgvXFxbXFxbKFteXFxdXSspXFxdXFxdL2cpO1xuICAgIGlmICghbWF0Y2hlcykge1xuICAgICAgICByZXR1cm4gW107XG4gICAgfVxuICAgIC8vIFx1NEVDRSBbW0xpbmt8QWxpYXNdXSBcdTYyMTYgW1tMaW5rXV0gXHU0RTJEXHU2M0QwXHU1M0Q2IFwiTGlua1wiXG4gICAgY29uc3QgaWRlYXMgPSBtYXRjaGVzLm1hcChtYXRjaCA9PiB7XG4gICAgICAgIHJldHVybiBtYXRjaC5zbGljZSgyLCAtMikuc3BsaXQoJ3wnKVswXS50cmltKCk7XG4gICAgfSk7XG4gICAgcmV0dXJuIFsuLi5uZXcgU2V0KGlkZWFzKV07IC8vIFx1OEZENFx1NTZERVx1NTNCQlx1OTFDRFx1NTQwRVx1NzY4NFx1N0VEM1x1Njc5Q1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2xlYW5NYXJrZG93bk91dHB1dChjb250ZW50OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IHRyaW1tZWQgPSBjb250ZW50LnRyaW0oKTtcbiAgICBpZiAodHJpbW1lZC5zdGFydHNXaXRoKFwiYGBgbWFya2Rvd25cIikgJiYgdHJpbW1lZC5lbmRzV2l0aChcImBgYFwiKSkge1xuICAgICAgICBsZXQgY2xlYW5lZCA9IHRyaW1tZWQuc3Vic3RyaW5nKFwiYGBgbWFya2Rvd25cIi5sZW5ndGgsIHRyaW1tZWQubGVuZ3RoIC0gXCJgYGBcIi5sZW5ndGgpO1xuICAgICAgICByZXR1cm4gY2xlYW5lZC50cmltKCk7XG4gICAgfVxuICAgIHJldHVybiB0cmltbWVkO1xufVxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLElBQUFBLG1CQUFzRTs7O0FDRXRFLElBQUFDLG1CQUF1RDs7O0FDQXZELHNCQUE0QztBQUlyQyxJQUFNLHVCQUFOLGNBQW1DLHNCQUFNO0FBQUEsRUFzQjVDLFlBQVksS0FBVSxRQUE4QjtBQUNoRCxVQUFNLEdBQUc7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SyxjQUFjLEtBQUssaUJBQWlCO0FBQ3pDLFNBQUssT0FBTyxnQkFBZ0I7QUFHNUIsU0FBSyxjQUFjLElBQUksY0FBYyxLQUFLLEtBQUssSUFBSSxDQUFDO0FBR3BELFNBQUssV0FBVztBQUFBLE1BQ1osSUFBSTtBQUFBLE1BQ0osTUFBTTtBQUFBLE1BQ04sVUFBVSxNQUFNO0FBQ1osYUFBSyxPQUFPLGtCQUFrQjtBQUFBLE1BQ2xDO0FBQUEsSUFDSixDQUFDO0FBRUQsU0FBSyxXQUFXO0FBQUEsTUFDWixJQUFJO0FBQUEsTUFDSixNQUFNO0FBQUEsTUFDTixlQUFlLENBQUMsYUFBc0I7QUFDbEMsY0FBTSxPQUFPLEtBQUssSUFBSSxVQUFVLGNBQWM7QUFDOUMsWUFBSSxNQUFNO0FBQ04sY0FBSSxDQUFDLFVBQVU7QUFDWCxpQkFBSyxPQUFPLGtCQUFrQixLQUFLLFFBQVE7QUFBQSxVQUMvQztBQUNBLGlCQUFPO0FBQUEsUUFDWDtBQUNBLGVBQU87QUFBQSxNQUNYO0FBQUEsSUFDSixDQUFDO0FBRUQsWUFBUSxJQUFJLDhEQUFZO0FBQUEsRUFDNUI7QUFBQSxFQUVBLFdBQVc7QUFDUCxZQUFRLElBQUksOERBQVk7QUFBQSxFQUM1QjtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQU9BLE1BQU0sZUFBZTtBQUNqQixVQUFNLGlCQUFpQixNQUFNLGtCQUFrQjtBQUUvQyxVQUFNLFlBQVksTUFBTSxLQUFLLFNBQVM7QUFFdEMsVUFBTSxnQkFBZ0IsYUFBYSxDQUFDO0FBR3BDLFNBQUssV0FBVyxPQUFPLE9BQU8sQ0FBQyxHQUFHLGtCQUFrQixnQkFBZ0IsYUFBYTtBQUFBLEVBQ3JGO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQU1BLE1BQU0sZUFBZTtBQUNqQixVQUFNLGFBQWEsRUFBRSxHQUFHLEtBQUssVUFBVSxhQUFhLEtBQUssS0FBSztBQUM5RCxVQUFNLEtBQUssU0FBUyxVQUFVO0FBQUEsRUFDbEM7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBTUEsTUFBTSxpQkFBaUI7QUFFbkIsVUFBTSxZQUFZLE1BQU0sS0FBSyxTQUFTO0FBRXRDLFVBQU0sY0FBYSx1Q0FBVyxnQkFBZSxDQUFDO0FBRzlDLFNBQUssT0FBTyxPQUFPLE9BQU8sQ0FBQyxHQUFHLHFCQUFxQixVQUFVO0FBQUEsRUFDakU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFPQSxNQUFNLGlCQUFpQjtBQUNuQixVQUFNLEtBQUssYUFBYTtBQUFBLEVBQzVCO0FBQ0o7IiwKICAibmFtZXMiOiBbImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiJdCn0K
