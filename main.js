/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => KnowledgeGraphPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian5 = require("obsidian");

// settings.ts
var import_obsidian2 = require("obsidian");

// QueueModal.ts
var import_obsidian = require("obsidian");
var QueueManagementModal = class extends import_obsidian.Modal {
  constructor(app, plugin) {
    super(app);
    // 用于保存搜索词
    this.searchTerms = {
      gen: "",
      rev: "",
      rep: "",
      dis: ""
    };
    // 【【【 已修改：默认全部折叠 】】】
    this.collapseStates = {
      gen: false,
      // 默认折叠
      rev: false,
      // 默认折叠
      rep: false,
      // 默认折叠
      dis: false
      // 默认折叠
    };
    this.plugin = plugin;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.addClass("kg-modal");
    contentEl.createEl("h2", { text: "\u961F\u5217\u7BA1\u7406\u4EEA\u8868\u76D8" });
    const status = this.plugin.data.status;
    const statusText = `\u72B6\u6001: ${status.toUpperCase()} | ${this.plugin.statusBarEl.getText()}`;
    new import_obsidian.Setting(contentEl).setName(status === "running" ? "\u5F15\u64CE\u8FD0\u884C\u4E2D" : "\u5F15\u64CE\u5DF2\u6682\u505C").setDesc(statusText).addButton(
      (button) => button.setButtonText(status === "running" ? "\u6682\u505C\u5F15\u64CE" : "\u542F\u52A8\u5F15\u64CE").setCta(status !== "running").onClick(() => {
        this.plugin.engine.toggleEngineState();
        this.onOpen();
      })
    );
    this.renderQueueSection(
      contentEl,
      "gen",
      "\u5F85\u751F\u6210 (Generation)",
      this.plugin.data.generationQueue,
      this.renderGenerationItem.bind(this)
    );
    this.renderQueueSection(
      contentEl,
      "rev",
      "\u5F85\u5BA1\u6838 (Review)",
      this.plugin.data.reviewQueue,
      this.renderReviewItem.bind(this)
    );
    this.renderQueueSection(
      contentEl,
      "rep",
      "\u5F85\u4FEE\u6B63 (Revision)",
      this.plugin.data.revisionQueue,
      this.renderRevisionItem.bind(this)
    );
    this.renderQueueSection(
      contentEl,
      "dis",
      "\u5DF2\u4E22\u5F03 (Discarded)",
      this.plugin.data.discardedPile,
      this.renderDiscardedItem.bind(this)
    );
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
  /**
   * 渲染一个队列区域 (带搜索和展开/折叠)
   */
  renderQueueSection(containerEl, key, title, data, renderFn) {
    const displayLimit = 100;
    const filter = this.searchTerms[key];
    const filteredData = data.filter((item) => {
      if (!filter)
        return true;
      const needle = filter.toLowerCase();
      if (typeof item === "string") {
        return item.toLowerCase().includes(needle);
      }
      return item.idea.toLowerCase().includes(needle);
    });
    const total = data.length;
    const filteredTotal = filteredData.length;
    const titleText = `${title} (${filteredTotal}${total !== filteredTotal ? " / " + total : ""} \u9879)`;
    const details = containerEl.createEl("details");
    details.open = this.collapseStates[key];
    const summary = details.createEl("summary", { text: titleText });
    summary.style.fontWeight = "bold";
    summary.style.fontSize = "var(--font-ui-large)";
    summary.style.cursor = "pointer";
    summary.style.padding = "5px 0";
    details.addEventListener("toggle", () => {
      this.collapseStates[key] = details.open;
    });
    new import_obsidian.Setting(details).setDesc(`\u641C\u7D22 ${title}...`).addText((text) => {
      text.setPlaceholder("\u8F93\u5165\u5173\u952E\u8BCD...").setValue(this.searchTerms[key]).onChange((value) => {
        this.searchTerms[key] = value;
        this.onOpen();
      });
    });
    const truncatedData = filteredData.slice(0, displayLimit);
    if (truncatedData.length === 0) {
      const desc = details.createEl("p", { text: "\u6B64\u961F\u5217\u4E3A\u7A7A\uFF0C\u6216\u672A\u627E\u5230\u5339\u914D\u9879\u3002", cls: "setting-item-description" });
      desc.style.paddingLeft = "10px";
      return;
    }
    const listContainer = details.createDiv("kg-list-container");
    listContainer.style.maxHeight = "200px";
    listContainer.style.overflowY = "auto";
    listContainer.style.border = "1px solid var(--background-modifier-border)";
    listContainer.style.padding = "5px";
    listContainer.style.marginLeft = "10px";
    truncatedData.forEach((item, index) => {
      renderFn(listContainer, item, index);
    });
    if (filteredData.length > displayLimit) {
      const truncatedInfo = details.createEl("p", {
        text: `... \u4EC5\u663E\u793A\u524D ${displayLimit} \u9879 (\u5171 ${filteredData.length} \u9879)\uFF0C\u8BF7\u4F7F\u7528\u641C\u7D22\u67E5\u627E\u66F4\u591A\u3002`,
        cls: "setting-item-description"
      });
      truncatedInfo.style.paddingLeft = "10px";
    }
  }
  // --- 单项渲染函数 (保持不变) ---
  renderGenerationItem(container, item) {
    new import_obsidian.Setting(container).setName(item).addButton(
      (btn) => btn.setIcon("trash").setTooltip("\u5220\u9664\u6B64\u6982\u5FF5").onClick(async () => {
        const queue = this.plugin.data.generationQueue;
        const index = queue.indexOf(item);
        if (index > -1) {
          queue.splice(index, 1);
          await this.plugin.savePluginData();
          this.plugin.engine.updateStatusBar();
          this.onOpen();
        }
      })
    );
  }
  renderReviewItem(container, item) {
    const task = item;
    new import_obsidian.Setting(container).setName(`[\u5BA1\u6838] ${task.idea}`).addButton(
      (btn) => btn.setIcon("trash").setTooltip("\u4E22\u5F03\u6B64\u4EFB\u52A1").onClick(async () => {
        this.plugin.data.reviewQueue.splice(this.plugin.data.reviewQueue.indexOf(task), 1);
        this.plugin.data.discardedPile.push(task);
        await this.plugin.savePluginData();
        this.plugin.engine.updateStatusBar();
        this.onOpen();
      })
    );
  }
  renderRevisionItem(container, item) {
    const task = item;
    new import_obsidian.Setting(container).setName(`[\u4FEE\u6B63] ${task.idea}`).setDesc(`\u539F\u56E0: ${task.reason || "\u672A\u77E5"}`).addButton(
      (btn) => btn.setIcon("trash").setTooltip("\u4E22\u5F03\u6B64\u4EFB\u52A1").onClick(async () => {
        this.plugin.data.revisionQueue.splice(this.plugin.data.revisionQueue.indexOf(task), 1);
        this.plugin.data.discardedPile.push(task);
        await this.plugin.savePluginData();
        this.plugin.engine.updateStatusBar();
        this.onOpen();
      })
    );
  }
  renderDiscardedItem(container, item) {
    const task = item;
    new import_obsidian.Setting(container).setName(`[\u5DF2\u4E22\u5F03] ${task.idea}`).setDesc(`\u6700\u540E\u539F\u56E0: ${task.reason || "\u672A\u77E5"}`).addButton(
      (btn) => btn.setIcon("refresh-cw").setTooltip("\u91CD\u65B0\u6392\u961F (\u653E\u56DE\u751F\u6210\u961F\u5217)").onClick(async () => {
        this.plugin.data.discardedPile.splice(this.plugin.data.discardedPile.indexOf(task), 1);
        this.plugin.engine.addConceptsToQueue([task.idea]);
        this.onOpen();
      })
    );
  }
};

// settings.ts
var PROMPT_GENERATOR_DEFAULT = `# Role: \u77E5\u8BC6\u7CFB\u7EDF\u6784\u5EFA\u4E13\u5BB6...`;
var PROMPT_CRITIC_DEFAULT = `# Role: \u77E5\u8BC6\u56FE\u8C31\u8D28\u91CF\u5BA1\u6838\u5458...`;
var PROMPT_REVISER_DEFAULT = `# \u89D2\u8272: \u8D44\u6DF1\u77E5\u8BC6\u7F16\u8F91\u4E0E\u5185\u5BB9\u4F18\u5316\u4E13\u5BB6...`;
var DEFAULT_SETTINGS = {
  // API
  openai_api_keys: "",
  openai_base_url: "https://api.openai.com/v1",
  openai_model: "gpt-4-turbo-preview",
  google_api_keys: "",
  google_model: "gemini-1.5-pro-latest",
  failover_cooldown_seconds: 300,
  // 参数
  generation_temperature: 0.7,
  generation_max_tokens: 4096,
  // 路径
  output_dir: "KnowledgeGraphNotes",
  // 系统
  max_workers: 2,
  generation_batch_size: 5,
  request_delay: 5,
  // Critic
  critic_mode: "heuristic",
  critic_required_headers: "# \u{1F9E0}\n> \n## \u{1F4DD} \u6838\u5FC3\u601D\u60F3\n## \u{1F3AF} \u9002\u7528\u573A\u666F\n## \u{1F6E0}\uFE0F \u4F7F\u7528\u6B65\u9AA4/\u6784\u6210\u8981\u7D20\n## \u{1F680} \u6848\u4F8B\u5206\u6790\n## \u{1F44D} \u4F18\u70B9 & \u{1F44E} \u7F3A\u70B9\n## \u{1F517} \u5173\u8054\u6A21\u578B",
  critic_min_content_length: 400,
  // Reviser
  max_revision_retries: 2,
  // Prompts
  prompt_generator: PROMPT_GENERATOR_DEFAULT,
  prompt_critic: PROMPT_CRITIC_DEFAULT,
  prompt_reviser: PROMPT_REVISER_DEFAULT,
  // 播种箱
  seedConcepts: "",
  // 【【【 新增配置项 】】】
  // 默认关闭新概念提取
  extract_new_concepts: false
};
async function getDefaultPrompts() {
  return {
    prompt_generator: PROMPT_GENERATOR_DEFAULT,
    prompt_critic: PROMPT_CRITIC_DEFAULT,
    prompt_reviser: PROMPT_REVISER_DEFAULT
  };
}
var KGsSettingTab = class extends import_obsidian2.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "\u77E5\u8BC6\u56FE\u8C31\u751F\u6210\u5668 - \u8BBE\u7F6E" });
    new import_obsidian2.Setting(containerEl).setName("\u5F15\u64CE\u4EEA\u8868\u76D8").setDesc("\u7BA1\u7406\u5F85\u751F\u6210\u3001\u5F85\u5BA1\u6838\u548C\u5DF2\u4E22\u5F03\u7684\u4EFB\u52A1\u3002").addButton(
      (button) => button.setButtonText("\u6253\u5F00\u961F\u5217\u7BA1\u7406\u5668").setCta().onClick(() => {
        new QueueManagementModal(this.app, this.plugin).open();
      })
    );
    new import_obsidian2.Setting(containerEl).setName("API \u8BBE\u7F6E").setHeading();
    containerEl.createEl("h3", { text: "OpenAI" });
    new import_obsidian2.Setting(containerEl).setName("OpenAI API Keys").setDesc("\u6BCF\u884C\u4E00\u4E2A Key\u3002\u63D2\u4EF6\u5C06\u81EA\u52A8\u8F6E\u6362\u548C\u51B7\u5374\u4F7F\u7528\u3002").addTextArea((text) => text.setPlaceholder("sk-...").setValue(this.plugin.settings.openai_api_keys).onChange(async (value) => {
      this.plugin.settings.openai_api_keys = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("OpenAI Base URL").setDesc("\u5982\u679C\u4F60\u4F7F\u7528\u7B2C\u4E09\u65B9\u4EE3\u7406\uFF0C\u8BF7\u5728\u6B64\u5904\u586B\u5165\u4EE3\u7406\u5730\u5740\u3002").addText((text) => text.setPlaceholder("https://api.openai.com/v1").setValue(this.plugin.settings.openai_base_url).onChange(async (value) => {
      this.plugin.settings.openai_base_url = value.trim();
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("OpenAI Model").setDesc("\u8F93\u5165\u4F60\u60F3\u4F7F\u7528\u7684 OpenAI \u6A21\u578B\u540D\u79F0\u3002").addText((text) => text.setPlaceholder("gpt-4-turbo-preview").setValue(this.plugin.settings.openai_model).onChange(async (value) => {
      this.plugin.settings.openai_model = value.trim();
      await this.plugin.saveSettings();
    }));
    containerEl.createEl("h3", { text: "Google Gemini" });
    new import_obsidian2.Setting(containerEl).setName("Google Gemini API Keys").setDesc("\u6BCF\u884C\u4E00\u4E2A Key\u3002").addTextArea((text) => text.setPlaceholder("AIzaSy...").setValue(this.plugin.settings.google_api_keys).onChange(async (value) => {
      this.plugin.settings.google_api_keys = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("Google Gemini Model").setDesc("\u8F93\u5165\u4F60\u60F3\u4F7F\u7528\u7684 Google \u6A21\u578B\u540D\u79F0\u3002").addText((text) => text.setPlaceholder("gemini-1.5-pro-latest").setValue(this.plugin.settings.google_model).onChange(async (value) => {
      this.plugin.settings.google_model = value.trim();
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("Key \u51B7\u5374\u65F6\u95F4 (\u79D2)").setDesc("API Key \u5931\u8D25\u540E\uFF0C\u9700\u8981\u7B49\u5F85\u591A\u5C11\u79D2\u624D\u80FD\u518D\u6B21\u4F7F\u7528\u3002").addText((text) => text.setValue(String(this.plugin.settings.failover_cooldown_seconds)).onChange(async (value) => {
      const num = parseInt(value, 10);
      if (!isNaN(num) && num >= 0) {
        this.plugin.settings.failover_cooldown_seconds = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("LLM \u53C2\u6570\u8BBE\u7F6E").setHeading();
    new import_obsidian2.Setting(containerEl).setName("\u751F\u6210\u6E29\u5EA6 (Temperature)").setDesc("\u63A7\u5236\u751F\u6210\u5185\u5BB9\u7684\u968F\u673A\u6027\u3002\u8F83\u4F4E\u7684\u503C\uFF08\u5982 0.2\uFF09\u66F4\u5177\u786E\u5B9A\u6027\uFF0C\u8F83\u9AD8\u7684\u503C\uFF08\u5982 0.8\uFF09\u66F4\u5177\u521B\u9020\u6027\u3002").addText((text) => text.setValue(String(this.plugin.settings.generation_temperature)).onChange(async (value) => {
      const num = parseFloat(value);
      if (!isNaN(num) && num >= 0 && num <= 2) {
        this.plugin.settings.generation_temperature = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("\u6700\u5927 Token \u6570 (Max Tokens)").setDesc("API \u4E00\u6B21\u8C03\u7528\u5141\u8BB8\u751F\u6210\u7684\u6700\u5927 Token \u6570\u91CF\u3002").addText((text) => text.setValue(String(this.plugin.settings.generation_max_tokens)).onChange(async (value) => {
      const num = parseInt(value, 10);
      if (!isNaN(num) && num > 0) {
        this.plugin.settings.generation_max_tokens = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("\u5F15\u64CE\u8BBE\u7F6E").setHeading();
    new import_obsidian2.Setting(containerEl).setName("\u8F93\u51FA\u6587\u4EF6\u5939").setDesc("\u6240\u6709\u751F\u6210\u7684\u7B14\u8BB0\u5C06\u4FDD\u5B58\u5230\u6B64\u6587\u4EF6\u5939\u3002").addText((text) => text.setPlaceholder("KnowledgeGraphNotes").setValue(this.plugin.settings.output_dir).onChange(async (value) => {
      this.plugin.settings.output_dir = value.trim().replace(/\/$/, "");
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("\u6700\u5927\u5E76\u53D1\u6570 (Max Workers)").setDesc("\uFF08\u6CE8\u610F\uFF1A\u5F53\u524D V2.2 \u5F15\u64CE\u4E3A\u5355\u7EBF\u7A0B\u6D41\u6C34\u7EBF\uFF0C\u6B64\u8BBE\u7F6E\u6682\u672A\u751F\u6548\uFF09").addText((text) => text.setValue(String(this.plugin.settings.max_workers)).onChange(async (value) => {
      const num = parseInt(value, 10);
      if (!isNaN(num) && num > 0) {
        this.plugin.settings.max_workers = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("\u751F\u6210\u6279\u5904\u7406\u5927\u5C0F").setDesc("\u5F15\u64CE\u6BCF\u4E00\u8F6E\u4ECE\u201C\u5F85\u751F\u6210\u961F\u5217\u201D\u4E2D\u53D6\u51FA\u7684\u4EFB\u52A1\u6570\u91CF\u3002").addText((text) => text.setValue(String(this.plugin.settings.generation_batch_size)).onChange(async (value) => {
      const num = parseInt(value, 10);
      if (!isNaN(num) && num > 0) {
        this.plugin.settings.generation_batch_size = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("\u6BCF\u8F6E\u8BF7\u6C42\u5EF6\u8FDF (\u79D2)").setDesc("\u5F15\u64CE\u5728\u5904\u7406\u5B8C\u4E00\u4E2A\u6279\u6B21\u540E\uFF0C\u7B49\u5F85\u591A\u5C11\u79D2\u518D\u5F00\u59CB\u4E0B\u4E00\u4E2A\u6279\u6B21\u3002").addText((text) => text.setValue(String(this.plugin.settings.request_delay)).onChange(async (value) => {
      const num = parseInt(value, 10);
      if (!isNaN(num) && num >= 0) {
        this.plugin.settings.request_delay = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("\u6700\u5927\u4FEE\u6B63\u6B21\u6570").setDesc("\u4E00\u7BC7\u7B14\u8BB0\u5728\u88AB\u653E\u5F03\uFF08\u79FB\u5165 Discarded Pile\uFF09\u524D\uFF0C\u6700\u591A\u5141\u8BB8\u88AB\u4FEE\u6B63\u7684\u6B21\u6570\u3002").addText((text) => text.setValue(String(this.plugin.settings.max_revision_retries)).onChange(async (value) => {
      const num = parseInt(value, 10);
      if (!isNaN(num) && num >= 0) {
        this.plugin.settings.max_revision_retries = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("\u81EA\u52A8\u63D0\u53D6\u65B0\u6982\u5FF5 (Extract New Concepts)").setDesc("\u5F00\u542F\u540E\uFF0C\u5C06\u81EA\u52A8\u4ECE\u5DF2\u6279\u51C6\u7B14\u8BB0\u7684\u5185\u5BB9\u4E2D\u63D0\u53D6 [[Wikilinks]] \u4F5C\u4E3A\u65B0\u6982\u5FF5\u52A0\u5165\u201C\u5F85\u751F\u6210\u961F\u5217\u201D\u3002(\u9ED8\u8BA4\u5173\u95ED)").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.extract_new_concepts).onChange(async (value) => {
        this.plugin.settings.extract_new_concepts = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian2.Setting(containerEl).setName("\u5BA1\u6838\u6A21\u5F0F (Critic Mode)").setDesc("\u9009\u62E9\u5185\u5BB9\u5BA1\u6838\u7684\u65B9\u5F0F\u3002\u542F\u53D1\u5F0F\u6A21\u5F0F\u901F\u5EA6\u5FEB\u4E14\u514D\u8D39\uFF0C\u4F46\u53EA\u68C0\u67E5\u683C\u5F0F\uFF1BAI\u6A21\u5F0F\u66F4\u667A\u80FD\uFF0C\u4F46\u4F1A\u6D88\u8017API\u989D\u5EA6\u3002").addDropdown((dropdown) => dropdown.addOption("heuristic", "\u542F\u53D1\u5F0F (Heuristic)").addOption("ai", "\u4EBA\u5DE5\u667A\u80FD (AI)").setValue(this.plugin.settings.critic_mode).onChange(async (value) => {
      this.plugin.settings.critic_mode = value;
      await this.plugin.saveSettings();
      this.display();
    }));
    if (this.plugin.settings.critic_mode === "heuristic") {
      new import_obsidian2.Setting(containerEl).setName("\u542F\u53D1\u5F0F\u5BA1\u6838\uFF1A\u5FC5\u987B\u7684\u6807\u9898").setDesc("\u5728\u542F\u53D1\u5F0F\u6A21\u5F0F\u4E0B\uFF0C\u68C0\u67E5\u7B14\u8BB0\u662F\u5426\u5305\u542B\u6240\u6709\u8FD9\u4E9B\u6807\u9898\uFF08\u6BCF\u884C\u4E00\u4E2A\uFF09\u3002").addTextArea((text) => text.setValue(this.plugin.settings.critic_required_headers).onChange(async (value) => {
        this.plugin.settings.critic_required_headers = value;
        await this.plugin.saveSettings();
      }).inputEl.style.height = "150px");
      new import_obsidian2.Setting(containerEl).setName("\u542F\u53D1\u5F0F\u5BA1\u6838\uFF1A\u6700\u5C0F\u5185\u5BB9\u957F\u5EA6").setDesc("\u5728\u542F\u53D1\u5F0F\u6A21\u5F0F\u4E0B\uFF0C\u7B14\u8BB0\u5185\u5BB9\u5FC5\u987B\u8FBE\u5230\u7684\u6700\u5C0F\u5B57\u7B26\u6570\u3002").addText((text) => text.setValue(String(this.plugin.settings.critic_min_content_length)).onChange(async (value) => {
        const num = parseInt(value, 10);
        if (!isNaN(num) && num >= 0) {
          this.plugin.settings.critic_min_content_length = num;
          await this.plugin.saveSettings();
        }
      }));
    }
    new import_obsidian2.Setting(containerEl).setName("\u6982\u5FF5\u64AD\u79CD (Concept Seeding)").setHeading();
    new import_obsidian2.Setting(containerEl).setName("\u6982\u5FF5\u64AD\u79CD\u7BB1").setDesc("\u5728\u6B64\u5904\u7C98\u8D34\u6216\u8F93\u5165\u60A8\u60F3\u8981\u751F\u6210\u521D\u59CB\u7B14\u8BB0\u7684\u6982\u5FF5\u5217\u8868\uFF0C\u6BCF\u884C\u4E00\u4E2A\u6982\u5FF5\u3002").addTextArea(
      (text) => text.setPlaceholder("\u4F8B\u5982\uFF1A\n\u7B2C\u4E00\u6027\u539F\u7406\n\u5965\u5361\u59C6\u5243\u5200\n\u523B\u610F\u7EC3\u4E60\n...").setValue(this.plugin.settings.seedConcepts).onChange(async (value) => {
        this.plugin.settings.seedConcepts = value;
        await this.plugin.saveSettings();
      }).inputEl.style.height = "200px"
    );
    new import_obsidian2.Setting(containerEl).addButton(
      (button) => button.setButtonText("\u64AD\u79CD\u5230\u5F85\u751F\u6210\u961F\u5217").setCta().onClick(async () => {
        const rawText = this.plugin.settings.seedConcepts;
        if (!rawText.trim()) {
          new import_obsidian2.Notice("\u64AD\u79CD\u7BB1\u4E3A\u7A7A\uFF0C\u65E0\u9700\u64CD\u4F5C\u3002");
          return;
        }
        const conceptsToSeed = [...new Set(rawText.split("\n").map((line) => line.trim()).filter(Boolean))];
        const addedCount = this.plugin.engine.addConceptsToQueue(conceptsToSeed);
        const ignoredCount = conceptsToSeed.length - addedCount;
        let noticeMessage = `\u6210\u529F\u6DFB\u52A0 ${addedCount} \u4E2A\u65B0\u6982\u5FF5\u5230\u961F\u5217\u3002`;
        if (ignoredCount > 0) {
          noticeMessage += `
${ignoredCount} \u4E2A\u6982\u5FF5\u56E0\u5DF2\u5B58\u5728\u6216\u91CD\u590D\u800C\u88AB\u5FFD\u7565\u3002`;
        }
        new import_obsidian2.Notice(noticeMessage, 5e3);
        this.plugin.settings.seedConcepts = "";
        await this.plugin.saveSettings();
        this.display();
      })
    );
    new import_obsidian2.Setting(containerEl).setName("Prompts \u8BBE\u7F6E").setHeading();
    new import_obsidian2.Setting(containerEl).setName("\u751F\u6210 Prompt").setDesc("\u7528\u4E8E\u751F\u6210\u65B0\u6982\u5FF5\u5185\u5BB9\u7684 Prompt\u3002").addTextArea((text) => text.setValue(this.plugin.settings.prompt_generator).onChange(async (value) => {
      this.plugin.settings.prompt_generator = value;
      await this.plugin.saveSettings();
    }).inputEl.style.height = "300px");
    if (this.plugin.settings.critic_mode === "ai") {
      new import_obsidian2.Setting(containerEl).setName("\u5BA1\u6838 Prompt (Critic)").setDesc("\u7528\u4E8E AI \u6A21\u5F0F\u4E0B\u5BA1\u6838\u751F\u6210\u5185\u5BB9\u7684 Prompt\u3002").addTextArea((text) => text.setValue(this.plugin.settings.prompt_critic).onChange(async (value) => {
        this.plugin.settings.prompt_critic = value;
        await this.plugin.saveSettings();
      }).inputEl.style.height = "300px");
    }
    new import_obsidian2.Setting(containerEl).setName("\u4FEE\u6B63 Prompt (Reviser)").setDesc("\u7528\u4E8E\u4FEE\u6B63\u88AB\u5BA1\u6838\u5458\u62D2\u7EDD\u5185\u5BB9\u7684 Prompt\u3002").addTextArea((text) => text.setValue(this.plugin.settings.prompt_reviser).onChange(async (value) => {
      this.plugin.settings.prompt_reviser = value;
      await this.plugin.saveSettings();
    }).inputEl.style.height = "300px");
  }
};

// engine.ts
var import_obsidian4 = require("obsidian");

// apiHandler.ts
var import_obsidian3 = require("obsidian");
var ApiKeyExhaustedError = class extends Error {
  constructor(message) {
    super(message);
    this.name = "ApiKeyExhaustedError";
  }
};
var AllModelsFailedError = class extends Error {
  constructor(message) {
    super(message);
    this.name = "AllModelsFailedError";
  }
};
var APIHandler = class {
  constructor(plugin) {
    this.keyUsageOpenAI = /* @__PURE__ */ new Map();
    this.keyUsageGoogle = /* @__PURE__ */ new Map();
    // 用于跟踪是否已经通知过故障切换
    this.hasNotifiedFailover = false;
    this.plugin = plugin;
    this.settings = plugin.settings;
    this.updateKeys();
  }
  updateKeys() {
    this.openai_keys = this.settings.openai_api_keys.split("\n").map((k) => k.trim()).filter(Boolean);
    this.google_keys = this.settings.google_api_keys.split("\n").map((k) => k.trim()).filter(Boolean);
    this.openai_keys.forEach((key) => {
      if (!this.keyUsageOpenAI.has(key)) {
        this.keyUsageOpenAI.set(key, { fails: 0, cooldown_until: 0 });
      }
    });
    this.google_keys.forEach((key) => {
      if (!this.keyUsageGoogle.has(key)) {
        this.keyUsageGoogle.set(key, { fails: 0, cooldown_until: 0 });
      }
    });
  }
  _selectKey(keys, provider) {
    const keyUsageMap = provider === "openai" ? this.keyUsageOpenAI : this.keyUsageGoogle;
    const currentTime = Date.now() / 1e3;
    for (const key of keys) {
      const usage = keyUsageMap.get(key);
      if (usage && currentTime >= usage.cooldown_until) {
        return key;
      }
    }
    return null;
  }
  async _callOpenAI(key, prompt) {
    var _a;
    try {
      const response = await (0, import_obsidian3.requestUrl)({
        url: `${this.settings.openai_base_url}/chat/completions`,
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "Authorization": `Bearer ${key}`
        },
        body: JSON.stringify({
          model: this.settings.openai_model,
          messages: [{ role: "user", content: prompt }],
          temperature: this.settings.generation_temperature,
          max_tokens: this.settings.generation_max_tokens
        })
      });
      const data = response.json;
      const keyUsage = this.keyUsageOpenAI.get(key);
      if (keyUsage)
        keyUsage.cooldown_until = 0;
      this.hasNotifiedFailover = false;
      return data.choices[0].message.content.trim();
    } catch (error) {
      console.error(`OpenAI API call failed for key ...${key.slice(-4)}:`, error);
      const keyUsage = this.keyUsageOpenAI.get(key);
      if (keyUsage) {
        const httpStatus = error.status;
        const errorMessage = ((_a = error.message) == null ? void 0 : _a.toLowerCase()) || "";
        if (httpStatus === 401 || httpStatus === 403 || httpStatus === 429 || errorMessage.includes("insufficient_quota") || errorMessage.includes("rate limit")) {
          console.warn(`Key ...${key.slice(-4)} exhausted. Applying full cooldown.`);
          keyUsage.cooldown_until = Date.now() / 1e3 + this.settings.failover_cooldown_seconds;
        } else {
          console.warn(`Key ...${key.slice(-4)} failed due to network/server error. No cooldown applied.`);
        }
      }
      throw new ApiKeyExhaustedError(`OpenAI key failed.`);
    }
  }
  async _callGoogleAPI(key, prompt) {
    var _a;
    const url = `https://generativelanguage.googleapis.com/v1beta/models/${this.settings.google_model}:generateContent?key=${key}`;
    try {
      const response = await (0, import_obsidian3.requestUrl)({
        url,
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          contents: [{ parts: [{ text: prompt }] }],
          generationConfig: {
            temperature: this.settings.generation_temperature,
            maxOutputTokens: this.settings.generation_max_tokens
          }
        })
      });
      const data = response.json;
      if (!data.candidates || data.candidates.length === 0) {
        throw new Error("API response is missing candidates. Full response: " + JSON.stringify(data));
      }
      const keyUsage = this.keyUsageGoogle.get(key);
      if (keyUsage)
        keyUsage.cooldown_until = 0;
      return data.candidates[0].content.parts[0].text.trim();
    } catch (error) {
      console.error(`Google Gemini API call failed for key ...${key.slice(-4)}:`, error);
      const keyUsage = this.keyUsageGoogle.get(key);
      if (keyUsage) {
        const httpStatus = error.status;
        const errorMessage = ((_a = error.message) == null ? void 0 : _a.toLowerCase()) || "";
        if (httpStatus === 401 || httpStatus === 403 || httpStatus === 429 || errorMessage.includes("quota") || errorMessage.includes("permission")) {
          console.warn(`Google Key ...${key.slice(-4)} exhausted. Applying full cooldown.`);
          keyUsage.cooldown_until = Date.now() / 1e3 + this.settings.failover_cooldown_seconds;
        } else {
          console.warn(`Google Key ...${key.slice(-4)} failed due to network/server error. No cooldown applied.`);
        }
      }
      throw new ApiKeyExhaustedError(`Google Gemini key failed.`);
    }
  }
  async call(prompt) {
    this.updateKeys();
    let lastError = null;
    let openAIKeysAttempted = false;
    if (this.openai_keys.length > 0) {
      openAIKeysAttempted = true;
      for (let i = 0; i < this.openai_keys.length; i++) {
        const key = this._selectKey(this.openai_keys, "openai");
        if (key) {
          try {
            console.log(`Trying OpenAI key ...${key.slice(-4)}`);
            return await this._callOpenAI(key, prompt);
          } catch (e) {
            lastError = e;
            new import_obsidian3.Notice(`OpenAI key ...${key.slice(-4)} failed. Trying next.`);
          }
        }
      }
    }
    if (this.google_keys.length > 0) {
      if (openAIKeysAttempted && !this.hasNotifiedFailover) {
        new import_obsidian3.Notice("All OpenAI keys failed or unavailable. Switching to Google Gemini...");
        this.hasNotifiedFailover = true;
      }
      for (let i = 0; i < this.google_keys.length; i++) {
        const key = this._selectKey(this.google_keys, "google");
        if (key) {
          try {
            console.log(`Trying Google Gemini key ...${key.slice(-4)}`);
            return await this._callGoogleAPI(key, prompt);
          } catch (e) {
            lastError = e;
            new import_obsidian3.Notice(`Google Gemini key ...${key.slice(-4)} failed. Trying next.`);
          }
        }
      }
    }
    throw new AllModelsFailedError(`All API providers failed. Last error: ${lastError == null ? void 0 : lastError.message}`);
  }
};

// critic.ts
var Critic = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.apiHandler = new APIHandler(plugin);
  }
  async judge(content) {
    if (this.plugin.settings.critic_mode === "ai") {
      return this._judgeByAI(content);
    }
    return this._judgeByHeuristic(content);
  }
  _judgeByHeuristic(content) {
    const reasons = [];
    const contentLower = content.toLowerCase();
    const requiredHeaders = this.plugin.settings.critic_required_headers.split("\n").map((h) => h.trim().toLowerCase()).filter(Boolean);
    const missingHeaders = requiredHeaders.filter((h) => !contentLower.includes(h));
    if (missingHeaders.length > 0) {
      reasons.push(`\u7F3A\u5C11\u5FC5\u9700\u7684\u6807\u9898: ${missingHeaders.join(", ")}`);
    }
    if (content.length < this.plugin.settings.critic_min_content_length) {
      reasons.push(`\u5185\u5BB9\u8FC7\u77ED (\u5F53\u524D: ${content.length}, \u8981\u6C42: ${this.plugin.settings.critic_min_content_length})`);
    }
    const refusalPatterns = ["\u4F5C\u4E3A\u4E00?\u4E2AAI", "\u4F5C\u4E3A\u8BED\u8A00\u6A21\u578B", "\u6211\u4E0D\u80FD", "\u6211\u65E0\u6CD5", "\u5F88\u62B1\u6B49"];
    for (const pattern of refusalPatterns) {
      if (new RegExp(pattern, "i").test(content)) {
        reasons.push(`\u5305\u542BAI\u62D2\u7EDD\u8BED (\u5339\u914D: '${pattern}')`);
        break;
      }
    }
    return {
      isApproved: reasons.length === 0,
      reason: reasons.length > 0 ? reasons.join("; ") : "\u901A\u8FC7\u6240\u6709\u542F\u53D1\u5F0F\u89C4\u5219\u68C0\u67E5\u3002"
    };
  }
  async _judgeByAI(content) {
    const prompt = this.plugin.settings.prompt_critic.replace("{content}", content);
    try {
      const response = await this.apiHandler.call(prompt);
      const decisionMatch = response.match(/DECISION:\s*(KEEP|DISCARD)/i);
      const reasonMatch = response.match(/\[REASON:\s*([^\]]+)\]/);
      const isApproved = decisionMatch ? decisionMatch[1].toUpperCase() === "KEEP" : false;
      const reason = reasonMatch ? reasonMatch[1].trim() : isApproved ? "AI \u6279\u51C6" : "AI \u62D2\u7EDD\uFF0C\u672A\u63D0\u4F9B\u660E\u786E\u7406\u7531";
      return { isApproved, reason };
    } catch (error) {
      console.error("AI Critic call failed:", error);
      return { isApproved: false, reason: `AI \u5BA1\u6838\u5668\u8C03\u7528\u5931\u8D25: ${error.message}` };
    }
  }
};

// reviser.ts
var Reviser = class {
  constructor(plugin) {
    this.plugin = plugin;
  }
  createRevisionPrompt(idea, originalContent, rejectionReason) {
    let prompt = this.plugin.settings.prompt_reviser;
    prompt = prompt.replace("{concept}", idea);
    prompt = prompt.replace("{original_content}", originalContent);
    prompt = prompt.replace("{rejection_reason}", rejectionReason);
    return prompt;
  }
};

// utils.ts
function sanitizeFilename(name) {
  let cleanName = name.replace(/\s*\(.*\)/g, "").trim();
  cleanName = cleanName.replace(/[\\/*?:"<>|]/g, "");
  return cleanName.slice(0, 100);
}
function extractNewIdeas(content) {
  const matches = content.match(/\[\[([^\]]+)\]\]/g);
  if (!matches) {
    return [];
  }
  const ideas = matches.map((match) => {
    return match.slice(2, -2).split("|")[0].trim();
  });
  return [...new Set(ideas)];
}
function cleanMarkdownOutput(content) {
  const trimmed = content.trim();
  if (trimmed.startsWith("```markdown") && trimmed.endsWith("```")) {
    let cleaned = trimmed.substring("```markdown".length, trimmed.length - "```".length);
    return cleaned.trim();
  }
  return trimmed;
}

// engine.ts
var Engine = class {
  constructor(plugin) {
    this.isRunning = false;
    this.timerId = null;
    this.plugin = plugin;
    this.app = plugin.app;
    this.apiHandler = new APIHandler(plugin);
    this.critic = new Critic(plugin);
    this.reviser = new Reviser(plugin);
  }
  // --- Public Controls ---
  /**
   * 切换引擎的运行/暂停状态
   */
  toggleEngineState() {
    if (this.isRunning) {
      this.stop();
    } else {
      this.start();
    }
  }
  /**
   * 添加单个概念到队列，并显示通知
   * @returns {boolean} 是否成功添加
   */
  addConceptToQueue(concept) {
    const added = this.addConceptsToQueue([concept]);
    if (added > 0) {
      new import_obsidian4.Notice(`'${concept}' \u5DF2\u6DFB\u52A0\u5230\u751F\u6210\u961F\u5217\u3002`);
      this.updateStatusBar();
      return true;
    }
    new import_obsidian4.Notice(`'${concept}' \u5DF2\u5B58\u5728\u4E8E\u961F\u5217\u6216\u4ED3\u5E93\u4E2D\uFF0C\u672A\u6DFB\u52A0\u3002`);
    return false;
  }
  /**
   * 添加多个概念到生成队列，会进行去重和检查文件是否存在
   * @param {string[]} concepts - 要添加的概念列表
   * @returns {number} 实际添加的新概念数量
   */
  addConceptsToQueue(concepts) {
    const currentQueue = new Set(this.plugin.data.generationQueue);
    const existingFiles = new Set(this.app.vault.getMarkdownFiles().map((f) => f.basename));
    let addedCount = 0;
    for (const concept of concepts) {
      const sanitized = sanitizeFilename(concept);
      if (!currentQueue.has(concept) && !existingFiles.has(sanitized)) {
        this.plugin.data.generationQueue.push(concept);
        currentQueue.add(concept);
        addedCount++;
      }
    }
    if (addedCount > 0) {
      this.plugin.savePluginData();
      this.updateStatusBar();
    }
    return addedCount;
  }
  // --- Core Loop ---
  /**
   * 启动引擎
   */
  async start() {
    if (this.isRunning)
      return;
    this.isRunning = true;
    this.plugin.data.status = "running";
    new import_obsidian4.Notice("\u77E5\u8BC6\u56FE\u8C31\u5F15\u64CE\u5DF2\u542F\u52A8\uFF01");
    this.updateStatusBar();
    this.tick();
  }
  /**
   * 停止引擎
   */
  stop() {
    if (!this.isRunning)
      return;
    this.isRunning = false;
    this.plugin.data.status = "paused";
    if (this.timerId) {
      clearTimeout(this.timerId);
      this.timerId = null;
    }
    new import_obsidian4.Notice("\u77E5\u8BC6\u56FE\u8C31\u5F15\u64CE\u5DF2\u6682\u505C\u3002");
    this.updateStatusBar();
    this.plugin.savePluginData();
  }
  /**
   * 安排下一个 tick
   */
  scheduleNextTick() {
    if (!this.isRunning)
      return;
    const delay = this.plugin.settings.request_delay * 1e3;
    this.timerId = setTimeout(() => this.tick(), delay);
  }
  /**
   * 引擎的核心“心跳”
   * 它会按优先级（修正 > 审核 > 生成）处理一个批次的任务
   */
  async tick() {
    if (!this.isRunning)
      return;
    try {
      let taskProcessed = false;
      if (this.plugin.data.revisionQueue.length > 0) {
        taskProcessed = await this.runRevisionPhase();
      } else if (this.plugin.data.reviewQueue.length > 0) {
        taskProcessed = await this.runCriticPhase();
      } else if (this.plugin.data.generationQueue.length > 0) {
        taskProcessed = await this.runGenerationPhase();
      }
      if (!taskProcessed && this.plugin.data.generationQueue.length === 0 && this.plugin.data.reviewQueue.length === 0 && this.plugin.data.revisionQueue.length === 0) {
        new import_obsidian4.Notice("\u{1F389} \u6240\u6709\u4EFB\u52A1\u5B8C\u6210\uFF01\u5F15\u64CE\u5DF2\u505C\u6B62\u3002");
        this.isRunning = false;
        this.plugin.data.status = "idle";
        this.updateStatusBar();
        await this.plugin.savePluginData();
        return;
      }
    } catch (error) {
      console.error("\u5F15\u64CE Tick \u53D1\u751F\u4E25\u91CD\u9519\u8BEF:", error);
      new import_obsidian4.Notice("\u5F15\u64CE\u9047\u5230\u9519\u8BEF\uFF0C\u5DF2\u6682\u505C\u3002\u8BF7\u68C0\u67E5\u63A7\u5236\u53F0\u3002");
      this.stop();
      return;
    }
    this.scheduleNextTick();
  }
  // --- Phases ---
  /**
   * 运行“生成”阶段
   * @returns {Promise<boolean>} 是否处理了任务
   */
  async runGenerationPhase() {
    const queue = this.plugin.data.generationQueue;
    if (queue.length === 0)
      return false;
    const batchSize = this.plugin.settings.generation_batch_size;
    const batch = queue.splice(0, Math.min(queue.length, batchSize));
    this.updateStatusBar();
    await this.plugin.savePluginData();
    const tasks = batch.map((idea) => this.generationTask(idea));
    await Promise.allSettled(tasks);
    await this.plugin.savePluginData();
    return true;
  }
  /**
   * 单个生成任务
   */
  async generationTask(idea) {
    const prompt = this.plugin.settings.prompt_generator.replace("{concept}", idea);
    try {
      const content = await this.apiHandler.call(prompt);
      const cleanedContent = cleanMarkdownOutput(content);
      this.plugin.data.reviewQueue.push({ idea, content: cleanedContent });
      console.log(`\u2705 [\u751F\u6210\u6210\u529F]: ${idea}`);
    } catch (e) {
      if (e instanceof AllModelsFailedError) {
        console.error(`\u274C [\u751F\u6210\u5931\u8D25]: ${idea} - ${e.message}`);
        this.plugin.data.generationQueue.unshift(idea);
      }
    }
  }
  /**
   * 运行“审核”阶段
   * @returns {Promise<boolean>} 是否处理了任务
   */
  async runCriticPhase() {
    const queue = this.plugin.data.reviewQueue;
    if (queue.length === 0)
      return false;
    const batchSize = this.plugin.settings.generation_batch_size;
    const tasksToReview = queue.splice(0, Math.min(queue.length, batchSize));
    this.updateStatusBar();
    await this.plugin.savePluginData();
    let newIdeasFound = /* @__PURE__ */ new Set();
    for (const task of tasksToReview) {
      const { isApproved, reason } = await this.critic.judge(task.content);
      if (isApproved) {
        await this.saveNote(task.idea, task.content);
        if (this.plugin.settings.extract_new_concepts) {
          const ideas = extractNewIdeas(task.content);
          ideas.forEach((idea) => newIdeasFound.add(idea));
        }
        console.log(`\u{1F44D} [\u5BA1\u6838\u901A\u8FC7]: ${task.idea}`);
      } else {
        task.reason = reason;
        task.retries = (task.retries || 0) + 1;
        this.plugin.data.revisionQueue.push(task);
        console.warn(`\u{1F44E} [\u5BA1\u6838\u62D2\u7EDD]: ${task.idea} - ${reason}`);
      }
    }
    if (newIdeasFound.size > 0) {
      this.addConceptsToQueue(Array.from(newIdeasFound));
    }
    await this.plugin.savePluginData();
    return true;
  }
  /**
   * 运行“修正”阶段
   * @returns {Promise<boolean>} 是否处理了任务
   */
  async runRevisionPhase() {
    const queue = this.plugin.data.revisionQueue;
    if (queue.length === 0)
      return false;
    const batchSize = this.plugin.settings.generation_batch_size;
    const tasksToRevise = queue.splice(0, Math.min(queue.length, batchSize));
    this.updateStatusBar();
    await this.plugin.savePluginData();
    for (const task of tasksToRevise) {
      if ((task.retries || 0) >= this.plugin.settings.max_revision_retries) {
        this.plugin.data.discardedPile.push(task);
        console.error(`\u{1F480} [\u653E\u5F03\u4FEE\u6B63]: ${task.idea} \u5DF2\u8FBE\u6700\u5927\u91CD\u8BD5\u6B21\u6570\u3002`);
        continue;
      }
      await this.revisionTask(task);
    }
    await this.plugin.savePluginData();
    return true;
  }
  /**
   * 单个修正任务
   */
  async revisionTask(task) {
    const prompt = this.reviser.createRevisionPrompt(task.idea, task.content, task.reason || "\u672A\u77E5\u539F\u56E0");
    try {
      const newContent = await this.apiHandler.call(prompt);
      const cleanedContent = cleanMarkdownOutput(newContent);
      const revisedTask = { ...task, content: cleanedContent };
      this.plugin.data.reviewQueue.push(revisedTask);
      console.log(`\u{1F504} [\u4FEE\u6B63\u5B8C\u6210]: ${task.idea}`);
    } catch (e) {
      console.error(`\u274C [\u4FEE\u6B63\u5931\u8D25]: ${task.idea} - ${e.message}`);
      this.plugin.data.revisionQueue.unshift(task);
    }
  }
  // --- File & UI ---
  /**
   * 保存笔记到文件系统
   */
  async saveNote(idea, content) {
    const filename = sanitizeFilename(idea);
    const folderPath = this.plugin.settings.output_dir;
    if (!(this.app.vault.getAbstractFileByPath(folderPath) instanceof import_obsidian4.TFolder)) {
      try {
        await this.app.vault.createFolder(folderPath);
      } catch (error) {
        console.error(`\u521B\u5EFA\u6587\u4EF6\u5939\u5931\u8D25: ${folderPath}`, error);
        new import_obsidian4.Notice(`\u65E0\u6CD5\u521B\u5EFA\u8F93\u51FA\u6587\u4EF6\u5939: ${folderPath}`);
        return;
      }
    }
    const filePath = (0, import_obsidian4.normalizePath)(`${folderPath}/${filename}.md`);
    const file = this.app.vault.getAbstractFileByPath(filePath);
    try {
      if (file instanceof import_obsidian4.TFile) {
        await this.app.vault.modify(file, content);
        new import_obsidian4.Notice(`\u7B14\u8BB0\u5DF2\u66F4\u65B0: ${filename}`);
      } else {
        await this.app.vault.create(filePath, content);
        new import_obsidian4.Notice(`\u7B14\u8BB0\u5DF2\u521B\u5EFA: ${filename}`);
      }
    } catch (error) {
      console.error(`\u4FDD\u5B58\u7B14\u8BB0\u5931\u8D25: ${filePath}`, error);
      new import_obsidian4.Notice(`\u65E0\u6CD5\u4FDD\u5B58\u7B14\u8BB0: ${filename}`);
    }
  }
  /**
   * 更新状态栏显示
   */
  updateStatusBar() {
    if (!this.plugin.statusBarEl)
      return;
    const { generationQueue, reviewQueue, revisionQueue } = this.plugin.data;
    const total = generationQueue.length + reviewQueue.length + revisionQueue.length;
    this.plugin.statusBarEl.setText(
      `KG: ${this.plugin.data.status} | G:${generationQueue.length} | C:${reviewQueue.length} | R:${revisionQueue.length} | Total:${total}`
    );
  }
};

// main.ts
var DEFAULT_PLUGIN_DATA = {
  status: "idle",
  generationQueue: [],
  reviewQueue: [],
  revisionQueue: [],
  discardedPile: []
};
var KnowledgeGraphPlugin = class extends import_obsidian5.Plugin {
  async onload() {
    await this.loadSettings();
    await this.loadPluginData();
    this.engine = new Engine(this);
    const ribbonIconEl = this.addRibbonIcon("brain-circuit", "\u77E5\u8BC6\u56FE\u8C31\u751F\u6210\u5668", (evt) => {
      this.engine.toggleEngineState();
    });
    ribbonIconEl.addClass("knowledge-graph-plugin-ribbon-class");
    this.statusBarEl = this.addStatusBarItem();
    this.engine.updateStatusBar();
    this.addSettingTab(new KGsSettingTab(this.app, this));
    this.addCommand({
      id: "toggle-knowledge-graph-engine",
      name: "\u542F\u52A8/\u6682\u505C \u77E5\u8BC6\u56FE\u8C31\u751F\u6210",
      callback: () => {
        this.engine.toggleEngineState();
      }
    });
    this.addCommand({
      id: "add-current-note-to-queue",
      name: "\u5C06\u5F53\u524D\u7B14\u8BB0\u6807\u9898\u6DFB\u52A0\u5230\u751F\u6210\u961F\u5217",
      checkCallback: (checking) => {
        const file = this.app.workspace.getActiveFile();
        if (file) {
          if (!checking) {
            this.engine.addConceptToQueue(file.basename);
          }
          return true;
        }
        return false;
      }
    });
    console.log("\u77E5\u8BC6\u56FE\u8C31\u63D2\u4EF6\u5DF2\u52A0\u8F7D\uFF01");
  }
  onunload() {
    console.log("\u77E5\u8BC6\u56FE\u8C31\u63D2\u4EF6\u5DF2\u5378\u8F7D\u3002");
  }
  /**
   * 加载插件的配置。
   * 它会合并默认设置、默认提示和用户保存的设置。
   * 这个方法需要兼容旧版本的数据结构。
   */
  async loadSettings() {
    const defaultPrompts = await getDefaultPrompts();
    const savedData = await this.loadData();
    const savedSettings = savedData || {};
    this.settings = Object.assign({}, DEFAULT_SETTINGS, defaultPrompts, savedSettings);
  }
  /**
   * 保存插件的配置和状态。
   * 这是唯一一个直接写入文件的方法，它将所有数据打包在一起。
   */
  async saveSettings() {
    const dataToSave = { ...this.settings, pluginState: this.data };
    await this.saveData(dataToSave);
  }
  /**
   * 加载插件的运行时状态。
   * 它会从保存的数据中提取 pluginState 部分。
   */
  async loadPluginData() {
    const savedData = await this.loadData();
    const savedState = (savedData == null ? void 0 : savedData.pluginState) || {};
    this.data = Object.assign({}, DEFAULT_PLUGIN_DATA, savedState);
  }
  /**
   * 保存插件的运行时状态。
   * 这个方法只是一个方便的别名，它实际上调用 saveSettings。
   * 这保证了状态和配置总是在一起被原子性地保存。
   */
  async savePluginData() {
    await this.saveSettings();
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzZXR0aW5ncy50cyIsICJRdWV1ZU1vZGFsLnRzIiwgImVuZ2luZS50cyIsICJhcGlIYW5kbGVyLnRzIiwgImNyaXRpYy50cyIsICJyZXZpc2VyLnRzIiwgInV0aWxzLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBBcHAsIFBsdWdpbiwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZywgTm90aWNlLCBURmlsZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IEtub3dsZWRnZUdyYXBoUGx1Z2luU2V0dGluZ3MsIFBsdWdpbkRhdGEgfSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7IEtHc1NldHRpbmdUYWIsIERFRkFVTFRfU0VUVElOR1MsIGdldERlZmF1bHRQcm9tcHRzIH0gZnJvbSAnLi9zZXR0aW5ncyc7XG5pbXBvcnQgeyBFbmdpbmUgfSBmcm9tICcuL2VuZ2luZSc7XG5cbmNvbnN0IERFRkFVTFRfUExVR0lOX0RBVEE6IFBsdWdpbkRhdGEgPSB7XG4gICAgc3RhdHVzOiAnaWRsZScsXG4gICAgZ2VuZXJhdGlvblF1ZXVlOiBbXSxcbiAgICByZXZpZXdRdWV1ZTogW10sXG4gICAgcmV2aXNpb25RdWV1ZTogW10sXG4gICAgZGlzY2FyZGVkUGlsZTogW10sXG59O1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBLbm93bGVkZ2VHcmFwaFBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG4gICAgc2V0dGluZ3M6IEtub3dsZWRnZUdyYXBoUGx1Z2luU2V0dGluZ3M7XG4gICAgZGF0YTogUGx1Z2luRGF0YTtcbiAgICBlbmdpbmU6IEVuZ2luZTtcbiAgICBzdGF0dXNCYXJFbDogSFRNTEVsZW1lbnQ7XG5cbiAgICBhc3luYyBvbmxvYWQoKSB7XG4gICAgICAgIC8vIDEuIFx1OTk5Nlx1NTE0OFx1NTJBMFx1OEY3RFx1OEJCRVx1N0Y2RSAoc2V0dGluZ3MpXG4gICAgICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cbiAgICAgICAgLy8gMi4gXHU3MTM2XHU1NDBFXHU1MkEwXHU4RjdEXHU2M0QyXHU0RUY2XHU3MkI2XHU2MDAxXG4gICAgICAgIGF3YWl0IHRoaXMubG9hZFBsdWdpbkRhdGEoKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMuZW5naW5lID0gbmV3IEVuZ2luZSh0aGlzKTtcblxuICAgICAgICAvLyBcdTdGMEVcdTVFMjZcdTU2RkVcdTY4MDdcbiAgICAgICAgY29uc3QgcmliYm9uSWNvbkVsID0gdGhpcy5hZGRSaWJib25JY29uKCdicmFpbi1jaXJjdWl0JywgJ1x1NzdFNVx1OEJDNlx1NTZGRVx1OEMzMVx1NzUxRlx1NjIxMFx1NTY2OCcsIChldnQ6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZW5naW5lLnRvZ2dsZUVuZ2luZVN0YXRlKCk7XG4gICAgICAgIH0pO1xuICAgICAgICByaWJib25JY29uRWwuYWRkQ2xhc3MoJ2tub3dsZWRnZS1ncmFwaC1wbHVnaW4tcmliYm9uLWNsYXNzJyk7XG5cbiAgICAgICAgLy8gXHU3MkI2XHU2MDAxXHU2ODBGXG4gICAgICAgIHRoaXMuc3RhdHVzQmFyRWwgPSB0aGlzLmFkZFN0YXR1c0Jhckl0ZW0oKTtcbiAgICAgICAgdGhpcy5lbmdpbmUudXBkYXRlU3RhdHVzQmFyKCk7XG5cbiAgICAgICAgLy8gXHU4QkJFXHU3RjZFXHU5MDA5XHU5ODc5XHU1MzYxXG4gICAgICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgS0dzU2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xuXG4gICAgICAgIC8vIFx1NTQ3RFx1NEVFNFxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICd0b2dnbGUta25vd2xlZGdlLWdyYXBoLWVuZ2luZScsXG4gICAgICAgICAgICBuYW1lOiAnXHU1NDJGXHU1MkE4L1x1NjY4Mlx1NTA1QyBcdTc3RTVcdThCQzZcdTU2RkVcdThDMzFcdTc1MUZcdTYyMTAnLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmVuZ2luZS50b2dnbGVFbmdpbmVTdGF0ZSgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAnYWRkLWN1cnJlbnQtbm90ZS10by1xdWV1ZScsXG4gICAgICAgICAgICBuYW1lOiAnXHU1QzA2XHU1RjUzXHU1MjREXHU3QjE0XHU4QkIwXHU2ODA3XHU5ODk4XHU2REZCXHU1MkEwXHU1MjMwXHU3NTFGXHU2MjEwXHU5NjFGXHU1MjE3JyxcbiAgICAgICAgICAgIGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICAgICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghY2hlY2tpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW5naW5lLmFkZENvbmNlcHRUb1F1ZXVlKGZpbGUuYmFzZW5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zb2xlLmxvZygnXHU3N0U1XHU4QkM2XHU1NkZFXHU4QzMxXHU2M0QyXHU0RUY2XHU1REYyXHU1MkEwXHU4RjdEXHVGRjAxJyk7XG4gICAgfVxuXG4gICAgb251bmxvYWQoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdcdTc3RTVcdThCQzZcdTU2RkVcdThDMzFcdTYzRDJcdTRFRjZcdTVERjJcdTUzNzhcdThGN0RcdTMwMDInKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBcdTUyQTBcdThGN0RcdTYzRDJcdTRFRjZcdTc2ODRcdTkxNERcdTdGNkVcdTMwMDJcbiAgICAgKiBcdTVCODNcdTRGMUFcdTU0MDhcdTVFNzZcdTlFRDhcdThCQTRcdThCQkVcdTdGNkVcdTMwMDFcdTlFRDhcdThCQTRcdTYzRDBcdTc5M0FcdTU0OENcdTc1MjhcdTYyMzdcdTRGRERcdTVCNThcdTc2ODRcdThCQkVcdTdGNkVcdTMwMDJcbiAgICAgKiBcdThGRDlcdTRFMkFcdTY1QjlcdTZDRDVcdTk3MDBcdTg5ODFcdTUxN0NcdTVCQjlcdTY1RTdcdTcyNDhcdTY3MkNcdTc2ODRcdTY1NzBcdTYzNkVcdTdFRDNcdTY3ODRcdTMwMDJcbiAgICAgKi9cbiAgICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG4gICAgICAgIGNvbnN0IGRlZmF1bHRQcm9tcHRzID0gYXdhaXQgZ2V0RGVmYXVsdFByb21wdHMoKTtcbiAgICAgICAgLy8gbG9hZERhdGEoKSBcdTRGMUFcdThCRkJcdTUzRDZcdTY1NzRcdTRFMkEgZGF0YS5qc29uIFx1NjU4N1x1NEVGNlxuICAgICAgICBjb25zdCBzYXZlZERhdGEgPSBhd2FpdCB0aGlzLmxvYWREYXRhKCk7XG4gICAgICAgIC8vIFx1NEVDRVx1NEZERFx1NUI1OFx1NzY4NFx1NjU3MFx1NjM2RVx1NEUyRFx1NjNEMFx1NTNENlx1OEJCRVx1N0Y2RVx1OTBFOFx1NTIwNlxuICAgICAgICBjb25zdCBzYXZlZFNldHRpbmdzID0gc2F2ZWREYXRhIHx8IHt9O1xuICAgICAgICBcbiAgICAgICAgLy8gXHU1NDA4XHU1RTc2XHU2MjQwXHU2NzA5XHU4QkJFXHU3RjZFXHVGRjBDXHU3ODZFXHU0RkREXHU2MjQwXHU2NzA5XHU5MTREXHU3RjZFXHU5ODc5XHU5MEZEXHU2NzA5XHU1MDNDXG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBkZWZhdWx0UHJvbXB0cywgc2F2ZWRTZXR0aW5ncyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogXHU0RkREXHU1QjU4XHU2M0QyXHU0RUY2XHU3Njg0XHU5MTREXHU3RjZFXHU1NDhDXHU3MkI2XHU2MDAxXHUzMDAyXG4gICAgICogXHU4RkQ5XHU2NjJGXHU1NTJGXHU0RTAwXHU0RTAwXHU0RTJBXHU3NkY0XHU2M0E1XHU1MTk5XHU1MTY1XHU2NTg3XHU0RUY2XHU3Njg0XHU2NUI5XHU2Q0Q1XHVGRjBDXHU1QjgzXHU1QzA2XHU2MjQwXHU2NzA5XHU2NTcwXHU2MzZFXHU2MjUzXHU1MzA1XHU1NzI4XHU0RTAwXHU4RDc3XHUzMDAyXG4gICAgICovXG4gICAgYXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuICAgICAgICBjb25zdCBkYXRhVG9TYXZlID0geyAuLi50aGlzLnNldHRpbmdzLCBwbHVnaW5TdGF0ZTogdGhpcy5kYXRhIH07XG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEoZGF0YVRvU2F2ZSk7XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIFx1NTJBMFx1OEY3RFx1NjNEMlx1NEVGNlx1NzY4NFx1OEZEMFx1ODg0Q1x1NjVGNlx1NzJCNlx1NjAwMVx1MzAwMlxuICAgICAqIFx1NUI4M1x1NEYxQVx1NEVDRVx1NEZERFx1NUI1OFx1NzY4NFx1NjU3MFx1NjM2RVx1NEUyRFx1NjNEMFx1NTNENiBwbHVnaW5TdGF0ZSBcdTkwRThcdTUyMDZcdTMwMDJcbiAgICAgKi9cbiAgICBhc3luYyBsb2FkUGx1Z2luRGF0YSgpIHtcbiAgICAgICAgLy8gbG9hZERhdGEoKSBcdTRGMUFcdThCRkJcdTUzRDZcdTY1NzRcdTRFMkEgZGF0YS5qc29uIFx1NjU4N1x1NEVGNlxuICAgICAgICBjb25zdCBzYXZlZERhdGEgPSBhd2FpdCB0aGlzLmxvYWREYXRhKCk7XG4gICAgICAgIC8vIFx1NEVDRVx1NEZERFx1NUI1OFx1NzY4NFx1NjU3MFx1NjM2RVx1NEUyRFx1NjNEMFx1NTNENlx1NzJCNlx1NjAwMVx1OTBFOFx1NTIwNlxuICAgICAgICBjb25zdCBzYXZlZFN0YXRlID0gc2F2ZWREYXRhPy5wbHVnaW5TdGF0ZSB8fCB7fTtcbiAgICAgICAgXG4gICAgICAgIC8vIFx1NTQwOFx1NUU3Nlx1OUVEOFx1OEJBNFx1NzJCNlx1NjAwMVx1NTQ4Q1x1NzUyOFx1NjIzN1x1NEZERFx1NUI1OFx1NzY4NFx1NzJCNlx1NjAwMVxuICAgICAgICB0aGlzLmRhdGEgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1BMVUdJTl9EQVRBLCBzYXZlZFN0YXRlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBcdTRGRERcdTVCNThcdTYzRDJcdTRFRjZcdTc2ODRcdThGRDBcdTg4NENcdTY1RjZcdTcyQjZcdTYwMDFcdTMwMDJcbiAgICAgKiBcdThGRDlcdTRFMkFcdTY1QjlcdTZDRDVcdTUzRUFcdTY2MkZcdTRFMDBcdTRFMkFcdTY1QjlcdTRGQkZcdTc2ODRcdTUyMkJcdTU0MERcdUZGMENcdTVCODNcdTVCOUVcdTk2NDVcdTRFMEFcdThDMDNcdTc1Mjggc2F2ZVNldHRpbmdzXHUzMDAyXG4gICAgICogXHU4RkQ5XHU0RkREXHU4QkMxXHU0RTg2XHU3MkI2XHU2MDAxXHU1NDhDXHU5MTREXHU3RjZFXHU2MDNCXHU2NjJGXHU1NzI4XHU0RTAwXHU4RDc3XHU4OEFCXHU1MzlGXHU1QjUwXHU2MDI3XHU1NzMwXHU0RkREXHU1QjU4XHUzMDAyXG4gICAgICovXG4gICAgYXN5bmMgc2F2ZVBsdWdpbkRhdGEoKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZVNldHRpbmdzKCk7XG4gICAgfVxufVxuIiwgIi8vIHNldHRpbmdzLnRzXG5cbmltcG9ydCB7IEFwcCwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZywgTm90aWNlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgS25vd2xlZGdlR3JhcGhQbHVnaW4gZnJvbSBcIi4vbWFpblwiO1xuLy8gXHU1MDQ3XHU4QkJFXHU0RjYwXHU3Njg0XHU3QzdCXHU1NzhCXHU1QjlBXHU0RTQ5XHU1NzI4XHU0RTAwXHU0RTJBXHU1M0VCICd0eXBlcy50cycgXHU3Njg0XHU2NTg3XHU0RUY2XHU5MUNDXG5pbXBvcnQgeyBLbm93bGVkZ2VHcmFwaFBsdWdpblNldHRpbmdzIH0gZnJvbSBcIi4vdHlwZXNcIjsgXG4vLyBcdTVCRkNcdTUxNjVcdTZBMjFcdTYwMDFcdTY4NDZcbmltcG9ydCB7IFF1ZXVlTWFuYWdlbWVudE1vZGFsIH0gZnJvbSBcIi4vUXVldWVNb2RhbFwiOyBcblxuLy8gLS0tIFx1OUVEOFx1OEJBNCBQcm9tcHRzIC0tLVxuZXhwb3J0IGNvbnN0IFBST01QVF9HRU5FUkFUT1JfREVGQVVMVCA9IGAjIFJvbGU6IFx1NzdFNVx1OEJDNlx1N0NGQlx1N0VERlx1Njc4NFx1NUVGQVx1NEUxM1x1NUJCNi4uLmA7XG5leHBvcnQgY29uc3QgUFJPTVBUX0NSSVRJQ19ERUZBVUxUID0gYCMgUm9sZTogXHU3N0U1XHU4QkM2XHU1NkZFXHU4QzMxXHU4RDI4XHU5MUNGXHU1QkExXHU2ODM4XHU1NDU4Li4uYDtcbmV4cG9ydCBjb25zdCBQUk9NUFRfUkVWSVNFUl9ERUZBVUxUID0gYCMgXHU4OUQyXHU4MjcyOiBcdThENDRcdTZERjFcdTc3RTVcdThCQzZcdTdGMTZcdThGOTFcdTRFMEVcdTUxODVcdTVCQjlcdTRGMThcdTUzMTZcdTRFMTNcdTVCQjYuLi5gO1xuXG5cbi8vIC0tLSBcdTlFRDhcdThCQTRcdThCQkVcdTdGNkUgLS0tXG5leHBvcnQgY29uc3QgREVGQVVMVF9TRVRUSU5HUzogS25vd2xlZGdlR3JhcGhQbHVnaW5TZXR0aW5ncyA9IHtcbiAgLy8gQVBJXG4gIG9wZW5haV9hcGlfa2V5czogXCJcIixcbiAgb3BlbmFpX2Jhc2VfdXJsOiBcImh0dHBzOi8vYXBpLm9wZW5haS5jb20vdjFcIixcbiAgb3BlbmFpX21vZGVsOiBcImdwdC00LXR1cmJvLXByZXZpZXdcIixcbiAgZ29vZ2xlX2FwaV9rZXlzOiBcIlwiLFxuICBnb29nbGVfbW9kZWw6IFwiZ2VtaW5pLTEuNS1wcm8tbGF0ZXN0XCIsXG4gIGZhaWxvdmVyX2Nvb2xkb3duX3NlY29uZHM6IDMwMCxcbiAgLy8gXHU1M0MyXHU2NTcwXG4gIGdlbmVyYXRpb25fdGVtcGVyYXR1cmU6IDAuNyxcbiAgZ2VuZXJhdGlvbl9tYXhfdG9rZW5zOiA0MDk2LFxuICAvLyBcdThERUZcdTVGODRcbiAgb3V0cHV0X2RpcjogXCJLbm93bGVkZ2VHcmFwaE5vdGVzXCIsXG4gIC8vIFx1N0NGQlx1N0VERlxuICBtYXhfd29ya2VyczogMixcbiAgZ2VuZXJhdGlvbl9iYXRjaF9zaXplOiA1LFxuICByZXF1ZXN0X2RlbGF5OiA1LFxuICAvLyBDcml0aWNcbiAgY3JpdGljX21vZGU6IFwiaGV1cmlzdGljXCIsXG4gIGNyaXRpY19yZXF1aXJlZF9oZWFkZXJzOiBcIiMgXHVEODNFXHVEREUwXFxuPiBcXG4jIyBcdUQ4M0RcdURDREQgXHU2ODM4XHU1RkMzXHU2MDFEXHU2MEYzXFxuIyMgXHVEODNDXHVERkFGIFx1OTAwMlx1NzUyOFx1NTczQVx1NjY2RlxcbiMjIFx1RDgzRFx1REVFMFx1RkUwRiBcdTRGN0ZcdTc1MjhcdTZCNjVcdTlBQTQvXHU2Nzg0XHU2MjEwXHU4OTgxXHU3RDIwXFxuIyMgXHVEODNEXHVERTgwIFx1Njg0OFx1NEY4Qlx1NTIwNlx1Njc5MFxcbiMjIFx1RDgzRFx1REM0RCBcdTRGMThcdTcwQjkgJiBcdUQ4M0RcdURDNEUgXHU3RjNBXHU3MEI5XFxuIyMgXHVEODNEXHVERDE3IFx1NTE3M1x1ODA1NFx1NkEyMVx1NTc4QlwiLFxuICBjcml0aWNfbWluX2NvbnRlbnRfbGVuZ3RoOiA0MDAsXG4gIC8vIFJldmlzZXJcbiAgbWF4X3JldmlzaW9uX3JldHJpZXM6IDIsXG4gIC8vIFByb21wdHNcbiAgcHJvbXB0X2dlbmVyYXRvcjogUFJPTVBUX0dFTkVSQVRPUl9ERUZBVUxULFxuICBwcm9tcHRfY3JpdGljOiBQUk9NUFRfQ1JJVElDX0RFRkFVTFQsXG4gIHByb21wdF9yZXZpc2VyOiBQUk9NUFRfUkVWSVNFUl9ERUZBVUxULFxuICAvLyBcdTY0QURcdTc5Q0RcdTdCQjFcbiAgc2VlZENvbmNlcHRzOiBcIlwiLFxuICBcbiAgLy8gXHUzMDEwXHUzMDEwXHUzMDEwIFx1NjVCMFx1NTg5RVx1OTE0RFx1N0Y2RVx1OTg3OSBcdTMwMTFcdTMwMTFcdTMwMTFcbiAgLy8gXHU5RUQ4XHU4QkE0XHU1MTczXHU5NUVEXHU2NUIwXHU2OTgyXHU1RkY1XHU2M0QwXHU1M0Q2XG4gIGV4dHJhY3RfbmV3X2NvbmNlcHRzOiBmYWxzZSwgXG59O1xuXG4vKipcbiAqIFx1ODNCN1x1NTNENlx1OUVEOFx1OEJBNFx1NzY4NCBwcm9tcHRzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXREZWZhdWx0UHJvbXB0cygpIHtcbiAgcmV0dXJuIHtcbiAgICBwcm9tcHRfZ2VuZXJhdG9yOiBQUk9NUFRfR0VORVJBVE9SX0RFRkFVTFQsXG4gICAgcHJvbXB0X2NyaXRpYzogUFJPTVBUX0NSSVRJQ19ERUZBVUxULFxuICAgIHByb21wdF9yZXZpc2VyOiBQUk9NUFRfUkVWSVNFUl9ERUZBVUxUXG4gIH07XG59XG5cblxuLy8gLS0tIFx1OEJCRVx1N0Y2RVx1OTc2Mlx1Njc3RlVJIC0tLVxuZXhwb3J0IGNsYXNzIEtHc1NldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcbiAgcGx1Z2luOiBLbm93bGVkZ2VHcmFwaFBsdWdpbjtcblxuICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBLbm93bGVkZ2VHcmFwaFBsdWdpbikge1xuICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgfVxuXG4gIGRpc3BsYXkoKTogdm9pZCB7XG4gICAgY29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcbiAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuXG4gICAgY29udGFpbmVyRWwuY3JlYXRlRWwoXCJoMlwiLCB7IHRleHQ6IFwiXHU3N0U1XHU4QkM2XHU1NkZFXHU4QzMxXHU3NTFGXHU2MjEwXHU1NjY4IC0gXHU4QkJFXHU3RjZFXCIgfSk7XG5cbiAgICAvLyAtLS0gXHU5NjFGXHU1MjE3XHU3QkExXHU3NDA2XHU1NjY4IC0tLVxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAuc2V0TmFtZShcIlx1NUYxNVx1NjRDRVx1NEVFQVx1ODg2OFx1NzZEOFwiKVxuICAgICAgICAuc2V0RGVzYyhcIlx1N0JBMVx1NzQwNlx1NUY4NVx1NzUxRlx1NjIxMFx1MzAwMVx1NUY4NVx1NUJBMVx1NjgzOFx1NTQ4Q1x1NURGMlx1NEUyMlx1NUYwM1x1NzY4NFx1NEVGQlx1NTJBMVx1MzAwMlwiKVxuICAgICAgICAuYWRkQnV0dG9uKFxuICAgICAgICAgIChidXR0b24pID0+IGJ1dHRvbi5zZXRCdXR0b25UZXh0KFwiXHU2MjUzXHU1RjAwXHU5NjFGXHU1MjE3XHU3QkExXHU3NDA2XHU1NjY4XCIpLnNldEN0YSgpLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgbmV3IFF1ZXVlTWFuYWdlbWVudE1vZGFsKHRoaXMuYXBwLCB0aGlzLnBsdWdpbikub3BlbigpO1xuICAgICAgICAgIH0pXG4gICAgICAgICk7XG5cbiAgICAvLyAtLS0gQVBJIFx1OEJCRVx1N0Y2RSAtLS1cbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbCkuc2V0TmFtZShcIkFQSSBcdThCQkVcdTdGNkVcIikuc2V0SGVhZGluZygpO1xuICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiaDNcIiwgeyB0ZXh0OiBcIk9wZW5BSVwiIH0pO1xuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAuc2V0TmFtZShcIk9wZW5BSSBBUEkgS2V5c1wiKVxuICAgICAgICAuc2V0RGVzYyhcIlx1NkJDRlx1ODg0Q1x1NEUwMFx1NEUyQSBLZXlcdTMwMDJcdTYzRDJcdTRFRjZcdTVDMDZcdTgxRUFcdTUyQThcdThGNkVcdTYzNjJcdTU0OENcdTUxQjdcdTUzNzRcdTRGN0ZcdTc1MjhcdTMwMDJcIilcbiAgICAgICAgLmFkZFRleHRBcmVhKCh0ZXh0KSA9PiB0ZXh0LnNldFBsYWNlaG9sZGVyKFwic2stLi4uXCIpLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm9wZW5haV9hcGlfa2V5cykub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Mub3BlbmFpX2FwaV9rZXlzID0gdmFsdWU7XG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIH0pKTtcbiAgICBcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgLnNldE5hbWUoXCJPcGVuQUkgQmFzZSBVUkxcIilcbiAgICAgICAgLnNldERlc2MoXCJcdTU5ODJcdTY3OUNcdTRGNjBcdTRGN0ZcdTc1MjhcdTdCMkNcdTRFMDlcdTY1QjlcdTRFRTNcdTc0MDZcdUZGMENcdThCRjdcdTU3MjhcdTZCNjRcdTU5MDRcdTU4NkJcdTUxNjVcdTRFRTNcdTc0MDZcdTU3MzBcdTU3NDBcdTMwMDJcIilcbiAgICAgICAgLmFkZFRleHQoKHRleHQpID0+IHRleHQuc2V0UGxhY2Vob2xkZXIoXCJodHRwczovL2FwaS5vcGVuYWkuY29tL3YxXCIpLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm9wZW5haV9iYXNlX3VybCkub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Mub3BlbmFpX2Jhc2VfdXJsID0gdmFsdWUudHJpbSgpO1xuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICB9KSk7XG5cbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgLnNldE5hbWUoXCJPcGVuQUkgTW9kZWxcIilcbiAgICAgICAgLnNldERlc2MoXCJcdThGOTNcdTUxNjVcdTRGNjBcdTYwRjNcdTRGN0ZcdTc1MjhcdTc2ODQgT3BlbkFJIFx1NkEyMVx1NTc4Qlx1NTQwRFx1NzlGMFx1MzAwMlwiKVxuICAgICAgICAuYWRkVGV4dCgodGV4dCkgPT4gdGV4dC5zZXRQbGFjZWhvbGRlcihcImdwdC00LXR1cmJvLXByZXZpZXdcIikuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Mub3BlbmFpX21vZGVsKS5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5vcGVuYWlfbW9kZWwgPSB2YWx1ZS50cmltKCk7XG4gICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIH0pKTtcbiAgICBcbiAgICBjb250YWluZXJFbC5jcmVhdGVFbChcImgzXCIsIHsgdGV4dDogXCJHb29nbGUgR2VtaW5pXCIgfSk7XG5cbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgLnNldE5hbWUoXCJHb29nbGUgR2VtaW5pIEFQSSBLZXlzXCIpXG4gICAgICAgIC5zZXREZXNjKFwiXHU2QkNGXHU4ODRDXHU0RTAwXHU0RTJBIEtleVx1MzAwMlwiKVxuICAgICAgICAuYWRkVGV4dEFyZWEoKHRleHQpID0+IHRleHQuc2V0UGxhY2Vob2xkZXIoXCJBSXphU3kuLi5cIikuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZ29vZ2xlX2FwaV9rZXlzKS5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5nb29nbGVfYXBpX2tleXMgPSB2YWx1ZTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgfSkpO1xuICAgIFxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAuc2V0TmFtZShcIkdvb2dsZSBHZW1pbmkgTW9kZWxcIilcbiAgICAgICAgLnNldERlc2MoXCJcdThGOTNcdTUxNjVcdTRGNjBcdTYwRjNcdTRGN0ZcdTc1MjhcdTc2ODQgR29vZ2xlIFx1NkEyMVx1NTc4Qlx1NTQwRFx1NzlGMFx1MzAwMlwiKVxuICAgICAgICAuYWRkVGV4dCgodGV4dCkgPT4gdGV4dC5zZXRQbGFjZWhvbGRlcihcImdlbWluaS0xLjUtcHJvLWxhdGVzdFwiKS5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nb29nbGVfbW9kZWwpLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmdvb2dsZV9tb2RlbCA9IHZhbHVlLnRyaW0oKTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgfSkpO1xuICAgIFxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAuc2V0TmFtZShcIktleSBcdTUxQjdcdTUzNzRcdTY1RjZcdTk1RjQgKFx1NzlEMilcIilcbiAgICAgICAgLnNldERlc2MoXCJBUEkgS2V5IFx1NTkzMVx1OEQyNVx1NTQwRVx1RkYwQ1x1OTcwMFx1ODk4MVx1N0I0OVx1NUY4NVx1NTkxQVx1NUMxMVx1NzlEMlx1NjI0RFx1ODBGRFx1NTE4RFx1NkIyMVx1NEY3Rlx1NzUyOFx1MzAwMlwiKVxuICAgICAgICAuYWRkVGV4dCgodGV4dCkgPT4gdGV4dC5zZXRWYWx1ZShTdHJpbmcodGhpcy5wbHVnaW4uc2V0dGluZ3MuZmFpbG92ZXJfY29vbGRvd25fc2Vjb25kcykpLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgIGNvbnN0IG51bSA9IHBhcnNlSW50KHZhbHVlLCAxMCk7XG4gICAgICAgICAgaWYgKCFpc05hTihudW0pICYmIG51bSA+PSAwKSB7XG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5mYWlsb3Zlcl9jb29sZG93bl9zZWNvbmRzID0gbnVtO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KSk7XG5cbiAgICAvLyAtLS0gTExNIFx1NTNDMlx1NjU3MFx1OEJCRVx1N0Y2RSAtLS1cbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbCkuc2V0TmFtZShcIkxMTSBcdTUzQzJcdTY1NzBcdThCQkVcdTdGNkVcIikuc2V0SGVhZGluZygpO1xuXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgIC5zZXROYW1lKFwiXHU3NTFGXHU2MjEwXHU2RTI5XHU1RUE2IChUZW1wZXJhdHVyZSlcIilcbiAgICAgICAgLnNldERlc2MoXCJcdTYzQTdcdTUyMzZcdTc1MUZcdTYyMTBcdTUxODVcdTVCQjlcdTc2ODRcdTk2OEZcdTY3M0FcdTYwMjdcdTMwMDJcdThGODNcdTRGNEVcdTc2ODRcdTUwM0NcdUZGMDhcdTU5ODIgMC4yXHVGRjA5XHU2NkY0XHU1MTc3XHU3ODZFXHU1QjlBXHU2MDI3XHVGRjBDXHU4RjgzXHU5QUQ4XHU3Njg0XHU1MDNDXHVGRjA4XHU1OTgyIDAuOFx1RkYwOVx1NjZGNFx1NTE3N1x1NTIxQlx1OTAyMFx1NjAyN1x1MzAwMlwiKVxuICAgICAgICAuYWRkVGV4dCgodGV4dCkgPT4gdGV4dC5zZXRWYWx1ZShTdHJpbmcodGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhdGlvbl90ZW1wZXJhdHVyZSkpLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgIGNvbnN0IG51bSA9IHBhcnNlRmxvYXQodmFsdWUpO1xuICAgICAgICAgIC8vIFx1Nzg2RVx1NEZERFx1NTAzQ1x1NTcyOCAwLjAgXHU1MjMwIDIuMCBcdTRFNEJcdTk1RjRcbiAgICAgICAgICBpZiAoIWlzTmFOKG51bSkgJiYgbnVtID49IDAuMCAmJiBudW0gPD0gMi4wKSB7IFxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhdGlvbl90ZW1wZXJhdHVyZSA9IG51bTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgIC5zZXROYW1lKFwiXHU2NzAwXHU1OTI3IFRva2VuIFx1NjU3MCAoTWF4IFRva2VucylcIilcbiAgICAgICAgLnNldERlc2MoXCJBUEkgXHU0RTAwXHU2QjIxXHU4QzAzXHU3NTI4XHU1MTQxXHU4QkI4XHU3NTFGXHU2MjEwXHU3Njg0XHU2NzAwXHU1OTI3IFRva2VuIFx1NjU3MFx1OTFDRlx1MzAwMlwiKVxuICAgICAgICAuYWRkVGV4dCgodGV4dCkgPT4gdGV4dC5zZXRWYWx1ZShTdHJpbmcodGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhdGlvbl9tYXhfdG9rZW5zKSkub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgY29uc3QgbnVtID0gcGFyc2VJbnQodmFsdWUsIDEwKTtcbiAgICAgICAgICBpZiAoIWlzTmFOKG51bSkgJiYgbnVtID4gMCkge1xuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhdGlvbl9tYXhfdG9rZW5zID0gbnVtO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KSk7XG5cbiAgICAvLyAtLS0gXHU1RjE1XHU2NENFXHU4QkJFXHU3RjZFIC0tLVxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKS5zZXROYW1lKFwiXHU1RjE1XHU2NENFXHU4QkJFXHU3RjZFXCIpLnNldEhlYWRpbmcoKTtcblxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAuc2V0TmFtZShcIlx1OEY5M1x1NTFGQVx1NjU4N1x1NEVGNlx1NTkzOVwiKVxuICAgICAgICAuc2V0RGVzYyhcIlx1NjI0MFx1NjcwOVx1NzUxRlx1NjIxMFx1NzY4NFx1N0IxNFx1OEJCMFx1NUMwNlx1NEZERFx1NUI1OFx1NTIzMFx1NkI2NFx1NjU4N1x1NEVGNlx1NTkzOVx1MzAwMlwiKVxuICAgICAgICAuYWRkVGV4dCgodGV4dCkgPT4gdGV4dC5zZXRQbGFjZWhvbGRlcihcIktub3dsZWRnZUdyYXBoTm90ZXNcIikuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Mub3V0cHV0X2Rpcikub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgLy8gXHU3OUZCXHU5NjY0XHU2NzJCXHU1QzNFXHU3Njg0XHU2NTlDXHU2NzYwXHVGRjBDXHU3ODZFXHU0RkREXHU4REVGXHU1Rjg0XHU1RTcyXHU1MUMwXG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Mub3V0cHV0X2RpciA9IHZhbHVlLnRyaW0oKS5yZXBsYWNlKC9cXC8kLywgXCJcIik7IFxuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICB9KSk7XG5cbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgLnNldE5hbWUoXCJcdTY3MDBcdTU5MjdcdTVFNzZcdTUzRDFcdTY1NzAgKE1heCBXb3JrZXJzKVwiKVxuICAgICAgICAuc2V0RGVzYyhcIlx1RkYwOFx1NkNFOFx1NjEwRlx1RkYxQVx1NUY1M1x1NTI0RCBWMi4yIFx1NUYxNVx1NjRDRVx1NEUzQVx1NTM1NVx1N0VCRlx1N0EwQlx1NkQ0MVx1NkMzNFx1N0VCRlx1RkYwQ1x1NkI2NFx1OEJCRVx1N0Y2RVx1NjY4Mlx1NjcyQVx1NzUxRlx1NjU0OFx1RkYwOVwiKVxuICAgICAgICAuYWRkVGV4dCgodGV4dCkgPT4gdGV4dC5zZXRWYWx1ZShTdHJpbmcodGhpcy5wbHVnaW4uc2V0dGluZ3MubWF4X3dvcmtlcnMpKS5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICBjb25zdCBudW0gPSBwYXJzZUludCh2YWx1ZSwgMTApO1xuICAgICAgICAgIGlmICghaXNOYU4obnVtKSAmJiBudW0gPiAwKSB7XG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5tYXhfd29ya2VycyA9IG51bTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSkpO1xuICAgIFxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAuc2V0TmFtZShcIlx1NzUxRlx1NjIxMFx1NjI3OVx1NTkwNFx1NzQwNlx1NTkyN1x1NUMwRlwiKVxuICAgICAgICAuc2V0RGVzYyhcIlx1NUYxNVx1NjRDRVx1NkJDRlx1NEUwMFx1OEY2RVx1NEVDRVx1MjAxQ1x1NUY4NVx1NzUxRlx1NjIxMFx1OTYxRlx1NTIxN1x1MjAxRFx1NEUyRFx1NTNENlx1NTFGQVx1NzY4NFx1NEVGQlx1NTJBMVx1NjU3MFx1OTFDRlx1MzAwMlwiKVxuICAgICAgICAuYWRkVGV4dCgodGV4dCkgPT4gdGV4dC5zZXRWYWx1ZShTdHJpbmcodGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhdGlvbl9iYXRjaF9zaXplKSkub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgY29uc3QgbnVtID0gcGFyc2VJbnQodmFsdWUsIDEwKTtcbiAgICAgICAgICBpZiAoIWlzTmFOKG51bSkgJiYgbnVtID4gMCkge1xuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhdGlvbl9iYXRjaF9zaXplID0gbnVtO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgIC5zZXROYW1lKFwiXHU2QkNGXHU4RjZFXHU4QkY3XHU2QzQyXHU1RUY2XHU4RkRGIChcdTc5RDIpXCIpXG4gICAgICAgIC5zZXREZXNjKFwiXHU1RjE1XHU2NENFXHU1NzI4XHU1OTA0XHU3NDA2XHU1QjhDXHU0RTAwXHU0RTJBXHU2Mjc5XHU2QjIxXHU1NDBFXHVGRjBDXHU3QjQ5XHU1Rjg1XHU1OTFBXHU1QzExXHU3OUQyXHU1MThEXHU1RjAwXHU1OUNCXHU0RTBCXHU0RTAwXHU0RTJBXHU2Mjc5XHU2QjIxXHUzMDAyXCIpXG4gICAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PiB0ZXh0LnNldFZhbHVlKFN0cmluZyh0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZXF1ZXN0X2RlbGF5KSkub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgY29uc3QgbnVtID0gcGFyc2VJbnQodmFsdWUsIDEwKTtcbiAgICAgICAgICBpZiAoIWlzTmFOKG51bSkgJiYgbnVtID49IDApIHtcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnJlcXVlc3RfZGVsYXkgPSBudW07XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICBcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgLnNldE5hbWUoXCJcdTY3MDBcdTU5MjdcdTRGRUVcdTZCNjNcdTZCMjFcdTY1NzBcIilcbiAgICAgICAgLnNldERlc2MoXCJcdTRFMDBcdTdCQzdcdTdCMTRcdThCQjBcdTU3MjhcdTg4QUJcdTY1M0VcdTVGMDNcdUZGMDhcdTc5RkJcdTUxNjUgRGlzY2FyZGVkIFBpbGVcdUZGMDlcdTUyNERcdUZGMENcdTY3MDBcdTU5MUFcdTUxNDFcdThCQjhcdTg4QUJcdTRGRUVcdTZCNjNcdTc2ODRcdTZCMjFcdTY1NzBcdTMwMDJcIilcbiAgICAgICAgLmFkZFRleHQoKHRleHQpID0+IHRleHQuc2V0VmFsdWUoU3RyaW5nKHRoaXMucGx1Z2luLnNldHRpbmdzLm1heF9yZXZpc2lvbl9yZXRyaWVzKSkub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgY29uc3QgbnVtID0gcGFyc2VJbnQodmFsdWUsIDEwKTtcbiAgICAgICAgICBpZiAoIWlzTmFOKG51bSkgJiYgbnVtID49IDApIHtcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm1heF9yZXZpc2lvbl9yZXRyaWVzID0gbnVtO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KSk7XG5cbiAgICAvLyBcdTMwMTBcdTMwMTBcdTMwMTAgXHU1NzI4XHU2QjY0XHU1OTA0XHU2REZCXHU1MkEwXHU2NUIwXHU1RjAwXHU1MTczIFx1MzAxMVx1MzAxMVx1MzAxMVxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAuc2V0TmFtZShcIlx1ODFFQVx1NTJBOFx1NjNEMFx1NTNENlx1NjVCMFx1Njk4Mlx1NUZGNSAoRXh0cmFjdCBOZXcgQ29uY2VwdHMpXCIpXG4gICAgICAgIC5zZXREZXNjKFwiXHU1RjAwXHU1NDJGXHU1NDBFXHVGRjBDXHU1QzA2XHU4MUVBXHU1MkE4XHU0RUNFXHU1REYyXHU2Mjc5XHU1MUM2XHU3QjE0XHU4QkIwXHU3Njg0XHU1MTg1XHU1QkI5XHU0RTJEXHU2M0QwXHU1M0Q2IFtbV2lraWxpbmtzXV0gXHU0RjVDXHU0RTNBXHU2NUIwXHU2OTgyXHU1RkY1XHU1MkEwXHU1MTY1XHUyMDFDXHU1Rjg1XHU3NTFGXHU2MjEwXHU5NjFGXHU1MjE3XHUyMDFEXHUzMDAyKFx1OUVEOFx1OEJBNFx1NTE3M1x1OTVFRClcIilcbiAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZXh0cmFjdF9uZXdfY29uY2VwdHMpXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZXh0cmFjdF9uZXdfY29uY2VwdHMgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG4gICAgLy8gXHUzMDEwXHUzMDEwXHUzMDEwIFx1NjVCMFx1NUYwMFx1NTE3M1x1NkRGQlx1NTJBMFx1NUI4Q1x1NkJENSBcdTMwMTFcdTMwMTFcdTMwMTFcblxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAuc2V0TmFtZShcIlx1NUJBMVx1NjgzOFx1NkEyMVx1NUYwRiAoQ3JpdGljIE1vZGUpXCIpXG4gICAgICAgIC5zZXREZXNjKFwiXHU5MDA5XHU2MkU5XHU1MTg1XHU1QkI5XHU1QkExXHU2ODM4XHU3Njg0XHU2NUI5XHU1RjBGXHUzMDAyXHU1NDJGXHU1M0QxXHU1RjBGXHU2QTIxXHU1RjBGXHU5MDFGXHU1RUE2XHU1RkVCXHU0RTE0XHU1MTREXHU4RDM5XHVGRjBDXHU0RjQ2XHU1M0VBXHU2OEMwXHU2N0U1XHU2ODNDXHU1RjBGXHVGRjFCQUlcdTZBMjFcdTVGMEZcdTY2RjRcdTY2N0FcdTgwRkRcdUZGMENcdTRGNDZcdTRGMUFcdTZEODhcdTgwMTdBUElcdTk4OURcdTVFQTZcdTMwMDJcIilcbiAgICAgICAgLmFkZERyb3Bkb3duKChkcm9wZG93bikgPT4gZHJvcGRvd25cbiAgICAgICAgICAuYWRkT3B0aW9uKFwiaGV1cmlzdGljXCIsIFwiXHU1NDJGXHU1M0QxXHU1RjBGIChIZXVyaXN0aWMpXCIpXG4gICAgICAgICAgLmFkZE9wdGlvbihcImFpXCIsIFwiXHU0RUJBXHU1REU1XHU2NjdBXHU4MEZEIChBSSlcIilcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuY3JpdGljX21vZGUpXG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogXCJoZXVyaXN0aWNcIiB8IFwiYWlcIikgPT4geyAvLyBcdTY2MEVcdTc4NkVcdTdDN0JcdTU3OEJcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmNyaXRpY19tb2RlID0gdmFsdWU7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpOyAvLyBcdTUyMzdcdTY1QjBcdTRFRTVcdTY2M0VcdTc5M0EvXHU5NjkwXHU4NUNGXHU3NkY4XHU1MTczXHU4QkJFXHU3RjZFXG4gICAgICAgICAgfSkpO1xuXG4gICAgLy8gXHU2ODM5XHU2MzZFXHU1QkExXHU2ODM4XHU2QTIxXHU1RjBGXHVGRjBDXHU2NjNFXHU3OTNBXHU0RTBEXHU1NDBDXHU3Njg0XHU4QkJFXHU3RjZFXG4gICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmNyaXRpY19tb2RlID09PSBcImhldXJpc3RpY1wiKSB7XG4gICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAuc2V0TmFtZShcIlx1NTQyRlx1NTNEMVx1NUYwRlx1NUJBMVx1NjgzOFx1RkYxQVx1NUZDNVx1OTg3Qlx1NzY4NFx1NjgwN1x1OTg5OFwiKVxuICAgICAgICAgIC5zZXREZXNjKFwiXHU1NzI4XHU1NDJGXHU1M0QxXHU1RjBGXHU2QTIxXHU1RjBGXHU0RTBCXHVGRjBDXHU2OEMwXHU2N0U1XHU3QjE0XHU4QkIwXHU2NjJGXHU1NDI2XHU1MzA1XHU1NDJCXHU2MjQwXHU2NzA5XHU4RkQ5XHU0RTlCXHU2ODA3XHU5ODk4XHVGRjA4XHU2QkNGXHU4ODRDXHU0RTAwXHU0RTJBXHVGRjA5XHUzMDAyXCIpXG4gICAgICAgICAgLmFkZFRleHRBcmVhKCh0ZXh0KSA9PiB0ZXh0XG4gICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuY3JpdGljX3JlcXVpcmVkX2hlYWRlcnMpXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmNyaXRpY19yZXF1aXJlZF9oZWFkZXJzID0gdmFsdWU7XG4gICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgfSkuaW5wdXRFbC5zdHlsZS5oZWlnaHQgPSBcIjE1MHB4XCIpOyAvLyBcdThCQkVcdTdGNkVcdTY1ODdcdTY3MkNcdTY4NDZcdTlBRDhcdTVFQTZcbiAgICAgIFxuICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgLnNldE5hbWUoXCJcdTU0MkZcdTUzRDFcdTVGMEZcdTVCQTFcdTY4MzhcdUZGMUFcdTY3MDBcdTVDMEZcdTUxODVcdTVCQjlcdTk1N0ZcdTVFQTZcIilcbiAgICAgICAgICAuc2V0RGVzYyhcIlx1NTcyOFx1NTQyRlx1NTNEMVx1NUYwRlx1NkEyMVx1NUYwRlx1NEUwQlx1RkYwQ1x1N0IxNFx1OEJCMFx1NTE4NVx1NUJCOVx1NUZDNVx1OTg3Qlx1OEZCRVx1NTIzMFx1NzY4NFx1NjcwMFx1NUMwRlx1NUI1N1x1N0IyNlx1NjU3MFx1MzAwMlwiKVxuICAgICAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PiB0ZXh0XG4gICAgICAgICAgICAuc2V0VmFsdWUoU3RyaW5nKHRoaXMucGx1Z2luLnNldHRpbmdzLmNyaXRpY19taW5fY29udGVudF9sZW5ndGgpKVxuICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICBjb25zdCBudW0gPSBwYXJzZUludCh2YWx1ZSwgMTApO1xuICAgICAgICAgICAgICBpZiAoIWlzTmFOKG51bSkgJiYgbnVtID49IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jcml0aWNfbWluX2NvbnRlbnRfbGVuZ3RoID0gbnVtO1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSk7XG4gICAgfVxuXG4gICAgLy8gLS0tIFx1Njk4Mlx1NUZGNVx1NjRBRFx1NzlDRCAtLS1cbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbCkuc2V0TmFtZShcIlx1Njk4Mlx1NUZGNVx1NjRBRFx1NzlDRCAoQ29uY2VwdCBTZWVkaW5nKVwiKS5zZXRIZWFkaW5nKCk7XG4gICAgXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgIC5zZXROYW1lKFwiXHU2OTgyXHU1RkY1XHU2NEFEXHU3OUNEXHU3QkIxXCIpXG4gICAgICAgIC5zZXREZXNjKFwiXHU1NzI4XHU2QjY0XHU1OTA0XHU3Qzk4XHU4RDM0XHU2MjE2XHU4RjkzXHU1MTY1XHU2MEE4XHU2MEYzXHU4OTgxXHU3NTFGXHU2MjEwXHU1MjFEXHU1OUNCXHU3QjE0XHU4QkIwXHU3Njg0XHU2OTgyXHU1RkY1XHU1MjE3XHU4ODY4XHVGRjBDXHU2QkNGXHU4ODRDXHU0RTAwXHU0RTJBXHU2OTgyXHU1RkY1XHUzMDAyXCIpXG4gICAgICAgIC5hZGRUZXh0QXJlYShcbiAgICAgICAgICAodGV4dCkgPT4gdGV4dFxuICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKFwiXHU0RjhCXHU1OTgyXHVGRjFBXFxuXHU3QjJDXHU0RTAwXHU2MDI3XHU1MzlGXHU3NDA2XFxuXHU1OTY1XHU1MzYxXHU1OUM2XHU1MjQzXHU1MjAwXFxuXHU1MjNCXHU2MTBGXHU3RUMzXHU0RTYwXFxuLi4uXCIpXG4gICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VlZENvbmNlcHRzKVxuICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWVkQ29uY2VwdHMgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICB9KS5pbnB1dEVsLnN0eWxlLmhlaWdodCA9IFwiMjAwcHhcIlxuICAgICAgICApO1xuXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgIC5hZGRCdXR0b24oXG4gICAgICAgICAgKGJ1dHRvbikgPT4gYnV0dG9uXG4gICAgICAgICAgICAuc2V0QnV0dG9uVGV4dChcIlx1NjRBRFx1NzlDRFx1NTIzMFx1NUY4NVx1NzUxRlx1NjIxMFx1OTYxRlx1NTIxN1wiKVxuICAgICAgICAgICAgLnNldEN0YSgpXG4gICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IHJhd1RleHQgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWVkQ29uY2VwdHM7XG4gICAgICAgICAgICAgIGlmICghcmF3VGV4dC50cmltKCkpIHtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKFwiXHU2NEFEXHU3OUNEXHU3QkIxXHU0RTNBXHU3QTdBXHVGRjBDXHU2NUUwXHU5NzAwXHU2NENEXHU0RjVDXHUzMDAyXCIpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvLyBcdTRGN0ZcdTc1MjggU2V0IFx1NTNCQlx1OTFDRFxuICAgICAgICAgICAgICBjb25zdCBjb25jZXB0c1RvU2VlZCA9IFsuLi5uZXcgU2V0KHJhd1RleHQuc3BsaXQoXCJcXG5cIikubWFwKChsaW5lKSA9PiBsaW5lLnRyaW0oKSkuZmlsdGVyKEJvb2xlYW4pKV07XG4gICAgICAgICAgICAgIGNvbnN0IGFkZGVkQ291bnQgPSB0aGlzLnBsdWdpbi5lbmdpbmUuYWRkQ29uY2VwdHNUb1F1ZXVlKGNvbmNlcHRzVG9TZWVkKTtcbiAgICAgICAgICAgICAgY29uc3QgaWdub3JlZENvdW50ID0gY29uY2VwdHNUb1NlZWQubGVuZ3RoIC0gYWRkZWRDb3VudDtcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIGxldCBub3RpY2VNZXNzYWdlID0gYFx1NjIxMFx1NTI5Rlx1NkRGQlx1NTJBMCAke2FkZGVkQ291bnR9IFx1NEUyQVx1NjVCMFx1Njk4Mlx1NUZGNVx1NTIzMFx1OTYxRlx1NTIxN1x1MzAwMmA7XG4gICAgICAgICAgICAgIGlmIChpZ25vcmVkQ291bnQgPiAwKSB7XG4gICAgICAgICAgICAgICAgbm90aWNlTWVzc2FnZSArPSBgXFxuJHtpZ25vcmVkQ291bnR9IFx1NEUyQVx1Njk4Mlx1NUZGNVx1NTZFMFx1NURGMlx1NUI1OFx1NTcyOFx1NjIxNlx1OTFDRFx1NTkwRFx1ODAwQ1x1ODhBQlx1NUZGRFx1NzU2NVx1MzAwMmA7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIG5ldyBOb3RpY2Uobm90aWNlTWVzc2FnZSwgNTAwMCk7IC8vIDVcdTc5RDJcdTY2M0VcdTc5M0FcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIC8vIFx1NkUwNVx1N0E3QVx1NjRBRFx1NzlDRFx1N0JCMVxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWVkQ29uY2VwdHMgPSBcIlwiO1xuICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7IC8vIFx1NTIzN1x1NjVCMFx1OEJCRVx1N0Y2RVx1OTg3NVx1OTc2MlxuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcblxuICAgIC8vIC0tLSBQcm9tcHRzIFx1OEJCRVx1N0Y2RSAtLS1cbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbCkuc2V0TmFtZShcIlByb21wdHMgXHU4QkJFXHU3RjZFXCIpLnNldEhlYWRpbmcoKTtcbiAgICBcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgLnNldE5hbWUoXCJcdTc1MUZcdTYyMTAgUHJvbXB0XCIpXG4gICAgICAgIC5zZXREZXNjKFwiXHU3NTI4XHU0RThFXHU3NTFGXHU2MjEwXHU2NUIwXHU2OTgyXHU1RkY1XHU1MTg1XHU1QkI5XHU3Njg0IFByb21wdFx1MzAwMlwiKVxuICAgICAgICAuYWRkVGV4dEFyZWEoKHRleHQpID0+IHRleHRcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvbXB0X2dlbmVyYXRvcilcbiAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9tcHRfZ2VuZXJhdG9yID0gdmFsdWU7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICB9KS5pbnB1dEVsLnN0eWxlLmhlaWdodCA9IFwiMzAwcHhcIik7XG4gICAgXG4gICAgLy8gXHU1M0VBXHU2NzA5XHU1NzI4IEFJIFx1NkEyMVx1NUYwRlx1NEUwQlx1NjI0RFx1NjYzRVx1NzkzQSBDcml0aWMgUHJvbXB0XG4gICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmNyaXRpY19tb2RlID09PSBcImFpXCIpIHtcbiAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgIC5zZXROYW1lKFwiXHU1QkExXHU2ODM4IFByb21wdCAoQ3JpdGljKVwiKVxuICAgICAgICAgIC5zZXREZXNjKFwiXHU3NTI4XHU0RThFIEFJIFx1NkEyMVx1NUYwRlx1NEUwQlx1NUJBMVx1NjgzOFx1NzUxRlx1NjIxMFx1NTE4NVx1NUJCOVx1NzY4NCBQcm9tcHRcdTMwMDJcIilcbiAgICAgICAgICAuYWRkVGV4dEFyZWEoKHRleHQpID0+IHRleHRcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9tcHRfY3JpdGljKVxuICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9tcHRfY3JpdGljID0gdmFsdWU7XG4gICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgfSkuaW5wdXRFbC5zdHlsZS5oZWlnaHQgPSBcIjMwMHB4XCIpO1xuICAgIH1cblxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAuc2V0TmFtZShcIlx1NEZFRVx1NkI2MyBQcm9tcHQgKFJldmlzZXIpXCIpXG4gICAgICAgIC5zZXREZXNjKFwiXHU3NTI4XHU0RThFXHU0RkVFXHU2QjYzXHU4OEFCXHU1QkExXHU2ODM4XHU1NDU4XHU2MkQyXHU3RUREXHU1MTg1XHU1QkI5XHU3Njg0IFByb21wdFx1MzAwMlwiKVxuICAgICAgICAuYWRkVGV4dEFyZWEoKHRleHQpID0+IHRleHRcbiAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvbXB0X3JldmlzZXIpXG4gICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvbXB0X3JldmlzZXIgPSB2YWx1ZTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgIH0pLmlucHV0RWwuc3R5bGUuaGVpZ2h0ID0gXCIzMDBweFwiKTtcbiAgfVxufVxuIiwgIi8vIE15T2JzaWRpYW5QbHVnaW4vUXVldWVNb2RhbC50cyAoVjEuMiAtIFx1OUVEOFx1OEJBNFx1NjI5OFx1NTNFMClcblxuaW1wb3J0IHsgQXBwLCBNb2RhbCwgU2V0dGluZywgTm90aWNlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IEtub3dsZWRnZUdyYXBoUGx1Z2luIGZyb20gJy4vbWFpbic7XG5pbXBvcnQgeyBUYXNrRGF0YSB9IGZyb20gJy4vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgUXVldWVNYW5hZ2VtZW50TW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gICAgcGx1Z2luOiBLbm93bGVkZ2VHcmFwaFBsdWdpbjtcblxuICAgIC8vIFx1NzUyOFx1NEU4RVx1NEZERFx1NUI1OFx1NjQxQ1x1N0QyMlx1OEJDRFxuICAgIHByaXZhdGUgc2VhcmNoVGVybXM6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH0gPSB7XG4gICAgICAgIGdlbjogJycsXG4gICAgICAgIHJldjogJycsXG4gICAgICAgIHJlcDogJycsXG4gICAgICAgIGRpczogJycsXG4gICAgfTtcbiAgICBcbiAgICAvLyBcdTMwMTBcdTMwMTBcdTMwMTAgXHU1REYyXHU0RkVFXHU2NTM5XHVGRjFBXHU5RUQ4XHU4QkE0XHU1MTY4XHU5MEU4XHU2Mjk4XHU1M0UwIFx1MzAxMVx1MzAxMVx1MzAxMVxuICAgIHByaXZhdGUgY29sbGFwc2VTdGF0ZXM6IHsgW2tleTogc3RyaW5nXTogYm9vbGVhbiB9ID0ge1xuICAgICAgICBnZW46IGZhbHNlLCAvLyBcdTlFRDhcdThCQTRcdTYyOThcdTUzRTBcbiAgICAgICAgcmV2OiBmYWxzZSwgLy8gXHU5RUQ4XHU4QkE0XHU2Mjk4XHU1M0UwXG4gICAgICAgIHJlcDogZmFsc2UsIC8vIFx1OUVEOFx1OEJBNFx1NjI5OFx1NTNFMFxuICAgICAgICBkaXM6IGZhbHNlLCAvLyBcdTlFRDhcdThCQTRcdTYyOThcdTUzRTBcbiAgICB9O1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogS25vd2xlZGdlR3JhcGhQbHVnaW4pIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgfVxuXG4gICAgb25PcGVuKCkge1xuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICAgICAgY29udGVudEVsLmVtcHR5KCk7XG4gICAgICAgIGNvbnRlbnRFbC5hZGRDbGFzcygna2ctbW9kYWwnKTsgXG4gICAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdcdTk2MUZcdTUyMTdcdTdCQTFcdTc0MDZcdTRFRUFcdTg4NjhcdTc2RDgnIH0pO1xuXG4gICAgICAgIGNvbnN0IHN0YXR1cyA9IHRoaXMucGx1Z2luLmRhdGEuc3RhdHVzO1xuICAgICAgICBjb25zdCBzdGF0dXNUZXh0ID0gYFx1NzJCNlx1NjAwMTogJHtzdGF0dXMudG9VcHBlckNhc2UoKX0gfCAke3RoaXMucGx1Z2luLnN0YXR1c0JhckVsLmdldFRleHQoKX1gO1xuICAgICAgICBcbiAgICAgICAgLy8gMS4gXHU3MkI2XHU2MDAxXHU1NDhDXHU1NDJGXHU1MDVDXHU2MzA5XHU5NEFFXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcbiAgICAgICAgICAgIC5zZXROYW1lKHN0YXR1cyA9PT0gJ3J1bm5pbmcnID8gJ1x1NUYxNVx1NjRDRVx1OEZEMFx1ODg0Q1x1NEUyRCcgOiAnXHU1RjE1XHU2NENFXHU1REYyXHU2NjgyXHU1MDVDJylcbiAgICAgICAgICAgIC5zZXREZXNjKHN0YXR1c1RleHQpXG4gICAgICAgICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cbiAgICAgICAgICAgICAgICAuc2V0QnV0dG9uVGV4dChzdGF0dXMgPT09ICdydW5uaW5nJyA/ICdcdTY2ODJcdTUwNUNcdTVGMTVcdTY0Q0UnIDogJ1x1NTQyRlx1NTJBOFx1NUYxNVx1NjRDRScpXG4gICAgICAgICAgICAgICAgLnNldEN0YShzdGF0dXMgIT09ICdydW5uaW5nJylcbiAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmVuZ2luZS50b2dnbGVFbmdpbmVTdGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uT3BlbigpOyAvLyBcdTUyMzdcdTY1QjAgTW9kYWwgXHU1MTg1XHU5MEU4XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgLy8gMi4gXHU2RTMyXHU2N0QzXHU1NkRCXHU0RTJBXHU5NjFGXHU1MjE3XG4gICAgICAgIHRoaXMucmVuZGVyUXVldWVTZWN0aW9uKFxuICAgICAgICAgICAgY29udGVudEVsLCBcbiAgICAgICAgICAgICdnZW4nLCBcbiAgICAgICAgICAgICdcdTVGODVcdTc1MUZcdTYyMTAgKEdlbmVyYXRpb24pJywgXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLmdlbmVyYXRpb25RdWV1ZSxcbiAgICAgICAgICAgIHRoaXMucmVuZGVyR2VuZXJhdGlvbkl0ZW0uYmluZCh0aGlzKVxuICAgICAgICApO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5yZW5kZXJRdWV1ZVNlY3Rpb24oXG4gICAgICAgICAgICBjb250ZW50RWwsXG4gICAgICAgICAgICAncmV2JyxcbiAgICAgICAgICAgICdcdTVGODVcdTVCQTFcdTY4MzggKFJldmlldyknLFxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5yZXZpZXdRdWV1ZSxcbiAgICAgICAgICAgIHRoaXMucmVuZGVyUmV2aWV3SXRlbS5iaW5kKHRoaXMpXG4gICAgICAgICk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLnJlbmRlclF1ZXVlU2VjdGlvbihcbiAgICAgICAgICAgIGNvbnRlbnRFbCxcbiAgICAgICAgICAgICdyZXAnLFxuICAgICAgICAgICAgJ1x1NUY4NVx1NEZFRVx1NkI2MyAoUmV2aXNpb24pJyxcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLmRhdGEucmV2aXNpb25RdWV1ZSxcbiAgICAgICAgICAgIHRoaXMucmVuZGVyUmV2aXNpb25JdGVtLmJpbmQodGhpcylcbiAgICAgICAgKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMucmVuZGVyUXVldWVTZWN0aW9uKFxuICAgICAgICAgICAgY29udGVudEVsLFxuICAgICAgICAgICAgJ2RpcycsXG4gICAgICAgICAgICAnXHU1REYyXHU0RTIyXHU1RjAzIChEaXNjYXJkZWQpJyxcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLmRhdGEuZGlzY2FyZGVkUGlsZSxcbiAgICAgICAgICAgIHRoaXMucmVuZGVyRGlzY2FyZGVkSXRlbS5iaW5kKHRoaXMpXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgb25DbG9zZSgpIHtcbiAgICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG4gICAgICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFx1NkUzMlx1NjdEM1x1NEUwMFx1NEUyQVx1OTYxRlx1NTIxN1x1NTMzQVx1NTdERiAoXHU1RTI2XHU2NDFDXHU3RDIyXHU1NDhDXHU1QzU1XHU1RjAwL1x1NjI5OFx1NTNFMClcbiAgICAgKi9cbiAgICBwcml2YXRlIHJlbmRlclF1ZXVlU2VjdGlvbihcbiAgICAgICAgY29udGFpbmVyRWw6IEhUTUxFbGVtZW50LFxuICAgICAgICBrZXk6ICdnZW4nIHwgJ3JldicgfCAncmVwJyB8ICdkaXMnLFxuICAgICAgICB0aXRsZTogc3RyaW5nLFxuICAgICAgICBkYXRhOiAoc3RyaW5nIHwgVGFza0RhdGEpW10sXG4gICAgICAgIHJlbmRlckZuOiAoY29udGFpbmVyOiBIVE1MRWxlbWVudCwgaXRlbTogc3RyaW5nIHwgVGFza0RhdGEsIGluZGV4OiBudW1iZXIpID0+IHZvaWRcbiAgICApIHtcbiAgICAgICAgY29uc3QgZGlzcGxheUxpbWl0ID0gMTAwOyAvLyBcdTZCQ0ZcdTZCMjFcdTY3MDBcdTU5MUFcdTZFMzJcdTY3RDMgMTAwIFx1OTg3OVxuICAgICAgICBjb25zdCBmaWx0ZXIgPSB0aGlzLnNlYXJjaFRlcm1zW2tleV07XG4gICAgICAgIFxuICAgICAgICAvLyAxLiBcdTYyNjdcdTg4NENcdThGQzdcdTZFRTRcbiAgICAgICAgY29uc3QgZmlsdGVyZWREYXRhID0gZGF0YS5maWx0ZXIoaXRlbSA9PiB7XG4gICAgICAgICAgICBpZiAoIWZpbHRlcikgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICBjb25zdCBuZWVkbGUgPSBmaWx0ZXIudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgaXRlbSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKG5lZWRsZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gaXRlbS5pZGVhLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMobmVlZGxlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgdG90YWwgPSBkYXRhLmxlbmd0aDtcbiAgICAgICAgY29uc3QgZmlsdGVyZWRUb3RhbCA9IGZpbHRlcmVkRGF0YS5sZW5ndGg7XG4gICAgICAgIGNvbnN0IHRpdGxlVGV4dCA9IGAke3RpdGxlfSAoJHtmaWx0ZXJlZFRvdGFsfSR7dG90YWwgIT09IGZpbHRlcmVkVG90YWwgPyAnIC8gJyArIHRvdGFsIDogJyd9IFx1OTg3OSlgO1xuXG4gICAgICAgIC8vIDIuIFx1NEY3Rlx1NzUyOCA8ZGV0YWlscz4gXHU1MTQzXHU3RDIwXHU1MjFCXHU1RUZBXHU1M0VGXHU2Mjk4XHU1M0UwXHU1MzNBXHU1N0RGXG4gICAgICAgIGNvbnN0IGRldGFpbHMgPSBjb250YWluZXJFbC5jcmVhdGVFbCgnZGV0YWlscycpO1xuICAgICAgICBkZXRhaWxzLm9wZW4gPSB0aGlzLmNvbGxhcHNlU3RhdGVzW2tleV07IC8vIFx1OEJCRVx1N0Y2RVx1NTIxRFx1NTlDQlx1NUM1NVx1NUYwMC9cdTYyOThcdTUzRTBcdTcyQjZcdTYwMDFcblxuICAgICAgICAvLyAzLiBcdTY4MDdcdTk4OTggKFx1NzNCMFx1NTcyOFx1NjYyRiA8c3VtbWFyeT5cdUZGMENcdTUzRUZcdTRFRTVcdTcwQjlcdTUxRkIpXG4gICAgICAgIGNvbnN0IHN1bW1hcnkgPSBkZXRhaWxzLmNyZWF0ZUVsKCdzdW1tYXJ5JywgeyB0ZXh0OiB0aXRsZVRleHQgfSk7XG4gICAgICAgIHN1bW1hcnkuc3R5bGUuZm9udFdlaWdodCA9ICdib2xkJztcbiAgICAgICAgc3VtbWFyeS5zdHlsZS5mb250U2l6ZSA9ICd2YXIoLS1mb250LXVpLWxhcmdlKSc7XG4gICAgICAgIHN1bW1hcnkuc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInO1xuICAgICAgICBzdW1tYXJ5LnN0eWxlLnBhZGRpbmcgPSAnNXB4IDAnO1xuXG4gICAgICAgIC8vIDQuIFx1NzZEMVx1NTQyQ1x1NzBCOVx1NTFGQlx1NEU4Qlx1NEVGNlx1RkYwQ1x1NEZERFx1NUI1OFx1NzJCNlx1NjAwMVxuICAgICAgICBkZXRhaWxzLmFkZEV2ZW50TGlzdGVuZXIoJ3RvZ2dsZScsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuY29sbGFwc2VTdGF0ZXNba2V5XSA9IGRldGFpbHMub3BlbjtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gNS4gXHU2NDFDXHU3RDIyXHU2ODQ2IChcdTY1M0VcdTU3MjggZGV0YWlscyBcdTUxODVcdTkwRTgpXG4gICAgICAgIG5ldyBTZXR0aW5nKGRldGFpbHMpXG4gICAgICAgICAgICAuc2V0RGVzYyhgXHU2NDFDXHU3RDIyICR7dGl0bGV9Li4uYClcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4ge1xuICAgICAgICAgICAgICAgIHRleHQuc2V0UGxhY2Vob2xkZXIoJ1x1OEY5M1x1NTE2NVx1NTE3M1x1OTUyRVx1OEJDRC4uLicpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnNlYXJjaFRlcm1zW2tleV0pXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlYXJjaFRlcm1zW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25PcGVuKCk7IC8vIFx1NTIzN1x1NjVCMCBNb2RhbFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIC8vIDYuIFx1NjIyQVx1NjVBRFx1NjU3MFx1NjM2RVx1NUU3Nlx1NkUzMlx1NjdEM1xuICAgICAgICBjb25zdCB0cnVuY2F0ZWREYXRhID0gZmlsdGVyZWREYXRhLnNsaWNlKDAsIGRpc3BsYXlMaW1pdCk7XG4gICAgICAgIFxuICAgICAgICBpZiAodHJ1bmNhdGVkRGF0YS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIGNvbnN0IGRlc2MgPSBkZXRhaWxzLmNyZWF0ZUVsKCdwJywgeyB0ZXh0OiAnXHU2QjY0XHU5NjFGXHU1MjE3XHU0RTNBXHU3QTdBXHVGRjBDXHU2MjE2XHU2NzJBXHU2MjdFXHU1MjMwXHU1MzM5XHU5MTREXHU5ODc5XHUzMDAyJywgY2xzOiAnc2V0dGluZy1pdGVtLWRlc2NyaXB0aW9uJyB9KTtcbiAgICAgICAgICAgIGRlc2Muc3R5bGUucGFkZGluZ0xlZnQgPSAnMTBweCc7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIDcuIFx1NTIxN1x1ODg2OFx1NUJCOVx1NTY2OCAoXHU2NTNFXHU1NzI4IGRldGFpbHMgXHU1MTg1XHU5MEU4KVxuICAgICAgICBjb25zdCBsaXN0Q29udGFpbmVyID0gZGV0YWlscy5jcmVhdGVEaXYoJ2tnLWxpc3QtY29udGFpbmVyJyk7XG4gICAgICAgIGxpc3RDb250YWluZXIuc3R5bGUubWF4SGVpZ2h0ID0gJzIwMHB4JzsgXG4gICAgICAgIGxpc3RDb250YWluZXIuc3R5bGUub3ZlcmZsb3dZID0gJ2F1dG8nOyBcbiAgICAgICAgbGlzdENvbnRhaW5lci5zdHlsZS5ib3JkZXIgPSAnMXB4IHNvbGlkIHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItYm9yZGVyKSc7XG4gICAgICAgIGxpc3RDb250YWluZXIuc3R5bGUucGFkZGluZyA9ICc1cHgnO1xuICAgICAgICBsaXN0Q29udGFpbmVyLnN0eWxlLm1hcmdpbkxlZnQgPSAnMTBweCc7IC8vIFx1N0YyOVx1OEZEQlxuXG4gICAgICAgIHRydW5jYXRlZERhdGEuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIHJlbmRlckZuKGxpc3RDb250YWluZXIsIGl0ZW0sIGluZGV4KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gOC4gXHU2NjNFXHU3OTNBXHU2MjJBXHU2NUFEXHU2M0QwXHU3OTNBXG4gICAgICAgIGlmIChmaWx0ZXJlZERhdGEubGVuZ3RoID4gZGlzcGxheUxpbWl0KSB7XG4gICAgICAgICAgICBjb25zdCB0cnVuY2F0ZWRJbmZvID0gZGV0YWlscy5jcmVhdGVFbCgncCcsIHsgXG4gICAgICAgICAgICAgICAgdGV4dDogYC4uLiBcdTRFQzVcdTY2M0VcdTc5M0FcdTUyNEQgJHtkaXNwbGF5TGltaXR9IFx1OTg3OSAoXHU1MTcxICR7ZmlsdGVyZWREYXRhLmxlbmd0aH0gXHU5ODc5KVx1RkYwQ1x1OEJGN1x1NEY3Rlx1NzUyOFx1NjQxQ1x1N0QyMlx1NjdFNVx1NjI3RVx1NjZGNFx1NTkxQVx1MzAwMmAsXG4gICAgICAgICAgICAgICAgY2xzOiAnc2V0dGluZy1pdGVtLWRlc2NyaXB0aW9uJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0cnVuY2F0ZWRJbmZvLnN0eWxlLnBhZGRpbmdMZWZ0ID0gJzEwcHgnO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gLS0tIFx1NTM1NVx1OTg3OVx1NkUzMlx1NjdEM1x1NTFGRFx1NjU3MCAoXHU0RkREXHU2MzAxXHU0RTBEXHU1M0Q4KSAtLS1cblxuICAgIHByaXZhdGUgcmVuZGVyR2VuZXJhdGlvbkl0ZW0oY29udGFpbmVyOiBIVE1MRWxlbWVudCwgaXRlbTogc3RyaW5nIHwgVGFza0RhdGEpIHtcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyKVxuICAgICAgICAgICAgLnNldE5hbWUoaXRlbSBhcyBzdHJpbmcpXG4gICAgICAgICAgICAuYWRkQnV0dG9uKGJ0biA9PiBidG5cbiAgICAgICAgICAgICAgICAuc2V0SWNvbigndHJhc2gnKVxuICAgICAgICAgICAgICAgIC5zZXRUb29sdGlwKCdcdTUyMjBcdTk2NjRcdTZCNjRcdTY5ODJcdTVGRjUnKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcXVldWUgPSB0aGlzLnBsdWdpbi5kYXRhLmdlbmVyYXRpb25RdWV1ZTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5kZXggPSBxdWV1ZS5pbmRleE9mKGl0ZW0gYXMgc3RyaW5nKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXVlLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlUGx1Z2luRGF0YSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uZW5naW5lLnVwZGF0ZVN0YXR1c0JhcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbk9wZW4oKTsgLy8gXHU1MjM3XHU2NUIwXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHJlbmRlclJldmlld0l0ZW0oY29udGFpbmVyOiBIVE1MRWxlbWVudCwgaXRlbTogc3RyaW5nIHwgVGFza0RhdGEpIHtcbiAgICAgICAgY29uc3QgdGFzayA9IGl0ZW0gYXMgVGFza0RhdGE7XG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lcilcbiAgICAgICAgICAgIC5zZXROYW1lKGBbXHU1QkExXHU2ODM4XSAke3Rhc2suaWRlYX1gKVxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidG4gPT4gYnRuXG4gICAgICAgICAgICAgICAgLnNldEljb24oJ3RyYXNoJylcbiAgICAgICAgICAgICAgICAuc2V0VG9vbHRpcCgnXHU0RTIyXHU1RjAzXHU2QjY0XHU0RUZCXHU1MkExJylcbiAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmRhdGEucmV2aWV3UXVldWUuc3BsaWNlKHRoaXMucGx1Z2luLmRhdGEucmV2aWV3UXVldWUuaW5kZXhPZih0YXNrKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmRhdGEuZGlzY2FyZGVkUGlsZS5wdXNoKHRhc2spO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlUGx1Z2luRGF0YSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5lbmdpbmUudXBkYXRlU3RhdHVzQmFyKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25PcGVuKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG4gICAgfVxuICAgIFxuICAgIHByaXZhdGUgcmVuZGVyUmV2aXNpb25JdGVtKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIGl0ZW06IHN0cmluZyB8IFRhc2tEYXRhKSB7XG4gICAgICAgIGNvbnN0IHRhc2sgPSBpdGVtIGFzIFRhc2tEYXRhO1xuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXIpXG4gICAgICAgICAgICAuc2V0TmFtZShgW1x1NEZFRVx1NkI2M10gJHt0YXNrLmlkZWF9YClcbiAgICAgICAgICAgIC5zZXREZXNjKGBcdTUzOUZcdTU2RTA6ICR7dGFzay5yZWFzb24gfHwgJ1x1NjcyQVx1NzdFNSd9YClcbiAgICAgICAgICAgIC5hZGRCdXR0b24oYnRuID0+IGJ0blxuICAgICAgICAgICAgICAgIC5zZXRJY29uKCd0cmFzaCcpXG4gICAgICAgICAgICAgICAgLnNldFRvb2x0aXAoJ1x1NEUyMlx1NUYwM1x1NkI2NFx1NEVGQlx1NTJBMScpXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLnJldmlzaW9uUXVldWUuc3BsaWNlKHRoaXMucGx1Z2luLmRhdGEucmV2aXNpb25RdWV1ZS5pbmRleE9mKHRhc2spLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5kaXNjYXJkZWRQaWxlLnB1c2godGFzayk7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVQbHVnaW5EYXRhKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmVuZ2luZS51cGRhdGVTdGF0dXNCYXIoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbk9wZW4oKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcbiAgICB9XG4gICAgXG4gICAgcHJpdmF0ZSByZW5kZXJEaXNjYXJkZWRJdGVtKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIGl0ZW06IHN0cmluZyB8IFRhc2tEYXRhKSB7XG4gICAgICAgIGNvbnN0IHRhc2sgPSBpdGVtIGFzIFRhc2tEYXRhO1xuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXIpXG4gICAgICAgICAgICAuc2V0TmFtZShgW1x1NURGMlx1NEUyMlx1NUYwM10gJHt0YXNrLmlkZWF9YClcbiAgICAgICAgICAgIC5zZXREZXNjKGBcdTY3MDBcdTU0MEVcdTUzOUZcdTU2RTA6ICR7dGFzay5yZWFzb24gfHwgJ1x1NjcyQVx1NzdFNSd9YClcbiAgICAgICAgICAgIC5hZGRCdXR0b24oYnRuID0+IGJ0blxuICAgICAgICAgICAgICAgIC5zZXRJY29uKCdyZWZyZXNoLWN3JylcbiAgICAgICAgICAgICAgICAuc2V0VG9vbHRpcCgnXHU5MUNEXHU2NUIwXHU2MzkyXHU5NjFGIChcdTY1M0VcdTU2REVcdTc1MUZcdTYyMTBcdTk2MUZcdTUyMTcpJylcbiAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmRhdGEuZGlzY2FyZGVkUGlsZS5zcGxpY2UodGhpcy5wbHVnaW4uZGF0YS5kaXNjYXJkZWRQaWxlLmluZGV4T2YodGFzayksIDEpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5lbmdpbmUuYWRkQ29uY2VwdHNUb1F1ZXVlKFt0YXNrLmlkZWFdKTsgLy8gXHU0RjdGXHU3NTI4IGVuZ2luZSBcdTc2ODRcdTY1QjlcdTZDRDVcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbk9wZW4oKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcbiAgICB9XG59XG4iLCAiLy8gZW5naW5lLnRzXG5cbmltcG9ydCB7IE5vdGljZSwgVEZpbGUsIFRGb2xkZXIsIG5vcm1hbGl6ZVBhdGgsIEFwcCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IEtub3dsZWRnZUdyYXBoUGx1Z2luIGZyb20gXCIuL21haW5cIjtcbmltcG9ydCB7IEFQSUhhbmRsZXIsIEFsbE1vZGVsc0ZhaWxlZEVycm9yIH0gZnJvbSBcIi4vYXBpSGFuZGxlclwiO1xuaW1wb3J0IHsgQ3JpdGljIH0gZnJvbSBcIi4vY3JpdGljXCI7XG5pbXBvcnQgeyBSZXZpc2VyIH0gZnJvbSBcIi4vcmV2aXNlclwiO1xuaW1wb3J0IHsgc2FuaXRpemVGaWxlbmFtZSwgZXh0cmFjdE5ld0lkZWFzLCBjbGVhbk1hcmtkb3duT3V0cHV0IH0gZnJvbSBcIi4vdXRpbHNcIjtcbi8vIFx1NTA0N1x1OEJCRVx1NEY2MFx1NzY4NFx1N0M3Qlx1NTc4Qlx1NUI5QVx1NEU0OVx1NTcyOFx1NEUwMFx1NEUyQVx1NTNFQiAndHlwZXMudHMnIFx1NzY4NFx1NjU4N1x1NEVGNlx1OTFDQ1xuaW1wb3J0IHsgVGFza0RhdGEgfSBmcm9tIFwiLi90eXBlc1wiO1xuXG5leHBvcnQgY2xhc3MgRW5naW5lIHtcbiAgICBwbHVnaW46IEtub3dsZWRnZUdyYXBoUGx1Z2luO1xuICAgIGFwcDogQXBwO1xuICAgIGFwaUhhbmRsZXI6IEFQSUhhbmRsZXI7XG4gICAgY3JpdGljOiBDcml0aWM7XG4gICAgcmV2aXNlcjogUmV2aXNlcjtcbiAgICBwcml2YXRlIGlzUnVubmluZzogYm9vbGVhbiA9IGZhbHNlO1xuICAgIHByaXZhdGUgdGltZXJJZDogTm9kZUpTLlRpbWVvdXQgfCBudWxsID0gbnVsbDtcblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogS25vd2xlZGdlR3JhcGhQbHVnaW4pIHtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgICAgIHRoaXMuYXBwID0gcGx1Z2luLmFwcDtcbiAgICAgICAgdGhpcy5hcGlIYW5kbGVyID0gbmV3IEFQSUhhbmRsZXIocGx1Z2luKTtcbiAgICAgICAgdGhpcy5jcml0aWMgPSBuZXcgQ3JpdGljKHBsdWdpbik7XG4gICAgICAgIHRoaXMucmV2aXNlciA9IG5ldyBSZXZpc2VyKHBsdWdpbik7XG4gICAgfVxuXG4gICAgLy8gLS0tIFB1YmxpYyBDb250cm9scyAtLS1cblxuICAgIC8qKlxuICAgICAqIFx1NTIwN1x1NjM2Mlx1NUYxNVx1NjRDRVx1NzY4NFx1OEZEMFx1ODg0Qy9cdTY2ODJcdTUwNUNcdTcyQjZcdTYwMDFcbiAgICAgKi9cbiAgICBwdWJsaWMgdG9nZ2xlRW5naW5lU3RhdGUoKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLmlzUnVubmluZykge1xuICAgICAgICAgICAgdGhpcy5zdG9wKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0KCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBcdTZERkJcdTUyQTBcdTUzNTVcdTRFMkFcdTY5ODJcdTVGRjVcdTUyMzBcdTk2MUZcdTUyMTdcdUZGMENcdTVFNzZcdTY2M0VcdTc5M0FcdTkwMUFcdTc3RTVcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gXHU2NjJGXHU1NDI2XHU2MjEwXHU1MjlGXHU2REZCXHU1MkEwXG4gICAgICovXG4gICAgcHVibGljIGFkZENvbmNlcHRUb1F1ZXVlKGNvbmNlcHQ6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCBhZGRlZCA9IHRoaXMuYWRkQ29uY2VwdHNUb1F1ZXVlKFtjb25jZXB0XSk7XG4gICAgICAgIGlmIChhZGRlZCA+IDApIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYCcke2NvbmNlcHR9JyBcdTVERjJcdTZERkJcdTUyQTBcdTUyMzBcdTc1MUZcdTYyMTBcdTk2MUZcdTUyMTdcdTMwMDJgKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU3RhdHVzQmFyKCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBuZXcgTm90aWNlKGAnJHtjb25jZXB0fScgXHU1REYyXHU1QjU4XHU1NzI4XHU0RThFXHU5NjFGXHU1MjE3XHU2MjE2XHU0RUQzXHU1RTkzXHU0RTJEXHVGRjBDXHU2NzJBXHU2REZCXHU1MkEwXHUzMDAyYCk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBcdTZERkJcdTUyQTBcdTU5MUFcdTRFMkFcdTY5ODJcdTVGRjVcdTUyMzBcdTc1MUZcdTYyMTBcdTk2MUZcdTUyMTdcdUZGMENcdTRGMUFcdThGREJcdTg4NENcdTUzQkJcdTkxQ0RcdTU0OENcdTY4QzBcdTY3RTVcdTY1ODdcdTRFRjZcdTY2MkZcdTU0MjZcdTVCNThcdTU3MjhcbiAgICAgKiBAcGFyYW0ge3N0cmluZ1tdfSBjb25jZXB0cyAtIFx1ODk4MVx1NkRGQlx1NTJBMFx1NzY4NFx1Njk4Mlx1NUZGNVx1NTIxN1x1ODg2OFxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IFx1NUI5RVx1OTY0NVx1NkRGQlx1NTJBMFx1NzY4NFx1NjVCMFx1Njk4Mlx1NUZGNVx1NjU3MFx1OTFDRlxuICAgICAqL1xuICAgIHB1YmxpYyBhZGRDb25jZXB0c1RvUXVldWUoY29uY2VwdHM6IHN0cmluZ1tdKTogbnVtYmVyIHtcbiAgICAgICAgY29uc3QgY3VycmVudFF1ZXVlID0gbmV3IFNldCh0aGlzLnBsdWdpbi5kYXRhLmdlbmVyYXRpb25RdWV1ZSk7XG4gICAgICAgIC8vIFx1ODNCN1x1NTNENlx1NEUwMFx1NEUyQSBTZXRcdUZGMENcdTUzMDVcdTU0MkJcdTYyNDBcdTY3MDlcdTVERjJcdTVCNThcdTU3MjhcdTdCMTRcdThCQjBcdTc2ODQgYmFzZW5hbWUgKFx1NjVFMCAubWQgXHU1NDBFXHU3RjAwKVxuICAgICAgICBjb25zdCBleGlzdGluZ0ZpbGVzID0gbmV3IFNldCh0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCkubWFwKGYgPT4gZi5iYXNlbmFtZSkpO1xuXG4gICAgICAgIGxldCBhZGRlZENvdW50ID0gMDtcbiAgICAgICAgZm9yIChjb25zdCBjb25jZXB0IG9mIGNvbmNlcHRzKSB7XG4gICAgICAgICAgICBjb25zdCBzYW5pdGl6ZWQgPSBzYW5pdGl6ZUZpbGVuYW1lKGNvbmNlcHQpO1xuICAgICAgICAgICAgLy8gXHU2OEMwXHU2N0U1XHVGRjFBMS4gXHU5NjFGXHU1MjE3XHU0RTJEXHU2Q0ExXHU2NzA5IDIuIFx1NEVEM1x1NUU5M1x1NEUyRFx1NEU1Rlx1NkNBMVx1NjcwOVx1NTQwQ1x1NTQwRFx1NjU4N1x1NEVGNlxuICAgICAgICAgICAgaWYgKCFjdXJyZW50UXVldWUuaGFzKGNvbmNlcHQpICYmICFleGlzdGluZ0ZpbGVzLmhhcyhzYW5pdGl6ZWQpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5nZW5lcmF0aW9uUXVldWUucHVzaChjb25jZXB0KTtcbiAgICAgICAgICAgICAgICBjdXJyZW50UXVldWUuYWRkKGNvbmNlcHQpOyAvLyBcdTRGRERcdThCQzFcdTU3MjhcdTUzNTVcdTZCMjFcdThDMDNcdTc1MjhcdTRFMkRcdTRFNUZcdTRFMERcdTkxQ0RcdTU5MERcdTZERkJcdTUyQTBcbiAgICAgICAgICAgICAgICBhZGRlZENvdW50Kys7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoYWRkZWRDb3VudCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVQbHVnaW5EYXRhKCk7IC8vIFx1NEZERFx1NUI1OFx1NjZGNFx1NjVCMFx1NTQwRVx1NzY4NFx1OTYxRlx1NTIxN1xuICAgICAgICAgICAgdGhpcy51cGRhdGVTdGF0dXNCYXIoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYWRkZWRDb3VudDtcbiAgICB9XG5cbiAgICAvLyAtLS0gQ29yZSBMb29wIC0tLVxuXG4gICAgLyoqXG4gICAgICogXHU1NDJGXHU1MkE4XHU1RjE1XHU2NENFXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBzdGFydCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKHRoaXMuaXNSdW5uaW5nKSByZXR1cm47XG4gICAgICAgIHRoaXMuaXNSdW5uaW5nID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5zdGF0dXMgPSBcInJ1bm5pbmdcIjtcbiAgICAgICAgbmV3IE5vdGljZShcIlx1NzdFNVx1OEJDNlx1NTZGRVx1OEMzMVx1NUYxNVx1NjRDRVx1NURGMlx1NTQyRlx1NTJBOFx1RkYwMVwiKTtcbiAgICAgICAgdGhpcy51cGRhdGVTdGF0dXNCYXIoKTtcbiAgICAgICAgLy8gXHU3QUNCXHU1MzczXHU1RjAwXHU1OUNCXHU3QjJDXHU0RTAwXHU2QjIxIHRpY2tcbiAgICAgICAgdGhpcy50aWNrKCk7IFxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFx1NTA1Q1x1NkI2Mlx1NUYxNVx1NjRDRVxuICAgICAqL1xuICAgIHByaXZhdGUgc3RvcCgpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzUnVubmluZykgcmV0dXJuO1xuICAgICAgICB0aGlzLmlzUnVubmluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLnN0YXR1cyA9IFwicGF1c2VkXCI7XG4gICAgICAgIGlmICh0aGlzLnRpbWVySWQpIHtcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVySWQpO1xuICAgICAgICAgICAgdGhpcy50aW1lcklkID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBuZXcgTm90aWNlKFwiXHU3N0U1XHU4QkM2XHU1NkZFXHU4QzMxXHU1RjE1XHU2NENFXHU1REYyXHU2NjgyXHU1MDVDXHUzMDAyXCIpO1xuICAgICAgICB0aGlzLnVwZGF0ZVN0YXR1c0JhcigpO1xuICAgICAgICB0aGlzLnBsdWdpbi5zYXZlUGx1Z2luRGF0YSgpOyAvLyBcdTU3MjhcdTY2ODJcdTUwNUNcdTY1RjZcdTRGRERcdTVCNThcdTcyQjZcdTYwMDFcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBcdTVCODlcdTYzOTJcdTRFMEJcdTRFMDBcdTRFMkEgdGlja1xuICAgICAqL1xuICAgIHByaXZhdGUgc2NoZWR1bGVOZXh0VGljaygpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzUnVubmluZykgcmV0dXJuO1xuICAgICAgICBjb25zdCBkZWxheSA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnJlcXVlc3RfZGVsYXkgKiAxMDAwO1xuICAgICAgICB0aGlzLnRpbWVySWQgPSBzZXRUaW1lb3V0KCgpID0+IHRoaXMudGljaygpLCBkZWxheSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogXHU1RjE1XHU2NENFXHU3Njg0XHU2ODM4XHU1RkMzXHUyMDFDXHU1RkMzXHU4REYzXHUyMDFEXG4gICAgICogXHU1QjgzXHU0RjFBXHU2MzA5XHU0RjE4XHU1MTQ4XHU3RUE3XHVGRjA4XHU0RkVFXHU2QjYzID4gXHU1QkExXHU2ODM4ID4gXHU3NTFGXHU2MjEwXHVGRjA5XHU1OTA0XHU3NDA2XHU0RTAwXHU0RTJBXHU2Mjc5XHU2QjIxXHU3Njg0XHU0RUZCXHU1MkExXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyB0aWNrKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAoIXRoaXMuaXNSdW5uaW5nKSByZXR1cm47XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGxldCB0YXNrUHJvY2Vzc2VkID0gZmFsc2U7XG5cbiAgICAgICAgICAgIC8vIDEuIFx1NEYxOFx1NTE0OFx1NTkwNFx1NzQwNlx1NEZFRVx1NkI2M1x1OTYxRlx1NTIxN1xuICAgICAgICAgICAgaWYgKHRoaXMucGx1Z2luLmRhdGEucmV2aXNpb25RdWV1ZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgdGFza1Byb2Nlc3NlZCA9IGF3YWl0IHRoaXMucnVuUmV2aXNpb25QaGFzZSgpO1xuICAgICAgICAgICAgfSBcbiAgICAgICAgICAgIC8vIDIuIFx1NTE3Nlx1NkIyMVx1NTkwNFx1NzQwNlx1NUJBMVx1NjgzOFx1OTYxRlx1NTIxN1xuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5wbHVnaW4uZGF0YS5yZXZpZXdRdWV1ZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgdGFza1Byb2Nlc3NlZCA9IGF3YWl0IHRoaXMucnVuQ3JpdGljUGhhc2UoKTtcbiAgICAgICAgICAgIH0gXG4gICAgICAgICAgICAvLyAzLiBcdTY3MDBcdTU0MEVcdTU5MDRcdTc0MDZcdTc1MUZcdTYyMTBcdTk2MUZcdTUyMTdcbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMucGx1Z2luLmRhdGEuZ2VuZXJhdGlvblF1ZXVlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICB0YXNrUHJvY2Vzc2VkID0gYXdhaXQgdGhpcy5ydW5HZW5lcmF0aW9uUGhhc2UoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gXHU2OEMwXHU2N0U1XHU2NjJGXHU1NDI2XHU2MjQwXHU2NzA5XHU1REU1XHU0RjVDXHU5MEZEXHU1QjhDXHU2MjEwXHU0RTg2XG4gICAgICAgICAgICBpZiAoIXRhc2tQcm9jZXNzZWQgJiZcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLmdlbmVyYXRpb25RdWV1ZS5sZW5ndGggPT09IDAgJiZcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLnJldmlld1F1ZXVlLmxlbmd0aCA9PT0gMCAmJlxuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmRhdGEucmV2aXNpb25RdWV1ZS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKFwiXHVEODNDXHVERjg5IFx1NjI0MFx1NjcwOVx1NEVGQlx1NTJBMVx1NUI4Q1x1NjIxMFx1RkYwMVx1NUYxNVx1NjRDRVx1NURGMlx1NTA1Q1x1NkI2Mlx1MzAwMlwiKTtcbiAgICAgICAgICAgICAgICB0aGlzLmlzUnVubmluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmRhdGEuc3RhdHVzID0gXCJpZGxlXCI7IC8vIFx1NTNEOFx1NEUzQVx1N0E3QVx1OTVGMlx1NzJCNlx1NjAwMVxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlU3RhdHVzQmFyKCk7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVBsdWdpbkRhdGEoKTsgLy8gXHU0RkREXHU1QjU4XHU2NzAwXHU3RUM4XHU3MkI2XHU2MDAxXG4gICAgICAgICAgICAgICAgcmV0dXJuOyAvLyBcdTUwNUNcdTZCNjIgdGljayBcdTVGQUFcdTczQUZcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIlx1NUYxNVx1NjRDRSBUaWNrIFx1NTNEMVx1NzUxRlx1NEUyNVx1OTFDRFx1OTUxOVx1OEJFRjpcIiwgZXJyb3IpO1xuICAgICAgICAgICAgbmV3IE5vdGljZShcIlx1NUYxNVx1NjRDRVx1OTA0N1x1NTIzMFx1OTUxOVx1OEJFRlx1RkYwQ1x1NURGMlx1NjY4Mlx1NTA1Q1x1MzAwMlx1OEJGN1x1NjhDMFx1NjdFNVx1NjNBN1x1NTIzNlx1NTNGMFx1MzAwMlwiKTtcbiAgICAgICAgICAgIHRoaXMuc3RvcCgpOyAvLyBcdTUzRDFcdTc1MUZcdTRFMjVcdTkxQ0RcdTk1MTlcdThCRUZcdTY1RjZcdTUwNUNcdTZCNjJcdTVGMTVcdTY0Q0VcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFx1NTk4Mlx1Njc5Q1x1NUYxNVx1NjRDRVx1NEVDRFx1NTcyOFx1OEZEMFx1ODg0Q1x1RkYwQ1x1NUI4OVx1NjM5Mlx1NEUwQlx1NEUwMFx1NEUyQSB0aWNrXG4gICAgICAgIHRoaXMuc2NoZWR1bGVOZXh0VGljaygpO1xuICAgIH1cblxuICAgIC8vIC0tLSBQaGFzZXMgLS0tXG5cbiAgICAvKipcbiAgICAgKiBcdThGRDBcdTg4NENcdTIwMUNcdTc1MUZcdTYyMTBcdTIwMURcdTk2MzZcdTZCQjVcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxib29sZWFuPn0gXHU2NjJGXHU1NDI2XHU1OTA0XHU3NDA2XHU0RTg2XHU0RUZCXHU1MkExXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBydW5HZW5lcmF0aW9uUGhhc2UoKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgICAgIGNvbnN0IHF1ZXVlID0gdGhpcy5wbHVnaW4uZGF0YS5nZW5lcmF0aW9uUXVldWU7XG4gICAgICAgIGlmIChxdWV1ZS5sZW5ndGggPT09IDApIHJldHVybiBmYWxzZTtcblxuICAgICAgICBjb25zdCBiYXRjaFNpemUgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW5lcmF0aW9uX2JhdGNoX3NpemU7XG4gICAgICAgIC8vIFx1NTNENlx1NTFGQVx1NEUwMFx1NEUyQVx1NjI3OVx1NkIyMVx1NzY4NFx1NEVGQlx1NTJBMVxuICAgICAgICBjb25zdCBiYXRjaCA9IHF1ZXVlLnNwbGljZSgwLCBNYXRoLm1pbihxdWV1ZS5sZW5ndGgsIGJhdGNoU2l6ZSkpO1xuXG4gICAgICAgIHRoaXMudXBkYXRlU3RhdHVzQmFyKCk7XG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVQbHVnaW5EYXRhKCk7IC8vIFx1NEZERFx1NUI1OFx1NURGMlx1NTNENlx1NTFGQVx1NzY4NFx1OTYxRlx1NTIxN1x1NzJCNlx1NjAwMVxuXG4gICAgICAgIC8vIFx1NUU3Nlx1ODg0Q1x1NTkwNFx1NzQwNlx1OEZEOVx1NEUwMFx1NjI3OVx1NkIyMVx1NzY4NFx1NjI0MFx1NjcwOVx1NEVGQlx1NTJBMVxuICAgICAgICBjb25zdCB0YXNrcyA9IGJhdGNoLm1hcChpZGVhID0+IHRoaXMuZ2VuZXJhdGlvblRhc2soaWRlYSkpO1xuICAgICAgICBhd2FpdCBQcm9taXNlLmFsbFNldHRsZWQodGFza3MpO1xuXG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVQbHVnaW5EYXRhKCk7IC8vIFx1NEZERFx1NUI1OFx1NEVGQlx1NTJBMVx1N0VEM1x1Njc5Q1x1RkYwOFx1OEZEQlx1NTE2NVx1NUJBMVx1NjgzOFx1OTYxRlx1NTIxN1x1RkYwOVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBcdTUzNTVcdTRFMkFcdTc1MUZcdTYyMTBcdTRFRkJcdTUyQTFcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIGdlbmVyYXRpb25UYXNrKGlkZWE6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9tcHRfZ2VuZXJhdG9yLnJlcGxhY2UoXCJ7Y29uY2VwdH1cIiwgaWRlYSk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5hcGlIYW5kbGVyLmNhbGwocHJvbXB0KTtcbiAgICAgICAgICAgIGNvbnN0IGNsZWFuZWRDb250ZW50ID0gY2xlYW5NYXJrZG93bk91dHB1dChjb250ZW50KTtcbiAgICAgICAgICAgIC8vIFx1NjIxMFx1NTI5Rlx1NTQwRVx1RkYwQ1x1NjUzRVx1NTE2NVx1NUJBMVx1NjgzOFx1OTYxRlx1NTIxN1xuICAgICAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5yZXZpZXdRdWV1ZS5wdXNoKHsgaWRlYSwgY29udGVudDogY2xlYW5lZENvbnRlbnQgfSk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgXHUyNzA1IFtcdTc1MUZcdTYyMTBcdTYyMTBcdTUyOUZdOiAke2lkZWF9YCk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGlmIChlIGluc3RhbmNlb2YgQWxsTW9kZWxzRmFpbGVkRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBcdTI3NEMgW1x1NzUxRlx1NjIxMFx1NTkzMVx1OEQyNV06ICR7aWRlYX0gLSAke2UubWVzc2FnZX1gKTtcbiAgICAgICAgICAgICAgICAvLyBcdTU5MzFcdThEMjVcdTU0MEVcdUZGMENcdTY1M0VcdTU2REVcdTk2MUZcdTUyMTdcdTU5MzRcdTkwRThcdUZGMENcdTRFMEJcdTZCMjFcdTRGMThcdTUxNDhcdTkxQ0RcdThCRDVcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLmdlbmVyYXRpb25RdWV1ZS51bnNoaWZ0KGlkZWEpOyBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFx1OEZEMFx1ODg0Q1x1MjAxQ1x1NUJBMVx1NjgzOFx1MjAxRFx1OTYzNlx1NkJCNVxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPGJvb2xlYW4+fSBcdTY2MkZcdTU0MjZcdTU5MDRcdTc0MDZcdTRFODZcdTRFRkJcdTUyQTFcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIHJ1bkNyaXRpY1BoYXNlKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgICAgICBjb25zdCBxdWV1ZSA9IHRoaXMucGx1Z2luLmRhdGEucmV2aWV3UXVldWU7XG4gICAgICAgIGlmIChxdWV1ZS5sZW5ndGggPT09IDApIHJldHVybiBmYWxzZTtcblxuICAgICAgICBjb25zdCBiYXRjaFNpemUgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW5lcmF0aW9uX2JhdGNoX3NpemU7XG4gICAgICAgIGNvbnN0IHRhc2tzVG9SZXZpZXcgPSBxdWV1ZS5zcGxpY2UoMCwgTWF0aC5taW4ocXVldWUubGVuZ3RoLCBiYXRjaFNpemUpKTtcblxuICAgICAgICB0aGlzLnVwZGF0ZVN0YXR1c0JhcigpO1xuICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlUGx1Z2luRGF0YSgpOyAvLyBcdTRGRERcdTVCNThcdTVERjJcdTUzRDZcdTUxRkFcdTc2ODRcdTk2MUZcdTUyMTdcdTcyQjZcdTYwMDFcblxuICAgICAgICBsZXQgbmV3SWRlYXNGb3VuZDogU2V0PHN0cmluZz4gPSBuZXcgU2V0KCk7XG5cbiAgICAgICAgZm9yIChjb25zdCB0YXNrIG9mIHRhc2tzVG9SZXZpZXcpIHtcbiAgICAgICAgICAgIGNvbnN0IHsgaXNBcHByb3ZlZCwgcmVhc29uIH0gPSBhd2FpdCB0aGlzLmNyaXRpYy5qdWRnZSh0YXNrLmNvbnRlbnQpO1xuICAgICAgICAgICAgaWYgKGlzQXBwcm92ZWQpIHtcbiAgICAgICAgICAgICAgICAvLyAxLiBcdTYyNzlcdTUxQzZcdUZGMUFcdTRGRERcdTVCNThcdTdCMTRcdThCQjBcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnNhdmVOb3RlKHRhc2suaWRlYSwgdGFzay5jb250ZW50KTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBcdTMwMTBcdTMwMTBcdTMwMTAgXHU0RkVFXHU2NTM5XHU3MEI5IFx1MzAxMVx1MzAxMVx1MzAxMVxuICAgICAgICAgICAgICAgIC8vIFx1NEVDNVx1NTcyOFx1NUYwMFx1NTE3M1x1NUYwMFx1NTQyRlx1NjVGNlx1NjI0RFx1NjNEMFx1NTNENlx1NjVCMFx1Njk4Mlx1NUZGNVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5leHRyYWN0X25ld19jb25jZXB0cykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBpZGVhcyA9IGV4dHJhY3ROZXdJZGVhcyh0YXNrLmNvbnRlbnQpO1xuICAgICAgICAgICAgICAgICAgICBpZGVhcy5mb3JFYWNoKChpZGVhKSA9PiBuZXdJZGVhc0ZvdW5kLmFkZChpZGVhKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIFx1MzAxMFx1MzAxMFx1MzAxMCBcdTRGRUVcdTY1MzlcdTdFRDNcdTY3NUYgXHUzMDExXHUzMDExXHUzMDExXG5cbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgXHVEODNEXHVEQzREIFtcdTVCQTFcdTY4MzhcdTkwMUFcdThGQzddOiAke3Rhc2suaWRlYX1gKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gMi4gXHU2MkQyXHU3RUREXHVGRjFBXHU4QkJFXHU3RjZFXHU1MzlGXHU1NkUwXHVGRjBDXHU1ODlFXHU1MkEwXHU5MUNEXHU4QkQ1XHU2QjIxXHU2NTcwXHVGRjBDXHU2NTNFXHU1MTY1XHU0RkVFXHU2QjYzXHU5NjFGXHU1MjE3XG4gICAgICAgICAgICAgICAgdGFzay5yZWFzb24gPSByZWFzb247XG4gICAgICAgICAgICAgICAgdGFzay5yZXRyaWVzID0gKHRhc2sucmV0cmllcyB8fCAwKSArIDE7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5yZXZpc2lvblF1ZXVlLnB1c2godGFzayk7XG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBcdUQ4M0RcdURDNEUgW1x1NUJBMVx1NjgzOFx1NjJEMlx1N0VERF06ICR7dGFzay5pZGVhfSAtICR7cmVhc29ufWApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gXHU1OTgyXHU2NzlDXHU1M0QxXHU3M0IwXHU0RTg2XHU2NUIwXHU2OTgyXHU1RkY1XHVGRjBDXHU1QzA2XHU1QjgzXHU0RUVDXHU2REZCXHU1MkEwXHU1MjMwXHU3NTFGXHU2MjEwXHU5NjFGXHU1MjE3XHU0RTJEXG4gICAgICAgIGlmIChuZXdJZGVhc0ZvdW5kLnNpemUgPiAwKSB7XG4gICAgICAgICAgICB0aGlzLmFkZENvbmNlcHRzVG9RdWV1ZShBcnJheS5mcm9tKG5ld0lkZWFzRm91bmQpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVQbHVnaW5EYXRhKCk7IC8vIFx1NEZERFx1NUI1OFx1NUJBMVx1NjgzOC9cdTRGRUVcdTZCNjMvXHU3NTFGXHU2MjEwXHU5NjFGXHU1MjE3XHU3Njg0XHU1M0Q4XHU1MkE4XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFx1OEZEMFx1ODg0Q1x1MjAxQ1x1NEZFRVx1NkI2M1x1MjAxRFx1OTYzNlx1NkJCNVxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPGJvb2xlYW4+fSBcdTY2MkZcdTU0MjZcdTU5MDRcdTc0MDZcdTRFODZcdTRFRkJcdTUyQTFcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIHJ1blJldmlzaW9uUGhhc2UoKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgICAgIGNvbnN0IHF1ZXVlID0gdGhpcy5wbHVnaW4uZGF0YS5yZXZpc2lvblF1ZXVlO1xuICAgICAgICBpZiAocXVldWUubGVuZ3RoID09PSAwKSByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgY29uc3QgYmF0Y2hTaXplID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhdGlvbl9iYXRjaF9zaXplO1xuICAgICAgICBjb25zdCB0YXNrc1RvUmV2aXNlID0gcXVldWUuc3BsaWNlKDAsIE1hdGgubWluKHF1ZXVlLmxlbmd0aCwgYmF0Y2hTaXplKSk7XG5cbiAgICAgICAgdGhpcy51cGRhdGVTdGF0dXNCYXIoKTtcbiAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVBsdWdpbkRhdGEoKTsgLy8gXHU0RkREXHU1QjU4XHU1REYyXHU1M0Q2XHU1MUZBXHU3Njg0XHU5NjFGXHU1MjE3XHU3MkI2XHU2MDAxXG5cbiAgICAgICAgZm9yIChjb25zdCB0YXNrIG9mIHRhc2tzVG9SZXZpc2UpIHtcbiAgICAgICAgICAgIC8vIFx1NjhDMFx1NjdFNVx1NjYyRlx1NTQyNlx1OEZCRVx1NTIzMFx1NjcwMFx1NTkyN1x1OTFDRFx1OEJENVx1NkIyMVx1NjU3MFxuICAgICAgICAgICAgaWYgKCh0YXNrLnJldHJpZXMgfHwgMCkgPj0gdGhpcy5wbHVnaW4uc2V0dGluZ3MubWF4X3JldmlzaW9uX3JldHJpZXMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLmRpc2NhcmRlZFBpbGUucHVzaCh0YXNrKTsgLy8gXHU2NTNFXHU1MTY1XHU0RTIyXHU1RjAzXHU1ODA2XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgXHVEODNEXHVEQzgwIFtcdTY1M0VcdTVGMDNcdTRGRUVcdTZCNjNdOiAke3Rhc2suaWRlYX0gXHU1REYyXHU4RkJFXHU2NzAwXHU1OTI3XHU5MUNEXHU4QkQ1XHU2QjIxXHU2NTcwXHUzMDAyYCk7XG4gICAgICAgICAgICAgICAgY29udGludWU7IC8vIFx1NEUwRFx1NTE4RFx1NTkwNFx1NzQwNlx1NkI2NFx1NEVGQlx1NTJBMVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gXHU2NzJBXHU4RkJFXHU1MjMwXHU2QjIxXHU2NTcwXHVGRjBDXHU2MjY3XHU4ODRDXHU0RkVFXHU2QjYzXHU0RUZCXHU1MkExXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnJldmlzaW9uVGFzayh0YXNrKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVQbHVnaW5EYXRhKCk7IC8vIFx1NEZERFx1NUI1OFx1NEVGQlx1NTJBMVx1N0VEM1x1Njc5Q1x1RkYwOFx1OEZEQlx1NTE2NVx1NUJBMVx1NjgzOFx1OTYxRlx1NTIxN1x1NjIxNlx1NEUyMlx1NUYwM1x1NTgwNlx1RkYwOVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBcdTUzNTVcdTRFMkFcdTRGRUVcdTZCNjNcdTRFRkJcdTUyQTFcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIHJldmlzaW9uVGFzayh0YXNrOiBUYXNrRGF0YSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLnJldmlzZXIuY3JlYXRlUmV2aXNpb25Qcm9tcHQodGFzay5pZGVhLCB0YXNrLmNvbnRlbnQsIHRhc2sucmVhc29uIHx8IFwiXHU2NzJBXHU3N0U1XHU1MzlGXHU1NkUwXCIpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgbmV3Q29udGVudCA9IGF3YWl0IHRoaXMuYXBpSGFuZGxlci5jYWxsKHByb21wdCk7XG4gICAgICAgICAgICBjb25zdCBjbGVhbmVkQ29udGVudCA9IGNsZWFuTWFya2Rvd25PdXRwdXQobmV3Q29udGVudCk7XG4gICAgICAgICAgICBjb25zdCByZXZpc2VkVGFzazogVGFza0RhdGEgPSB7IC4uLnRhc2ssIGNvbnRlbnQ6IGNsZWFuZWRDb250ZW50IH07XG4gICAgICAgICAgICAvLyBcdTRGRUVcdTZCNjNcdTU0MEVcdUZGMENcdTY1M0VcdTU2REVcdTVCQTFcdTY4MzhcdTk2MUZcdTUyMTdcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLmRhdGEucmV2aWV3UXVldWUucHVzaChyZXZpc2VkVGFzayk7IFxuICAgICAgICAgICAgY29uc29sZS5sb2coYFx1RDgzRFx1REQwNCBbXHU0RkVFXHU2QjYzXHU1QjhDXHU2MjEwXTogJHt0YXNrLmlkZWF9YCk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYFx1Mjc0QyBbXHU0RkVFXHU2QjYzXHU1OTMxXHU4RDI1XTogJHt0YXNrLmlkZWF9IC0gJHtlLm1lc3NhZ2V9YCk7XG4gICAgICAgICAgICAvLyBcdTU5MzFcdThEMjVcdTU0MEVcdUZGMENcdTY1M0VcdTU2REVcdTRGRUVcdTZCNjNcdTk2MUZcdTUyMTdcdTU5MzRcdTkwRThcdUZGMENcdTRFMEJcdTZCMjFcdTRGMThcdTUxNDhcdTkxQ0RcdThCRDVcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLmRhdGEucmV2aXNpb25RdWV1ZS51bnNoaWZ0KHRhc2spOyBcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIC0tLSBGaWxlICYgVUkgLS0tXG5cbiAgICAvKipcbiAgICAgKiBcdTRGRERcdTVCNThcdTdCMTRcdThCQjBcdTUyMzBcdTY1ODdcdTRFRjZcdTdDRkJcdTdFREZcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIHNhdmVOb3RlKGlkZWE6IHN0cmluZywgY29udGVudDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGZpbGVuYW1lID0gc2FuaXRpemVGaWxlbmFtZShpZGVhKTtcbiAgICAgICAgY29uc3QgZm9sZGVyUGF0aCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLm91dHB1dF9kaXI7XG5cbiAgICAgICAgLy8gXHU2OEMwXHU2N0U1XHU2NTg3XHU0RUY2XHU1OTM5XHU2NjJGXHU1NDI2XHU1QjU4XHU1NzI4XHVGRjBDXHU0RTBEXHU1QjU4XHU1NzI4XHU1MjE5XHU1MjFCXHU1RUZBXG4gICAgICAgIGlmICghKHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmb2xkZXJQYXRoKSBpbnN0YW5jZW9mIFRGb2xkZXIpKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZUZvbGRlcihmb2xkZXJQYXRoKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgXHU1MjFCXHU1RUZBXHU2NTg3XHU0RUY2XHU1OTM5XHU1OTMxXHU4RDI1OiAke2ZvbGRlclBhdGh9YCwgZXJyb3IpO1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYFx1NjVFMFx1NkNENVx1NTIxQlx1NUVGQVx1OEY5M1x1NTFGQVx1NjU4N1x1NEVGNlx1NTkzOTogJHtmb2xkZXJQYXRofWApO1xuICAgICAgICAgICAgICAgIHJldHVybjsgLy8gXHU2NUUwXHU2Q0Q1XHU1MjFCXHU1RUZBXHU2NTg3XHU0RUY2XHU1OTM5XHVGRjBDXHU1MDVDXHU2QjYyXHU0RkREXHU1QjU4XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZpbGVQYXRoID0gbm9ybWFsaXplUGF0aChgJHtmb2xkZXJQYXRofS8ke2ZpbGVuYW1lfS5tZGApO1xuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVQYXRoKTtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xuICAgICAgICAgICAgICAgIC8vIFx1NjU4N1x1NEVGNlx1NURGMlx1NUI1OFx1NTcyOFx1RkYwQ1x1NEZFRVx1NjUzOVx1NTE4NVx1NUJCOVxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBjb250ZW50KTtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKGBcdTdCMTRcdThCQjBcdTVERjJcdTY2RjRcdTY1QjA6ICR7ZmlsZW5hbWV9YCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIFx1NjU4N1x1NEVGNlx1NEUwRFx1NUI1OFx1NTcyOFx1RkYwQ1x1NTIxQlx1NUVGQVx1NjVCMFx1NjU4N1x1NEVGNlxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZShmaWxlUGF0aCwgY29udGVudCk7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShgXHU3QjE0XHU4QkIwXHU1REYyXHU1MjFCXHU1RUZBOiAke2ZpbGVuYW1lfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihgXHU0RkREXHU1QjU4XHU3QjE0XHU4QkIwXHU1OTMxXHU4RDI1OiAke2ZpbGVQYXRofWAsIGVycm9yKTtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYFx1NjVFMFx1NkNENVx1NEZERFx1NUI1OFx1N0IxNFx1OEJCMDogJHtmaWxlbmFtZX1gKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFx1NjZGNFx1NjVCMFx1NzJCNlx1NjAwMVx1NjgwRlx1NjYzRVx1NzkzQVxuICAgICAqL1xuICAgIHB1YmxpYyB1cGRhdGVTdGF0dXNCYXIoKTogdm9pZCB7XG4gICAgICAgIGlmICghdGhpcy5wbHVnaW4uc3RhdHVzQmFyRWwpIHJldHVybjtcbiAgICAgICAgY29uc3QgeyBnZW5lcmF0aW9uUXVldWUsIHJldmlld1F1ZXVlLCByZXZpc2lvblF1ZXVlIH0gPSB0aGlzLnBsdWdpbi5kYXRhO1xuICAgICAgICBjb25zdCB0b3RhbCA9IGdlbmVyYXRpb25RdWV1ZS5sZW5ndGggKyByZXZpZXdRdWV1ZS5sZW5ndGggKyByZXZpc2lvblF1ZXVlLmxlbmd0aDtcbiAgICAgICAgLy8gXHU3OTNBXHU0RjhCOiBLRzogcnVubmluZyB8IEc6NSB8IEM6MiB8IFI6MSB8IFRvdGFsOjhcbiAgICAgICAgdGhpcy5wbHVnaW4uc3RhdHVzQmFyRWwuc2V0VGV4dChcbiAgICAgICAgICAgIGBLRzogJHt0aGlzLnBsdWdpbi5kYXRhLnN0YXR1c30gfCBHOiR7Z2VuZXJhdGlvblF1ZXVlLmxlbmd0aH0gfCBDOiR7cmV2aWV3UXVldWUubGVuZ3RofSB8IFI6JHtyZXZpc2lvblF1ZXVlLmxlbmd0aH0gfCBUb3RhbDoke3RvdGFsfWBcbiAgICAgICAgKTtcbiAgICB9XG59XG4iLCAiLy8gYXBpSGFuZGxlci50cyAoXHU2NzAwXHU3RUM4XHU0RjE4XHU1MzE2XHU3MjQ4IC0gXHU5NkM2XHU2MjEwXHU3Q0JFXHU3RUM2XHU5NTE5XHU4QkVGXHU1OTA0XHU3NDA2XHU0RTBFXHU4MUVBXHU1MkE4XHU2MDYyXHU1OTBEKVxuXG5pbXBvcnQgeyByZXF1ZXN0VXJsLCBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBLbm93bGVkZ2VHcmFwaFBsdWdpblNldHRpbmdzLCBLZXlVc2FnZVN0YXR1cyB9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IEtub3dsZWRnZUdyYXBoUGx1Z2luIGZyb20gJy4vbWFpbic7XG5cbmV4cG9ydCBjbGFzcyBBcGlLZXlFeGhhdXN0ZWRFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgICBjb25zdHJ1Y3RvcihtZXNzYWdlOiBzdHJpbmcpIHtcbiAgICAgICAgc3VwZXIobWVzc2FnZSk7XG4gICAgICAgIHRoaXMubmFtZSA9ICdBcGlLZXlFeGhhdXN0ZWRFcnJvcic7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgQWxsTW9kZWxzRmFpbGVkRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gICAgY29uc3RydWN0b3IobWVzc2FnZTogc3RyaW5nKSB7XG4gICAgICAgIHN1cGVyKG1lc3NhZ2UpO1xuICAgICAgICB0aGlzLm5hbWUgPSAnQWxsTW9kZWxzRmFpbGVkRXJyb3InO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIEFQSUhhbmRsZXIge1xuICAgIHByaXZhdGUgcGx1Z2luOiBLbm93bGVkZ2VHcmFwaFBsdWdpbjtcbiAgICBwcml2YXRlIHNldHRpbmdzOiBLbm93bGVkZ2VHcmFwaFBsdWdpblNldHRpbmdzO1xuICAgIHByaXZhdGUgb3BlbmFpX2tleXM6IHN0cmluZ1tdO1xuICAgIHByaXZhdGUgZ29vZ2xlX2tleXM6IHN0cmluZ1tdO1xuICAgIHByaXZhdGUga2V5VXNhZ2VPcGVuQUk6IE1hcDxzdHJpbmcsIEtleVVzYWdlU3RhdHVzPiA9IG5ldyBNYXAoKTtcbiAgICBwcml2YXRlIGtleVVzYWdlR29vZ2xlOiBNYXA8c3RyaW5nLCBLZXlVc2FnZVN0YXR1cz4gPSBuZXcgTWFwKCk7XG4gICAgXG4gICAgLy8gXHU3NTI4XHU0RThFXHU4RERGXHU4RTJBXHU2NjJGXHU1NDI2XHU1REYyXHU3RUNGXHU5MDFBXHU3N0U1XHU4RkM3XHU2NTQ1XHU5NjlDXHU1MjA3XHU2MzYyXG4gICAgcHJpdmF0ZSBoYXNOb3RpZmllZEZhaWxvdmVyOiBib29sZWFuID0gZmFsc2U7IFxuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBLbm93bGVkZ2VHcmFwaFBsdWdpbikge1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHBsdWdpbi5zZXR0aW5ncztcbiAgICAgICAgdGhpcy51cGRhdGVLZXlzKCk7XG4gICAgfVxuXG4gICAgdXBkYXRlS2V5cygpIHtcbiAgICAgICAgdGhpcy5vcGVuYWlfa2V5cyA9IHRoaXMuc2V0dGluZ3Mub3BlbmFpX2FwaV9rZXlzLnNwbGl0KCdcXG4nKS5tYXAoayA9PiBrLnRyaW0oKSkuZmlsdGVyKEJvb2xlYW4pO1xuICAgICAgICB0aGlzLmdvb2dsZV9rZXlzID0gdGhpcy5zZXR0aW5ncy5nb29nbGVfYXBpX2tleXMuc3BsaXQoJ1xcbicpLm1hcChrID0+IGsudHJpbSgpKS5maWx0ZXIoQm9vbGVhbik7XG5cbiAgICAgICAgdGhpcy5vcGVuYWlfa2V5cy5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgICAgICBpZiAoIXRoaXMua2V5VXNhZ2VPcGVuQUkuaGFzKGtleSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmtleVVzYWdlT3BlbkFJLnNldChrZXksIHsgZmFpbHM6IDAsIGNvb2xkb3duX3VudGlsOiAwIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5nb29nbGVfa2V5cy5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgICAgICBpZiAoIXRoaXMua2V5VXNhZ2VHb29nbGUuaGFzKGtleSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmtleVVzYWdlR29vZ2xlLnNldChrZXksIHsgZmFpbHM6IDAsIGNvb2xkb3duX3VudGlsOiAwIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIF9zZWxlY3RLZXkoa2V5czogc3RyaW5nW10sIHByb3ZpZGVyOiAnb3BlbmFpJyB8ICdnb29nbGUnKTogc3RyaW5nIHwgbnVsbCB7XG4gICAgICAgIGNvbnN0IGtleVVzYWdlTWFwID0gcHJvdmlkZXIgPT09ICdvcGVuYWknID8gdGhpcy5rZXlVc2FnZU9wZW5BSSA6IHRoaXMua2V5VXNhZ2VHb29nbGU7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRUaW1lID0gRGF0ZS5ub3coKSAvIDEwMDA7XG4gICAgICAgIFxuICAgICAgICBmb3IgKGNvbnN0IGtleSBvZiBrZXlzKSB7XG4gICAgICAgICAgICBjb25zdCB1c2FnZSA9IGtleVVzYWdlTWFwLmdldChrZXkpO1xuICAgICAgICAgICAgaWYgKHVzYWdlICYmIGN1cnJlbnRUaW1lID49IHVzYWdlLmNvb2xkb3duX3VudGlsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGtleTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIF9jYWxsT3BlbkFJKGtleTogc3RyaW5nLCBwcm9tcHQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3RVcmwoe1xuICAgICAgICAgICAgICAgIHVybDogYCR7dGhpcy5zZXR0aW5ncy5vcGVuYWlfYmFzZV91cmx9L2NoYXQvY29tcGxldGlvbnNgLFxuICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiQXV0aG9yaXphdGlvblwiOiBgQmVhcmVyICR7a2V5fWBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICAgICAgbW9kZWw6IHRoaXMuc2V0dGluZ3Mub3BlbmFpX21vZGVsLFxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlczogW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiBwcm9tcHQgfV0sXG4gICAgICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiB0aGlzLnNldHRpbmdzLmdlbmVyYXRpb25fdGVtcGVyYXR1cmUsXG4gICAgICAgICAgICAgICAgICAgIG1heF90b2tlbnM6IHRoaXMuc2V0dGluZ3MuZ2VuZXJhdGlvbl9tYXhfdG9rZW5zXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc3QgZGF0YSA9IHJlc3BvbnNlLmpzb247XG4gICAgICAgICAgICBjb25zdCBrZXlVc2FnZSA9IHRoaXMua2V5VXNhZ2VPcGVuQUkuZ2V0KGtleSk7XG4gICAgICAgICAgICBpZiAoa2V5VXNhZ2UpIGtleVVzYWdlLmNvb2xkb3duX3VudGlsID0gMDsgLy8gXHU2MjEwXHU1MjlGXHU1MjE5XHU2RTA1XHU5NjY0XHU1MUI3XHU1Mzc0XG5cbiAgICAgICAgICAgIC8vIFx1MzAxMFx1NjVCMFx1NTg5RVx1MzAxMVx1NjIxMFx1NTI5Rlx1OEMwM1x1NzUyOCBPcGVuQUkgQVBJIFx1NTQwRVx1RkYwQ1x1OTFDRFx1N0Y2RVx1NjU0NVx1OTY5Q1x1NTIwN1x1NjM2Mlx1NjgwN1x1NUZEN1xuICAgICAgICAgICAgdGhpcy5oYXNOb3RpZmllZEZhaWxvdmVyID0gZmFsc2U7XG5cbiAgICAgICAgICAgIHJldHVybiBkYXRhLmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50LnRyaW0oKTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBPcGVuQUkgQVBJIGNhbGwgZmFpbGVkIGZvciBrZXkgLi4uJHtrZXkuc2xpY2UoLTQpfTpgLCBlcnJvcik7XG4gICAgICAgICAgICBjb25zdCBrZXlVc2FnZSA9IHRoaXMua2V5VXNhZ2VPcGVuQUkuZ2V0KGtleSk7XG4gICAgICAgICAgICBpZiAoa2V5VXNhZ2UpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBodHRwU3RhdHVzID0gZXJyb3Iuc3RhdHVzO1xuICAgICAgICAgICAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGVycm9yLm1lc3NhZ2U/LnRvTG93ZXJDYXNlKCkgfHwgJyc7XG5cbiAgICAgICAgICAgICAgICAvLyBcdTVCRjlcdTRFOEVcdThCQTRcdThCQzFcdTMwMDFcdTY3NDNcdTk2NTBcdTMwMDFcdTk4OURcdTVFQTZcdTk1RUVcdTk4OThcdUZGMENcdTVFOTRcdTc1MjhcdTVCOENcdTY1NzRcdTc2ODRcdTUxQjdcdTUzNzRcdTY1RjZcdTk1RjRcbiAgICAgICAgICAgICAgICBpZiAoaHR0cFN0YXR1cyA9PT0gNDAxIHx8IGh0dHBTdGF0dXMgPT09IDQwMyB8fCBodHRwU3RhdHVzID09PSA0MjkgfHwgZXJyb3JNZXNzYWdlLmluY2x1ZGVzKCdpbnN1ZmZpY2llbnRfcXVvdGEnKSB8fCBlcnJvck1lc3NhZ2UuaW5jbHVkZXMoJ3JhdGUgbGltaXQnKSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYEtleSAuLi4ke2tleS5zbGljZSgtNCl9IGV4aGF1c3RlZC4gQXBwbHlpbmcgZnVsbCBjb29sZG93bi5gKTtcbiAgICAgICAgICAgICAgICAgICAga2V5VXNhZ2UuY29vbGRvd25fdW50aWwgPSBEYXRlLm5vdygpIC8gMTAwMCArIHRoaXMuc2V0dGluZ3MuZmFpbG92ZXJfY29vbGRvd25fc2Vjb25kcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gXHU1QkY5XHU0RThFXHU3RjUxXHU3RURDXHU2MjE2XHU2NzBEXHU1MkExXHU1NjY4XHU0RTM0XHU2NUY2XHU5NUVFXHU5ODk4XHVGRjBDXHU0RTBEXHU1RTk0XHU3NTI4XHU5NTdGXHU2NUY2XHU5NUY0XHU3Njg0XHU1MUI3XHU1Mzc0XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgS2V5IC4uLiR7a2V5LnNsaWNlKC00KX0gZmFpbGVkIGR1ZSB0byBuZXR3b3JrL3NlcnZlciBlcnJvci4gTm8gY29vbGRvd24gYXBwbGllZC5gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aHJvdyBuZXcgQXBpS2V5RXhoYXVzdGVkRXJyb3IoYE9wZW5BSSBrZXkgZmFpbGVkLmApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBfY2FsbEdvb2dsZUFQSShrZXk6IHN0cmluZywgcHJvbXB0OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgICAgICBjb25zdCB1cmwgPSBgaHR0cHM6Ly9nZW5lcmF0aXZlbGFuZ3VhZ2UuZ29vZ2xlYXBpcy5jb20vdjFiZXRhL21vZGVscy8ke3RoaXMuc2V0dGluZ3MuZ29vZ2xlX21vZGVsfTpnZW5lcmF0ZUNvbnRlbnQ/a2V5PSR7a2V5fWA7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3RVcmwoe1xuICAgICAgICAgICAgICAgIHVybCxcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcbiAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnRzOiBbeyBwYXJ0czogW3sgdGV4dDogcHJvbXB0IH1dIH1dLFxuICAgICAgICAgICAgICAgICAgICBnZW5lcmF0aW9uQ29uZmlnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogdGhpcy5zZXR0aW5ncy5nZW5lcmF0aW9uX3RlbXBlcmF0dXJlLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWF4T3V0cHV0VG9rZW5zOiB0aGlzLnNldHRpbmdzLmdlbmVyYXRpb25fbWF4X3Rva2Vuc1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgY29uc3QgZGF0YSA9IHJlc3BvbnNlLmpzb247XG4gICAgICAgICAgICBpZiAoIWRhdGEuY2FuZGlkYXRlcyB8fCBkYXRhLmNhbmRpZGF0ZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQVBJIHJlc3BvbnNlIGlzIG1pc3NpbmcgY2FuZGlkYXRlcy4gRnVsbCByZXNwb25zZTogXCIgKyBKU09OLnN0cmluZ2lmeShkYXRhKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBrZXlVc2FnZSA9IHRoaXMua2V5VXNhZ2VHb29nbGUuZ2V0KGtleSk7XG4gICAgICAgICAgICBpZiAoa2V5VXNhZ2UpIGtleVVzYWdlLmNvb2xkb3duX3VudGlsID0gMDsgLy8gXHU2MjEwXHU1MjlGXHU1MjE5XHU2RTA1XHU5NjY0XHU1MUI3XHU1Mzc0XG4gICAgICAgICAgICByZXR1cm4gZGF0YS5jYW5kaWRhdGVzWzBdLmNvbnRlbnQucGFydHNbMF0udGV4dC50cmltKCk7XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihgR29vZ2xlIEdlbWluaSBBUEkgY2FsbCBmYWlsZWQgZm9yIGtleSAuLi4ke2tleS5zbGljZSgtNCl9OmAsIGVycm9yKTtcbiAgICAgICAgICAgIGNvbnN0IGtleVVzYWdlID0gdGhpcy5rZXlVc2FnZUdvb2dsZS5nZXQoa2V5KTtcbiAgICAgICAgICAgIGlmIChrZXlVc2FnZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGh0dHBTdGF0dXMgPSBlcnJvci5zdGF0dXM7XG4gICAgICAgICAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IubWVzc2FnZT8udG9Mb3dlckNhc2UoKSB8fCAnJztcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiAoaHR0cFN0YXR1cyA9PT0gNDAxIHx8IGh0dHBTdGF0dXMgPT09IDQwMyB8fCBodHRwU3RhdHVzID09PSA0MjkgfHwgZXJyb3JNZXNzYWdlLmluY2x1ZGVzKCdxdW90YScpIHx8IGVycm9yTWVzc2FnZS5pbmNsdWRlcygncGVybWlzc2lvbicpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgR29vZ2xlIEtleSAuLi4ke2tleS5zbGljZSgtNCl9IGV4aGF1c3RlZC4gQXBwbHlpbmcgZnVsbCBjb29sZG93bi5gKTtcbiAgICAgICAgICAgICAgICAgICAga2V5VXNhZ2UuY29vbGRvd25fdW50aWwgPSBEYXRlLm5vdygpIC8gMTAwMCArIHRoaXMuc2V0dGluZ3MuZmFpbG92ZXJfY29vbGRvd25fc2Vjb25kcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgR29vZ2xlIEtleSAuLi4ke2tleS5zbGljZSgtNCl9IGZhaWxlZCBkdWUgdG8gbmV0d29yay9zZXJ2ZXIgZXJyb3IuIE5vIGNvb2xkb3duIGFwcGxpZWQuYCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhyb3cgbmV3IEFwaUtleUV4aGF1c3RlZEVycm9yKGBHb29nbGUgR2VtaW5pIGtleSBmYWlsZWQuYCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgY2FsbChwcm9tcHQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIHRoaXMudXBkYXRlS2V5cygpOyAvLyBcdTc4NkVcdTRGRERcdTRGN0ZcdTc1MjhcdTY3MDBcdTY1QjBcdTc2ODQga2V5c1xuICAgICAgICBsZXQgbGFzdEVycm9yOiBFcnJvciB8IG51bGwgPSBudWxsO1xuICAgICAgICBsZXQgb3BlbkFJS2V5c0F0dGVtcHRlZCA9IGZhbHNlOyBcblxuICAgICAgICAvLyAxLiBcdTVDMURcdThCRDUgT3BlbkFJXG4gICAgICAgIGlmICh0aGlzLm9wZW5haV9rZXlzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIG9wZW5BSUtleXNBdHRlbXB0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm9wZW5haV9rZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qga2V5ID0gdGhpcy5fc2VsZWN0S2V5KHRoaXMub3BlbmFpX2tleXMsICdvcGVuYWknKTtcbiAgICAgICAgICAgICAgICBpZiAoa2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgVHJ5aW5nIE9wZW5BSSBrZXkgLi4uJHtrZXkuc2xpY2UoLTQpfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuX2NhbGxPcGVuQUkoa2V5LCBwcm9tcHQpO1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsYXN0RXJyb3IgPSBlO1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZShgT3BlbkFJIGtleSAuLi4ke2tleS5zbGljZSgtNCl9IGZhaWxlZC4gVHJ5aW5nIG5leHQuYCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyAyLiBcdTVDMURcdThCRDUgR29vZ2xlXG4gICAgICAgIGlmICh0aGlzLmdvb2dsZV9rZXlzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIC8vIFx1NTk4Mlx1Njc5Q1x1NUMxRFx1OEJENVx1OEZDNyBPcGVuQUkgXHU0RjQ2XHU5MEZEXHU1OTMxXHU4RDI1XHU0RTg2XHVGRjBDXHU1RTc2XHU0RTE0XHU4RkQ5XHU2NjJGXHU3QjJDXHU0RTAwXHU2QjIxXHU1MjA3XHU2MzYyXHU1MjMwIEdvb2dsZVx1RkYwQ1x1NTIxOVx1OTAxQVx1NzdFNVx1NzUyOFx1NjIzN1xuICAgICAgICAgICAgaWYgKG9wZW5BSUtleXNBdHRlbXB0ZWQgJiYgIXRoaXMuaGFzTm90aWZpZWRGYWlsb3Zlcikge1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ0FsbCBPcGVuQUkga2V5cyBmYWlsZWQgb3IgdW5hdmFpbGFibGUuIFN3aXRjaGluZyB0byBHb29nbGUgR2VtaW5pLi4uJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5oYXNOb3RpZmllZEZhaWxvdmVyID0gdHJ1ZTsgLy8gXHU2ODA3XHU4QkIwXHU0RTNBXHU1REYyXHU5MDFBXHU3N0U1XHVGRjBDXHU5MDdGXHU1MTREXHU5MUNEXHU1OTBEXHU5MDFBXHU3N0U1XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5nb29nbGVfa2V5cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGtleSA9IHRoaXMuX3NlbGVjdEtleSh0aGlzLmdvb2dsZV9rZXlzLCAnZ29vZ2xlJyk7XG4gICAgICAgICAgICAgICAgaWYgKGtleSkge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYFRyeWluZyBHb29nbGUgR2VtaW5pIGtleSAuLi4ke2tleS5zbGljZSgtNCl9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5fY2FsbEdvb2dsZUFQSShrZXksIHByb21wdCk7XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RFcnJvciA9IGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKGBHb29nbGUgR2VtaW5pIGtleSAuLi4ke2tleS5zbGljZSgtNCl9IGZhaWxlZC4gVHJ5aW5nIG5leHQuYCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyAzLiBcdTUxNjhcdTkwRThcdTU5MzFcdThEMjVcbiAgICAgICAgdGhyb3cgbmV3IEFsbE1vZGVsc0ZhaWxlZEVycm9yKGBBbGwgQVBJIHByb3ZpZGVycyBmYWlsZWQuIExhc3QgZXJyb3I6ICR7bGFzdEVycm9yPy5tZXNzYWdlfWApO1xuICAgIH1cbn1cbiIsICIvLyBjcml0aWMudHNcblxuaW1wb3J0IEtub3dsZWRnZUdyYXBoUGx1Z2luIGZyb20gJy4vbWFpbic7XG5pbXBvcnQgeyBBUElIYW5kbGVyIH0gZnJvbSAnLi9hcGlIYW5kbGVyJztcblxuZXhwb3J0IGNsYXNzIENyaXRpYyB7XG4gICAgcHJpdmF0ZSBwbHVnaW46IEtub3dsZWRnZUdyYXBoUGx1Z2luO1xuICAgIHByaXZhdGUgYXBpSGFuZGxlcjogQVBJSGFuZGxlcjtcblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogS25vd2xlZGdlR3JhcGhQbHVnaW4pIHtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgICAgIHRoaXMuYXBpSGFuZGxlciA9IG5ldyBBUElIYW5kbGVyKHBsdWdpbik7IC8vIENyaXRpYyBjYW4gaGF2ZSBpdHMgb3duIGhhbmRsZXIgaWYgbmVlZGVkXG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIGp1ZGdlKGNvbnRlbnQ6IHN0cmluZyk6IFByb21pc2U8eyBpc0FwcHJvdmVkOiBib29sZWFuLCByZWFzb246IHN0cmluZyB9PiB7XG4gICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jcml0aWNfbW9kZSA9PT0gJ2FpJykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2p1ZGdlQnlBSShjb250ZW50KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fanVkZ2VCeUhldXJpc3RpYyhjb250ZW50KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIF9qdWRnZUJ5SGV1cmlzdGljKGNvbnRlbnQ6IHN0cmluZyk6IHsgaXNBcHByb3ZlZDogYm9vbGVhbiwgcmVhc29uOiBzdHJpbmcgfSB7XG4gICAgICAgIGNvbnN0IHJlYXNvbnM6IHN0cmluZ1tdID0gW107XG4gICAgICAgIGNvbnN0IGNvbnRlbnRMb3dlciA9IGNvbnRlbnQudG9Mb3dlckNhc2UoKTtcblxuICAgICAgICAvLyAxLiBDaGVjayBmb3IgcmVxdWlyZWQgaGVhZGVyc1xuICAgICAgICBjb25zdCByZXF1aXJlZEhlYWRlcnMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jcml0aWNfcmVxdWlyZWRfaGVhZGVyc1xuICAgICAgICAgICAgLnNwbGl0KCdcXG4nKS5tYXAoaCA9PiBoLnRyaW0oKS50b0xvd2VyQ2FzZSgpKS5maWx0ZXIoQm9vbGVhbik7XG4gICAgICAgIGNvbnN0IG1pc3NpbmdIZWFkZXJzID0gcmVxdWlyZWRIZWFkZXJzLmZpbHRlcihoID0+ICFjb250ZW50TG93ZXIuaW5jbHVkZXMoaCkpO1xuICAgICAgICBpZiAobWlzc2luZ0hlYWRlcnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgcmVhc29ucy5wdXNoKGBcdTdGM0FcdTVDMTFcdTVGQzVcdTk3MDBcdTc2ODRcdTY4MDdcdTk4OTg6ICR7bWlzc2luZ0hlYWRlcnMuam9pbignLCAnKX1gKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIDIuIENoZWNrIGZvciBtaW4gbGVuZ3RoXG4gICAgICAgIGlmIChjb250ZW50Lmxlbmd0aCA8IHRoaXMucGx1Z2luLnNldHRpbmdzLmNyaXRpY19taW5fY29udGVudF9sZW5ndGgpIHtcbiAgICAgICAgICAgIHJlYXNvbnMucHVzaChgXHU1MTg1XHU1QkI5XHU4RkM3XHU3N0VEIChcdTVGNTNcdTUyNEQ6ICR7Y29udGVudC5sZW5ndGh9LCBcdTg5ODFcdTZDNDI6ICR7dGhpcy5wbHVnaW4uc2V0dGluZ3MuY3JpdGljX21pbl9jb250ZW50X2xlbmd0aH0pYCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyAzLiBDaGVjayBmb3IgcmVmdXNhbCBwYXR0ZXJuc1xuICAgICAgICBjb25zdCByZWZ1c2FsUGF0dGVybnMgPSBbXCJcdTRGNUNcdTRFM0FcdTRFMDA/XHU0RTJBQUlcIiwgXCJcdTRGNUNcdTRFM0FcdThCRURcdThBMDBcdTZBMjFcdTU3OEJcIiwgXCJcdTYyMTFcdTRFMERcdTgwRkRcIiwgXCJcdTYyMTFcdTY1RTBcdTZDRDVcIiwgXCJcdTVGODhcdTYyQjFcdTZCNDlcIl07XG4gICAgICAgIGZvciAoY29uc3QgcGF0dGVybiBvZiByZWZ1c2FsUGF0dGVybnMpIHtcbiAgICAgICAgICAgIGlmIChuZXcgUmVnRXhwKHBhdHRlcm4sICdpJykudGVzdChjb250ZW50KSkge1xuICAgICAgICAgICAgICAgIHJlYXNvbnMucHVzaChgXHU1MzA1XHU1NDJCQUlcdTYyRDJcdTdFRERcdThCRUQgKFx1NTMzOVx1OTE0RDogJyR7cGF0dGVybn0nKWApO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaXNBcHByb3ZlZDogcmVhc29ucy5sZW5ndGggPT09IDAsXG4gICAgICAgICAgICByZWFzb246IHJlYXNvbnMubGVuZ3RoID4gMCA/IHJlYXNvbnMuam9pbignOyAnKSA6IFwiXHU5MDFBXHU4RkM3XHU2MjQwXHU2NzA5XHU1NDJGXHU1M0QxXHU1RjBGXHU4OUM0XHU1MjE5XHU2OEMwXHU2N0U1XHUzMDAyXCJcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIF9qdWRnZUJ5QUkoY29udGVudDogc3RyaW5nKTogUHJvbWlzZTx7IGlzQXBwcm92ZWQ6IGJvb2xlYW4sIHJlYXNvbjogc3RyaW5nIH0+IHtcbiAgICAgICAgY29uc3QgcHJvbXB0ID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvbXB0X2NyaXRpYy5yZXBsYWNlKCd7Y29udGVudH0nLCBjb250ZW50KTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5hcGlIYW5kbGVyLmNhbGwocHJvbXB0KTtcbiAgICAgICAgICAgIGNvbnN0IGRlY2lzaW9uTWF0Y2ggPSByZXNwb25zZS5tYXRjaCgvREVDSVNJT046XFxzKihLRUVQfERJU0NBUkQpL2kpO1xuICAgICAgICAgICAgY29uc3QgcmVhc29uTWF0Y2ggPSByZXNwb25zZS5tYXRjaCgvXFxbUkVBU09OOlxccyooW15cXF1dKylcXF0vKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgaXNBcHByb3ZlZCA9IGRlY2lzaW9uTWF0Y2ggPyBkZWNpc2lvbk1hdGNoWzFdLnRvVXBwZXJDYXNlKCkgPT09ICdLRUVQJyA6IGZhbHNlO1xuICAgICAgICAgICAgY29uc3QgcmVhc29uID0gcmVhc29uTWF0Y2ggPyByZWFzb25NYXRjaFsxXS50cmltKCkgOiAoaXNBcHByb3ZlZCA/IFwiQUkgXHU2Mjc5XHU1MUM2XCIgOiBcIkFJIFx1NjJEMlx1N0VERFx1RkYwQ1x1NjcyQVx1NjNEMFx1NEY5Qlx1NjYwRVx1Nzg2RVx1NzQwNlx1NzUzMVwiKTtcblxuICAgICAgICAgICAgcmV0dXJuIHsgaXNBcHByb3ZlZCwgcmVhc29uIH07XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiQUkgQ3JpdGljIGNhbGwgZmFpbGVkOlwiLCBlcnJvcik7XG4gICAgICAgICAgICByZXR1cm4geyBpc0FwcHJvdmVkOiBmYWxzZSwgcmVhc29uOiBgQUkgXHU1QkExXHU2ODM4XHU1NjY4XHU4QzAzXHU3NTI4XHU1OTMxXHU4RDI1OiAke2Vycm9yLm1lc3NhZ2V9YCB9O1xuICAgICAgICB9XG4gICAgfVxufVxuIiwgIi8vIHJldmlzZXIudHNcblxuaW1wb3J0IEtub3dsZWRnZUdyYXBoUGx1Z2luIGZyb20gJy4vbWFpbic7XG5cbmV4cG9ydCBjbGFzcyBSZXZpc2VyIHtcbiAgICBwcml2YXRlIHBsdWdpbjogS25vd2xlZGdlR3JhcGhQbHVnaW47XG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IEtub3dsZWRnZUdyYXBoUGx1Z2luKSB7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVSZXZpc2lvblByb21wdChpZGVhOiBzdHJpbmcsIG9yaWdpbmFsQ29udGVudDogc3RyaW5nLCByZWplY3Rpb25SZWFzb246IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGxldCBwcm9tcHQgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9tcHRfcmV2aXNlcjtcbiAgICAgICAgcHJvbXB0ID0gcHJvbXB0LnJlcGxhY2UoJ3tjb25jZXB0fScsIGlkZWEpO1xuICAgICAgICBwcm9tcHQgPSBwcm9tcHQucmVwbGFjZSgne29yaWdpbmFsX2NvbnRlbnR9Jywgb3JpZ2luYWxDb250ZW50KTtcbiAgICAgICAgcHJvbXB0ID0gcHJvbXB0LnJlcGxhY2UoJ3tyZWplY3Rpb25fcmVhc29ufScsIHJlamVjdGlvblJlYXNvbik7XG4gICAgICAgIHJldHVybiBwcm9tcHQ7XG4gICAgfVxufVxuIiwgIi8vIHV0aWxzLnRzIChcdTUzOUZcdTU5Q0JcdTdBMzNcdTVCOUFcdTcyNDgpXG5cbmV4cG9ydCBmdW5jdGlvbiBzYW5pdGl6ZUZpbGVuYW1lKG5hbWU6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgLy8gXHU3OUZCXHU5NjY0XHU2MkVDXHU1M0Y3XHU1M0NBXHU1MTc2XHU1MTg1XHU1QkI5XG4gICAgbGV0IGNsZWFuTmFtZSA9IG5hbWUucmVwbGFjZSgvXFxzKlxcKC4qXFwpL2csICcnKS50cmltKCk7XG4gICAgLy8gXHU3OUZCXHU5NjY0XHU2NTg3XHU0RUY2XHU3Q0ZCXHU3RURGXHU0RTBEXHU1MTQxXHU4QkI4XHU3Njg0XHU1QjU3XHU3QjI2XG4gICAgY2xlYW5OYW1lID0gY2xlYW5OYW1lLnJlcGxhY2UoL1tcXFxcLyo/OlwiPD58XS9nLCBcIlwiKTtcbiAgICAvLyBcdTk2NTBcdTUyMzZcdTk1N0ZcdTVFQTZcbiAgICByZXR1cm4gY2xlYW5OYW1lLnNsaWNlKDAsIDEwMCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBleHRyYWN0TmV3SWRlYXMoY29udGVudDogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IG1hdGNoZXMgPSBjb250ZW50Lm1hdGNoKC9cXFtcXFsoW15cXF1dKylcXF1cXF0vZyk7XG4gICAgaWYgKCFtYXRjaGVzKSB7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gICAgLy8gXHU0RUNFIFtbTGlua3xBbGlhc11dIFx1NjIxNiBbW0xpbmtdXSBcdTRFMkRcdTYzRDBcdTUzRDYgXCJMaW5rXCJcbiAgICBjb25zdCBpZGVhcyA9IG1hdGNoZXMubWFwKG1hdGNoID0+IHtcbiAgICAgICAgcmV0dXJuIG1hdGNoLnNsaWNlKDIsIC0yKS5zcGxpdCgnfCcpWzBdLnRyaW0oKTtcbiAgICB9KTtcbiAgICByZXR1cm4gWy4uLm5ldyBTZXQoaWRlYXMpXTsgLy8gXHU4RkQ0XHU1NkRFXHU1M0JCXHU5MUNEXHU1NDBFXHU3Njg0XHU3RUQzXHU2NzlDXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjbGVhbk1hcmtkb3duT3V0cHV0KGNvbnRlbnQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgdHJpbW1lZCA9IGNvbnRlbnQudHJpbSgpO1xuICAgIGlmICh0cmltbWVkLnN0YXJ0c1dpdGgoXCJgYGBtYXJrZG93blwiKSAmJiB0cmltbWVkLmVuZHNXaXRoKFwiYGBgXCIpKSB7XG4gICAgICAgIGxldCBjbGVhbmVkID0gdHJpbW1lZC5zdWJzdHJpbmcoXCJgYGBtYXJrZG93blwiLmxlbmd0aCwgdHJpbW1lZC5sZW5ndGggLSBcImBgYFwiLmxlbmd0aCk7XG4gICAgICAgIHJldHVybiBjbGVhbmVkLnRyaW0oKTtcbiAgICB9XG4gICAgcmV0dXJuIHRyaW1tZWQ7XG59XG4iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsSUFBQUEsbUJBQXNFOzs7QUNFdEUsSUFBQUMsbUJBQXVEOzs7QUNBdkQsc0JBQTRDO0FBSXJDLElBQU0sdUJBQU4sY0FBbUMsc0JBQU07QUFBQSxFQW1CNUMsWUFBWSxLQUFVLFFBQThCO0FBQ2hELFVBQU0sR0FBRztBQWhCYjtBQUFBLFNBQVEsY0FBeUM7QUFBQSxNQUM3QyxLQUFLO0FBQUEsTUFDTCxLQUFLO0FBQUEsTUFDTCxLQUFLO0FBQUEsTUFDTCxLQUFLO0FBQUEsSUFDVDtBQUdBO0FBQUEsU0FBUSxpQkFBNkM7QUFBQSxNQUNqRCxLQUFLO0FBQUE7QUFBQSxNQUNMLEtBQUs7QUFBQTtBQUFBLE1BQ0wsS0FBSztBQUFBO0FBQUEsTUFDTCxLQUFL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S0FBSyxRQUFRO0FBQUEsVUFDL0M7QUFDQSxpQkFBTztBQUFBLFFBQ1g7QUFDQSxlQUFPO0FBQUEsTUFDWDtBQUFBLElBQ0osQ0FBQztBQUVELFlBQVEsSUFBSSw4REFBWTtBQUFBLEVBQzVCO0FBQUEsRUFFQSxXQUFXO0FBQ1AsWUFBUSxJQUFJLDhEQUFZO0FBQUEsRUFDNUI7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFPQSxNQUFNLGVBQWU7QUFDakIsVUFBTSxpQkFBaUIsTUFBTSxrQkFBa0I7QUFFL0MsVUFBTSxZQUFZLE1BQU0sS0FBSyxTQUFTO0FBRXRDLFVBQU0sZ0JBQWdCLGFBQWEsQ0FBQztBQUdwQyxTQUFLLFdBQVcsT0FBTyxPQUFPLENBQUMsR0FBRyxrQkFBa0IsZ0JBQWdCLGFBQWE7QUFBQSxFQUNyRjtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFNQSxNQUFNLGVBQWU7QUFDakIsVUFBTSxhQUFhLEVBQUUsR0FBRyxLQUFLLFVBQVUsYUFBYSxLQUFLLEtBQUs7QUFDOUQsVUFBTSxLQUFLLFNBQVMsVUFBVTtBQUFBLEVBQ2xDO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQU1BLE1BQU0saUJBQWlCO0FBRW5CLFVBQU0sWUFBWSxNQUFNLEtBQUssU0FBUztBQUV0QyxVQUFNLGNBQWEsdUNBQVcsZ0JBQWUsQ0FBQztBQUc5QyxTQUFLLE9BQU8sT0FBTyxPQUFPLENBQUMsR0FBRyxxQkFBcUIsVUFBVTtBQUFBLEVBQ2pFO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBT0EsTUFBTSxpQkFBaUI7QUFDbkIsVUFBTSxLQUFLLGFBQWE7QUFBQSxFQUM1QjtBQUNKOyIsCiAgIm5hbWVzIjogWyJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iXQp9Cg==
