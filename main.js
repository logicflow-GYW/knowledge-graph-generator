/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => KnowledgeGraphPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian6 = require("obsidian");

// src/settings.ts
var import_obsidian2 = require("obsidian");

// src/QueueModal.ts
var import_obsidian = require("obsidian");
var QueueManagementModal = class extends import_obsidian.Modal {
  constructor(app, plugin) {
    super(app);
    // 用于保存搜索词
    this.searchTerms = {
      gen: "",
      rev: "",
      rep: "",
      dis: ""
    };
    // 默认全部折叠
    this.collapseStates = {
      gen: false,
      rev: false,
      rep: false,
      dis: false
    };
    this.plugin = plugin;
    this.refreshContent = this.onOpen.bind(this);
  }
  onOpen() {
    const { contentEl } = this;
    this.app.workspace.off("kg-data-updated", this.refreshContent);
    contentEl.empty();
    contentEl.addClass("kg-modal");
    contentEl.createEl("h2", { text: "Queue management dashboard" });
    const status = this.plugin.data.status;
    const statusText = `Status: ${status.toUpperCase()} | ${this.plugin.statusBarEl.getText()}`;
    new import_obsidian.Setting(contentEl).setName(status === "running" ? "Engine running" : "Engine paused").setDesc(statusText).addButton(
      (button) => button.setButtonText(status === "running" ? "Pause engine" : "Start engine").setCta(status !== "running").onClick(() => {
        this.plugin.engine.toggleEngineState();
        this.onOpen();
      })
    );
    this.renderQueueSection(
      contentEl,
      "gen",
      "Pending generation",
      this.plugin.data.generationQueue,
      this.renderGenerationItem.bind(this)
    );
    this.renderQueueSection(
      contentEl,
      "rev",
      "Pending review",
      this.plugin.data.reviewQueue,
      this.renderReviewItem.bind(this)
    );
    this.renderQueueSection(
      contentEl,
      "rep",
      "Pending revision",
      this.plugin.data.revisionQueue,
      this.renderRevisionItem.bind(this)
    );
    this.renderQueueSection(
      contentEl,
      "dis",
      "Discarded pile",
      this.plugin.data.discardedPile,
      this.renderDiscardedItem.bind(this)
    );
    this.app.workspace.on("kg-data-updated", this.refreshContent);
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
    this.app.workspace.off("kg-data-updated", this.refreshContent);
  }
  /**
   * 渲染一个队列区域 (带搜索和展开/折叠)
   */
  renderQueueSection(containerEl, key, title, data, renderFn) {
    const displayLimit = 100;
    const filter = this.searchTerms[key];
    const filteredData = data.filter((item) => {
      if (!filter)
        return true;
      const needle = filter.toLowerCase();
      if (typeof item === "string") {
        return item.toLowerCase().includes(needle);
      }
      return item.idea.toLowerCase().includes(needle);
    });
    const total = data.length;
    const filteredTotal = filteredData.length;
    const titleText = `${title} (${filteredTotal}${total !== filteredTotal ? " / " + total : ""} items)`;
    const details = containerEl.createEl("details");
    details.open = this.collapseStates[key];
    const summary = details.createEl("summary", { text: titleText });
    summary.addClass("kg-modal-summary");
    details.addEventListener("toggle", () => {
      this.collapseStates[key] = details.open;
    });
    new import_obsidian.Setting(details).setDesc(`Search ${title.toLowerCase()}...`).addText((text) => {
      text.setPlaceholder("Enter keywords...").setValue(this.searchTerms[key]).onChange((value) => {
        this.searchTerms[key] = value;
        this.onOpen();
      });
    });
    const truncatedData = filteredData.slice(0, displayLimit);
    if (truncatedData.length === 0) {
      const desc = details.createEl("p", { text: "Queue is empty or no matches found.", cls: "setting-item-description" });
      desc.addClass("kg-queue-desc-empty");
      return;
    }
    const listContainer = details.createDiv("kg-list-container");
    truncatedData.forEach((item, index) => {
      renderFn(listContainer, item, index);
    });
    if (filteredData.length > displayLimit) {
      const truncatedInfo = details.createEl("p", {
        text: `... showing first ${displayLimit} items (total ${filteredData.length}), use search to find more.`,
        cls: "setting-item-description"
      });
      truncatedInfo.addClass("kg-queue-desc-truncated");
    }
  }
  // --- 单项渲染函数 ---
  renderGenerationItem(container, item) {
    const itemName = typeof item === "string" ? item : item.idea;
    new import_obsidian.Setting(container).setName(itemName).addButton(
      (btn) => btn.setIcon("trash").setTooltip("Delete concept").onClick(async () => {
        const queue = this.plugin.data.generationQueue;
        const index = queue.indexOf(itemName);
        if (index > -1) {
          queue.splice(index, 1);
          await this.plugin.savePluginData();
          this.plugin.engine.updateStatusBar();
          this.onOpen();
        }
      })
    );
  }
  renderReviewItem(container, item) {
    const task = item;
    new import_obsidian.Setting(container).setName(`[Review] ${task.idea}`).addButton(
      (btn) => btn.setIcon("trash").setTooltip("Discard task").onClick(async () => {
        this.plugin.data.reviewQueue.splice(this.plugin.data.reviewQueue.indexOf(task), 1);
        this.plugin.data.discardedPile.push(task);
        await this.plugin.savePluginData();
        this.plugin.engine.updateStatusBar();
        this.onOpen();
      })
    );
  }
  renderRevisionItem(container, item) {
    const task = item;
    new import_obsidian.Setting(container).setName(`[Revision] ${task.idea}`).setDesc(`Reason: ${task.reason || "Unknown"}`).addButton(
      (btn) => btn.setIcon("trash").setTooltip("Discard task").onClick(async () => {
        this.plugin.data.revisionQueue.splice(this.plugin.data.revisionQueue.indexOf(task), 1);
        this.plugin.data.discardedPile.push(task);
        await this.plugin.savePluginData();
        this.plugin.engine.updateStatusBar();
        this.onOpen();
      })
    );
  }
  renderDiscardedItem(container, item) {
    const task = item;
    new import_obsidian.Setting(container).setName(`[Discarded] ${task.idea}`).setDesc(`Last reason: ${task.reason || "Unknown"}`).addButton(
      (btn) => btn.setIcon("refresh-cw").setTooltip("Re-queue (generation)").onClick(() => {
        this.plugin.data.discardedPile.splice(this.plugin.data.discardedPile.indexOf(task), 1);
        this.plugin.engine.addConceptsToQueue([task.idea]);
        this.onOpen();
      })
    );
  }
};

// src/utils.ts
var _Logger = class {
  static setDebugMode(debug) {
    _Logger.isDebug = debug;
  }
  // Changed any[] to unknown[] to satisfy linter
  // Changed console.log to console.debug to satisfy linter
  static log(message, ...args) {
    if (_Logger.isDebug) {
      console.debug(`[KG-Gen] ${message}`, ...args);
    }
  }
  static warn(message, ...args) {
    console.warn(`[KG-Gen] ${message}`, ...args);
  }
  static error(message, ...args) {
    console.error(`[KG-Gen] ${message}`, ...args);
  }
};
var Logger = _Logger;
Logger.isDebug = false;
function sanitizeFilename(name) {
  let cleanName = name.replace(/\s*\(.*\)/g, "").trim();
  cleanName = cleanName.replace(/[\\/*?:"<>|]/g, "");
  return cleanName.slice(0, 100);
}
function extractNewIdeas(content) {
  const matches = content.match(/\[\[([^\]]+)\]\]/g);
  if (!matches) {
    return [];
  }
  const ideas = matches.map((match) => {
    return match.slice(2, -2).split("|")[0].trim();
  });
  return [...new Set(ideas)];
}
function cleanMarkdownOutput(content) {
  const trimmed = content.trim();
  if (trimmed.startsWith("```markdown") && trimmed.endsWith("```")) {
    let cleaned = trimmed.substring("```markdown".length, trimmed.length - "```".length);
    return cleaned.trim();
  }
  return trimmed;
}

// src/settings.ts
var PROMPT_GENERATOR_DEFAULT = `# Role
\u4F60\u662F\u4E00\u4F4D**\u6DF1\u5EA6\u7684\u672C\u8D28\u8FD8\u539F\u8005**\u4E0E**\u8BA4\u77E5\u67B6\u6784\u5E08**\u3002
\u4F60\u7684\u76EE\u6807\u662F\u4E3A\u6982\u5FF5 \`{concept}\` \u6784\u5EFA\u4E00\u5F20\u7B26\u5408 Obsidian \u89C6\u89C9\u7F8E\u5B66\uFF08\u9002\u5408\u624B\u673A\u9605\u8BFB\uFF09\u4E14\u5177\u6709\u6781\u9AD8\u601D\u7EF4\u5BC6\u5EA6\u7684\u77E5\u8BC6\u5361\u7247\u3002

# \u6838\u5FC3\u539F\u5219
1.  **\u7B2C\u4E00\u6027\u539F\u7406**\uFF1A\u4E0D\u5806\u780C\u540D\u8BCD\uFF0C\u800C\u662F\u6316\u6398\u8BE5\u6982\u5FF5\u5E95\u5C42\u7684\u201C\u52A8\u529B\u5B66\u673A\u5236\u201D\u3002
2.  **\u6781\u7B80\u89C6\u89C9**\uFF1A\u4E25\u683C\u4F7F\u7528 Obsidian Callout \u548C Mermaid\u3002
3.  **\u6807\u7B7E\u89C4\u8303**\uFF1A**\u5173\u952E**\u3002\u6807\u9898\u4E0B\u65B9\u7684\u6807\u7B7E\u5FC5\u987B\u7B26\u5408 Obsidian \u683C\u5F0F\uFF08\u4F8B\u5982\uFF1A\`#\u8BA4\u77E5\u79D1\u5B66 #\u535A\u5F08\u8BBA\`\uFF09\uFF0C**\u4E95\u53F7\u4E0E\u6587\u5B57\u4E4B\u95F4\u4E0D\u80FD\u6709\u7A7A\u683C**\u3002
4.  **\u56FE\u8C31\u751F\u957F**\uFF1A**\u5173\u952E**\u3002\u5728\u6B63\u6587\u4E2D\u63D0\u5230\u4EFB\u4F55\u76F8\u5173\u7684\u3001\u503C\u5F97\u6DF1\u5165\u7814\u7A76\u7684\u9AD8\u4EF7\u503C\u6982\u5FF5\u65F6\uFF0C\u5FC5\u987B\u4F7F\u7528 \`[[WikiLinks]]\` \u683C\u5F0F\uFF08\u4F8B\u5982\uFF1A[[\u71B5\u589E\u5B9A\u5F8B]]\uFF09\u3002
5.  **\u53BB\u9664\u975EMarkdown\u5185\u5BB9**\uFF1A\u4E0D\u8981\u8F93\u51FA "Here is the content..." \u7B49\u5E9F\u8BDD\uFF0C\u76F4\u63A5\u8F93\u51FA\u7B14\u8BB0\u5185\u5BB9\u3002

# \u8F93\u51FA\u5185\u5BB9\u7ED3\u6784

### {concept}
#\u81EA\u52A8\u63A8\u5BFC\u7684\u4E3B\u9898 #\u672C\u8D28\u5B9A\u4E49

> [!QUOTE] \u26A1 **\u6838\u5FC3\u9690\u55BB**
> (\u4E0D\u8981\u7528\u7B80\u5355\u7684\u6BD4\u55BB\u3002\u8BF7\u4F7F\u7528\u4E00\u4E2A\u80FD\u63ED\u793A**\u52A8\u6001\u673A\u5236**\u6216**\u7ED3\u6784\u5F20\u529B**\u7684\u573A\u666F\u9690\u55BB\u3002\u9650 50 \u5B57\u3002)

#### \u2160. \u7CFB\u7EDF\u5EFA\u6A21
> [!NOTE] \u{1F4A1} **\u6DF1\u5EA6\u89E3\u7801**
> (\u63ED\u793A\u6A21\u578B\u80CC\u540E\u7684\u7CFB\u7EDF\u52A8\u529B\u5B66\u673A\u5236\u3002\u6B64\u5904\u5FC5\u987B\u5305\u542B\u81F3\u5C11 2 \u4E2A\u76F8\u5173\u7684 [[WikiLink]] \u6982\u5FF5\u3002)

\`\`\`mermaid
graph TD
    A(\u6838\u5FC3\u8981\u7D20) -->|\u6B63\u53CD\u9988/\u538B\u529B| B{\u5173\u952E\u8282\u70B9}
    B -->|\u8DEF\u5F841| C[\u7ED3\u679C/\u73B0\u8C61]
    C -->|\u8D1F\u53CD\u9988/\u8C03\u8282| A
    B -->|\u8DEF\u5F842| D[\u7CFB\u7EDF\u5D29\u6E83/\u53D8\u5F02]
    style A fill:#f9f,stroke:#333,stroke-width:2px
    style B fill:#ccf,stroke:#333,stroke-width:2px
\`\`\`

#### \u2161. \u8DE8\u754C\u4F20\u9001\u95E8 (\u540C\u6784\u6620\u5C04)

> [!EXAMPLE] \u{1F680} **\u8FC1\u79FB\u81F3 [\u610F\u60F3\u4E0D\u5230\u7684\u9886\u57DF]**
> **\u573A\u666F\uFF1A** (\u5BFB\u627E\u7ED3\u6784\u5B8C\u5168\u76F8\u540C\u7684\u53E6\u4E00\u4E2A\u9886\u57DF\uFF0C\u8D8A\u8DE8\u754C\u8D8A\u597D)
> **\u{1F50D} \u6D1E\u5BDF\uFF1A** (\u63ED\u793A\u4E24\u4E2A\u770B\u4F3C\u65E0\u5173\u9886\u57DF\u80CC\u540E\u7684**\u6570\u5B66/\u903B\u8F91\u540C\u6784\u6027**\u3002\u5C1D\u8BD5\u4F7F\u7528 1 \u4E2A [[WikiLink]]\u3002)

#### \u2162. \u8FB9\u754C\u4E0E\u6096\u8BBA (\u8FA9\u8BC1\u601D\u8003)

> [!WARNING] \u26A0\uFE0F **\u8BA4\u77E5\u8FB9\u754C**
>
>   * **\u5931\u6548\u76F2\u533A\uFF1A** (\u8BE5\u6A21\u578B\u5728\u4EC0\u4E48\u6781\u7AEF\u6761\u4EF6\u4E0B\u4F1A\u5931\u6548)
>   * **\u6838\u5FC3\u6096\u8BBA\uFF1A** (\u5185\u90E8\u662F\u5426\u5B58\u5728\u81EA\u6211\u77DB\u76FE\uFF1F\u5982\u201C\u6548\u7387\u4E0E\u516C\u5E73\u7684\u4E92\u65A5\u201D)

#### \u2163. \u7075\u9B42\u62F7\u95EE (\u5185\u7701)

> [!QUESTION] \u{1F9D8} **\u77E5\u884C\u5408\u4E00**
>
>   * **[\u535A\u5F08\u6289\u62E9]:** (\u8BBE\u8BA1\u4E00\u4E2A\u6CA1\u6709\u6807\u51C6\u7B54\u6848\u3001\u9700\u8981\u6743\u8861\u5229\u5F0A\u7684\u51B3\u7B56\u573A\u666F)
>   * **[\u601D\u7EF4\u523A\u9488]:** (\u4E00\u53E5\u8BDD\u523A\u7834\u7528\u6237\u53EF\u80FD\u7684\u865A\u8363\u6216\u8BA4\u77E5\u60F0\u6027)

-----

**\u{1F3F7}\uFE0F \u6781\u7B80\u603B\u7ED3\uFF1A** (\u4E00\u53E5\u6DF1\u523B\u7684\u3001\u5177\u6709\u54F2\u5B66\u610F\u5473\u7684\u91D1\u53E5)`;
var PROMPT_CRITIC_DEFAULT = `# Role: \u77E5\u8BC6\u56FE\u8C31\u8D28\u91CF\u5BA1\u6838\u5458 (Knowledge Graph Auditor)

\u4F60\u6B63\u5728\u5BA1\u6838\u4E00\u7BC7\u5173\u4E8E "{concept}" \u7684 Obsidian \u77E5\u8BC6\u5361\u7247\u3002
\u8BE5\u5361\u7247\u5FC5\u987B\u4E25\u683C\u9075\u5FAA\u201C\u672C\u8D28\u8FD8\u539F\u8005\u201D\u7684\u6781\u7B80\u9AD8\u5BC6\u5EA6\u98CE\u683C\u3002

## \u5BA1\u6838\u6E05\u5355 (Checklist)
1.  **\u7ED3\u6784\u5B8C\u6574\u6027**\uFF1A\u5185\u5BB9\u5FC5\u987B\u5305\u542B\u4EE5\u4E0B Markdown \u6807\u9898\u6216 Callout\uFF1A
    * \`> [!QUOTE] \u26A1\` (\u6838\u5FC3\u9690\u55BB)
    * \`#### \u2160. \u7CFB\u7EDF\u5EFA\u6A21\` (\u5FC5\u987B\u5305\u542B Mermaid \u56FE\u8868)
    * \`#### \u2161. \u8DE8\u754C\u4F20\u9001\u95E8\` (\u540C\u6784\u6620\u5C04)
    * \`#### \u2162. \u8FB9\u754C\u4E0E\u6096\u8BBA\`
    * \`#### \u2163. \u7075\u9B42\u62F7\u95EE\`
2.  **Mermaid \u8BED\u6CD5\u68C0\u67E5**\uFF1A
    * \u5FC5\u987B\u5305\u542B \`\`\`mermaid\` \u4EE3\u7801\u5757\u3002
    * **\u5173\u952E**\uFF1A\u56FE\u8868\u65B9\u5411\u5FC5\u987B\u662F \`graph TD\` (\u4ECE\u4E0A\u5230\u4E0B\uFF0C\u9002\u914D\u624B\u673A\u7AD6\u5C4F)\u3002
    * \u68C0\u67E5\u662F\u5426\u5B58\u5728\u7834\u574F\u6E32\u67D3\u7684\u7279\u6B8A\u5B57\u7B26\uFF08\u5982\u672A\u8F6C\u4E49\u7684\u62EC\u53F7\uFF09\u3002
3.  **\u81EA\u52A8\u751F\u957F\u673A\u5236**\uFF1A
    * \u6B63\u6587\u4E2D**\u5FC5\u987B**\u5305\u542B\u81F3\u5C11 2 \u4E2A \`[[WikiLinks]]\` \u683C\u5F0F\u7684\u94FE\u63A5\uFF08\u4F8B\u5982 \`[[\u71B5\u589E]]\` \u6216 \`[[\u975E\u8FDE\u7EED\u6027]]\`\uFF09\uFF0C\u7528\u4E8E\u56FE\u8C31\u81EA\u52A8\u6269\u5C55\u3002
4.  **\u7EAF\u51C0\u5EA6**\uFF1A
    * \u5FC5\u987B\u662F\u7EAF Markdown \u5185\u5BB9\u3002
    * **\u4E25\u7981**\u51FA\u73B0 "\u597D\u7684\uFF0C\u8FD9\u662F\u4E3A\u60A8\u751F\u6210\u7684..." \u6216 "Certainly..." \u7B49 AI \u95F2\u804A\u8BED\u3002

## \u539F\u59CB\u5185\u5BB9
{content}

---

## \u8F93\u51FA\u6307\u4EE4 (\u4E25\u683C\u9075\u5B88)
\u4F60\u5FC5\u987B\u8F93\u51FA\u4E14\u4EC5\u8F93\u51FA\u4EE5\u4E0B\u683C\u5F0F\uFF08\u7528\u4E8E\u6B63\u5219\u63D0\u53D6\uFF09\uFF1A

DECISION: [KEEP \u6216 DISCARD]
[REASON: \u5982\u679C\u662F DISCARD\uFF0C\u8BF7\u7528\u4E00\u53E5\u8BDD\u7B80\u8FF0\u5177\u4F53\u539F\u56E0\uFF0C\u4F8B\u5982"Mermaid\u65B9\u5411\u9519\u8BEF(\u9700TD)"\u6216"\u7F3A\u5C11[[WikiLink]]"]
\`\`\``;
var PROMPT_REVISER_DEFAULT = `# Role: \u8D44\u6DF1\u77E5\u8BC6\u7F16\u8F91\u4E0E\u5185\u5BB9\u4F18\u5316\u4E13\u5BB6

\u4F60\u6536\u5230\u7684\u4EFB\u52A1\u662F\u4FEE\u6B63\u4E00\u7BC7\u5173\u4E8E "{concept}" \u7684\u77E5\u8BC6\u5361\u7247\u3002
\u8FD9\u7BC7\u5361\u7247\u5728\u4E0A\u4E00\u8F6E\u5BA1\u6838\u4E2D\u88AB\u62D2\u7EDD\u4E86\u3002

## \u62D2\u7EDD\u539F\u56E0
{rejection_reason}

## \u539F\u59CB\u8349\u7A3F
{original_content}

## \u4FEE\u6B63\u4EFB\u52A1
\u8BF7\u6839\u636E\u62D2\u7EDD\u539F\u56E0\uFF0C\u91CD\u65B0\u7F16\u5199\u6216\u8C03\u6574\u4E0A\u8FF0\u5185\u5BB9\u3002
1.  \u5982\u679C\u539F\u56E0\u662F **"\u683C\u5F0F\u9519\u8BEF"** \u6216 **"\u7F3A\u5C11\u6807\u9898"**\uFF1A\u8BF7\u4E25\u683C\u8865\u5145\u7F3A\u5931\u7684 \`> [!QUOTE]\`, \`#### \u2160. \u7CFB\u7EDF\u5EFA\u6A21\` \u7B49\u7ED3\u6784\u3002
2.  \u5982\u679C\u539F\u56E0\u662F **"Mermaid\u65B9\u5411\u9519\u8BEF"** \u6216 **"\u7F3A\u5C11 Mermaid"**\uFF1A\u8BF7\u91CD\u7ED8\u4E00\u4E2A \`graph TD\` (\u7AD6\u5411\u6D41) \u7684\u7CFB\u7EDF\u56FE\uFF0C\u786E\u4FDD\u9002\u5408\u624B\u673A\u9605\u8BFB\u3002
3.  \u5982\u679C\u539F\u56E0\u662F **"\u7F3A\u5C11 WikiLink"**\uFF1A\u8BF7\u5728\u6B63\u6587\u7684\u5173\u952E\u6982\u5FF5\u5904\u6DFB\u52A0 \`[[ ]]\`\uFF0C\u786E\u4FDD\u81F3\u5C11\u6709 2 \u4E2A\u3002
4.  \u5982\u679C\u539F\u56E0\u662F **"\u5305\u542B AI \u5E9F\u8BDD"**\uFF1A\u8BF7\u5220\u9664\u6240\u6709\u5F00\u573A\u767D\uFF0C\u53EA\u4FDD\u7559 Markdown \u6B63\u6587\u3002

## \u8F93\u51FA\u8981\u6C42
* **\u76F4\u63A5\u8F93\u51FA\u4FEE\u6B63\u540E\u7684\u5B8C\u6574 Markdown \u5185\u5BB9**\u3002
* \u4E0D\u8981\u89E3\u91CA\u4F60\u4FEE\u6539\u4E86\u4EC0\u4E48\uFF0C\u4E0D\u8981\u8F93\u51FA "Here is the revised version"\u3002
* \u4FDD\u6301\u201C\u672C\u8D28\u8FD8\u539F\u8005\u201D\u7684\u9AD8\u5BC6\u5EA6\u3001\u6781\u7B80\u98CE\u683C\u3002`;
var DEFAULT_SETTINGS = {
  // API
  openai_api_keys: "",
  openai_base_url: "https://api.openai.com/v1",
  openai_model: "gpt-4-turbo-preview",
  openai_backup_model: "",
  google_api_keys: "",
  google_model: "gemini-1.5-pro-latest",
  google_backup_model: "",
  failover_cooldown_seconds: 300,
  // 参数
  generation_temperature: 0.7,
  generation_max_tokens: 4096,
  // 路径
  output_dir: "KnowledgeGraphNotes",
  // 系统
  generation_batch_size: 5,
  request_delay: 5,
  debug_mode: false,
  // Critic
  critic_mode: "heuristic",
  critic_required_headers: `> [!QUOTE] \u26A1
#### \u2160. \u7CFB\u7EDF\u5EFA\u6A21
#### \u2161. \u8DE8\u754C\u4F20\u9001\u95E8
#### \u2162. \u8FB9\u754C\u4E0E\u6096\u8BBA
#### \u2163. \u7075\u9B42\u62F7\u95EE`,
  critic_min_content_length: 200,
  // Reviser
  max_revision_retries: 2,
  // Prompts
  prompt_generator: PROMPT_GENERATOR_DEFAULT,
  prompt_critic: PROMPT_CRITIC_DEFAULT,
  prompt_reviser: PROMPT_REVISER_DEFAULT,
  // 播种箱
  seedConcepts: "",
  // 新概念提取
  extract_new_concepts: false
};
function getDefaultPrompts() {
  return {
    prompt_generator: PROMPT_GENERATOR_DEFAULT,
    prompt_critic: PROMPT_CRITIC_DEFAULT,
    prompt_reviser: PROMPT_REVISER_DEFAULT
  };
}
var KGsSettingTab = class extends import_obsidian2.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian2.Setting(containerEl).setName("Engine dashboard").setDesc("Manage generation, review, and discarded tasks.").addButton(
      (button) => button.setButtonText("Open queue manager").setCta().onClick(() => {
        new QueueManagementModal(this.app, this.plugin).open();
      })
    );
    new import_obsidian2.Setting(containerEl).setName("API").setHeading();
    new import_obsidian2.Setting(containerEl).setName("OpenAI").setHeading();
    new import_obsidian2.Setting(containerEl).setName("OpenAI API keys").setDesc("One key per line.").addTextArea((text) => text.setPlaceholder("sk-...").setValue(this.plugin.settings.openai_api_keys).onChange(async (value) => {
      this.plugin.settings.openai_api_keys = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("OpenAI base URL").setDesc("Proxy URL if applicable.").addText((text) => text.setPlaceholder("https://api.openai.com/v1").setValue(this.plugin.settings.openai_base_url).onChange(async (value) => {
      this.plugin.settings.openai_base_url = value.trim();
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("OpenAI model (primary)").setDesc("Primary model name.").addText((text) => text.setPlaceholder("gpt-4-turbo-preview").setValue(this.plugin.settings.openai_model).onChange(async (value) => {
      this.plugin.settings.openai_model = value.trim();
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("OpenAI backup model").setDesc("Used when primary fails.").addText((text) => text.setPlaceholder("gpt-3.5-turbo").setValue(this.plugin.settings.openai_backup_model).onChange(async (value) => {
      this.plugin.settings.openai_backup_model = value.trim();
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("Google Gemini").setHeading();
    new import_obsidian2.Setting(containerEl).setName("Google Gemini API keys").setDesc("One key per line.").addTextArea((text) => text.setPlaceholder("AIzaSy...").setValue(this.plugin.settings.google_api_keys).onChange(async (value) => {
      this.plugin.settings.google_api_keys = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("Google Gemini model (primary)").setDesc("Primary model name.").addText((text) => text.setPlaceholder("gemini-1.5-pro-latest").setValue(this.plugin.settings.google_model).onChange(async (value) => {
      this.plugin.settings.google_model = value.trim();
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("Google Gemini backup model").setDesc("Used when primary fails.").addText((text) => text.setPlaceholder("gemini-1.0-pro").setValue(this.plugin.settings.google_backup_model).onChange(async (value) => {
      this.plugin.settings.google_backup_model = value.trim();
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("Key cooldown (seconds)").setDesc("Wait time after key failure.").addText((text) => text.setValue(String(this.plugin.settings.failover_cooldown_seconds)).onChange(async (value) => {
      const num = parseInt(value, 10);
      if (!isNaN(num) && num >= 0) {
        this.plugin.settings.failover_cooldown_seconds = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("LLM parameters").setHeading();
    new import_obsidian2.Setting(containerEl).setName("Generation temperature").setDesc("0.0 to 2.0 (Creative vs deterministic).").addText((text) => text.setValue(String(this.plugin.settings.generation_temperature)).onChange(async (value) => {
      const num = parseFloat(value);
      if (!isNaN(num) && num >= 0 && num <= 2) {
        this.plugin.settings.generation_temperature = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("Max tokens").setDesc("Maximum tokens per response.").addText((text) => text.setValue(String(this.plugin.settings.generation_max_tokens)).onChange(async (value) => {
      const num = parseInt(value, 10);
      if (!isNaN(num) && num > 0) {
        this.plugin.settings.generation_max_tokens = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("Engine").setHeading();
    new import_obsidian2.Setting(containerEl).setName("Output folder").setDesc("Notes will be saved here.").addText((text) => text.setPlaceholder("KnowledgeGraphNotes").setValue(this.plugin.settings.output_dir).onChange(async (value) => {
      this.plugin.settings.output_dir = value.trim().replace(/\/$/, "");
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("Generation batch size").setDesc("Number of tasks per cycle.").addText((text) => text.setValue(String(this.plugin.settings.generation_batch_size)).onChange(async (value) => {
      const num = parseInt(value, 10);
      if (!isNaN(num) && num > 0) {
        this.plugin.settings.generation_batch_size = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("Request delay (seconds)").setDesc("Wait time between batches.").addText((text) => text.setValue(String(this.plugin.settings.request_delay)).onChange(async (value) => {
      const num = parseInt(value, 10);
      if (!isNaN(num) && num >= 0) {
        this.plugin.settings.request_delay = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("Debug mode").setDesc("Enable to see verbose logs in console.").addToggle((toggle) => toggle.setValue(this.plugin.settings.debug_mode).onChange(async (value) => {
      this.plugin.settings.debug_mode = value;
      Logger.setDebugMode(value);
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("Max revision retries").setDesc("Maximum attempts before discarding.").addText((text) => text.setValue(String(this.plugin.settings.max_revision_retries)).onChange(async (value) => {
      const num = parseInt(value, 10);
      if (!isNaN(num) && num >= 0) {
        this.plugin.settings.max_revision_retries = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("Extract new concepts").setDesc("Automatically add [[Wikilinks]] from approved notes to generation queue.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.extract_new_concepts).onChange(async (value) => {
        this.plugin.settings.extract_new_concepts = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian2.Setting(containerEl).setName("Critic mode").setDesc("Heuristic (fast, formatting check) or AI (smart, content check).").addDropdown((dropdown) => dropdown.addOption("heuristic", "Heuristic").addOption("ai", "Artificial intelligence (AI)").setValue(this.plugin.settings.critic_mode).onChange(async (value) => {
      this.plugin.settings.critic_mode = value;
      await this.plugin.saveSettings();
      this.display();
    }));
    if (this.plugin.settings.critic_mode === "heuristic") {
      new import_obsidian2.Setting(containerEl).setName("Heuristic: required headers").setDesc("Notes must contain these headers (one per line).").addTextArea((text) => {
        text.setValue(this.plugin.settings.critic_required_headers).onChange(async (value) => {
          this.plugin.settings.critic_required_headers = value;
          await this.plugin.saveSettings();
        });
        text.inputEl.addClass("kg-textarea-short");
      });
      new import_obsidian2.Setting(containerEl).setName("Heuristic: min content length").setDesc("Minimum character count.").addText((text) => text.setValue(String(this.plugin.settings.critic_min_content_length)).onChange(async (value) => {
        const num = parseInt(value, 10);
        if (!isNaN(num) && num >= 0) {
          this.plugin.settings.critic_min_content_length = num;
          await this.plugin.saveSettings();
        }
      }));
    }
    new import_obsidian2.Setting(containerEl).setName("Concept seeding").setHeading();
    new import_obsidian2.Setting(containerEl).setName("Seed box").setDesc("Enter concepts here, one per line.").addTextArea((text) => {
      text.setPlaceholder("First principles\nOccam's razor\n...").setValue(this.plugin.settings.seedConcepts).onChange(async (value) => {
        this.plugin.settings.seedConcepts = value;
        await this.plugin.saveSettings();
      });
      text.inputEl.addClass("kg-textarea-medium");
    });
    new import_obsidian2.Setting(containerEl).addButton(
      (button) => button.setButtonText("Seed to queue").setCta().onClick(async () => {
        const rawText = this.plugin.settings.seedConcepts;
        if (!rawText.trim()) {
          new import_obsidian2.Notice("Seed box is empty.");
          return;
        }
        const conceptsToSeed = [...new Set(
          rawText.split("\n").map((line) => line.trim()).filter(Boolean)
        )];
        const addedCount = this.plugin.engine.addConceptsToQueue(conceptsToSeed);
        const ignoredCount = conceptsToSeed.length - addedCount;
        let noticeMessage = `Added ${addedCount} concepts.`;
        if (ignoredCount > 0) {
          noticeMessage += `
${ignoredCount} ignored (duplicate/existing).`;
        }
        new import_obsidian2.Notice(noticeMessage, 5e3);
        this.plugin.settings.seedConcepts = "";
        await this.plugin.saveSettings();
        this.display();
      })
    );
    new import_obsidian2.Setting(containerEl).setName("Prompts").setHeading();
    new import_obsidian2.Setting(containerEl).setName("Generator prompt").setDesc("Prompt for generating new content.").addTextArea((text) => {
      text.setValue(this.plugin.settings.prompt_generator).onChange(async (value) => {
        this.plugin.settings.prompt_generator = value;
        await this.plugin.saveSettings();
      });
      text.inputEl.addClass("kg-textarea-tall");
    });
    if (this.plugin.settings.critic_mode === "ai") {
      new import_obsidian2.Setting(containerEl).setName("Critic prompt").setDesc("Prompt for AI content review.").addTextArea((text) => {
        text.setValue(this.plugin.settings.prompt_critic).onChange(async (value) => {
          this.plugin.settings.prompt_critic = value;
          await this.plugin.saveSettings();
        });
        text.inputEl.addClass("kg-textarea-tall");
      });
    }
    new import_obsidian2.Setting(containerEl).setName("Reviser prompt").setDesc("Prompt for revising rejected content.").addTextArea((text) => {
      text.setValue(this.plugin.settings.prompt_reviser).onChange(async (value) => {
        this.plugin.settings.prompt_reviser = value;
        await this.plugin.saveSettings();
      });
      text.inputEl.addClass("kg-textarea-tall");
    });
  }
};

// src/engine.ts
var import_obsidian4 = require("obsidian");

// src/apiHandler.ts
var import_obsidian3 = require("obsidian");
var ApiKeyExhaustedError = class extends Error {
  constructor(message) {
    super(message);
    this.name = "ApiKeyExhaustedError";
  }
};
var AllModelsFailedError = class extends Error {
  constructor(message) {
    super(message);
    this.name = "AllModelsFailedError";
  }
};
var APIHandler = class {
  constructor(plugin) {
    this.openai_keys = [];
    this.google_keys = [];
    this.keyUsageOpenAI = /* @__PURE__ */ new Map();
    this.keyUsageGoogle = /* @__PURE__ */ new Map();
    this.hasNotifiedFailover = false;
    this.plugin = plugin;
    this.settings = plugin.settings;
    this.updateKeys();
  }
  updateKeys() {
    this.openai_keys = this.settings.openai_api_keys.split("\n").map((k) => k.trim()).filter(Boolean);
    this.google_keys = this.settings.google_api_keys.split("\n").map((k) => k.trim()).filter(Boolean);
    this.openai_keys.forEach((key) => {
      if (!this.keyUsageOpenAI.has(key)) {
        this.keyUsageOpenAI.set(key, { fails: 0, cooldown_until: 0 });
      }
    });
    this.google_keys.forEach((key) => {
      if (!this.keyUsageGoogle.has(key)) {
        this.keyUsageGoogle.set(key, { fails: 0, cooldown_until: 0 });
      }
    });
  }
  _selectKey(keys, provider) {
    const keyUsageMap = provider === "openai" ? this.keyUsageOpenAI : this.keyUsageGoogle;
    const currentTime = Date.now() / 1e3;
    for (const key of keys) {
      const usage = keyUsageMap.get(key);
      if (usage && currentTime >= usage.cooldown_until) {
        return key;
      }
    }
    return null;
  }
  async _makeOpenAIRequest(key, prompt, modelName) {
    const response = await (0, import_obsidian3.requestUrl)({
      url: `${this.settings.openai_base_url}/chat/completions`,
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${key}`
      },
      body: JSON.stringify({
        model: modelName,
        messages: [{ role: "user", content: prompt }],
        temperature: this.settings.generation_temperature,
        max_tokens: this.settings.generation_max_tokens
      })
    });
    return response.json.choices[0].message.content.trim();
  }
  async _makeGoogleAPIRequest(key, prompt, modelName) {
    const url = `https://generativelanguage.googleapis.com/v1beta/models/${modelName}:generateContent?key=${key}`;
    const response = await (0, import_obsidian3.requestUrl)({
      url,
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        contents: [{ parts: [{ text: prompt }] }],
        generationConfig: {
          temperature: this.settings.generation_temperature,
          maxOutputTokens: this.settings.generation_max_tokens
        }
      })
    });
    const data = response.json;
    if (!data.candidates || data.candidates.length === 0) {
      throw new Error("API response is missing candidates. Full response: " + JSON.stringify(data));
    }
    return data.candidates[0].content.parts[0].text.trim();
  }
  // Fixed: replaced 'any' with 'unknown'
  _isQuotaError(error) {
    var _a;
    const err = error;
    const httpStatus = err.status;
    const errorMessage = ((_a = err.message) == null ? void 0 : _a.toLowerCase()) || "";
    if (httpStatus === 401 || httpStatus === 403 || httpStatus === 429) {
      return true;
    }
    if (errorMessage.includes("insufficient_quota") || errorMessage.includes("rate limit") || errorMessage.includes("quota") || errorMessage.includes("permission") || errorMessage.includes("429")) {
      return true;
    }
    return false;
  }
  _cooldownKey(key, provider) {
    const keyUsageMap = provider === "openai" ? this.keyUsageOpenAI : this.keyUsageGoogle;
    const keyUsage = keyUsageMap.get(key);
    if (keyUsage) {
      console.warn(`Key ...${key.slice(-4)} (${provider}) failed due to quota/auth error. Applying cooldown.`);
      keyUsage.cooldown_until = Date.now() / 1e3 + this.settings.failover_cooldown_seconds;
    }
  }
  _resetCooldown(key, provider) {
    const keyUsageMap = provider === "openai" ? this.keyUsageOpenAI : this.keyUsageGoogle;
    const keyUsage = keyUsageMap.get(key);
    if (keyUsage) {
      keyUsage.cooldown_until = 0;
    }
    this.hasNotifiedFailover = false;
  }
  async _callOpenAI(key, prompt) {
    const primaryModel = this.settings.openai_model;
    const backupModel = this.settings.openai_backup_model;
    try {
      const result = await this._makeOpenAIRequest(key, prompt, primaryModel);
      this._resetCooldown(key, "openai");
      return result;
    } catch (e) {
      const primaryError = e;
      const primaryMsg = e instanceof Error ? e.message : String(e);
      console.warn(`OpenAI primary model '${primaryModel}' failed for key ...${key.slice(-4)}:`, primaryMsg);
      if (backupModel) {
        try {
          const backupResult = await this._makeOpenAIRequest(key, prompt, backupModel);
          this._resetCooldown(key, "openai");
          return backupResult;
        } catch (e2) {
          const backupMsg = e2 instanceof Error ? e2.message : String(e2);
          console.error(`OpenAI backup model '${backupModel}' also failed for key ...${key.slice(-4)}:`, backupMsg);
          if (this._isQuotaError(primaryError) || this._isQuotaError(e2)) {
            this._cooldownKey(key, "openai");
          }
          throw new ApiKeyExhaustedError(`OpenAI key failed (both primary and backup models).`);
        }
      }
      if (this._isQuotaError(primaryError)) {
        this._cooldownKey(key, "openai");
      }
      throw new ApiKeyExhaustedError(`OpenAI key failed (primary model failed, no backup): ${primaryMsg}`);
    }
  }
  async _callGoogleAPI(key, prompt) {
    const primaryModel = this.settings.google_model;
    const backupModel = this.settings.google_backup_model;
    try {
      const result = await this._makeGoogleAPIRequest(key, prompt, primaryModel);
      this._resetCooldown(key, "google");
      return result;
    } catch (e) {
      const primaryError = e;
      const primaryMsg = e instanceof Error ? e.message : String(e);
      console.warn(`Google primary model '${primaryModel}' failed for key ...${key.slice(-4)}:`, primaryMsg);
      if (backupModel) {
        try {
          const backupResult = await this._makeGoogleAPIRequest(key, prompt, backupModel);
          this._resetCooldown(key, "google");
          return backupResult;
        } catch (e2) {
          const backupMsg = e2 instanceof Error ? e2.message : String(e2);
          console.error(`Google backup model '${backupModel}' also failed for key ...${key.slice(-4)}:`, backupMsg);
          if (this._isQuotaError(primaryError) || this._isQuotaError(e2)) {
            this._cooldownKey(key, "google");
          }
          throw new ApiKeyExhaustedError(`Google key failed (both primary and backup models).`);
        }
      }
      if (this._isQuotaError(primaryError)) {
        this._cooldownKey(key, "google");
      }
      throw new ApiKeyExhaustedError(`Google key failed (primary model failed, no backup): ${primaryMsg}`);
    }
  }
  async call(prompt) {
    this.updateKeys();
    let lastError = null;
    let openAIKeysAttempted = false;
    const openAIEnabled = this.openai_keys.length > 0 && !!(this.settings.openai_model || this.settings.openai_backup_model);
    const googleEnabled = this.google_keys.length > 0 && !!(this.settings.google_model || this.settings.google_backup_model);
    if (openAIEnabled) {
      openAIKeysAttempted = true;
      for (let i = 0; i < this.openai_keys.length; i++) {
        const key = this._selectKey(this.openai_keys, "openai");
        if (key) {
          try {
            console.debug(`Trying OpenAI key ...${key.slice(-4)}`);
            return await this._callOpenAI(key, prompt);
          } catch (e) {
            const err = e;
            lastError = err;
            new import_obsidian3.Notice(`OpenAI key ...${key.slice(-4)} failed. Trying next.`);
          }
        }
      }
    } else if (this.openai_keys.length > 0) {
      openAIKeysAttempted = true;
      lastError = new Error("OpenAI: Keys provided but no models defined.");
      console.warn(lastError.message);
    }
    if (googleEnabled) {
      if (openAIKeysAttempted && !this.hasNotifiedFailover) {
        new import_obsidian3.Notice("All OpenAI keys failed or unavailable. Switching to Google Gemini...");
        this.hasNotifiedFailover = true;
      }
      for (let i = 0; i < this.google_keys.length; i++) {
        const key = this._selectKey(this.google_keys, "google");
        if (key) {
          try {
            console.debug(`Trying Google Gemini key ...${key.slice(-4)}`);
            return await this._callGoogleAPI(key, prompt);
          } catch (e) {
            const err = e;
            lastError = err;
            new import_obsidian3.Notice(`Google Gemini key ...${key.slice(-4)} failed. Trying next.`);
          }
        }
      }
    } else if (this.google_keys.length > 0) {
      lastError = lastError || new Error("Google: Keys provided but no models defined.");
      console.warn(lastError.message);
    }
    if (!openAIEnabled && !googleEnabled && (this.openai_keys.length > 0 || this.google_keys.length > 0)) {
      new import_obsidian3.Notice("Please provide API keys and at least one model name in settings.");
      throw new AllModelsFailedError("Keys provided but no models defined.");
    }
    throw new AllModelsFailedError(`All API providers failed. Last error: ${lastError == null ? void 0 : lastError.message}`);
  }
};

// src/critic.ts
var Critic = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.apiHandler = new APIHandler(plugin);
  }
  async judge(content) {
    if (this.plugin.settings.critic_mode === "ai") {
      return this._judgeByAI(content);
    }
    return this._judgeByHeuristic(content);
  }
  _judgeByHeuristic(content) {
    const reasons = [];
    const contentLower = content.toLowerCase();
    const requiredHeaders = this.plugin.settings.critic_required_headers.split("\n").map((h) => h.trim().toLowerCase()).filter(Boolean);
    const missingHeaders = requiredHeaders.filter((h) => !contentLower.includes(h));
    if (missingHeaders.length > 0) {
      reasons.push(`\u7F3A\u5C11\u5FC5\u9700\u7684\u6807\u9898: ${missingHeaders.join(", ")}`);
    }
    if (content.length < this.plugin.settings.critic_min_content_length) {
      reasons.push(`\u5185\u5BB9\u8FC7\u77ED (\u5F53\u524D: ${content.length}, \u8981\u6C42: ${this.plugin.settings.critic_min_content_length})`);
    }
    const refusalPatterns = ["\u4F5C\u4E3A\u4E00?\u4E2AAI", "\u4F5C\u4E3A\u8BED\u8A00\u6A21\u578B", "\u6211\u4E0D\u80FD", "\u6211\u65E0\u6CD5", "\u5F88\u62B1\u6B49"];
    for (const pattern of refusalPatterns) {
      if (new RegExp(pattern, "i").test(content)) {
        reasons.push(`\u5305\u542BAI\u62D2\u7EDD\u8BED (\u5339\u914D: '${pattern}')`);
        break;
      }
    }
    return {
      isApproved: reasons.length === 0,
      reason: reasons.length > 0 ? reasons.join("; ") : "\u901A\u8FC7\u6240\u6709\u542F\u53D1\u5F0F\u89C4\u5219\u68C0\u67E5\u3002"
    };
  }
  async _judgeByAI(content) {
    const prompt = this.plugin.settings.prompt_critic.replace("{content}", content);
    try {
      const response = await this.apiHandler.call(prompt);
      const decisionMatch = response.match(/DECISION:\s*(KEEP|DISCARD)/i);
      const reasonMatch = response.match(/\[REASON:\s*([^\]]+)\]/i);
      const isApproved = decisionMatch ? decisionMatch[1].toUpperCase() === "KEEP" : false;
      const reason = reasonMatch ? reasonMatch[1].trim() : isApproved ? "AI \u6279\u51C6" : "AI \u62D2\u7EDD\uFF0C\u672A\u63D0\u4F9B\u660E\u786E\u7406\u7531";
      return { isApproved, reason };
    } catch (error) {
      console.error("AI Critic call failed:", error);
      return { isApproved: false, reason: `AI \u5BA1\u6838\u5668\u8C03\u7528\u5931\u8D25: ${error.message}` };
    }
  }
};

// src/reviser.ts
var Reviser = class {
  constructor(plugin) {
    this.plugin = plugin;
  }
  createRevisionPrompt(idea, originalContent, rejectionReason) {
    let prompt = this.plugin.settings.prompt_reviser;
    prompt = prompt.replace("{concept}", idea);
    prompt = prompt.replace("{original_content}", originalContent);
    prompt = prompt.replace("{rejection_reason}", rejectionReason);
    return prompt;
  }
};

// src/engine.ts
var Engine = class {
  constructor(plugin) {
    this.isRunning = false;
    this.timerId = null;
    this.plugin = plugin;
    this.app = plugin.app;
    this.apiHandler = new APIHandler(plugin);
    this.critic = new Critic(plugin);
    this.reviser = new Reviser(plugin);
  }
  // --- Public Controls ---
  toggleEngineState() {
    if (this.isRunning) {
      this.stop();
    } else {
      this.start();
    }
  }
  addConceptToQueue(concept) {
    const added = this.addConceptsToQueue([concept]);
    if (added > 0) {
      new import_obsidian4.Notice(`'${concept}' added to queue.`);
      this.updateStatusBar();
      return true;
    }
    new import_obsidian4.Notice(`'${concept}' already exists or queued.`);
    return false;
  }
  addConceptsToQueue(concepts) {
    const currentQueue = new Set(this.plugin.data.generationQueue);
    const existingFiles = new Set(this.app.vault.getMarkdownFiles().map((f) => f.basename));
    let addedCount = 0;
    for (const concept of concepts) {
      const sanitized = sanitizeFilename(concept);
      if (!currentQueue.has(concept) && !existingFiles.has(sanitized)) {
        this.plugin.data.generationQueue.push(concept);
        currentQueue.add(concept);
        addedCount++;
      }
    }
    if (addedCount > 0) {
      void this.plugin.savePluginData();
      this.updateStatusBar();
    }
    return addedCount;
  }
  // --- Core Loop ---
  start() {
    if (this.isRunning)
      return;
    this.isRunning = true;
    this.plugin.data.status = "running";
    new import_obsidian4.Notice("Knowledge graph engine started!");
    this.updateStatusBar();
    this.tick().catch((error) => {
      Logger.error("Tick error during start:", error);
      this.stop();
    });
  }
  stop() {
    if (!this.isRunning)
      return;
    this.isRunning = false;
    this.plugin.data.status = "paused";
    if (this.timerId) {
      clearTimeout(this.timerId);
      this.timerId = null;
    }
    new import_obsidian4.Notice("Knowledge graph engine paused.");
    this.updateStatusBar();
    void this.plugin.savePluginData();
  }
  scheduleNextTick() {
    if (!this.isRunning)
      return;
    const delay = this.plugin.settings.request_delay * 1e3;
    this.timerId = setTimeout(() => {
      this.tick().catch((error) => {
        Logger.error("Tick error:", error);
      });
    }, delay);
  }
  async tick() {
    if (!this.isRunning)
      return;
    try {
      let taskProcessed = false;
      if (this.plugin.data.revisionQueue.length > 0) {
        taskProcessed = await this.runRevisionPhase();
      } else if (this.plugin.data.reviewQueue.length > 0) {
        taskProcessed = await this.runCriticPhase();
      } else if (this.plugin.data.generationQueue.length > 0) {
        taskProcessed = await this.runGenerationPhase();
      }
      if (!taskProcessed && this.plugin.data.generationQueue.length === 0 && this.plugin.data.reviewQueue.length === 0 && this.plugin.data.revisionQueue.length === 0) {
        new import_obsidian4.Notice("\u{1F389} All tasks completed! Engine stopped.");
        this.isRunning = false;
        this.plugin.data.status = "idle";
        this.updateStatusBar();
        await this.plugin.savePluginData();
        return;
      }
    } catch (error) {
      Logger.error("Engine fatal error:", error);
      new import_obsidian4.Notice("Engine encountered an error and paused. Check console.");
      this.stop();
      return;
    }
    this.scheduleNextTick();
  }
  // --- Phases ---
  async runGenerationPhase() {
    const queue = this.plugin.data.generationQueue;
    if (queue.length === 0)
      return false;
    const batchSize = this.plugin.settings.generation_batch_size;
    const batch = queue.splice(0, Math.min(queue.length, batchSize));
    this.updateStatusBar();
    await this.plugin.savePluginData();
    const tasks = batch.map((idea) => this.generationTask(idea));
    await Promise.allSettled(tasks);
    await this.plugin.savePluginData();
    return true;
  }
  async generationTask(idea) {
    const prompt = this.plugin.settings.prompt_generator.replace("{concept}", idea);
    try {
      const content = await this.apiHandler.call(prompt);
      const cleanedContent = cleanMarkdownOutput(content);
      await this.plugin.persistence.saveTaskContent(idea, cleanedContent);
      this.plugin.data.reviewQueue.push({ idea, content: cleanedContent });
      Logger.log(`\u2705 [Generation Success]: ${idea}`);
    } catch (e) {
      if (e instanceof AllModelsFailedError) {
        Logger.error(`\u274C [Generation Failed]: ${idea} - ${e.message}`);
        this.plugin.data.generationQueue.unshift(idea);
      }
    }
  }
  async runCriticPhase() {
    const queue = this.plugin.data.reviewQueue;
    if (queue.length === 0)
      return false;
    const batchSize = this.plugin.settings.generation_batch_size;
    const tasksToReview = queue.splice(0, Math.min(queue.length, batchSize));
    this.updateStatusBar();
    await this.plugin.savePluginData();
    let newIdeasFound = /* @__PURE__ */ new Set();
    for (const task of tasksToReview) {
      let content = task.content;
      if (!content) {
        content = await this.plugin.persistence.loadTaskContent(task.idea);
      }
      if (!content) {
        Logger.error(`\u274C [Critic Error]: Content not found for ${task.idea}. Discarding.`);
        this.plugin.data.discardedPile.push({ ...task, reason: "Content file lost" });
        continue;
      }
      const { isApproved, reason } = await this.critic.judge(content);
      if (isApproved) {
        await this.saveNote(task.idea, content);
        await this.plugin.persistence.deleteTaskContent(task.idea);
        if (this.plugin.settings.extract_new_concepts) {
          const ideas = extractNewIdeas(content);
          ideas.forEach((idea) => newIdeasFound.add(idea));
        }
        Logger.log(`\u{1F44D} [Approved]: ${task.idea}`);
      } else {
        task.reason = reason;
        task.retries = (task.retries || 0) + 1;
        this.plugin.data.revisionQueue.push(task);
        Logger.warn(`\u{1F44E} [Rejected]: ${task.idea} - ${reason}`);
      }
    }
    if (newIdeasFound.size > 0) {
      this.addConceptsToQueue(Array.from(newIdeasFound));
    }
    await this.plugin.savePluginData();
    return true;
  }
  async runRevisionPhase() {
    const queue = this.plugin.data.revisionQueue;
    if (queue.length === 0)
      return false;
    const batchSize = this.plugin.settings.generation_batch_size;
    const tasksToRevise = queue.splice(0, Math.min(queue.length, batchSize));
    this.updateStatusBar();
    await this.plugin.savePluginData();
    for (const task of tasksToRevise) {
      if ((task.retries || 0) >= this.plugin.settings.max_revision_retries) {
        this.plugin.data.discardedPile.push(task);
        Logger.error(`\u{1F480} [Give up]: ${task.idea} max retries reached.`);
        continue;
      }
      await this.revisionTask(task);
    }
    await this.plugin.savePluginData();
    return true;
  }
  async revisionTask(task) {
    let content = task.content;
    if (!content) {
      content = await this.plugin.persistence.loadTaskContent(task.idea);
    }
    if (!content) {
      Logger.error(`Content missing for revision: ${task.idea}`);
      this.plugin.data.discardedPile.push(task);
      return;
    }
    const prompt = this.reviser.createRevisionPrompt(task.idea, content, task.reason || "unknown");
    try {
      const newContent = await this.apiHandler.call(prompt);
      const cleanedContent = cleanMarkdownOutput(newContent);
      await this.plugin.persistence.saveTaskContent(task.idea, cleanedContent);
      const revisedTask = { ...task, content: cleanedContent };
      this.plugin.data.reviewQueue.push(revisedTask);
      Logger.log(`\u{1F504} [Revision Complete]: ${task.idea}`);
    } catch (e) {
      const errMsg = e instanceof Error ? e.message : String(e);
      Logger.error(`\u274C [Revision Failed]: ${task.idea} - ${errMsg}`);
      this.plugin.data.revisionQueue.unshift(task);
    }
  }
  // --- File & UI ---
  async saveNote(idea, content) {
    const filename = sanitizeFilename(idea);
    const folderPath = this.plugin.settings.output_dir;
    if (!(this.app.vault.getAbstractFileByPath(folderPath) instanceof import_obsidian4.TFolder)) {
      try {
        await this.app.vault.createFolder(folderPath);
      } catch (error) {
        Logger.error(`Create folder failed: ${folderPath}`, error);
        new import_obsidian4.Notice(`Cannot create folder: ${folderPath}`);
        return;
      }
    }
    const filePath = (0, import_obsidian4.normalizePath)(`${folderPath}/${filename}.md`);
    const file = this.app.vault.getAbstractFileByPath(filePath);
    try {
      if (file instanceof import_obsidian4.TFile) {
        await this.app.vault.modify(file, content);
        new import_obsidian4.Notice(`Note updated: ${filename}`);
      } else {
        await this.app.vault.create(filePath, content);
        new import_obsidian4.Notice(`Note created: ${filename}`);
      }
    } catch (error) {
      Logger.error(`Save note failed: ${filePath}`, error);
      new import_obsidian4.Notice(`Cannot save note: ${filename}`);
    }
  }
  updateStatusBar() {
    if (!this.plugin.statusBarEl)
      return;
    const { generationQueue, reviewQueue, revisionQueue } = this.plugin.data;
    const total = generationQueue.length + reviewQueue.length + revisionQueue.length;
    this.plugin.statusBarEl.setText(
      `KG: ${this.plugin.data.status} | G:${generationQueue.length} | C:${reviewQueue.length} | R:${revisionQueue.length} | Total:${total}`
    );
    this.app.workspace.trigger("kg-data-updated");
  }
};

// src/persistence.ts
var import_obsidian5 = require("obsidian");
var Persistence = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.app = plugin.app;
    this.cacheDir = (0, import_obsidian5.normalizePath)(`${this.app.vault.configDir}/plugins/${this.plugin.manifest.id}/task_cache`);
    this.queueFile = (0, import_obsidian5.normalizePath)(`${this.app.vault.configDir}/plugins/${this.plugin.manifest.id}/queues.json`);
  }
  async init() {
    const adapter = this.app.vault.adapter;
    if (!await adapter.exists(this.cacheDir)) {
      await adapter.mkdir(this.cacheDir);
    }
  }
  // --- 队列元数据 (轻量级) ---
  async loadQueueData() {
    const adapter = this.app.vault.adapter;
    if (await adapter.exists(this.queueFile)) {
      try {
        const content = await adapter.read(this.queueFile);
        return JSON.parse(content);
      } catch (e) {
        Logger.error("Failed to load queue data:", e);
        return null;
      }
    }
    return null;
  }
  async saveQueueData(data) {
    const cleanData = JSON.parse(JSON.stringify(data));
    const stripContent = (queue) => {
      queue.forEach((task) => {
        delete task.content;
      });
    };
    stripContent(cleanData.reviewQueue);
    stripContent(cleanData.revisionQueue);
    stripContent(cleanData.discardedPile);
    const adapter = this.app.vault.adapter;
    try {
      await adapter.write(this.queueFile, JSON.stringify(cleanData, null, 2));
    } catch (e) {
      Logger.error("Failed to save queue data:", e);
    }
  }
  // --- 任务内容 (重量级 - 独立文件) ---
  getCachePath(idea) {
    const safeName = idea.replace(/[\\/*?:"<>|]/g, "").trim().slice(0, 100);
    return `${this.cacheDir}/${safeName}.md`;
  }
  async saveTaskContent(idea, content) {
    const path = this.getCachePath(idea);
    try {
      await this.app.vault.adapter.write(path, content);
      Logger.log(`Saved content cache for: ${idea}`);
    } catch (e) {
      Logger.error(`Failed to save content cache for ${idea}:`, e);
    }
  }
  async loadTaskContent(idea) {
    const path = this.getCachePath(idea);
    try {
      if (await this.app.vault.adapter.exists(path)) {
        return await this.app.vault.adapter.read(path);
      }
    } catch (e) {
      Logger.error(`Failed to load content cache for ${idea}:`, e);
    }
    return "";
  }
  async deleteTaskContent(idea) {
    const path = this.getCachePath(idea);
    try {
      if (await this.app.vault.adapter.exists(path)) {
        await this.app.vault.adapter.remove(path);
        Logger.log(`Deleted content cache for: ${idea}`);
      }
    } catch (e) {
      Logger.warn(`Failed to delete content cache for ${idea} (might allow cleanup later):`, e);
    }
  }
};

// src/main.ts
var DEFAULT_PLUGIN_DATA = {
  status: "idle",
  generationQueue: [],
  reviewQueue: [],
  revisionQueue: [],
  discardedPile: []
};
var KnowledgeGraphPlugin = class extends import_obsidian6.Plugin {
  async onload() {
    await this.loadSettings();
    Logger.setDebugMode(this.settings.debug_mode);
    this.persistence = new Persistence(this);
    await this.persistence.init();
    await this.loadPluginData();
    this.engine = new Engine(this);
    const ribbonIconEl = this.addRibbonIcon("brain-circuit", "Knowledge graph generator", (evt) => {
      this.engine.toggleEngineState();
    });
    ribbonIconEl.addClass("knowledge-graph-plugin-ribbon-class");
    this.statusBarEl = this.addStatusBarItem();
    this.engine.updateStatusBar();
    this.addSettingTab(new KGsSettingTab(this.app, this));
    this.addCommand({
      id: "toggle-knowledge-graph-engine",
      name: "Start/pause knowledge graph generation",
      callback: () => {
        this.engine.toggleEngineState();
      }
    });
    this.addCommand({
      id: "add-current-note-to-queue",
      name: "Add current note title to generation queue",
      checkCallback: (checking) => {
        const file = this.app.workspace.getActiveFile();
        if (file) {
          if (!checking) {
            this.engine.addConceptToQueue(file.basename);
          }
          return true;
        }
        return false;
      }
    });
    Logger.log("Knowledge Graph plugin loaded.");
  }
  onunload() {
    Logger.log("Knowledge Graph plugin unloaded.");
  }
  async loadSettings() {
    const defaultPrompts = getDefaultPrompts();
    const savedData = await this.loadData();
    this.settings = Object.assign({}, DEFAULT_SETTINGS, defaultPrompts, savedData);
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  async loadPluginData() {
    const savedState = await this.persistence.loadQueueData();
    this.data = Object.assign({}, DEFAULT_PLUGIN_DATA, savedState || {});
  }
  async savePluginData() {
    await this.persistence.saveQueueData(this.data);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3NldHRpbmdzLnRzIiwgInNyYy9RdWV1ZU1vZGFsLnRzIiwgInNyYy91dGlscy50cyIsICJzcmMvZW5naW5lLnRzIiwgInNyYy9hcGlIYW5kbGVyLnRzIiwgInNyYy9jcml0aWMudHMiLCAic3JjL3JldmlzZXIudHMiLCAic3JjL3BlcnNpc3RlbmNlLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyIvLyBzcmMvbWFpbi50c1xuXG5pbXBvcnQgeyBQbHVnaW4gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBLbm93bGVkZ2VHcmFwaFBsdWdpblNldHRpbmdzLCBQbHVnaW5EYXRhIH0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQgeyBLR3NTZXR0aW5nVGFiLCBERUZBVUxUX1NFVFRJTkdTLCBnZXREZWZhdWx0UHJvbXB0cyB9IGZyb20gJy4vc2V0dGluZ3MnO1xuaW1wb3J0IHsgRW5naW5lIH0gZnJvbSAnLi9lbmdpbmUnO1xuaW1wb3J0IHsgUGVyc2lzdGVuY2UgfSBmcm9tICcuL3BlcnNpc3RlbmNlJztcbmltcG9ydCB7IExvZ2dlciB9IGZyb20gJy4vdXRpbHMnO1xuXG5jb25zdCBERUZBVUxUX1BMVUdJTl9EQVRBOiBQbHVnaW5EYXRhID0ge1xuICAgIHN0YXR1czogJ2lkbGUnLFxuICAgIGdlbmVyYXRpb25RdWV1ZTogW10sXG4gICAgcmV2aWV3UXVldWU6IFtdLFxuICAgIHJldmlzaW9uUXVldWU6IFtdLFxuICAgIGRpc2NhcmRlZFBpbGU6IFtdLFxufTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgS25vd2xlZGdlR3JhcGhQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuICAgIHNldHRpbmdzOiBLbm93bGVkZ2VHcmFwaFBsdWdpblNldHRpbmdzO1xuICAgIGRhdGE6IFBsdWdpbkRhdGE7XG4gICAgZW5naW5lOiBFbmdpbmU7XG4gICAgcGVyc2lzdGVuY2U6IFBlcnNpc3RlbmNlO1xuICAgIHN0YXR1c0JhckVsOiBIVE1MRWxlbWVudDtcblxuICAgIGFzeW5jIG9ubG9hZCgpIHtcbiAgICAgICAgLy8gMS4gXHU1MkEwXHU4RjdEXHU4QkJFXHU3RjZFIChkYXRhLmpzb24pXG4gICAgICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG4gICAgICAgIExvZ2dlci5zZXREZWJ1Z01vZGUodGhpcy5zZXR0aW5ncy5kZWJ1Z19tb2RlKTtcblxuICAgICAgICAvLyAyLiBcdTUyMURcdTU5Q0JcdTUzMTZcdTYzMDFcdTRFNDVcdTUzMTZcdTZBMjFcdTU3NTdcbiAgICAgICAgdGhpcy5wZXJzaXN0ZW5jZSA9IG5ldyBQZXJzaXN0ZW5jZSh0aGlzKTtcbiAgICAgICAgYXdhaXQgdGhpcy5wZXJzaXN0ZW5jZS5pbml0KCk7XG5cbiAgICAgICAgLy8gMy4gXHU1MkEwXHU4RjdEXHU5NjFGXHU1MjE3XHU2NTcwXHU2MzZFIChxdWV1ZXMuanNvbilcbiAgICAgICAgYXdhaXQgdGhpcy5sb2FkUGx1Z2luRGF0YSgpO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5lbmdpbmUgPSBuZXcgRW5naW5lKHRoaXMpO1xuXG4gICAgICAgIC8vIEZpeGVkOiBTZW50ZW5jZSBjYXNlIGZvciB0b29sdGlwXG4gICAgICAgIGNvbnN0IHJpYmJvbkljb25FbCA9IHRoaXMuYWRkUmliYm9uSWNvbignYnJhaW4tY2lyY3VpdCcsICdLbm93bGVkZ2UgZ3JhcGggZ2VuZXJhdG9yJywgKGV2dDogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5lbmdpbmUudG9nZ2xlRW5naW5lU3RhdGUoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJpYmJvbkljb25FbC5hZGRDbGFzcygna25vd2xlZGdlLWdyYXBoLXBsdWdpbi1yaWJib24tY2xhc3MnKTtcblxuICAgICAgICB0aGlzLnN0YXR1c0JhckVsID0gdGhpcy5hZGRTdGF0dXNCYXJJdGVtKCk7XG4gICAgICAgIHRoaXMuZW5naW5lLnVwZGF0ZVN0YXR1c0JhcigpO1xuXG4gICAgICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgS0dzU2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xuXG4gICAgICAgIC8vIEZpeGVkOiBTZW50ZW5jZSBjYXNlIGZvciBjb21tYW5kIG5hbWVzXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogJ3RvZ2dsZS1rbm93bGVkZ2UtZ3JhcGgtZW5naW5lJyxcbiAgICAgICAgICAgIG5hbWU6ICdTdGFydC9wYXVzZSBrbm93bGVkZ2UgZ3JhcGggZ2VuZXJhdGlvbicsXG4gICAgICAgICAgICBjYWxsYmFjazogKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuZW5naW5lLnRvZ2dsZUVuZ2luZVN0YXRlKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICdhZGQtY3VycmVudC1ub3RlLXRvLXF1ZXVlJyxcbiAgICAgICAgICAgIG5hbWU6ICdBZGQgY3VycmVudCBub3RlIHRpdGxlIHRvIGdlbmVyYXRpb24gcXVldWUnLFxuICAgICAgICAgICAgY2hlY2tDYWxsYmFjazogKGNoZWNraW5nOiBib29sZWFuKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgICAgICAgICAgaWYgKGZpbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjaGVja2luZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbmdpbmUuYWRkQ29uY2VwdFRvUXVldWUoZmlsZS5iYXNlbmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgTG9nZ2VyLmxvZygnS25vd2xlZGdlIEdyYXBoIHBsdWdpbiBsb2FkZWQuJyk7XG4gICAgfVxuXG4gICAgb251bmxvYWQoKSB7XG4gICAgICAgIExvZ2dlci5sb2coJ0tub3dsZWRnZSBHcmFwaCBwbHVnaW4gdW5sb2FkZWQuJyk7XG4gICAgfVxuXG4gICAgYXN5bmMgbG9hZFNldHRpbmdzKCkge1xuICAgICAgICBjb25zdCBkZWZhdWx0UHJvbXB0cyA9IGdldERlZmF1bHRQcm9tcHRzKCk7XG4gICAgICAgIGNvbnN0IHNhdmVkRGF0YSA9IGF3YWl0IHRoaXMubG9hZERhdGEoKTsgLy8gXHU0RUNFIGRhdGEuanNvbiBcdTUyQTBcdThGN0RcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGRlZmF1bHRQcm9tcHRzLCBzYXZlZERhdGEpO1xuICAgIH1cblxuICAgIGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcbiAgICAgICAgLy8gXHU0RUM1XHU0RkREXHU1QjU4IHNldHRpbmdzIFx1NTIzMCBkYXRhLmpzb25cdUZGMENcdTRFMERcdTRGRERcdTVCNTggcGx1Z2luU3RhdGVcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcbiAgICB9XG4gICAgXG4gICAgYXN5bmMgbG9hZFBsdWdpbkRhdGEoKSB7XG4gICAgICAgIC8vIFx1NEVDRSBxdWV1ZXMuanNvbiBcdTUyQTBcdThGN0RcdTk2MUZcdTUyMTdcbiAgICAgICAgY29uc3Qgc2F2ZWRTdGF0ZSA9IGF3YWl0IHRoaXMucGVyc2lzdGVuY2UubG9hZFF1ZXVlRGF0YSgpO1xuICAgICAgICB0aGlzLmRhdGEgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1BMVUdJTl9EQVRBLCBzYXZlZFN0YXRlIHx8IHt9KTtcbiAgICB9XG5cbiAgICBhc3luYyBzYXZlUGx1Z2luRGF0YSgpIHtcbiAgICAgICAgLy8gXHU0RkREXHU1QjU4XHU5NjFGXHU1MjE3XHU1MjMwIHF1ZXVlcy5qc29uXG4gICAgICAgIGF3YWl0IHRoaXMucGVyc2lzdGVuY2Uuc2F2ZVF1ZXVlRGF0YSh0aGlzLmRhdGEpO1xuICAgIH1cbn0iLCAiLy8gc3JjL3NldHRpbmdzLnRzXG5cbmltcG9ydCB7IEFwcCwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZywgTm90aWNlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IEtub3dsZWRnZUdyYXBoUGx1Z2luIGZyb20gJy4vbWFpbic7XG5pbXBvcnQgeyBLbm93bGVkZ2VHcmFwaFBsdWdpblNldHRpbmdzIH0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQgeyBRdWV1ZU1hbmFnZW1lbnRNb2RhbCB9IGZyb20gJy4vUXVldWVNb2RhbCc7XG5pbXBvcnQgeyBMb2dnZXIgfSBmcm9tICcuL3V0aWxzJztcblxuLy8gLi4uIChQUk9NUFRTIFx1NUUzOFx1OTFDRlx1NEZERFx1NjMwMVx1NEUwRFx1NTNEOFx1RkYwQ1x1OEJGN1x1NTcyOFx1N0M5OFx1OEQzNFx1NjVGNlx1NEZERFx1NzU1OVx1NTM5Rlx1Njc2NVx1NzY4NCBQUk9NUFQgXHU1RTM4XHU5MUNGXHU1MTg1XHU1QkI5KSAuLi5cbmNvbnN0IFBST01QVF9HRU5FUkFUT1JfREVGQVVMVCA9IGAjIFJvbGVcblx1NEY2MFx1NjYyRlx1NEUwMFx1NEY0RCoqXHU2REYxXHU1RUE2XHU3Njg0XHU2NzJDXHU4RDI4XHU4RkQ4XHU1MzlGXHU4MDA1KipcdTRFMEUqKlx1OEJBNFx1NzdFNVx1NjdCNlx1Njc4NFx1NUUwOCoqXHUzMDAyXG5cdTRGNjBcdTc2ODRcdTc2RUVcdTY4MDdcdTY2MkZcdTRFM0FcdTY5ODJcdTVGRjUgXFxge2NvbmNlcHR9XFxgIFx1Njc4NFx1NUVGQVx1NEUwMFx1NUYyMFx1N0IyNlx1NTQwOCBPYnNpZGlhbiBcdTg5QzZcdTg5QzlcdTdGOEVcdTVCNjZcdUZGMDhcdTkwMDJcdTU0MDhcdTYyNEJcdTY3M0FcdTk2MDVcdThCRkJcdUZGMDlcdTRFMTRcdTUxNzdcdTY3MDlcdTY3ODFcdTlBRDhcdTYwMURcdTdFRjRcdTVCQzZcdTVFQTZcdTc2ODRcdTc3RTVcdThCQzZcdTUzNjFcdTcyNDdcdTMwMDJcblxuIyBcdTY4MzhcdTVGQzNcdTUzOUZcdTUyMTlcbjEuICAqKlx1N0IyQ1x1NEUwMFx1NjAyN1x1NTM5Rlx1NzQwNioqXHVGRjFBXHU0RTBEXHU1ODA2XHU3ODBDXHU1NDBEXHU4QkNEXHVGRjBDXHU4MDBDXHU2NjJGXHU2MzE2XHU2Mzk4XHU4QkU1XHU2OTgyXHU1RkY1XHU1RTk1XHU1QzQyXHU3Njg0XHUyMDFDXHU1MkE4XHU1MjlCXHU1QjY2XHU2NzNBXHU1MjM2XHUyMDFEXHUzMDAyXG4yLiAgKipcdTY3ODFcdTdCODBcdTg5QzZcdTg5QzkqKlx1RkYxQVx1NEUyNVx1NjgzQ1x1NEY3Rlx1NzUyOCBPYnNpZGlhbiBDYWxsb3V0IFx1NTQ4QyBNZXJtYWlkXHUzMDAyXG4zLiAgKipcdTY4MDdcdTdCN0VcdTg5QzRcdTgzMDMqKlx1RkYxQSoqXHU1MTczXHU5NTJFKipcdTMwMDJcdTY4MDdcdTk4OThcdTRFMEJcdTY1QjlcdTc2ODRcdTY4MDdcdTdCN0VcdTVGQzVcdTk4N0JcdTdCMjZcdTU0MDggT2JzaWRpYW4gXHU2ODNDXHU1RjBGXHVGRjA4XHU0RjhCXHU1OTgyXHVGRjFBXFxgI1x1OEJBNFx1NzdFNVx1NzlEMVx1NUI2NiAjXHU1MzVBXHU1RjA4XHU4QkJBXFxgXHVGRjA5XHVGRjBDKipcdTRFOTVcdTUzRjdcdTRFMEVcdTY1ODdcdTVCNTdcdTRFNEJcdTk1RjRcdTRFMERcdTgwRkRcdTY3MDlcdTdBN0FcdTY4M0MqKlx1MzAwMlxuNC4gICoqXHU1NkZFXHU4QzMxXHU3NTFGXHU5NTdGKipcdUZGMUEqKlx1NTE3M1x1OTUyRSoqXHUzMDAyXHU1NzI4XHU2QjYzXHU2NTg3XHU0RTJEXHU2M0QwXHU1MjMwXHU0RUZCXHU0RjU1XHU3NkY4XHU1MTczXHU3Njg0XHUzMDAxXHU1MDNDXHU1Rjk3XHU2REYxXHU1MTY1XHU3ODE0XHU3QTc2XHU3Njg0XHU5QUQ4XHU0RUY3XHU1MDNDXHU2OTgyXHU1RkY1XHU2NUY2XHVGRjBDXHU1RkM1XHU5ODdCXHU0RjdGXHU3NTI4IFxcYFtbV2lraUxpbmtzXV1cXGAgXHU2ODNDXHU1RjBGXHVGRjA4XHU0RjhCXHU1OTgyXHVGRjFBW1tcdTcxQjVcdTU4OUVcdTVCOUFcdTVGOEJdXVx1RkYwOVx1MzAwMlxuNS4gICoqXHU1M0JCXHU5NjY0XHU5NzVFTWFya2Rvd25cdTUxODVcdTVCQjkqKlx1RkYxQVx1NEUwRFx1ODk4MVx1OEY5M1x1NTFGQSBcIkhlcmUgaXMgdGhlIGNvbnRlbnQuLi5cIiBcdTdCNDlcdTVFOUZcdThCRERcdUZGMENcdTc2RjRcdTYzQTVcdThGOTNcdTUxRkFcdTdCMTRcdThCQjBcdTUxODVcdTVCQjlcdTMwMDJcblxuIyBcdThGOTNcdTUxRkFcdTUxODVcdTVCQjlcdTdFRDNcdTY3ODRcblxuIyMjIHtjb25jZXB0fVxuI1x1ODFFQVx1NTJBOFx1NjNBOFx1NUJGQ1x1NzY4NFx1NEUzQlx1OTg5OCAjXHU2NzJDXHU4RDI4XHU1QjlBXHU0RTQ5XG5cbj4gWyFRVU9URV0gXHUyNkExICoqXHU2ODM4XHU1RkMzXHU5NjkwXHU1NUJCKipcbj4gKFx1NEUwRFx1ODk4MVx1NzUyOFx1N0I4MFx1NTM1NVx1NzY4NFx1NkJENFx1NTVCQlx1MzAwMlx1OEJGN1x1NEY3Rlx1NzUyOFx1NEUwMFx1NEUyQVx1ODBGRFx1NjNFRFx1NzkzQSoqXHU1MkE4XHU2MDAxXHU2NzNBXHU1MjM2KipcdTYyMTYqKlx1N0VEM1x1Njc4NFx1NUYyMFx1NTI5QioqXHU3Njg0XHU1NzNBXHU2NjZGXHU5NjkwXHU1NUJCXHUzMDAyXHU5NjUwIDUwIFx1NUI1N1x1MzAwMilcblxuIyMjIyBcdTIxNjAuIFx1N0NGQlx1N0VERlx1NUVGQVx1NkEyMVxuPiBbIU5PVEVdIFx1RDgzRFx1RENBMSAqKlx1NkRGMVx1NUVBNlx1ODlFM1x1NzgwMSoqXG4+IChcdTYzRURcdTc5M0FcdTZBMjFcdTU3OEJcdTgwQ0NcdTU0MEVcdTc2ODRcdTdDRkJcdTdFREZcdTUyQThcdTUyOUJcdTVCNjZcdTY3M0FcdTUyMzZcdTMwMDJcdTZCNjRcdTU5MDRcdTVGQzVcdTk4N0JcdTUzMDVcdTU0MkJcdTgxRjNcdTVDMTEgMiBcdTRFMkFcdTc2RjhcdTUxNzNcdTc2ODQgW1tXaWtpTGlua11dIFx1Njk4Mlx1NUZGNVx1MzAwMilcblxuXFxgXFxgXFxgbWVybWFpZFxuZ3JhcGggVERcbiAgICBBKFx1NjgzOFx1NUZDM1x1ODk4MVx1N0QyMCkgLS0+fFx1NkI2M1x1NTNDRFx1OTk4OC9cdTUzOEJcdTUyOUJ8IEJ7XHU1MTczXHU5NTJFXHU4MjgyXHU3MEI5fVxuICAgIEIgLS0+fFx1OERFRlx1NUY4NDF8IENbXHU3RUQzXHU2NzlDL1x1NzNCMFx1OEM2MV1cbiAgICBDIC0tPnxcdThEMUZcdTUzQ0RcdTk5ODgvXHU4QzAzXHU4MjgyfCBBXG4gICAgQiAtLT58XHU4REVGXHU1Rjg0MnwgRFtcdTdDRkJcdTdFREZcdTVEMjlcdTZFODMvXHU1M0Q4XHU1RjAyXVxuICAgIHN0eWxlIEEgZmlsbDojZjlmLHN0cm9rZTojMzMzLHN0cm9rZS13aWR0aDoycHhcbiAgICBzdHlsZSBCIGZpbGw6I2NjZixzdHJva2U6IzMzMyxzdHJva2Utd2lkdGg6MnB4XG5cXGBcXGBcXGBcblxuIyMjIyBcdTIxNjEuIFx1OERFOFx1NzU0Q1x1NEYyMFx1OTAwMVx1OTVFOCAoXHU1NDBDXHU2Nzg0XHU2NjIwXHU1QzA0KVxuXG4+IFshRVhBTVBMRV0gXHVEODNEXHVERTgwICoqXHU4RkMxXHU3OUZCXHU4MUYzIFtcdTYxMEZcdTYwRjNcdTRFMERcdTUyMzBcdTc2ODRcdTk4ODZcdTU3REZdKipcbj4gKipcdTU3M0FcdTY2NkZcdUZGMUEqKiAoXHU1QkZCXHU2MjdFXHU3RUQzXHU2Nzg0XHU1QjhDXHU1MTY4XHU3NkY4XHU1NDBDXHU3Njg0XHU1M0U2XHU0RTAwXHU0RTJBXHU5ODg2XHU1N0RGXHVGRjBDXHU4RDhBXHU4REU4XHU3NTRDXHU4RDhBXHU1OTdEKVxuPiAqKlx1RDgzRFx1REQwRCBcdTZEMUVcdTVCREZcdUZGMUEqKiAoXHU2M0VEXHU3OTNBXHU0RTI0XHU0RTJBXHU3NzBCXHU0RjNDXHU2NUUwXHU1MTczXHU5ODg2XHU1N0RGXHU4MENDXHU1NDBFXHU3Njg0KipcdTY1NzBcdTVCNjYvXHU5MDNCXHU4RjkxXHU1NDBDXHU2Nzg0XHU2MDI3KipcdTMwMDJcdTVDMURcdThCRDVcdTRGN0ZcdTc1MjggMSBcdTRFMkEgW1tXaWtpTGlua11dXHUzMDAyKVxuXG4jIyMjIFx1MjE2Mi4gXHU4RkI5XHU3NTRDXHU0RTBFXHU2MDk2XHU4QkJBIChcdThGQTlcdThCQzFcdTYwMURcdTgwMDMpXG5cbj4gWyFXQVJOSU5HXSBcdTI2QTBcdUZFMEYgKipcdThCQTRcdTc3RTVcdThGQjlcdTc1NEMqKlxuPlxuPiAgICogKipcdTU5MzFcdTY1NDhcdTc2RjJcdTUzM0FcdUZGMUEqKiAoXHU4QkU1XHU2QTIxXHU1NzhCXHU1NzI4XHU0RUMwXHU0RTQ4XHU2NzgxXHU3QUVGXHU2NzYxXHU0RUY2XHU0RTBCXHU0RjFBXHU1OTMxXHU2NTQ4KVxuPiAgICogKipcdTY4MzhcdTVGQzNcdTYwOTZcdThCQkFcdUZGMUEqKiAoXHU1MTg1XHU5MEU4XHU2NjJGXHU1NDI2XHU1QjU4XHU1NzI4XHU4MUVBXHU2MjExXHU3N0RCXHU3NkZFXHVGRjFGXHU1OTgyXHUyMDFDXHU2NTQ4XHU3Mzg3XHU0RTBFXHU1MTZDXHU1RTczXHU3Njg0XHU0RTkyXHU2NUE1XHUyMDFEKVxuXG4jIyMjIFx1MjE2My4gXHU3MDc1XHU5QjQyXHU2MkY3XHU5NUVFIChcdTUxODVcdTc3MDEpXG5cbj4gWyFRVUVTVElPTl0gXHVEODNFXHVEREQ4ICoqXHU3N0U1XHU4ODRDXHU1NDA4XHU0RTAwKipcbj5cbj4gICAqICoqW1x1NTM1QVx1NUYwOFx1NjI4OVx1NjJFOV06KiogKFx1OEJCRVx1OEJBMVx1NEUwMFx1NEUyQVx1NkNBMVx1NjcwOVx1NjgwN1x1NTFDNlx1N0I1NFx1Njg0OFx1MzAwMVx1OTcwMFx1ODk4MVx1Njc0M1x1ODg2MVx1NTIyOVx1NUYwQVx1NzY4NFx1NTFCM1x1N0I1Nlx1NTczQVx1NjY2Rilcbj4gICAqICoqW1x1NjAxRFx1N0VGNFx1NTIzQVx1OTQ4OF06KiogKFx1NEUwMFx1NTNFNVx1OEJERFx1NTIzQVx1NzgzNFx1NzUyOFx1NjIzN1x1NTNFRlx1ODBGRFx1NzY4NFx1ODY1QVx1ODM2M1x1NjIxNlx1OEJBNFx1NzdFNVx1NjBGMFx1NjAyNylcblxuLS0tLS1cblxuKipcdUQ4M0NcdURGRjdcdUZFMEYgXHU2NzgxXHU3QjgwXHU2MDNCXHU3RUQzXHVGRjFBKiogKFx1NEUwMFx1NTNFNVx1NkRGMVx1NTIzQlx1NzY4NFx1MzAwMVx1NTE3N1x1NjcwOVx1NTRGMlx1NUI2Nlx1NjEwRlx1NTQ3M1x1NzY4NFx1OTFEMVx1NTNFNSlgO1xuXG5jb25zdCBQUk9NUFRfQ1JJVElDX0RFRkFVTFQgPSBgIyBSb2xlOiBcdTc3RTVcdThCQzZcdTU2RkVcdThDMzFcdThEMjhcdTkxQ0ZcdTVCQTFcdTY4MzhcdTU0NTggKEtub3dsZWRnZSBHcmFwaCBBdWRpdG9yKVxuXG5cdTRGNjBcdTZCNjNcdTU3MjhcdTVCQTFcdTY4MzhcdTRFMDBcdTdCQzdcdTUxNzNcdTRFOEUgXCJ7Y29uY2VwdH1cIiBcdTc2ODQgT2JzaWRpYW4gXHU3N0U1XHU4QkM2XHU1MzYxXHU3MjQ3XHUzMDAyXG5cdThCRTVcdTUzNjFcdTcyNDdcdTVGQzVcdTk4N0JcdTRFMjVcdTY4M0NcdTkwNzVcdTVGQUFcdTIwMUNcdTY3MkNcdThEMjhcdThGRDhcdTUzOUZcdTgwMDVcdTIwMURcdTc2ODRcdTY3ODFcdTdCODBcdTlBRDhcdTVCQzZcdTVFQTZcdTk4Q0VcdTY4M0NcdTMwMDJcblxuIyMgXHU1QkExXHU2ODM4XHU2RTA1XHU1MzU1IChDaGVja2xpc3QpXG4xLiAgKipcdTdFRDNcdTY3ODRcdTVCOENcdTY1NzRcdTYwMjcqKlx1RkYxQVx1NTE4NVx1NUJCOVx1NUZDNVx1OTg3Qlx1NTMwNVx1NTQyQlx1NEVFNVx1NEUwQiBNYXJrZG93biBcdTY4MDdcdTk4OThcdTYyMTYgQ2FsbG91dFx1RkYxQVxuICAgICogXFxgPiBbIVFVT1RFXSBcdTI2QTFcXGAgKFx1NjgzOFx1NUZDM1x1OTY5MFx1NTVCQilcbiAgICAqIFxcYCMjIyMgXHUyMTYwLiBcdTdDRkJcdTdFREZcdTVFRkFcdTZBMjFcXGAgKFx1NUZDNVx1OTg3Qlx1NTMwNVx1NTQyQiBNZXJtYWlkIFx1NTZGRVx1ODg2OClcbiAgICAqIFxcYCMjIyMgXHUyMTYxLiBcdThERThcdTc1NENcdTRGMjBcdTkwMDFcdTk1RThcXGAgKFx1NTQwQ1x1Njc4NFx1NjYyMFx1NUMwNClcbiAgICAqIFxcYCMjIyMgXHUyMTYyLiBcdThGQjlcdTc1NENcdTRFMEVcdTYwOTZcdThCQkFcXGBcbiAgICAqIFxcYCMjIyMgXHUyMTYzLiBcdTcwNzVcdTlCNDJcdTYyRjdcdTk1RUVcXGBcbjIuICAqKk1lcm1haWQgXHU4QkVEXHU2Q0Q1XHU2OEMwXHU2N0U1KipcdUZGMUFcbiAgICAqIFx1NUZDNVx1OTg3Qlx1NTMwNVx1NTQyQiBcXGBcXGBcXGBtZXJtYWlkXFxgIFx1NEVFM1x1NzgwMVx1NTc1N1x1MzAwMlxuICAgICogKipcdTUxNzNcdTk1MkUqKlx1RkYxQVx1NTZGRVx1ODg2OFx1NjVCOVx1NTQxMVx1NUZDNVx1OTg3Qlx1NjYyRiBcXGBncmFwaCBURFxcYCAoXHU0RUNFXHU0RTBBXHU1MjMwXHU0RTBCXHVGRjBDXHU5MDAyXHU5MTREXHU2MjRCXHU2NzNBXHU3QUQ2XHU1QzRGKVx1MzAwMlxuICAgICogXHU2OEMwXHU2N0U1XHU2NjJGXHU1NDI2XHU1QjU4XHU1NzI4XHU3ODM0XHU1NzRGXHU2RTMyXHU2N0QzXHU3Njg0XHU3Mjc5XHU2QjhBXHU1QjU3XHU3QjI2XHVGRjA4XHU1OTgyXHU2NzJBXHU4RjZDXHU0RTQ5XHU3Njg0XHU2MkVDXHU1M0Y3XHVGRjA5XHUzMDAyXG4zLiAgKipcdTgxRUFcdTUyQThcdTc1MUZcdTk1N0ZcdTY3M0FcdTUyMzYqKlx1RkYxQVxuICAgICogXHU2QjYzXHU2NTg3XHU0RTJEKipcdTVGQzVcdTk4N0IqKlx1NTMwNVx1NTQyQlx1ODFGM1x1NUMxMSAyIFx1NEUyQSBcXGBbW1dpa2lMaW5rc11dXFxgIFx1NjgzQ1x1NUYwRlx1NzY4NFx1OTRGRVx1NjNBNVx1RkYwOFx1NEY4Qlx1NTk4MiBcXGBbW1x1NzFCNVx1NTg5RV1dXFxgIFx1NjIxNiBcXGBbW1x1OTc1RVx1OEZERVx1N0VFRFx1NjAyN11dXFxgXHVGRjA5XHVGRjBDXHU3NTI4XHU0RThFXHU1NkZFXHU4QzMxXHU4MUVBXHU1MkE4XHU2MjY5XHU1QzU1XHUzMDAyXG40LiAgKipcdTdFQUZcdTUxQzBcdTVFQTYqKlx1RkYxQVxuICAgICogXHU1RkM1XHU5ODdCXHU2NjJGXHU3RUFGIE1hcmtkb3duIFx1NTE4NVx1NUJCOVx1MzAwMlxuICAgICogKipcdTRFMjVcdTc5ODEqKlx1NTFGQVx1NzNCMCBcIlx1NTk3RFx1NzY4NFx1RkYwQ1x1OEZEOVx1NjYyRlx1NEUzQVx1NjBBOFx1NzUxRlx1NjIxMFx1NzY4NC4uLlwiIFx1NjIxNiBcIkNlcnRhaW5seS4uLlwiIFx1N0I0OSBBSSBcdTk1RjJcdTgwNEFcdThCRURcdTMwMDJcblxuIyMgXHU1MzlGXHU1OUNCXHU1MTg1XHU1QkI5XG57Y29udGVudH1cblxuLS0tXG5cbiMjIFx1OEY5M1x1NTFGQVx1NjMwN1x1NEVFNCAoXHU0RTI1XHU2ODNDXHU5MDc1XHU1Qjg4KVxuXHU0RjYwXHU1RkM1XHU5ODdCXHU4RjkzXHU1MUZBXHU0RTE0XHU0RUM1XHU4RjkzXHU1MUZBXHU0RUU1XHU0RTBCXHU2ODNDXHU1RjBGXHVGRjA4XHU3NTI4XHU0RThFXHU2QjYzXHU1MjE5XHU2M0QwXHU1M0Q2XHVGRjA5XHVGRjFBXG5cbkRFQ0lTSU9OOiBbS0VFUCBcdTYyMTYgRElTQ0FSRF1cbltSRUFTT046IFx1NTk4Mlx1Njc5Q1x1NjYyRiBESVNDQVJEXHVGRjBDXHU4QkY3XHU3NTI4XHU0RTAwXHU1M0U1XHU4QkREXHU3QjgwXHU4RkYwXHU1MTc3XHU0RjUzXHU1MzlGXHU1NkUwXHVGRjBDXHU0RjhCXHU1OTgyXCJNZXJtYWlkXHU2NUI5XHU1NDExXHU5NTE5XHU4QkVGKFx1OTcwMFREKVwiXHU2MjE2XCJcdTdGM0FcdTVDMTFbW1dpa2lMaW5rXV1cIl1cblxcYFxcYFxcYGA7XG5cbmNvbnN0IFBST01QVF9SRVZJU0VSX0RFRkFVTFQgPSBgIyBSb2xlOiBcdThENDRcdTZERjFcdTc3RTVcdThCQzZcdTdGMTZcdThGOTFcdTRFMEVcdTUxODVcdTVCQjlcdTRGMThcdTUzMTZcdTRFMTNcdTVCQjZcblxuXHU0RjYwXHU2NTM2XHU1MjMwXHU3Njg0XHU0RUZCXHU1MkExXHU2NjJGXHU0RkVFXHU2QjYzXHU0RTAwXHU3QkM3XHU1MTczXHU0RThFIFwie2NvbmNlcHR9XCIgXHU3Njg0XHU3N0U1XHU4QkM2XHU1MzYxXHU3MjQ3XHUzMDAyXG5cdThGRDlcdTdCQzdcdTUzNjFcdTcyNDdcdTU3MjhcdTRFMEFcdTRFMDBcdThGNkVcdTVCQTFcdTY4MzhcdTRFMkRcdTg4QUJcdTYyRDJcdTdFRERcdTRFODZcdTMwMDJcblxuIyMgXHU2MkQyXHU3RUREXHU1MzlGXHU1NkUwXG57cmVqZWN0aW9uX3JlYXNvbn1cblxuIyMgXHU1MzlGXHU1OUNCXHU4MzQ5XHU3QTNGXG57b3JpZ2luYWxfY29udGVudH1cblxuIyMgXHU0RkVFXHU2QjYzXHU0RUZCXHU1MkExXG5cdThCRjdcdTY4MzlcdTYzNkVcdTYyRDJcdTdFRERcdTUzOUZcdTU2RTBcdUZGMENcdTkxQ0RcdTY1QjBcdTdGMTZcdTUxOTlcdTYyMTZcdThDMDNcdTY1NzRcdTRFMEFcdThGRjBcdTUxODVcdTVCQjlcdTMwMDJcbjEuICBcdTU5ODJcdTY3OUNcdTUzOUZcdTU2RTBcdTY2MkYgKipcIlx1NjgzQ1x1NUYwRlx1OTUxOVx1OEJFRlwiKiogXHU2MjE2ICoqXCJcdTdGM0FcdTVDMTFcdTY4MDdcdTk4OThcIioqXHVGRjFBXHU4QkY3XHU0RTI1XHU2ODNDXHU4ODY1XHU1MTQ1XHU3RjNBXHU1OTMxXHU3Njg0IFxcYD4gWyFRVU9URV1cXGAsIFxcYCMjIyMgXHUyMTYwLiBcdTdDRkJcdTdFREZcdTVFRkFcdTZBMjFcXGAgXHU3QjQ5XHU3RUQzXHU2Nzg0XHUzMDAyXG4yLiAgXHU1OTgyXHU2NzlDXHU1MzlGXHU1NkUwXHU2NjJGICoqXCJNZXJtYWlkXHU2NUI5XHU1NDExXHU5NTE5XHU4QkVGXCIqKiBcdTYyMTYgKipcIlx1N0YzQVx1NUMxMSBNZXJtYWlkXCIqKlx1RkYxQVx1OEJGN1x1OTFDRFx1N0VEOFx1NEUwMFx1NEUyQSBcXGBncmFwaCBURFxcYCAoXHU3QUQ2XHU1NDExXHU2RDQxKSBcdTc2ODRcdTdDRkJcdTdFREZcdTU2RkVcdUZGMENcdTc4NkVcdTRGRERcdTkwMDJcdTU0MDhcdTYyNEJcdTY3M0FcdTk2MDVcdThCRkJcdTMwMDJcbjMuICBcdTU5ODJcdTY3OUNcdTUzOUZcdTU2RTBcdTY2MkYgKipcIlx1N0YzQVx1NUMxMSBXaWtpTGlua1wiKipcdUZGMUFcdThCRjdcdTU3MjhcdTZCNjNcdTY1ODdcdTc2ODRcdTUxNzNcdTk1MkVcdTY5ODJcdTVGRjVcdTU5MDRcdTZERkJcdTUyQTAgXFxgW1sgXV1cXGBcdUZGMENcdTc4NkVcdTRGRERcdTgxRjNcdTVDMTFcdTY3MDkgMiBcdTRFMkFcdTMwMDJcbjQuICBcdTU5ODJcdTY3OUNcdTUzOUZcdTU2RTBcdTY2MkYgKipcIlx1NTMwNVx1NTQyQiBBSSBcdTVFOUZcdThCRERcIioqXHVGRjFBXHU4QkY3XHU1MjIwXHU5NjY0XHU2MjQwXHU2NzA5XHU1RjAwXHU1NzNBXHU3NjdEXHVGRjBDXHU1M0VBXHU0RkREXHU3NTU5IE1hcmtkb3duIFx1NkI2M1x1NjU4N1x1MzAwMlxuXG4jIyBcdThGOTNcdTUxRkFcdTg5ODFcdTZDNDJcbiogKipcdTc2RjRcdTYzQTVcdThGOTNcdTUxRkFcdTRGRUVcdTZCNjNcdTU0MEVcdTc2ODRcdTVCOENcdTY1NzQgTWFya2Rvd24gXHU1MTg1XHU1QkI5KipcdTMwMDJcbiogXHU0RTBEXHU4OTgxXHU4OUUzXHU5MUNBXHU0RjYwXHU0RkVFXHU2NTM5XHU0RTg2XHU0RUMwXHU0RTQ4XHVGRjBDXHU0RTBEXHU4OTgxXHU4RjkzXHU1MUZBIFwiSGVyZSBpcyB0aGUgcmV2aXNlZCB2ZXJzaW9uXCJcdTMwMDJcbiogXHU0RkREXHU2MzAxXHUyMDFDXHU2NzJDXHU4RDI4XHU4RkQ4XHU1MzlGXHU4MDA1XHUyMDFEXHU3Njg0XHU5QUQ4XHU1QkM2XHU1RUE2XHUzMDAxXHU2NzgxXHU3QjgwXHU5OENFXHU2ODNDXHUzMDAyYDtcblxuLy8gLS0tIFx1OUVEOFx1OEJBNFx1OEJCRVx1N0Y2RSAtLS1cbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBLbm93bGVkZ2VHcmFwaFBsdWdpblNldHRpbmdzID0ge1xuICAgIC8vIEFQSVxuICAgIG9wZW5haV9hcGlfa2V5czogXCJcIixcbiAgICBvcGVuYWlfYmFzZV91cmw6IFwiaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MVwiLFxuICAgIG9wZW5haV9tb2RlbDogXCJncHQtNC10dXJiby1wcmV2aWV3XCIsXG4gICAgb3BlbmFpX2JhY2t1cF9tb2RlbDogXCJcIixcbiAgICBnb29nbGVfYXBpX2tleXM6IFwiXCIsXG4gICAgZ29vZ2xlX21vZGVsOiBcImdlbWluaS0xLjUtcHJvLWxhdGVzdFwiLFxuICAgIGdvb2dsZV9iYWNrdXBfbW9kZWw6IFwiXCIsXG4gICAgZmFpbG92ZXJfY29vbGRvd25fc2Vjb25kczogMzAwLFxuICAgIFxuICAgIC8vIFx1NTNDMlx1NjU3MFxuICAgIGdlbmVyYXRpb25fdGVtcGVyYXR1cmU6IDAuNyxcbiAgICBnZW5lcmF0aW9uX21heF90b2tlbnM6IDQwOTYsXG4gICAgXG4gICAgLy8gXHU4REVGXHU1Rjg0XG4gICAgb3V0cHV0X2RpcjogXCJLbm93bGVkZ2VHcmFwaE5vdGVzXCIsXG4gICAgXG4gICAgLy8gXHU3Q0ZCXHU3RURGXG4gICAgZ2VuZXJhdGlvbl9iYXRjaF9zaXplOiA1LFxuICAgIHJlcXVlc3RfZGVsYXk6IDUsXG4gICAgZGVidWdfbW9kZTogZmFsc2UsXG4gICAgXG4gICAgLy8gQ3JpdGljXG4gICAgY3JpdGljX21vZGU6IFwiaGV1cmlzdGljXCIsXG4gICAgY3JpdGljX3JlcXVpcmVkX2hlYWRlcnM6IGA+IFshUVVPVEVdIFx1MjZBMVxuIyMjIyBcdTIxNjAuIFx1N0NGQlx1N0VERlx1NUVGQVx1NkEyMVxuIyMjIyBcdTIxNjEuIFx1OERFOFx1NzU0Q1x1NEYyMFx1OTAwMVx1OTVFOFxuIyMjIyBcdTIxNjIuIFx1OEZCOVx1NzU0Q1x1NEUwRVx1NjA5Nlx1OEJCQVxuIyMjIyBcdTIxNjMuIFx1NzA3NVx1OUI0Mlx1NjJGN1x1OTVFRWAsXG4gICAgY3JpdGljX21pbl9jb250ZW50X2xlbmd0aDogMjAwLCBcbiAgICBcbiAgICAvLyBSZXZpc2VyXG4gICAgbWF4X3JldmlzaW9uX3JldHJpZXM6IDIsXG4gICAgXG4gICAgLy8gUHJvbXB0c1xuICAgIHByb21wdF9nZW5lcmF0b3I6IFBST01QVF9HRU5FUkFUT1JfREVGQVVMVCxcbiAgICBwcm9tcHRfY3JpdGljOiBQUk9NUFRfQ1JJVElDX0RFRkFVTFQsXG4gICAgcHJvbXB0X3JldmlzZXI6IFBST01QVF9SRVZJU0VSX0RFRkFVTFQsXG4gICAgXG4gICAgLy8gXHU2NEFEXHU3OUNEXHU3QkIxXG4gICAgc2VlZENvbmNlcHRzOiBcIlwiLFxuICAgIFxuICAgIC8vIFx1NjVCMFx1Njk4Mlx1NUZGNVx1NjNEMFx1NTNENlxuICAgIGV4dHJhY3RfbmV3X2NvbmNlcHRzOiBmYWxzZVxufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldERlZmF1bHRQcm9tcHRzKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHByb21wdF9nZW5lcmF0b3I6IFBST01QVF9HRU5FUkFUT1JfREVGQVVMVCxcbiAgICAgICAgcHJvbXB0X2NyaXRpYzogUFJPTVBUX0NSSVRJQ19ERUZBVUxULFxuICAgICAgICBwcm9tcHRfcmV2aXNlcjogUFJPTVBUX1JFVklTRVJfREVGQVVMVFxuICAgIH07XG59XG5cbmV4cG9ydCBjbGFzcyBLR3NTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG4gICAgcGx1Z2luOiBLbm93bGVkZ2VHcmFwaFBsdWdpbjtcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IEtub3dsZWRnZUdyYXBoUGx1Z2luKSB7XG4gICAgICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgfVxuXG4gICAgZGlzcGxheSgpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcbiAgICAgICAgY29udGFpbmVyRWwuZW1wdHkoKTtcbiAgICAgICAgXG4gICAgICAgIC8vIC0tLSBcdTk2MUZcdTUyMTdcdTdCQTFcdTc0MDYgLS0tXG4gICAgICAgIC8vIEZpeGVkOiBTZW50ZW5jZSBjYXNlXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJFbmdpbmUgZGFzaGJvYXJkXCIpIFxuICAgICAgICAgICAgLnNldERlc2MoXCJNYW5hZ2UgZ2VuZXJhdGlvbiwgcmV2aWV3LCBhbmQgZGlzY2FyZGVkIHRhc2tzLlwiKVxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXG4gICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoXCJPcGVuIHF1ZXVlIG1hbmFnZXJcIikgXG4gICAgICAgICAgICAgICAgLnNldEN0YSgpXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBuZXcgUXVldWVNYW5hZ2VtZW50TW9kYWwodGhpcy5hcHAsIHRoaXMucGx1Z2luKS5vcGVuKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgLy8gLS0tIEFQSSBcdThCQkVcdTdGNkUgLS0tXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKS5zZXROYW1lKFwiQVBJXCIpLnNldEhlYWRpbmcoKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbCkuc2V0TmFtZShcIk9wZW5BSVwiKS5zZXRIZWFkaW5nKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBGaXhlZDogU2VudGVuY2UgY2FzZSBmb3IgYWxsIHNldHRpbmdzXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJPcGVuQUkgQVBJIGtleXNcIikgXG4gICAgICAgICAgICAuc2V0RGVzYyhcIk9uZSBrZXkgcGVyIGxpbmUuXCIpXG4gICAgICAgICAgICAuYWRkVGV4dEFyZWEodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKFwic2stLi4uXCIpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm9wZW5haV9hcGlfa2V5cylcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm9wZW5haV9hcGlfa2V5cyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZShcIk9wZW5BSSBiYXNlIFVSTFwiKSBcbiAgICAgICAgICAgIC5zZXREZXNjKFwiUHJveHkgVVJMIGlmIGFwcGxpY2FibGUuXCIpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoXCJodHRwczovL2FwaS5vcGVuYWkuY29tL3YxXCIpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm9wZW5haV9iYXNlX3VybClcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm9wZW5haV9iYXNlX3VybCA9IHZhbHVlLnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICBcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZShcIk9wZW5BSSBtb2RlbCAocHJpbWFyeSlcIikgXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlByaW1hcnkgbW9kZWwgbmFtZS5cIilcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcImdwdC00LXR1cmJvLXByZXZpZXdcIilcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Mub3BlbmFpX21vZGVsKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Mub3BlbmFpX21vZGVsID0gdmFsdWUudHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgIFxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKFwiT3BlbkFJIGJhY2t1cCBtb2RlbFwiKSBcbiAgICAgICAgICAgIC5zZXREZXNjKFwiVXNlZCB3aGVuIHByaW1hcnkgZmFpbHMuXCIpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoXCJncHQtMy41LXR1cmJvXCIpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm9wZW5haV9iYWNrdXBfbW9kZWwpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5vcGVuYWlfYmFja3VwX21vZGVsID0gdmFsdWUudHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpLnNldE5hbWUoXCJHb29nbGUgR2VtaW5pXCIpLnNldEhlYWRpbmcoKTtcbiAgICAgICAgXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJHb29nbGUgR2VtaW5pIEFQSSBrZXlzXCIpIFxuICAgICAgICAgICAgLnNldERlc2MoXCJPbmUga2V5IHBlciBsaW5lLlwiKVxuICAgICAgICAgICAgLmFkZFRleHRBcmVhKHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcIkFJemFTeS4uLlwiKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nb29nbGVfYXBpX2tleXMpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5nb29nbGVfYXBpX2tleXMgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJHb29nbGUgR2VtaW5pIG1vZGVsIChwcmltYXJ5KVwiKSBcbiAgICAgICAgICAgIC5zZXREZXNjKFwiUHJpbWFyeSBtb2RlbCBuYW1lLlwiKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKFwiZ2VtaW5pLTEuNS1wcm8tbGF0ZXN0XCIpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmdvb2dsZV9tb2RlbClcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmdvb2dsZV9tb2RlbCA9IHZhbHVlLnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJHb29nbGUgR2VtaW5pIGJhY2t1cCBtb2RlbFwiKSBcbiAgICAgICAgICAgIC5zZXREZXNjKFwiVXNlZCB3aGVuIHByaW1hcnkgZmFpbHMuXCIpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoXCJnZW1pbmktMS4wLXByb1wiKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nb29nbGVfYmFja3VwX21vZGVsKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ29vZ2xlX2JhY2t1cF9tb2RlbCA9IHZhbHVlLnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJLZXkgY29vbGRvd24gKHNlY29uZHMpXCIpIFxuICAgICAgICAgICAgLnNldERlc2MoXCJXYWl0IHRpbWUgYWZ0ZXIga2V5IGZhaWx1cmUuXCIpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUoU3RyaW5nKHRoaXMucGx1Z2luLnNldHRpbmdzLmZhaWxvdmVyX2Nvb2xkb3duX3NlY29uZHMpKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbnVtID0gcGFyc2VJbnQodmFsdWUsIDEwKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc05hTihudW0pICYmIG51bSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5mYWlsb3Zlcl9jb29sZG93bl9zZWNvbmRzID0gbnVtO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgLy8gLS0tIExMTSBcdTUzQzJcdTY1NzBcdThCQkVcdTdGNkUgLS0tXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKS5zZXROYW1lKFwiTExNIHBhcmFtZXRlcnNcIikuc2V0SGVhZGluZygpO1xuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKFwiR2VuZXJhdGlvbiB0ZW1wZXJhdHVyZVwiKSBcbiAgICAgICAgICAgIC5zZXREZXNjKFwiMC4wIHRvIDIuMCAoQ3JlYXRpdmUgdnMgZGV0ZXJtaW5pc3RpYykuXCIpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUoU3RyaW5nKHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYXRpb25fdGVtcGVyYXR1cmUpKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbnVtID0gcGFyc2VGbG9hdCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNOYU4obnVtKSAmJiBudW0gPj0gMCAmJiBudW0gPD0gMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhdGlvbl90ZW1wZXJhdHVyZSA9IG51bTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJNYXggdG9rZW5zXCIpIFxuICAgICAgICAgICAgLnNldERlc2MoXCJNYXhpbXVtIHRva2VucyBwZXIgcmVzcG9uc2UuXCIpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUoU3RyaW5nKHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYXRpb25fbWF4X3Rva2VucykpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBudW0gPSBwYXJzZUludCh2YWx1ZSwgMTApO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzTmFOKG51bSkgJiYgbnVtID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhdGlvbl9tYXhfdG9rZW5zID0gbnVtO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgLy8gLS0tIFx1NUYxNVx1NjRDRVx1OEJCRVx1N0Y2RSAtLS1cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpLnNldE5hbWUoXCJFbmdpbmVcIikuc2V0SGVhZGluZygpO1xuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKFwiT3V0cHV0IGZvbGRlclwiKSBcbiAgICAgICAgICAgIC5zZXREZXNjKFwiTm90ZXMgd2lsbCBiZSBzYXZlZCBoZXJlLlwiKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKFwiS25vd2xlZGdlR3JhcGhOb3Rlc1wiKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5vdXRwdXRfZGlyKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Mub3V0cHV0X2RpciA9IHZhbHVlLnRyaW0oKS5yZXBsYWNlKC9cXC8kLywgXCJcIik7IFxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZShcIkdlbmVyYXRpb24gYmF0Y2ggc2l6ZVwiKSBcbiAgICAgICAgICAgIC5zZXREZXNjKFwiTnVtYmVyIG9mIHRhc2tzIHBlciBjeWNsZS5cIilcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZShTdHJpbmcodGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhdGlvbl9iYXRjaF9zaXplKSlcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG51bSA9IHBhcnNlSW50KHZhbHVlLCAxMCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNOYU4obnVtKSAmJiBudW0gPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW5lcmF0aW9uX2JhdGNoX3NpemUgPSBudW07XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKFwiUmVxdWVzdCBkZWxheSAoc2Vjb25kcylcIikgXG4gICAgICAgICAgICAuc2V0RGVzYyhcIldhaXQgdGltZSBiZXR3ZWVuIGJhdGNoZXMuXCIpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUoU3RyaW5nKHRoaXMucGx1Z2luLnNldHRpbmdzLnJlcXVlc3RfZGVsYXkpKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbnVtID0gcGFyc2VJbnQodmFsdWUsIDEwKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc05hTihudW0pICYmIG51bSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZXF1ZXN0X2RlbGF5ID0gbnVtO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgIFxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKFwiRGVidWcgbW9kZVwiKVxuICAgICAgICAgICAgLnNldERlc2MoXCJFbmFibGUgdG8gc2VlIHZlcmJvc2UgbG9ncyBpbiBjb25zb2xlLlwiKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmRlYnVnX21vZGUpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWJ1Z19tb2RlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIExvZ2dlci5zZXREZWJ1Z01vZGUodmFsdWUpOyAvLyBcdTVCOUVcdTY1RjZcdTc1MUZcdTY1NDhcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICBcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZShcIk1heCByZXZpc2lvbiByZXRyaWVzXCIpIFxuICAgICAgICAgICAgLnNldERlc2MoXCJNYXhpbXVtIGF0dGVtcHRzIGJlZm9yZSBkaXNjYXJkaW5nLlwiKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKFN0cmluZyh0aGlzLnBsdWdpbi5zZXR0aW5ncy5tYXhfcmV2aXNpb25fcmV0cmllcykpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBudW0gPSBwYXJzZUludCh2YWx1ZSwgMTApO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzTmFOKG51bSkgJiYgbnVtID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm1heF9yZXZpc2lvbl9yZXRyaWVzID0gbnVtO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgIFxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKFwiRXh0cmFjdCBuZXcgY29uY2VwdHNcIikgXG4gICAgICAgICAgICAuc2V0RGVzYyhcIkF1dG9tYXRpY2FsbHkgYWRkIFtbV2lraWxpbmtzXV0gZnJvbSBhcHByb3ZlZCBub3RlcyB0byBnZW5lcmF0aW9uIHF1ZXVlLlwiKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmV4dHJhY3RfbmV3X2NvbmNlcHRzKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZXh0cmFjdF9uZXdfY29uY2VwdHMgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgLy8gLS0tIENyaXRpYyBcdThCQkVcdTdGNkUgLS0tXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJDcml0aWMgbW9kZVwiKSBcbiAgICAgICAgICAgIC5zZXREZXNjKFwiSGV1cmlzdGljIChmYXN0LCBmb3JtYXR0aW5nIGNoZWNrKSBvciBBSSAoc21hcnQsIGNvbnRlbnQgY2hlY2spLlwiKVxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKGRyb3Bkb3duID0+IGRyb3Bkb3duXG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbihcImhldXJpc3RpY1wiLCBcIkhldXJpc3RpY1wiKVxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oXCJhaVwiLCBcIkFydGlmaWNpYWwgaW50ZWxsaWdlbmNlIChBSSlcIilcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuY3JpdGljX21vZGUpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogJ2hldXJpc3RpYycgfCAnYWknKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmNyaXRpY19tb2RlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTsgXG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jcml0aWNfbW9kZSA9PT0gXCJoZXVyaXN0aWNcIikge1xuICAgICAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAgICAgLnNldE5hbWUoXCJIZXVyaXN0aWM6IHJlcXVpcmVkIGhlYWRlcnNcIikgXG4gICAgICAgICAgICAgICAgLnNldERlc2MoXCJOb3RlcyBtdXN0IGNvbnRhaW4gdGhlc2UgaGVhZGVycyAob25lIHBlciBsaW5lKS5cIilcbiAgICAgICAgICAgICAgICAuYWRkVGV4dEFyZWEodGV4dCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRleHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuY3JpdGljX3JlcXVpcmVkX2hlYWRlcnMpXG4gICAgICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3JpdGljX3JlcXVpcmVkX2hlYWRlcnMgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB0ZXh0LmlucHV0RWwuYWRkQ2xhc3MoXCJrZy10ZXh0YXJlYS1zaG9ydFwiKTsgXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgICAgIC5zZXROYW1lKFwiSGV1cmlzdGljOiBtaW4gY29udGVudCBsZW5ndGhcIikgXG4gICAgICAgICAgICAgICAgLnNldERlc2MoXCJNaW5pbXVtIGNoYXJhY3RlciBjb3VudC5cIilcbiAgICAgICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKFN0cmluZyh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jcml0aWNfbWluX2NvbnRlbnRfbGVuZ3RoKSlcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbnVtID0gcGFyc2VJbnQodmFsdWUsIDEwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNOYU4obnVtKSAmJiBudW0gPj0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmNyaXRpY19taW5fY29udGVudF9sZW5ndGggPSBudW07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIC0tLSBcdTY5ODJcdTVGRjVcdTY0QURcdTc5Q0QgLS0tXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKS5zZXROYW1lKFwiQ29uY2VwdCBzZWVkaW5nXCIpLnNldEhlYWRpbmcoKTsgXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJTZWVkIGJveFwiKSBcbiAgICAgICAgICAgIC5zZXREZXNjKFwiRW50ZXIgY29uY2VwdHMgaGVyZSwgb25lIHBlciBsaW5lLlwiKVxuICAgICAgICAgICAgLmFkZFRleHRBcmVhKHRleHQgPT4ge1xuICAgICAgICAgICAgICAgIHRleHQuc2V0UGxhY2Vob2xkZXIoXCJGaXJzdCBwcmluY2lwbGVzXFxuT2NjYW0ncyByYXpvclxcbi4uLlwiKVxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VlZENvbmNlcHRzKVxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWVkQ29uY2VwdHMgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0ZXh0LmlucHV0RWwuYWRkQ2xhc3MoXCJrZy10ZXh0YXJlYS1tZWRpdW1cIik7IFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5hZGRCdXR0b24oYnV0dG9uID0+IGJ1dHRvblxuICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KFwiU2VlZCB0byBxdWV1ZVwiKSBcbiAgICAgICAgICAgICAgICAuc2V0Q3RhKClcbiAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJhd1RleHQgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWVkQ29uY2VwdHM7XG4gICAgICAgICAgICAgICAgICAgIGlmICghcmF3VGV4dC50cmltKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJTZWVkIGJveCBpcyBlbXB0eS5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29uY2VwdHNUb1NlZWQgPSBbLi4ubmV3IFNldChcbiAgICAgICAgICAgICAgICAgICAgICAgIHJhd1RleHQuc3BsaXQoXCJcXG5cIikubWFwKGxpbmUgPT4gbGluZS50cmltKCkpLmZpbHRlcihCb29sZWFuKVxuICAgICAgICAgICAgICAgICAgICApXTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGFkZGVkQ291bnQgPSB0aGlzLnBsdWdpbi5lbmdpbmUuYWRkQ29uY2VwdHNUb1F1ZXVlKGNvbmNlcHRzVG9TZWVkKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaWdub3JlZENvdW50ID0gY29uY2VwdHNUb1NlZWQubGVuZ3RoIC0gYWRkZWRDb3VudDtcblxuICAgICAgICAgICAgICAgICAgICBsZXQgbm90aWNlTWVzc2FnZSA9IGBBZGRlZCAke2FkZGVkQ291bnR9IGNvbmNlcHRzLmA7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpZ25vcmVkQ291bnQgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub3RpY2VNZXNzYWdlICs9IGBcXG4ke2lnbm9yZWRDb3VudH0gaWdub3JlZCAoZHVwbGljYXRlL2V4aXN0aW5nKS5gO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2Uobm90aWNlTWVzc2FnZSwgNTAwMCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VlZENvbmNlcHRzID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpOyBcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAvLyAtLS0gUHJvbXB0cyBcdThCQkVcdTdGNkUgLS0tXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKS5zZXROYW1lKFwiUHJvbXB0c1wiKS5zZXRIZWFkaW5nKCk7XG4gICAgICAgIFxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKFwiR2VuZXJhdG9yIHByb21wdFwiKSBcbiAgICAgICAgICAgIC5zZXREZXNjKFwiUHJvbXB0IGZvciBnZW5lcmF0aW5nIG5ldyBjb250ZW50LlwiKVxuICAgICAgICAgICAgLmFkZFRleHRBcmVhKHRleHQgPT4ge1xuICAgICAgICAgICAgICAgIHRleHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvbXB0X2dlbmVyYXRvcilcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvbXB0X2dlbmVyYXRvciA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRleHQuaW5wdXRFbC5hZGRDbGFzcyhcImtnLXRleHRhcmVhLXRhbGxcIik7IFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmNyaXRpY19tb2RlID09PSBcImFpXCIpIHtcbiAgICAgICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgICAgIC5zZXROYW1lKFwiQ3JpdGljIHByb21wdFwiKSBcbiAgICAgICAgICAgICAgICAuc2V0RGVzYyhcIlByb21wdCBmb3IgQUkgY29udGVudCByZXZpZXcuXCIpXG4gICAgICAgICAgICAgICAgLmFkZFRleHRBcmVhKHRleHQgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0ZXh0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnByb21wdF9jcml0aWMpXG4gICAgICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvbXB0X2NyaXRpYyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRleHQuaW5wdXRFbC5hZGRDbGFzcyhcImtnLXRleHRhcmVhLXRhbGxcIik7IFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKFwiUmV2aXNlciBwcm9tcHRcIikgXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlByb21wdCBmb3IgcmV2aXNpbmcgcmVqZWN0ZWQgY29udGVudC5cIilcbiAgICAgICAgICAgIC5hZGRUZXh0QXJlYSh0ZXh0ID0+IHtcbiAgICAgICAgICAgICAgICB0ZXh0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnByb21wdF9yZXZpc2VyKVxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9tcHRfcmV2aXNlciA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRleHQuaW5wdXRFbC5hZGRDbGFzcyhcImtnLXRleHRhcmVhLXRhbGxcIik7IFxuICAgICAgICAgICAgfSk7XG4gICAgfVxufSIsICIvLyBzcmMvUXVldWVNb2RhbC50c1xuXG5pbXBvcnQgeyBBcHAsIE1vZGFsLCBTZXR0aW5nIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IEtub3dsZWRnZUdyYXBoUGx1Z2luIGZyb20gJy4vbWFpbic7XG5pbXBvcnQgeyBUYXNrRGF0YSB9IGZyb20gJy4vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgUXVldWVNYW5hZ2VtZW50TW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gICAgcGx1Z2luOiBLbm93bGVkZ2VHcmFwaFBsdWdpbjtcblxuICAgIC8vIFx1NzUyOFx1NEU4RVx1NEZERFx1NUI1OFx1NjQxQ1x1N0QyMlx1OEJDRFxuICAgIHByaXZhdGUgc2VhcmNoVGVybXM6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH0gPSB7XG4gICAgICAgIGdlbjogJycsXG4gICAgICAgIHJldjogJycsXG4gICAgICAgIHJlcDogJycsXG4gICAgICAgIGRpczogJycsXG4gICAgfTtcbiAgICBcbiAgICAvLyBcdTlFRDhcdThCQTRcdTUxNjhcdTkwRThcdTYyOThcdTUzRTBcbiAgICBwcml2YXRlIGNvbGxhcHNlU3RhdGVzOiB7IFtrZXk6IHN0cmluZ106IGJvb2xlYW4gfSA9IHtcbiAgICAgICAgZ2VuOiBmYWxzZSxcbiAgICAgICAgcmV2OiBmYWxzZSxcbiAgICAgICAgcmVwOiBmYWxzZSxcbiAgICAgICAgZGlzOiBmYWxzZSxcbiAgICB9O1xuXG4gICAgLy8gXHU3NTI4XHU0RThFXHU3RUQxXHU1QjlBXHU3Njg0XHU1MjM3XHU2NUIwXHU1MUZEXHU2NTcwXG4gICAgcHJpdmF0ZSByZWZyZXNoQ29udGVudDogKCkgPT4gdm9pZDtcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IEtub3dsZWRnZUdyYXBoUGx1Z2luKSB7XG4gICAgICAgIHN1cGVyKGFwcCk7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgICAgICAvLyBcdTUyMUJcdTVFRkFcdTRFMDBcdTRFMkFcdTdFRDFcdTVCOUFcdTc2ODRcdTUxRkRcdTY1NzBcdTVGMTVcdTc1MjhcdUZGMENcdTc1MjhcdTRFOEVcdTUyMzdcdTY1QjBcbiAgICAgICAgdGhpcy5yZWZyZXNoQ29udGVudCA9IHRoaXMub25PcGVuLmJpbmQodGhpcyk7XG4gICAgfVxuXG4gICAgb25PcGVuKCkge1xuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcblxuICAgICAgICAvLyBcdTRFM0FcdTRFODZcdTVCODlcdTUxNjhcdUZGMENcdTUxNDhcdTZDRThcdTk1MDBcdTY1RTdcdTc2ODRcdTc2RDFcdTU0MkNcdTU2NjhcbiAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLm9mZihcImtnLWRhdGEtdXBkYXRlZFwiLCB0aGlzLnJlZnJlc2hDb250ZW50KTtcblxuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcbiAgICAgICAgY29udGVudEVsLmFkZENsYXNzKCdrZy1tb2RhbCcpOyBcbiAgICAgICAgLy8gRml4ZWQ6IFNlbnRlbmNlIGNhc2VcbiAgICAgICAgY29udGVudEVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ1F1ZXVlIG1hbmFnZW1lbnQgZGFzaGJvYXJkJyB9KTsgXG5cbiAgICAgICAgY29uc3Qgc3RhdHVzID0gdGhpcy5wbHVnaW4uZGF0YS5zdGF0dXM7XG4gICAgICAgIGNvbnN0IHN0YXR1c1RleHQgPSBgU3RhdHVzOiAke3N0YXR1cy50b1VwcGVyQ2FzZSgpfSB8ICR7dGhpcy5wbHVnaW4uc3RhdHVzQmFyRWwuZ2V0VGV4dCgpfWA7XG4gICAgICAgIFxuICAgICAgICAvLyAxLiBcdTcyQjZcdTYwMDFcdTU0OENcdTU0MkZcdTUwNUNcdTYzMDlcdTk0QUVcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxuICAgICAgICAgICAgLnNldE5hbWUoc3RhdHVzID09PSAncnVubmluZycgPyAnRW5naW5lIHJ1bm5pbmcnIDogJ0VuZ2luZSBwYXVzZWQnKSAvLyBGaXhlZDogU2VudGVuY2UgY2FzZVxuICAgICAgICAgICAgLnNldERlc2Moc3RhdHVzVGV4dClcbiAgICAgICAgICAgIC5hZGRCdXR0b24oYnV0dG9uID0+IGJ1dHRvblxuICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KHN0YXR1cyA9PT0gJ3J1bm5pbmcnID8gJ1BhdXNlIGVuZ2luZScgOiAnU3RhcnQgZW5naW5lJykgLy8gRml4ZWQ6IFNlbnRlbmNlIGNhc2VcbiAgICAgICAgICAgICAgICAuc2V0Q3RhKHN0YXR1cyAhPT0gJ3J1bm5pbmcnKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uZW5naW5lLnRvZ2dsZUVuZ2luZVN0YXRlKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25PcGVuKCk7IC8vIFx1NTIzN1x1NjVCMCBNb2RhbCBcdTUxODVcdTkwRThcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAvLyAyLiBcdTZFMzJcdTY3RDNcdTU2REJcdTRFMkFcdTk2MUZcdTUyMTdcbiAgICAgICAgLy8gRml4ZWQ6IFNlbnRlbmNlIGNhc2UgZm9yIHRpdGxlc1xuICAgICAgICB0aGlzLnJlbmRlclF1ZXVlU2VjdGlvbihcbiAgICAgICAgICAgIGNvbnRlbnRFbCwgXG4gICAgICAgICAgICAnZ2VuJywgXG4gICAgICAgICAgICAnUGVuZGluZyBnZW5lcmF0aW9uJywgXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLmdlbmVyYXRpb25RdWV1ZSxcbiAgICAgICAgICAgIHRoaXMucmVuZGVyR2VuZXJhdGlvbkl0ZW0uYmluZCh0aGlzKVxuICAgICAgICApO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5yZW5kZXJRdWV1ZVNlY3Rpb24oXG4gICAgICAgICAgICBjb250ZW50RWwsXG4gICAgICAgICAgICAncmV2JyxcbiAgICAgICAgICAgICdQZW5kaW5nIHJldmlldycsXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLnJldmlld1F1ZXVlLFxuICAgICAgICAgICAgdGhpcy5yZW5kZXJSZXZpZXdJdGVtLmJpbmQodGhpcylcbiAgICAgICAgKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMucmVuZGVyUXVldWVTZWN0aW9uKFxuICAgICAgICAgICAgY29udGVudEVsLFxuICAgICAgICAgICAgJ3JlcCcsXG4gICAgICAgICAgICAnUGVuZGluZyByZXZpc2lvbicsXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLnJldmlzaW9uUXVldWUsXG4gICAgICAgICAgICB0aGlzLnJlbmRlclJldmlzaW9uSXRlbS5iaW5kKHRoaXMpXG4gICAgICAgICk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLnJlbmRlclF1ZXVlU2VjdGlvbihcbiAgICAgICAgICAgIGNvbnRlbnRFbCxcbiAgICAgICAgICAgICdkaXMnLFxuICAgICAgICAgICAgJ0Rpc2NhcmRlZCBwaWxlJyxcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLmRhdGEuZGlzY2FyZGVkUGlsZSxcbiAgICAgICAgICAgIHRoaXMucmVuZGVyRGlzY2FyZGVkSXRlbS5iaW5kKHRoaXMpXG4gICAgICAgICk7XG5cbiAgICAgICAgLy8gXHU1NzI4IG9uT3BlbiBcdTc2ODRcdTY3MkJcdTVDM0UsIFx1NkNFOFx1NTE4Q1x1NjVCMFx1NzY4NFx1NzZEMVx1NTQyQ1x1NTY2OFxuICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub24oXCJrZy1kYXRhLXVwZGF0ZWRcIiwgdGhpcy5yZWZyZXNoQ29udGVudCk7XG4gICAgfVxuXG4gICAgb25DbG9zZSgpIHtcbiAgICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG4gICAgICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xuICAgICAgICBcbiAgICAgICAgLy8gXHU1NzI4IE1vZGFsIFx1NTE3M1x1OTVFRFx1NjVGNiwgXHU1RkM1XHU5ODdCXHU2Q0U4XHU5NTAwXHU3NkQxXHU1NDJDXHU1NjY4XG4gICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5vZmYoXCJrZy1kYXRhLXVwZGF0ZWRcIiwgdGhpcy5yZWZyZXNoQ29udGVudCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogXHU2RTMyXHU2N0QzXHU0RTAwXHU0RTJBXHU5NjFGXHU1MjE3XHU1MzNBXHU1N0RGIChcdTVFMjZcdTY0MUNcdTdEMjJcdTU0OENcdTVDNTVcdTVGMDAvXHU2Mjk4XHU1M0UwKVxuICAgICAqL1xuICAgIHByaXZhdGUgcmVuZGVyUXVldWVTZWN0aW9uKFxuICAgICAgICBjb250YWluZXJFbDogSFRNTEVsZW1lbnQsXG4gICAgICAgIGtleTogJ2dlbicgfCAncmV2JyB8ICdyZXAnIHwgJ2RpcycsXG4gICAgICAgIHRpdGxlOiBzdHJpbmcsXG4gICAgICAgIGRhdGE6IChzdHJpbmcgfCBUYXNrRGF0YSlbXSxcbiAgICAgICAgcmVuZGVyRm46IChjb250YWluZXI6IEhUTUxFbGVtZW50LCBpdGVtOiBzdHJpbmcgfCBUYXNrRGF0YSwgaW5kZXg6IG51bWJlcikgPT4gdm9pZFxuICAgICkge1xuICAgICAgICBjb25zdCBkaXNwbGF5TGltaXQgPSAxMDA7IC8vIFx1NkJDRlx1NkIyMVx1NjcwMFx1NTkxQVx1NkUzMlx1NjdEMyAxMDAgXHU5ODc5XG4gICAgICAgIGNvbnN0IGZpbHRlciA9IHRoaXMuc2VhcmNoVGVybXNba2V5XTtcbiAgICAgICAgXG4gICAgICAgIC8vIDEuIFx1NjI2N1x1ODg0Q1x1OEZDN1x1NkVFNFxuICAgICAgICBjb25zdCBmaWx0ZXJlZERhdGEgPSBkYXRhLmZpbHRlcihpdGVtID0+IHtcbiAgICAgICAgICAgIGlmICghZmlsdGVyKSByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIGNvbnN0IG5lZWRsZSA9IGZpbHRlci50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBpdGVtID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMobmVlZGxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBpdGVtLmlkZWEudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhuZWVkbGUpO1xuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCB0b3RhbCA9IGRhdGEubGVuZ3RoO1xuICAgICAgICBjb25zdCBmaWx0ZXJlZFRvdGFsID0gZmlsdGVyZWREYXRhLmxlbmd0aDtcbiAgICAgICAgY29uc3QgdGl0bGVUZXh0ID0gYCR7dGl0bGV9ICgke2ZpbHRlcmVkVG90YWx9JHt0b3RhbCAhPT0gZmlsdGVyZWRUb3RhbCA/ICcgLyAnICsgdG90YWwgOiAnJ30gaXRlbXMpYDtcblxuICAgICAgICAvLyAyLiBcdTRGN0ZcdTc1MjggPGRldGFpbHM+IFx1NTE0M1x1N0QyMFx1NTIxQlx1NUVGQVx1NTNFRlx1NjI5OFx1NTNFMFx1NTMzQVx1NTdERlxuICAgICAgICBjb25zdCBkZXRhaWxzID0gY29udGFpbmVyRWwuY3JlYXRlRWwoJ2RldGFpbHMnKTtcbiAgICAgICAgZGV0YWlscy5vcGVuID0gdGhpcy5jb2xsYXBzZVN0YXRlc1trZXldOyAvLyBcdThCQkVcdTdGNkVcdTUyMURcdTU5Q0JcdTVDNTVcdTVGMDAvXHU2Mjk4XHU1M0UwXHU3MkI2XHU2MDAxXG5cbiAgICAgICAgLy8gMy4gXHU2ODA3XHU5ODk4IChcdTRGN0ZcdTc1MjggQ1NTIFx1N0M3QilcbiAgICAgICAgY29uc3Qgc3VtbWFyeSA9IGRldGFpbHMuY3JlYXRlRWwoJ3N1bW1hcnknLCB7IHRleHQ6IHRpdGxlVGV4dCB9KTtcbiAgICAgICAgc3VtbWFyeS5hZGRDbGFzcygna2ctbW9kYWwtc3VtbWFyeScpO1xuXG4gICAgICAgIC8vIDQuIFx1NzZEMVx1NTQyQ1x1NzBCOVx1NTFGQlx1NEU4Qlx1NEVGNlx1RkYwQ1x1NEZERFx1NUI1OFx1NzJCNlx1NjAwMVxuICAgICAgICBkZXRhaWxzLmFkZEV2ZW50TGlzdGVuZXIoJ3RvZ2dsZScsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuY29sbGFwc2VTdGF0ZXNba2V5XSA9IGRldGFpbHMub3BlbjtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gNS4gXHU2NDFDXHU3RDIyXHU2ODQ2IChcdTY1M0VcdTU3MjggZGV0YWlscyBcdTUxODVcdTkwRTgpXG4gICAgICAgIG5ldyBTZXR0aW5nKGRldGFpbHMpXG4gICAgICAgICAgICAuc2V0RGVzYyhgU2VhcmNoICR7dGl0bGUudG9Mb3dlckNhc2UoKX0uLi5gKSBcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4ge1xuICAgICAgICAgICAgICAgIHRleHQuc2V0UGxhY2Vob2xkZXIoJ0VudGVyIGtleXdvcmRzLi4uJylcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMuc2VhcmNoVGVybXNba2V5XSlcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoVGVybXNba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbk9wZW4oKTsgLy8gXHU1MjM3XHU2NUIwIE1vZGFsXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gNi4gXHU2MjJBXHU2NUFEXHU2NTcwXHU2MzZFXHU1RTc2XHU2RTMyXHU2N0QzXG4gICAgICAgIGNvbnN0IHRydW5jYXRlZERhdGEgPSBmaWx0ZXJlZERhdGEuc2xpY2UoMCwgZGlzcGxheUxpbWl0KTtcbiAgICAgICAgXG4gICAgICAgIGlmICh0cnVuY2F0ZWREYXRhLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgY29uc3QgZGVzYyA9IGRldGFpbHMuY3JlYXRlRWwoJ3AnLCB7IHRleHQ6ICdRdWV1ZSBpcyBlbXB0eSBvciBubyBtYXRjaGVzIGZvdW5kLicsIGNsczogJ3NldHRpbmctaXRlbS1kZXNjcmlwdGlvbicgfSk7XG4gICAgICAgICAgICBkZXNjLmFkZENsYXNzKCdrZy1xdWV1ZS1kZXNjLWVtcHR5Jyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIDcuIFx1NTIxN1x1ODg2OFx1NUJCOVx1NTY2OCAoXHU2NTNFXHU1NzI4IGRldGFpbHMgXHU1MTg1XHU5MEU4XHVGRjBDXHU0RjdGXHU3NTI4IENTUyBcdTdDN0IpXG4gICAgICAgIGNvbnN0IGxpc3RDb250YWluZXIgPSBkZXRhaWxzLmNyZWF0ZURpdigna2ctbGlzdC1jb250YWluZXInKTtcblxuICAgICAgICB0cnVuY2F0ZWREYXRhLmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7XG4gICAgICAgICAgICByZW5kZXJGbihsaXN0Q29udGFpbmVyLCBpdGVtLCBpbmRleCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIDguIFx1NjYzRVx1NzkzQVx1NjIyQVx1NjVBRFx1NjNEMFx1NzkzQVxuICAgICAgICBpZiAoZmlsdGVyZWREYXRhLmxlbmd0aCA+IGRpc3BsYXlMaW1pdCkge1xuICAgICAgICAgICAgY29uc3QgdHJ1bmNhdGVkSW5mbyA9IGRldGFpbHMuY3JlYXRlRWwoJ3AnLCB7IFxuICAgICAgICAgICAgICAgIHRleHQ6IGAuLi4gc2hvd2luZyBmaXJzdCAke2Rpc3BsYXlMaW1pdH0gaXRlbXMgKHRvdGFsICR7ZmlsdGVyZWREYXRhLmxlbmd0aH0pLCB1c2Ugc2VhcmNoIHRvIGZpbmQgbW9yZS5gLFxuICAgICAgICAgICAgICAgIGNsczogJ3NldHRpbmctaXRlbS1kZXNjcmlwdGlvbidcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdHJ1bmNhdGVkSW5mby5hZGRDbGFzcygna2ctcXVldWUtZGVzYy10cnVuY2F0ZWQnKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIC0tLSBcdTUzNTVcdTk4NzlcdTZFMzJcdTY3RDNcdTUxRkRcdTY1NzAgLS0tXG5cbiAgICBwcml2YXRlIHJlbmRlckdlbmVyYXRpb25JdGVtKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIGl0ZW06IHN0cmluZyB8IFRhc2tEYXRhKSB7XG4gICAgICAgIC8vIGl0ZW0gXHU1NzI4IGdlbmVyYXRpb24gcXVldWUgXHU0RTJEXHU5MDFBXHU1RTM4XHU2NjJGIHN0cmluZ1xuICAgICAgICBjb25zdCBpdGVtTmFtZSA9IHR5cGVvZiBpdGVtID09PSAnc3RyaW5nJyA/IGl0ZW0gOiBpdGVtLmlkZWE7XG4gICAgICAgIFxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXIpXG4gICAgICAgICAgICAuc2V0TmFtZShpdGVtTmFtZSlcbiAgICAgICAgICAgIC5hZGRCdXR0b24oYnRuID0+IGJ0blxuICAgICAgICAgICAgICAgIC5zZXRJY29uKCd0cmFzaCcpXG4gICAgICAgICAgICAgICAgLnNldFRvb2x0aXAoJ0RlbGV0ZSBjb25jZXB0JykgLy8gRml4ZWQ6IFNlbnRlbmNlIGNhc2VcbiAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHF1ZXVlID0gdGhpcy5wbHVnaW4uZGF0YS5nZW5lcmF0aW9uUXVldWU7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gcXVldWUuaW5kZXhPZihpdGVtTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmRleCA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBxdWV1ZS5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVBsdWdpbkRhdGEoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmVuZ2luZS51cGRhdGVTdGF0dXNCYXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25PcGVuKCk7IC8vIFx1NTIzN1x1NjVCMFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkgXG4gICAgICAgICAgICApO1xuICAgIH1cblxuICAgIHByaXZhdGUgcmVuZGVyUmV2aWV3SXRlbShjb250YWluZXI6IEhUTUxFbGVtZW50LCBpdGVtOiBzdHJpbmcgfCBUYXNrRGF0YSkge1xuICAgICAgICBjb25zdCB0YXNrID0gaXRlbSBhcyBUYXNrRGF0YTtcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyKVxuICAgICAgICAgICAgLnNldE5hbWUoYFtSZXZpZXddICR7dGFzay5pZGVhfWApXG4gICAgICAgICAgICAuYWRkQnV0dG9uKGJ0biA9PiBidG5cbiAgICAgICAgICAgICAgICAuc2V0SWNvbigndHJhc2gnKVxuICAgICAgICAgICAgICAgIC5zZXRUb29sdGlwKCdEaXNjYXJkIHRhc2snKSAvLyBGaXhlZDogU2VudGVuY2UgY2FzZVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5yZXZpZXdRdWV1ZS5zcGxpY2UodGhpcy5wbHVnaW4uZGF0YS5yZXZpZXdRdWV1ZS5pbmRleE9mKHRhc2spLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5kaXNjYXJkZWRQaWxlLnB1c2godGFzayk7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVQbHVnaW5EYXRhKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmVuZ2luZS51cGRhdGVTdGF0dXNCYXIoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbk9wZW4oKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcbiAgICB9XG4gICAgXG4gICAgcHJpdmF0ZSByZW5kZXJSZXZpc2lvbkl0ZW0oY29udGFpbmVyOiBIVE1MRWxlbWVudCwgaXRlbTogc3RyaW5nIHwgVGFza0RhdGEpIHtcbiAgICAgICAgY29uc3QgdGFzayA9IGl0ZW0gYXMgVGFza0RhdGE7XG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lcilcbiAgICAgICAgICAgIC5zZXROYW1lKGBbUmV2aXNpb25dICR7dGFzay5pZGVhfWApXG4gICAgICAgICAgICAuc2V0RGVzYyhgUmVhc29uOiAke3Rhc2sucmVhc29uIHx8ICdVbmtub3duJ31gKVxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidG4gPT4gYnRuXG4gICAgICAgICAgICAgICAgLnNldEljb24oJ3RyYXNoJylcbiAgICAgICAgICAgICAgICAuc2V0VG9vbHRpcCgnRGlzY2FyZCB0YXNrJykgLy8gRml4ZWQ6IFNlbnRlbmNlIGNhc2VcbiAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmRhdGEucmV2aXNpb25RdWV1ZS5zcGxpY2UodGhpcy5wbHVnaW4uZGF0YS5yZXZpc2lvblF1ZXVlLmluZGV4T2YodGFzayksIDEpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLmRpc2NhcmRlZFBpbGUucHVzaCh0YXNrKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVBsdWdpbkRhdGEoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uZW5naW5lLnVwZGF0ZVN0YXR1c0JhcigpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uT3BlbigpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuICAgIH1cbiAgICBcbiAgICBwcml2YXRlIHJlbmRlckRpc2NhcmRlZEl0ZW0oY29udGFpbmVyOiBIVE1MRWxlbWVudCwgaXRlbTogc3RyaW5nIHwgVGFza0RhdGEpIHtcbiAgICAgICAgY29uc3QgdGFzayA9IGl0ZW0gYXMgVGFza0RhdGE7XG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lcilcbiAgICAgICAgICAgIC5zZXROYW1lKGBbRGlzY2FyZGVkXSAke3Rhc2suaWRlYX1gKVxuICAgICAgICAgICAgLnNldERlc2MoYExhc3QgcmVhc29uOiAke3Rhc2sucmVhc29uIHx8ICdVbmtub3duJ31gKVxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidG4gPT4gYnRuXG4gICAgICAgICAgICAgICAgLnNldEljb24oJ3JlZnJlc2gtY3cnKVxuICAgICAgICAgICAgICAgIC5zZXRUb29sdGlwKCdSZS1xdWV1ZSAoZ2VuZXJhdGlvbiknKSAvLyBGaXhlZDogU2VudGVuY2UgY2FzZVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5kaXNjYXJkZWRQaWxlLnNwbGljZSh0aGlzLnBsdWdpbi5kYXRhLmRpc2NhcmRlZFBpbGUuaW5kZXhPZih0YXNrKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmVuZ2luZS5hZGRDb25jZXB0c1RvUXVldWUoW3Rhc2suaWRlYV0pOyAvLyBcdTRGN0ZcdTc1MjggZW5naW5lIFx1NzY4NFx1NjVCOVx1NkNENVxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uT3BlbigpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuICAgIH1cbn0iLCAiLy8gc3JjL3V0aWxzLnRzXG5cbmV4cG9ydCBjbGFzcyBMb2dnZXIge1xuICAgIHByaXZhdGUgc3RhdGljIGlzRGVidWc6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAgIHN0YXRpYyBzZXREZWJ1Z01vZGUoZGVidWc6IGJvb2xlYW4pIHtcbiAgICAgICAgTG9nZ2VyLmlzRGVidWcgPSBkZWJ1ZztcbiAgICB9XG5cbiAgICAvLyBDaGFuZ2VkIGFueVtdIHRvIHVua25vd25bXSB0byBzYXRpc2Z5IGxpbnRlclxuICAgIC8vIENoYW5nZWQgY29uc29sZS5sb2cgdG8gY29uc29sZS5kZWJ1ZyB0byBzYXRpc2Z5IGxpbnRlclxuICAgIHN0YXRpYyBsb2cobWVzc2FnZTogc3RyaW5nLCAuLi5hcmdzOiB1bmtub3duW10pIHtcbiAgICAgICAgaWYgKExvZ2dlci5pc0RlYnVnKSB7XG4gICAgICAgICAgICBjb25zb2xlLmRlYnVnKGBbS0ctR2VuXSAke21lc3NhZ2V9YCwgLi4uYXJncyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzdGF0aWMgd2FybihtZXNzYWdlOiBzdHJpbmcsIC4uLmFyZ3M6IHVua25vd25bXSkge1xuICAgICAgICBjb25zb2xlLndhcm4oYFtLRy1HZW5dICR7bWVzc2FnZX1gLCAuLi5hcmdzKTtcbiAgICB9XG5cbiAgICBzdGF0aWMgZXJyb3IobWVzc2FnZTogc3RyaW5nLCAuLi5hcmdzOiB1bmtub3duW10pIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihgW0tHLUdlbl0gJHttZXNzYWdlfWAsIC4uLmFyZ3MpO1xuICAgIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNhbml0aXplRmlsZW5hbWUobmFtZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBsZXQgY2xlYW5OYW1lID0gbmFtZS5yZXBsYWNlKC9cXHMqXFwoLipcXCkvZywgJycpLnRyaW0oKTtcbiAgICBjbGVhbk5hbWUgPSBjbGVhbk5hbWUucmVwbGFjZSgvW1xcXFwvKj86XCI8PnxdL2csIFwiXCIpO1xuICAgIHJldHVybiBjbGVhbk5hbWUuc2xpY2UoMCwgMTAwKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGV4dHJhY3ROZXdJZGVhcyhjb250ZW50OiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgbWF0Y2hlcyA9IGNvbnRlbnQubWF0Y2goL1xcW1xcWyhbXlxcXV0rKVxcXVxcXS9nKTtcbiAgICBpZiAoIW1hdGNoZXMpIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICBjb25zdCBpZGVhcyA9IG1hdGNoZXMubWFwKG1hdGNoID0+IHtcbiAgICAgICAgcmV0dXJuIG1hdGNoLnNsaWNlKDIsIC0yKS5zcGxpdCgnfCcpWzBdLnRyaW0oKTtcbiAgICB9KTtcbiAgICByZXR1cm4gWy4uLm5ldyBTZXQoaWRlYXMpXTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFuTWFya2Rvd25PdXRwdXQoY29udGVudDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCB0cmltbWVkID0gY29udGVudC50cmltKCk7XG4gICAgaWYgKHRyaW1tZWQuc3RhcnRzV2l0aChcImBgYG1hcmtkb3duXCIpICYmIHRyaW1tZWQuZW5kc1dpdGgoXCJgYGBcIikpIHtcbiAgICAgICAgbGV0IGNsZWFuZWQgPSB0cmltbWVkLnN1YnN0cmluZyhcImBgYG1hcmtkb3duXCIubGVuZ3RoLCB0cmltbWVkLmxlbmd0aCAtIFwiYGBgXCIubGVuZ3RoKTtcbiAgICAgICAgcmV0dXJuIGNsZWFuZWQudHJpbSgpO1xuICAgIH1cbiAgICByZXR1cm4gdHJpbW1lZDtcbn0iLCAiLy8gc3JjL2VuZ2luZS50c1xuXG5pbXBvcnQgeyBOb3RpY2UsIFRGaWxlLCBURm9sZGVyLCBub3JtYWxpemVQYXRoLCBBcHAgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBLbm93bGVkZ2VHcmFwaFBsdWdpbiBmcm9tIFwiLi9tYWluXCI7XG5pbXBvcnQgeyBBUElIYW5kbGVyLCBBbGxNb2RlbHNGYWlsZWRFcnJvciB9IGZyb20gXCIuL2FwaUhhbmRsZXJcIjtcbmltcG9ydCB7IENyaXRpYyB9IGZyb20gXCIuL2NyaXRpY1wiO1xuaW1wb3J0IHsgUmV2aXNlciB9IGZyb20gXCIuL3JldmlzZXJcIjtcbmltcG9ydCB7IHNhbml0aXplRmlsZW5hbWUsIGV4dHJhY3ROZXdJZGVhcywgY2xlYW5NYXJrZG93bk91dHB1dCwgTG9nZ2VyIH0gZnJvbSBcIi4vdXRpbHNcIjtcbmltcG9ydCB7IFRhc2tEYXRhIH0gZnJvbSBcIi4vdHlwZXNcIjtcblxuZXhwb3J0IGNsYXNzIEVuZ2luZSB7XG4gICAgcGx1Z2luOiBLbm93bGVkZ2VHcmFwaFBsdWdpbjtcbiAgICBhcHA6IEFwcDtcbiAgICBhcGlIYW5kbGVyOiBBUElIYW5kbGVyO1xuICAgIGNyaXRpYzogQ3JpdGljO1xuICAgIHJldmlzZXI6IFJldmlzZXI7XG4gICAgcHJpdmF0ZSBpc1J1bm5pbmc6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBwcml2YXRlIHRpbWVySWQ6IE5vZGVKUy5UaW1lb3V0IHwgbnVsbCA9IG51bGw7XG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IEtub3dsZWRnZUdyYXBoUGx1Z2luKSB7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgICAgICB0aGlzLmFwcCA9IHBsdWdpbi5hcHA7XG4gICAgICAgIHRoaXMuYXBpSGFuZGxlciA9IG5ldyBBUElIYW5kbGVyKHBsdWdpbik7XG4gICAgICAgIHRoaXMuY3JpdGljID0gbmV3IENyaXRpYyhwbHVnaW4pO1xuICAgICAgICB0aGlzLnJldmlzZXIgPSBuZXcgUmV2aXNlcihwbHVnaW4pO1xuICAgIH1cblxuICAgIC8vIC0tLSBQdWJsaWMgQ29udHJvbHMgLS0tXG4gICAgcHVibGljIHRvZ2dsZUVuZ2luZVN0YXRlKCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5pc1J1bm5pbmcpIHtcbiAgICAgICAgICAgIHRoaXMuc3RvcCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zdGFydCgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGFkZENvbmNlcHRUb1F1ZXVlKGNvbmNlcHQ6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCBhZGRlZCA9IHRoaXMuYWRkQ29uY2VwdHNUb1F1ZXVlKFtjb25jZXB0XSk7XG4gICAgICAgIGlmIChhZGRlZCA+IDApIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYCcke2NvbmNlcHR9JyBhZGRlZCB0byBxdWV1ZS5gKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU3RhdHVzQmFyKCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBuZXcgTm90aWNlKGAnJHtjb25jZXB0fScgYWxyZWFkeSBleGlzdHMgb3IgcXVldWVkLmApO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgcHVibGljIGFkZENvbmNlcHRzVG9RdWV1ZShjb25jZXB0czogc3RyaW5nW10pOiBudW1iZXIge1xuICAgICAgICBjb25zdCBjdXJyZW50UXVldWUgPSBuZXcgU2V0KHRoaXMucGx1Z2luLmRhdGEuZ2VuZXJhdGlvblF1ZXVlKTtcbiAgICAgICAgY29uc3QgZXhpc3RpbmdGaWxlcyA9IG5ldyBTZXQodGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpLm1hcChmID0+IGYuYmFzZW5hbWUpKTtcblxuICAgICAgICBsZXQgYWRkZWRDb3VudCA9IDA7XG4gICAgICAgIGZvciAoY29uc3QgY29uY2VwdCBvZiBjb25jZXB0cykge1xuICAgICAgICAgICAgY29uc3Qgc2FuaXRpemVkID0gc2FuaXRpemVGaWxlbmFtZShjb25jZXB0KTtcbiAgICAgICAgICAgIGlmICghY3VycmVudFF1ZXVlLmhhcyhjb25jZXB0KSAmJiAhZXhpc3RpbmdGaWxlcy5oYXMoc2FuaXRpemVkKSkge1xuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmRhdGEuZ2VuZXJhdGlvblF1ZXVlLnB1c2goY29uY2VwdCk7XG4gICAgICAgICAgICAgICAgY3VycmVudFF1ZXVlLmFkZChjb25jZXB0KTsgXG4gICAgICAgICAgICAgICAgYWRkZWRDb3VudCsrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGFkZGVkQ291bnQgPiAwKSB7XG4gICAgICAgICAgICB2b2lkIHRoaXMucGx1Z2luLnNhdmVQbHVnaW5EYXRhKCk7IFxuICAgICAgICAgICAgdGhpcy51cGRhdGVTdGF0dXNCYXIoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYWRkZWRDb3VudDtcbiAgICB9XG5cbiAgICAvLyAtLS0gQ29yZSBMb29wIC0tLVxuICAgIFxuICAgIHByaXZhdGUgc3RhcnQoKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLmlzUnVubmluZykgcmV0dXJuO1xuICAgICAgICB0aGlzLmlzUnVubmluZyA9IHRydWU7XG4gICAgICAgIHRoaXMucGx1Z2luLmRhdGEuc3RhdHVzID0gXCJydW5uaW5nXCI7XG4gICAgICAgIG5ldyBOb3RpY2UoXCJLbm93bGVkZ2UgZ3JhcGggZW5naW5lIHN0YXJ0ZWQhXCIpO1xuICAgICAgICB0aGlzLnVwZGF0ZVN0YXR1c0JhcigpO1xuICAgICAgICBcbiAgICAgICAgdGhpcy50aWNrKCkuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICAgICAgTG9nZ2VyLmVycm9yKFwiVGljayBlcnJvciBkdXJpbmcgc3RhcnQ6XCIsIGVycm9yKTtcbiAgICAgICAgICAgIHRoaXMuc3RvcCgpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHN0b3AoKTogdm9pZCB7XG4gICAgICAgIGlmICghdGhpcy5pc1J1bm5pbmcpIHJldHVybjtcbiAgICAgICAgdGhpcy5pc1J1bm5pbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5zdGF0dXMgPSBcInBhdXNlZFwiO1xuICAgICAgICBpZiAodGhpcy50aW1lcklkKSB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lcklkKTtcbiAgICAgICAgICAgIHRoaXMudGltZXJJZCA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgbmV3IE5vdGljZShcIktub3dsZWRnZSBncmFwaCBlbmdpbmUgcGF1c2VkLlwiKTtcbiAgICAgICAgdGhpcy51cGRhdGVTdGF0dXNCYXIoKTtcbiAgICAgICAgdm9pZCB0aGlzLnBsdWdpbi5zYXZlUGx1Z2luRGF0YSgpOyBcbiAgICB9XG5cbiAgICBwcml2YXRlIHNjaGVkdWxlTmV4dFRpY2soKTogdm9pZCB7XG4gICAgICAgIGlmICghdGhpcy5pc1J1bm5pbmcpIHJldHVybjtcbiAgICAgICAgY29uc3QgZGVsYXkgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZXF1ZXN0X2RlbGF5ICogMTAwMDtcbiAgICAgICAgdGhpcy50aW1lcklkID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnRpY2soKS5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgICAgICAgICAgTG9nZ2VyLmVycm9yKFwiVGljayBlcnJvcjpcIiwgZXJyb3IpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sIGRlbGF5KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIHRpY2soKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICghdGhpcy5pc1J1bm5pbmcpIHJldHVybjtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgbGV0IHRhc2tQcm9jZXNzZWQgPSBmYWxzZTtcblxuICAgICAgICAgICAgaWYgKHRoaXMucGx1Z2luLmRhdGEucmV2aXNpb25RdWV1ZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgdGFza1Byb2Nlc3NlZCA9IGF3YWl0IHRoaXMucnVuUmV2aXNpb25QaGFzZSgpO1xuICAgICAgICAgICAgfSBcbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMucGx1Z2luLmRhdGEucmV2aWV3UXVldWUubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHRhc2tQcm9jZXNzZWQgPSBhd2FpdCB0aGlzLnJ1bkNyaXRpY1BoYXNlKCk7XG4gICAgICAgICAgICB9IFxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5wbHVnaW4uZGF0YS5nZW5lcmF0aW9uUXVldWUubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHRhc2tQcm9jZXNzZWQgPSBhd2FpdCB0aGlzLnJ1bkdlbmVyYXRpb25QaGFzZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIXRhc2tQcm9jZXNzZWQgJiZcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLmdlbmVyYXRpb25RdWV1ZS5sZW5ndGggPT09IDAgJiZcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLnJldmlld1F1ZXVlLmxlbmd0aCA9PT0gMCAmJlxuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmRhdGEucmV2aXNpb25RdWV1ZS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKFwiXHVEODNDXHVERjg5IEFsbCB0YXNrcyBjb21wbGV0ZWQhIEVuZ2luZSBzdG9wcGVkLlwiKTtcbiAgICAgICAgICAgICAgICB0aGlzLmlzUnVubmluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmRhdGEuc3RhdHVzID0gXCJpZGxlXCI7IFxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlU3RhdHVzQmFyKCk7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVBsdWdpbkRhdGEoKTsgXG4gICAgICAgICAgICAgICAgcmV0dXJuOyBcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgTG9nZ2VyLmVycm9yKFwiRW5naW5lIGZhdGFsIGVycm9yOlwiLCBlcnJvcik7XG4gICAgICAgICAgICBuZXcgTm90aWNlKFwiRW5naW5lIGVuY291bnRlcmVkIGFuIGVycm9yIGFuZCBwYXVzZWQuIENoZWNrIGNvbnNvbGUuXCIpO1xuICAgICAgICAgICAgdGhpcy5zdG9wKCk7IFxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zY2hlZHVsZU5leHRUaWNrKCk7XG4gICAgfVxuXG4gICAgLy8gLS0tIFBoYXNlcyAtLS1cbiAgICBwcml2YXRlIGFzeW5jIHJ1bkdlbmVyYXRpb25QaGFzZSgpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICAgICAgY29uc3QgcXVldWUgPSB0aGlzLnBsdWdpbi5kYXRhLmdlbmVyYXRpb25RdWV1ZTtcbiAgICAgICAgaWYgKHF1ZXVlLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgIGNvbnN0IGJhdGNoU2l6ZSA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYXRpb25fYmF0Y2hfc2l6ZTtcbiAgICAgICAgY29uc3QgYmF0Y2ggPSBxdWV1ZS5zcGxpY2UoMCwgTWF0aC5taW4ocXVldWUubGVuZ3RoLCBiYXRjaFNpemUpKTtcblxuICAgICAgICB0aGlzLnVwZGF0ZVN0YXR1c0JhcigpO1xuICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlUGx1Z2luRGF0YSgpOyBcblxuICAgICAgICBjb25zdCB0YXNrcyA9IGJhdGNoLm1hcChpZGVhID0+IHRoaXMuZ2VuZXJhdGlvblRhc2soaWRlYSkpO1xuICAgICAgICBhd2FpdCBQcm9taXNlLmFsbFNldHRsZWQodGFza3MpO1xuXG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVQbHVnaW5EYXRhKCk7IFxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIGdlbmVyYXRpb25UYXNrKGlkZWE6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9tcHRfZ2VuZXJhdG9yLnJlcGxhY2UoXCJ7Y29uY2VwdH1cIiwgaWRlYSk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5hcGlIYW5kbGVyLmNhbGwocHJvbXB0KTtcbiAgICAgICAgICAgIGNvbnN0IGNsZWFuZWRDb250ZW50ID0gY2xlYW5NYXJrZG93bk91dHB1dChjb250ZW50KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gXHUzMDEwXHU0RkVFXHU2NTM5XHUzMDExXHU0RkREXHU1QjU4XHU1MTg1XHU1QkI5XHU1MjMwXHU3RjEzXHU1QjU4XHU2NTg3XHU0RUY2XHVGRjBDXHU4MDBDXHU0RTBEXHU2NjJGXHU0RUM1XHU0RkREXHU3NTU5XHU1NzI4XHU1MTg1XHU1QjU4XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5wZXJzaXN0ZW5jZS5zYXZlVGFza0NvbnRlbnQoaWRlYSwgY2xlYW5lZENvbnRlbnQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBcdTk2MUZcdTUyMTdcdTRFMkRcdTUzRUFcdTRGRERcdTVCNThcdTUxNDNcdTY1NzBcdTYzNkVcdUZGMENjb250ZW50IFx1NTNFRlx1OTAwOVxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5yZXZpZXdRdWV1ZS5wdXNoKHsgaWRlYSwgY29udGVudDogY2xlYW5lZENvbnRlbnQgfSk7XG4gICAgICAgICAgICBMb2dnZXIubG9nKGBcdTI3MDUgW0dlbmVyYXRpb24gU3VjY2Vzc106ICR7aWRlYX1gKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBBbGxNb2RlbHNGYWlsZWRFcnJvcikge1xuICAgICAgICAgICAgICAgIExvZ2dlci5lcnJvcihgXHUyNzRDIFtHZW5lcmF0aW9uIEZhaWxlZF06ICR7aWRlYX0gLSAke2UubWVzc2FnZX1gKTtcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLmdlbmVyYXRpb25RdWV1ZS51bnNoaWZ0KGlkZWEpOyBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgcnVuQ3JpdGljUGhhc2UoKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgICAgIGNvbnN0IHF1ZXVlID0gdGhpcy5wbHVnaW4uZGF0YS5yZXZpZXdRdWV1ZTtcbiAgICAgICAgaWYgKHF1ZXVlLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgIGNvbnN0IGJhdGNoU2l6ZSA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYXRpb25fYmF0Y2hfc2l6ZTtcbiAgICAgICAgY29uc3QgdGFza3NUb1JldmlldyA9IHF1ZXVlLnNwbGljZSgwLCBNYXRoLm1pbihxdWV1ZS5sZW5ndGgsIGJhdGNoU2l6ZSkpO1xuXG4gICAgICAgIHRoaXMudXBkYXRlU3RhdHVzQmFyKCk7XG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVQbHVnaW5EYXRhKCk7IFxuXG4gICAgICAgIGxldCBuZXdJZGVhc0ZvdW5kOiBTZXQ8c3RyaW5nPiA9IG5ldyBTZXQoKTtcblxuICAgICAgICBmb3IgKGNvbnN0IHRhc2sgb2YgdGFza3NUb1Jldmlldykge1xuICAgICAgICAgICAgLy8gXHUzMDEwXHU0RkVFXHU2NTM5XHUzMDExXHU1OTgyXHU2NzlDXHU1MTg1XHU1QjU4XHU0RTJEXHU2Q0ExXHU2NzA5XHU1MTg1XHU1QkI5XHVGRjA4XHU1MjFBXHU1MkEwXHU4RjdEXHVGRjA5XHVGRjBDXHU0RUNFXHU2NTg3XHU0RUY2XHU1MkEwXHU4RjdEXG4gICAgICAgICAgICBsZXQgY29udGVudCA9IHRhc2suY29udGVudDtcbiAgICAgICAgICAgIGlmICghY29udGVudCkge1xuICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBhd2FpdCB0aGlzLnBsdWdpbi5wZXJzaXN0ZW5jZS5sb2FkVGFza0NvbnRlbnQodGFzay5pZGVhKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCFjb250ZW50KSB7XG4gICAgICAgICAgICAgICAgTG9nZ2VyLmVycm9yKGBcdTI3NEMgW0NyaXRpYyBFcnJvcl06IENvbnRlbnQgbm90IGZvdW5kIGZvciAke3Rhc2suaWRlYX0uIERpc2NhcmRpbmcuYCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5kaXNjYXJkZWRQaWxlLnB1c2goeyAuLi50YXNrLCByZWFzb246IFwiQ29udGVudCBmaWxlIGxvc3RcIiB9KTtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgeyBpc0FwcHJvdmVkLCByZWFzb24gfSA9IGF3YWl0IHRoaXMuY3JpdGljLmp1ZGdlKGNvbnRlbnQpO1xuICAgICAgICAgICAgaWYgKGlzQXBwcm92ZWQpIHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnNhdmVOb3RlKHRhc2suaWRlYSwgY29udGVudCk7XG4gICAgICAgICAgICAgICAgLy8gXHUzMDEwXHU0RkVFXHU2NTM5XHUzMDExXHU2Mjc5XHU1MUM2XHU1NDBFXHVGRjBDXHU2RTA1XHU3NDA2XHU3RjEzXHU1QjU4XHU2NTg3XHU0RUY2XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4ucGVyc2lzdGVuY2UuZGVsZXRlVGFza0NvbnRlbnQodGFzay5pZGVhKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZXh0cmFjdF9uZXdfY29uY2VwdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaWRlYXMgPSBleHRyYWN0TmV3SWRlYXMoY29udGVudCk7XG4gICAgICAgICAgICAgICAgICAgIGlkZWFzLmZvckVhY2goaWRlYSA9PiBuZXdJZGVhc0ZvdW5kLmFkZChpZGVhKSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgTG9nZ2VyLmxvZyhgXHVEODNEXHVEQzREIFtBcHByb3ZlZF06ICR7dGFzay5pZGVhfWApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0YXNrLnJlYXNvbiA9IHJlYXNvbjtcbiAgICAgICAgICAgICAgICB0YXNrLnJldHJpZXMgPSAodGFzay5yZXRyaWVzIHx8IDApICsgMTtcbiAgICAgICAgICAgICAgICAvLyBcdTYyRDJcdTdFRERcdTU0MEVcdUZGMENcdTUxODVcdTVCQjlcdTRGOURcdTcxMzZcdTRGRERcdTVCNThcdTU3MjhcdTdGMTNcdTVCNThcdTRFMkRcdUZGMENcdTY1RTBcdTk3MDBcdTkxQ0RcdTY1QjBcdTRGRERcdTVCNThcdUZGMENcdTUzRUFcdTk3MDBcdTc5RkJcdTUyQThcdTk2MUZcdTUyMTdcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLnJldmlzaW9uUXVldWUucHVzaCh0YXNrKTtcbiAgICAgICAgICAgICAgICBMb2dnZXIud2FybihgXHVEODNEXHVEQzRFIFtSZWplY3RlZF06ICR7dGFzay5pZGVhfSAtICR7cmVhc29ufWApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG5ld0lkZWFzRm91bmQuc2l6ZSA+IDApIHtcbiAgICAgICAgICAgIHRoaXMuYWRkQ29uY2VwdHNUb1F1ZXVlKEFycmF5LmZyb20obmV3SWRlYXNGb3VuZCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVBsdWdpbkRhdGEoKTsgXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgcnVuUmV2aXNpb25QaGFzZSgpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICAgICAgY29uc3QgcXVldWUgPSB0aGlzLnBsdWdpbi5kYXRhLnJldmlzaW9uUXVldWU7XG4gICAgICAgIGlmIChxdWV1ZS5sZW5ndGggPT09IDApIHJldHVybiBmYWxzZTtcblxuICAgICAgICBjb25zdCBiYXRjaFNpemUgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW5lcmF0aW9uX2JhdGNoX3NpemU7XG4gICAgICAgIGNvbnN0IHRhc2tzVG9SZXZpc2UgPSBxdWV1ZS5zcGxpY2UoMCwgTWF0aC5taW4ocXVldWUubGVuZ3RoLCBiYXRjaFNpemUpKTtcblxuICAgICAgICB0aGlzLnVwZGF0ZVN0YXR1c0JhcigpO1xuICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlUGx1Z2luRGF0YSgpOyBcblxuICAgICAgICBmb3IgKGNvbnN0IHRhc2sgb2YgdGFza3NUb1JldmlzZSkge1xuICAgICAgICAgICAgaWYgKCh0YXNrLnJldHJpZXMgfHwgMCkgPj0gdGhpcy5wbHVnaW4uc2V0dGluZ3MubWF4X3JldmlzaW9uX3JldHJpZXMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLmRpc2NhcmRlZFBpbGUucHVzaCh0YXNrKTsgXG4gICAgICAgICAgICAgICAgLy8gXHUzMDEwXHU0RkVFXHU2NTM5XHUzMDExXHU1RjdCXHU1RTk1XHU0RTIyXHU1RjAzXHU2NUY2XHVGRjBDXHU2NjJGXHU1NDI2XHU1MjIwXHU5NjY0XHU3RjEzXHU1QjU4XHVGRjFGXHU3NkVFXHU1MjREXHU0RkREXHU3NTU5XHU0RUU1XHU0RkJGXHU2MjRCXHU1MkE4XHU5MUNEXHU4QkQ1XHVGRjBDXHU2MjE2XHU4MDA1XHU2MEE4XHU1M0VGXHU0RUU1XHU5MDA5XHU2MkU5XHU1MjIwXHU5NjY0XG4gICAgICAgICAgICAgICAgLy8gYXdhaXQgdGhpcy5wbHVnaW4ucGVyc2lzdGVuY2UuZGVsZXRlVGFza0NvbnRlbnQodGFzay5pZGVhKTsgXG4gICAgICAgICAgICAgICAgTG9nZ2VyLmVycm9yKGBcdUQ4M0RcdURDODAgW0dpdmUgdXBdOiAke3Rhc2suaWRlYX0gbWF4IHJldHJpZXMgcmVhY2hlZC5gKTtcbiAgICAgICAgICAgICAgICBjb250aW51ZTsgXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnJldmlzaW9uVGFzayh0YXNrKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVQbHVnaW5EYXRhKCk7IFxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIHJldmlzaW9uVGFzayh0YXNrOiBUYXNrRGF0YSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICAvLyBcdTMwMTBcdTRGRUVcdTY1MzlcdTMwMTFcdTc4NkVcdTRGRERcdTY3MDlcdTUxODVcdTVCQjlcbiAgICAgICAgbGV0IGNvbnRlbnQgPSB0YXNrLmNvbnRlbnQ7XG4gICAgICAgIGlmICghY29udGVudCkge1xuICAgICAgICAgICAgY29udGVudCA9IGF3YWl0IHRoaXMucGx1Z2luLnBlcnNpc3RlbmNlLmxvYWRUYXNrQ29udGVudCh0YXNrLmlkZWEpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghY29udGVudCkge1xuICAgICAgICAgICAgIExvZ2dlci5lcnJvcihgQ29udGVudCBtaXNzaW5nIGZvciByZXZpc2lvbjogJHt0YXNrLmlkZWF9YCk7XG4gICAgICAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5kaXNjYXJkZWRQaWxlLnB1c2godGFzayk7XG4gICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcHJvbXB0ID0gdGhpcy5yZXZpc2VyLmNyZWF0ZVJldmlzaW9uUHJvbXB0KHRhc2suaWRlYSwgY29udGVudCwgdGFzay5yZWFzb24gfHwgXCJ1bmtub3duXCIpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgbmV3Q29udGVudCA9IGF3YWl0IHRoaXMuYXBpSGFuZGxlci5jYWxsKHByb21wdCk7XG4gICAgICAgICAgICBjb25zdCBjbGVhbmVkQ29udGVudCA9IGNsZWFuTWFya2Rvd25PdXRwdXQobmV3Q29udGVudCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFx1MzAxMFx1NEZFRVx1NjUzOVx1MzAxMVx1NjZGNFx1NjVCMFx1N0YxM1x1NUI1OFx1NjU4N1x1NEVGNlxuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4ucGVyc2lzdGVuY2Uuc2F2ZVRhc2tDb250ZW50KHRhc2suaWRlYSwgY2xlYW5lZENvbnRlbnQpO1xuXG4gICAgICAgICAgICBjb25zdCByZXZpc2VkVGFzazogVGFza0RhdGEgPSB7IC4uLnRhc2ssIGNvbnRlbnQ6IGNsZWFuZWRDb250ZW50IH07XG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLnJldmlld1F1ZXVlLnB1c2gocmV2aXNlZFRhc2spOyBcbiAgICAgICAgICAgIExvZ2dlci5sb2coYFx1RDgzRFx1REQwNCBbUmV2aXNpb24gQ29tcGxldGVdOiAke3Rhc2suaWRlYX1gKTtcbiAgICAgICAgfSBjYXRjaCAoZTogdW5rbm93bikgeyAvLyBGaXhlZDogdW5rbm93blxuICAgICAgICAgICAgY29uc3QgZXJyTXNnID0gZSBpbnN0YW5jZW9mIEVycm9yID8gZS5tZXNzYWdlIDogU3RyaW5nKGUpO1xuICAgICAgICAgICAgTG9nZ2VyLmVycm9yKGBcdTI3NEMgW1JldmlzaW9uIEZhaWxlZF06ICR7dGFzay5pZGVhfSAtICR7ZXJyTXNnfWApO1xuICAgICAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5yZXZpc2lvblF1ZXVlLnVuc2hpZnQodGFzayk7IFxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gLS0tIEZpbGUgJiBVSSAtLS1cbiAgICBwcml2YXRlIGFzeW5jIHNhdmVOb3RlKGlkZWE6IHN0cmluZywgY29udGVudDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGZpbGVuYW1lID0gc2FuaXRpemVGaWxlbmFtZShpZGVhKTtcbiAgICAgICAgY29uc3QgZm9sZGVyUGF0aCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLm91dHB1dF9kaXI7XG5cbiAgICAgICAgaWYgKCEodGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZvbGRlclBhdGgpIGluc3RhbmNlb2YgVEZvbGRlcikpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQuY3JlYXRlRm9sZGVyKGZvbGRlclBhdGgpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBMb2dnZXIuZXJyb3IoYENyZWF0ZSBmb2xkZXIgZmFpbGVkOiAke2ZvbGRlclBhdGh9YCwgZXJyb3IpO1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYENhbm5vdCBjcmVhdGUgZm9sZGVyOiAke2ZvbGRlclBhdGh9YCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuOyBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgY29uc3QgZmlsZVBhdGggPSBub3JtYWxpemVQYXRoKGAke2ZvbGRlclBhdGh9LyR7ZmlsZW5hbWV9Lm1kYCk7XG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIGNvbnRlbnQpO1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYE5vdGUgdXBkYXRlZDogJHtmaWxlbmFtZX1gKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQuY3JlYXRlKGZpbGVQYXRoLCBjb250ZW50KTtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKGBOb3RlIGNyZWF0ZWQ6ICR7ZmlsZW5hbWV9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBMb2dnZXIuZXJyb3IoYFNhdmUgbm90ZSBmYWlsZWQ6ICR7ZmlsZVBhdGh9YCwgZXJyb3IpO1xuICAgICAgICAgICAgbmV3IE5vdGljZShgQ2Fubm90IHNhdmUgbm90ZTogJHtmaWxlbmFtZX1gKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyB1cGRhdGVTdGF0dXNCYXIoKTogdm9pZCB7XG4gICAgICAgIGlmICghdGhpcy5wbHVnaW4uc3RhdHVzQmFyRWwpIHJldHVybjtcbiAgICAgICAgY29uc3QgeyBnZW5lcmF0aW9uUXVldWUsIHJldmlld1F1ZXVlLCByZXZpc2lvblF1ZXVlIH0gPSB0aGlzLnBsdWdpbi5kYXRhO1xuICAgICAgICBjb25zdCB0b3RhbCA9IGdlbmVyYXRpb25RdWV1ZS5sZW5ndGggKyByZXZpZXdRdWV1ZS5sZW5ndGggKyByZXZpc2lvblF1ZXVlLmxlbmd0aDtcbiAgICAgICAgXG4gICAgICAgIHRoaXMucGx1Z2luLnN0YXR1c0JhckVsLnNldFRleHQoXG4gICAgICAgICAgICBgS0c6ICR7dGhpcy5wbHVnaW4uZGF0YS5zdGF0dXN9IHwgRzoke2dlbmVyYXRpb25RdWV1ZS5sZW5ndGh9IHwgQzoke3Jldmlld1F1ZXVlLmxlbmd0aH0gfCBSOiR7cmV2aXNpb25RdWV1ZS5sZW5ndGh9IHwgVG90YWw6JHt0b3RhbH1gXG4gICAgICAgICk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2UudHJpZ2dlcihcImtnLWRhdGEtdXBkYXRlZFwiKTtcbiAgICB9XG59IiwgIi8vIHNyYy9hcGlIYW5kbGVyLnRzXG5cbmltcG9ydCB7IHJlcXVlc3RVcmwsIE5vdGljZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBLbm93bGVkZ2VHcmFwaFBsdWdpbiBmcm9tICcuL21haW4nO1xuaW1wb3J0IHsgS25vd2xlZGdlR3JhcGhQbHVnaW5TZXR0aW5ncywgS2V5VXNhZ2VTdGF0dXMgfSBmcm9tICcuL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIEFwaUtleUV4aGF1c3RlZEVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICAgIGNvbnN0cnVjdG9yKG1lc3NhZ2U6IHN0cmluZykge1xuICAgICAgICBzdXBlcihtZXNzYWdlKTtcbiAgICAgICAgdGhpcy5uYW1lID0gXCJBcGlLZXlFeGhhdXN0ZWRFcnJvclwiO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIEFsbE1vZGVsc0ZhaWxlZEVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICAgIGNvbnN0cnVjdG9yKG1lc3NhZ2U6IHN0cmluZykge1xuICAgICAgICBzdXBlcihtZXNzYWdlKTtcbiAgICAgICAgdGhpcy5uYW1lID0gXCJBbGxNb2RlbHNGYWlsZWRFcnJvclwiO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIEFQSUhhbmRsZXIge1xuICAgIHByaXZhdGUgcGx1Z2luOiBLbm93bGVkZ2VHcmFwaFBsdWdpbjtcbiAgICBwcml2YXRlIHNldHRpbmdzOiBLbm93bGVkZ2VHcmFwaFBsdWdpblNldHRpbmdzO1xuICAgIFxuICAgIHByaXZhdGUgb3BlbmFpX2tleXM6IHN0cmluZ1tdID0gW107XG4gICAgcHJpdmF0ZSBnb29nbGVfa2V5czogc3RyaW5nW10gPSBbXTtcbiAgICBcbiAgICBwcml2YXRlIGtleVVzYWdlT3BlbkFJID0gbmV3IE1hcDxzdHJpbmcsIEtleVVzYWdlU3RhdHVzPigpO1xuICAgIHByaXZhdGUga2V5VXNhZ2VHb29nbGUgPSBuZXcgTWFwPHN0cmluZywgS2V5VXNhZ2VTdGF0dXM+KCk7XG4gICAgXG4gICAgcHJpdmF0ZSBoYXNOb3RpZmllZEZhaWxvdmVyOiBib29sZWFuID0gZmFsc2U7XG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IEtub3dsZWRnZUdyYXBoUGx1Z2luKSB7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gcGx1Z2luLnNldHRpbmdzO1xuICAgICAgICB0aGlzLnVwZGF0ZUtleXMoKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgdXBkYXRlS2V5cygpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5vcGVuYWlfa2V5cyA9IHRoaXMuc2V0dGluZ3Mub3BlbmFpX2FwaV9rZXlzLnNwbGl0KFwiXFxuXCIpLm1hcCgoaykgPT4gay50cmltKCkpLmZpbHRlcihCb29sZWFuKTtcbiAgICAgICAgdGhpcy5nb29nbGVfa2V5cyA9IHRoaXMuc2V0dGluZ3MuZ29vZ2xlX2FwaV9rZXlzLnNwbGl0KFwiXFxuXCIpLm1hcCgoaykgPT4gay50cmltKCkpLmZpbHRlcihCb29sZWFuKTtcblxuICAgICAgICB0aGlzLm9wZW5haV9rZXlzLmZvckVhY2goKGtleSkgPT4ge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmtleVVzYWdlT3BlbkFJLmhhcyhrZXkpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5rZXlVc2FnZU9wZW5BSS5zZXQoa2V5LCB7IGZhaWxzOiAwLCBjb29sZG93bl91bnRpbDogMCB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuZ29vZ2xlX2tleXMuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgICAgICAgICBpZiAoIXRoaXMua2V5VXNhZ2VHb29nbGUuaGFzKGtleSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmtleVVzYWdlR29vZ2xlLnNldChrZXksIHsgZmFpbHM6IDAsIGNvb2xkb3duX3VudGlsOiAwIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIF9zZWxlY3RLZXkoa2V5czogc3RyaW5nW10sIHByb3ZpZGVyOiAnb3BlbmFpJyB8ICdnb29nbGUnKTogc3RyaW5nIHwgbnVsbCB7XG4gICAgICAgIGNvbnN0IGtleVVzYWdlTWFwID0gcHJvdmlkZXIgPT09IFwib3BlbmFpXCIgPyB0aGlzLmtleVVzYWdlT3BlbkFJIDogdGhpcy5rZXlVc2FnZUdvb2dsZTtcbiAgICAgICAgY29uc3QgY3VycmVudFRpbWUgPSBEYXRlLm5vdygpIC8gMTAwMDtcblxuICAgICAgICBmb3IgKGNvbnN0IGtleSBvZiBrZXlzKSB7XG4gICAgICAgICAgICBjb25zdCB1c2FnZSA9IGtleVVzYWdlTWFwLmdldChrZXkpO1xuICAgICAgICAgICAgaWYgKHVzYWdlICYmIGN1cnJlbnRUaW1lID49IHVzYWdlLmNvb2xkb3duX3VudGlsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGtleTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIF9tYWtlT3BlbkFJUmVxdWVzdChrZXk6IHN0cmluZywgcHJvbXB0OiBzdHJpbmcsIG1vZGVsTmFtZTogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0VXJsKHtcbiAgICAgICAgICAgIHVybDogYCR7dGhpcy5zZXR0aW5ncy5vcGVuYWlfYmFzZV91cmx9L2NoYXQvY29tcGxldGlvbnNgLFxuICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgICAgICAgICBcIkF1dGhvcml6YXRpb25cIjogYEJlYXJlciAke2tleX1gXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgIG1vZGVsOiBtb2RlbE5hbWUsXG4gICAgICAgICAgICAgICAgbWVzc2FnZXM6IFt7IHJvbGU6IFwidXNlclwiLCBjb250ZW50OiBwcm9tcHQgfV0sXG4gICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHRoaXMuc2V0dGluZ3MuZ2VuZXJhdGlvbl90ZW1wZXJhdHVyZSxcbiAgICAgICAgICAgICAgICBtYXhfdG9rZW5zOiB0aGlzLnNldHRpbmdzLmdlbmVyYXRpb25fbWF4X3Rva2Vuc1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiByZXNwb25zZS5qc29uLmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50LnRyaW0oKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIF9tYWtlR29vZ2xlQVBJUmVxdWVzdChrZXk6IHN0cmluZywgcHJvbXB0OiBzdHJpbmcsIG1vZGVsTmFtZTogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICAgICAgY29uc3QgdXJsID0gYGh0dHBzOi8vZ2VuZXJhdGl2ZWxhbmd1YWdlLmdvb2dsZWFwaXMuY29tL3YxYmV0YS9tb2RlbHMvJHttb2RlbE5hbWV9OmdlbmVyYXRlQ29udGVudD9rZXk9JHtrZXl9YDtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0VXJsKHtcbiAgICAgICAgICAgIHVybCxcbiAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgICBoZWFkZXJzOiB7IFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiIH0sXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgY29udGVudHM6IFt7IHBhcnRzOiBbeyB0ZXh0OiBwcm9tcHQgfV0gfV0sXG4gICAgICAgICAgICAgICAgZ2VuZXJhdGlvbkNvbmZpZzoge1xuICAgICAgICAgICAgICAgICAgICB0ZW1wZXJhdHVyZTogdGhpcy5zZXR0aW5ncy5nZW5lcmF0aW9uX3RlbXBlcmF0dXJlLFxuICAgICAgICAgICAgICAgICAgICBtYXhPdXRwdXRUb2tlbnM6IHRoaXMuc2V0dGluZ3MuZ2VuZXJhdGlvbl9tYXhfdG9rZW5zXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgZGF0YSA9IHJlc3BvbnNlLmpzb247XG4gICAgICAgIGlmICghZGF0YS5jYW5kaWRhdGVzIHx8IGRhdGEuY2FuZGlkYXRlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkFQSSByZXNwb25zZSBpcyBtaXNzaW5nIGNhbmRpZGF0ZXMuIEZ1bGwgcmVzcG9uc2U6IFwiICsgSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkYXRhLmNhbmRpZGF0ZXNbMF0uY29udGVudC5wYXJ0c1swXS50ZXh0LnRyaW0oKTtcbiAgICB9XG5cbiAgICAvLyBGaXhlZDogcmVwbGFjZWQgJ2FueScgd2l0aCAndW5rbm93bidcbiAgICBwcml2YXRlIF9pc1F1b3RhRXJyb3IoZXJyb3I6IHVua25vd24pOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgZXJyID0gZXJyb3IgYXMgeyBzdGF0dXM/OiBudW1iZXI7IG1lc3NhZ2U/OiBzdHJpbmcgfTsgXG4gICAgICAgIGNvbnN0IGh0dHBTdGF0dXMgPSBlcnIuc3RhdHVzO1xuICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBlcnIubWVzc2FnZT8udG9Mb3dlckNhc2UoKSB8fCBcIlwiO1xuICAgICAgICBcbiAgICAgICAgaWYgKGh0dHBTdGF0dXMgPT09IDQwMSB8fCBodHRwU3RhdHVzID09PSA0MDMgfHwgaHR0cFN0YXR1cyA9PT0gNDI5KSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKGVycm9yTWVzc2FnZS5pbmNsdWRlcyhcImluc3VmZmljaWVudF9xdW90YVwiKSB8fCBlcnJvck1lc3NhZ2UuaW5jbHVkZXMoXCJyYXRlIGxpbWl0XCIpIHx8IGVycm9yTWVzc2FnZS5pbmNsdWRlcyhcInF1b3RhXCIpIHx8IGVycm9yTWVzc2FnZS5pbmNsdWRlcyhcInBlcm1pc3Npb25cIikgfHwgZXJyb3JNZXNzYWdlLmluY2x1ZGVzKFwiNDI5XCIpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHByaXZhdGUgX2Nvb2xkb3duS2V5KGtleTogc3RyaW5nLCBwcm92aWRlcjogJ29wZW5haScgfCAnZ29vZ2xlJyk6IHZvaWQge1xuICAgICAgICBjb25zdCBrZXlVc2FnZU1hcCA9IHByb3ZpZGVyID09PSBcIm9wZW5haVwiID8gdGhpcy5rZXlVc2FnZU9wZW5BSSA6IHRoaXMua2V5VXNhZ2VHb29nbGU7XG4gICAgICAgIGNvbnN0IGtleVVzYWdlID0ga2V5VXNhZ2VNYXAuZ2V0KGtleSk7XG4gICAgICAgIGlmIChrZXlVc2FnZSkge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKGBLZXkgLi4uJHtrZXkuc2xpY2UoLTQpfSAoJHtwcm92aWRlcn0pIGZhaWxlZCBkdWUgdG8gcXVvdGEvYXV0aCBlcnJvci4gQXBwbHlpbmcgY29vbGRvd24uYCk7XG4gICAgICAgICAgICBrZXlVc2FnZS5jb29sZG93bl91bnRpbCA9IChEYXRlLm5vdygpIC8gMTAwMCkgKyB0aGlzLnNldHRpbmdzLmZhaWxvdmVyX2Nvb2xkb3duX3NlY29uZHM7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIF9yZXNldENvb2xkb3duKGtleTogc3RyaW5nLCBwcm92aWRlcjogJ29wZW5haScgfCAnZ29vZ2xlJyk6IHZvaWQge1xuICAgICAgICBjb25zdCBrZXlVc2FnZU1hcCA9IHByb3ZpZGVyID09PSBcIm9wZW5haVwiID8gdGhpcy5rZXlVc2FnZU9wZW5BSSA6IHRoaXMua2V5VXNhZ2VHb29nbGU7XG4gICAgICAgIGNvbnN0IGtleVVzYWdlID0ga2V5VXNhZ2VNYXAuZ2V0KGtleSk7XG4gICAgICAgIGlmIChrZXlVc2FnZSkge1xuICAgICAgICAgICAga2V5VXNhZ2UuY29vbGRvd25fdW50aWwgPSAwO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaGFzTm90aWZpZWRGYWlsb3ZlciA9IGZhbHNlO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgX2NhbGxPcGVuQUkoa2V5OiBzdHJpbmcsIHByb21wdDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICAgICAgY29uc3QgcHJpbWFyeU1vZGVsID0gdGhpcy5zZXR0aW5ncy5vcGVuYWlfbW9kZWw7XG4gICAgICAgIGNvbnN0IGJhY2t1cE1vZGVsID0gdGhpcy5zZXR0aW5ncy5vcGVuYWlfYmFja3VwX21vZGVsO1xuICAgICAgICBcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuX21ha2VPcGVuQUlSZXF1ZXN0KGtleSwgcHJvbXB0LCBwcmltYXJ5TW9kZWwpO1xuICAgICAgICAgICAgdGhpcy5fcmVzZXRDb29sZG93bihrZXksIFwib3BlbmFpXCIpO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfSBjYXRjaCAoZTogdW5rbm93bikgeyAvLyBGaXhlZDogdW5rbm93blxuICAgICAgICAgICAgY29uc3QgcHJpbWFyeUVycm9yID0gZTtcbiAgICAgICAgICAgIGNvbnN0IHByaW1hcnlNc2cgPSAoZSBpbnN0YW5jZW9mIEVycm9yKSA/IGUubWVzc2FnZSA6IFN0cmluZyhlKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc29sZS53YXJuKGBPcGVuQUkgcHJpbWFyeSBtb2RlbCAnJHtwcmltYXJ5TW9kZWx9JyBmYWlsZWQgZm9yIGtleSAuLi4ke2tleS5zbGljZSgtNCl9OmAsIHByaW1hcnlNc2cpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoYmFja3VwTW9kZWwpIHsgXG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYmFja3VwUmVzdWx0ID0gYXdhaXQgdGhpcy5fbWFrZU9wZW5BSVJlcXVlc3Qoa2V5LCBwcm9tcHQsIGJhY2t1cE1vZGVsKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVzZXRDb29sZG93bihrZXksIFwib3BlbmFpXCIpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYmFja3VwUmVzdWx0OyBcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlMjogdW5rbm93bikgeyAvLyBGaXhlZDogdW5rbm93blxuICAgICAgICAgICAgICAgICAgICBjb25zdCBiYWNrdXBNc2cgPSAoZTIgaW5zdGFuY2VvZiBFcnJvcikgPyBlMi5tZXNzYWdlIDogU3RyaW5nKGUyKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgT3BlbkFJIGJhY2t1cCBtb2RlbCAnJHtiYWNrdXBNb2RlbH0nIGFsc28gZmFpbGVkIGZvciBrZXkgLi4uJHtrZXkuc2xpY2UoLTQpfTpgLCBiYWNrdXBNc2cpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2lzUXVvdGFFcnJvcihwcmltYXJ5RXJyb3IpIHx8IHRoaXMuX2lzUXVvdGFFcnJvcihlMikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2Nvb2xkb3duS2V5KGtleSwgXCJvcGVuYWlcIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEFwaUtleUV4aGF1c3RlZEVycm9yKGBPcGVuQUkga2V5IGZhaWxlZCAoYm90aCBwcmltYXJ5IGFuZCBiYWNrdXAgbW9kZWxzKS5gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICh0aGlzLl9pc1F1b3RhRXJyb3IocHJpbWFyeUVycm9yKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2Nvb2xkb3duS2V5KGtleSwgXCJvcGVuYWlcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aHJvdyBuZXcgQXBpS2V5RXhoYXVzdGVkRXJyb3IoYE9wZW5BSSBrZXkgZmFpbGVkIChwcmltYXJ5IG1vZGVsIGZhaWxlZCwgbm8gYmFja3VwKTogJHtwcmltYXJ5TXNnfWApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBfY2FsbEdvb2dsZUFQSShrZXk6IHN0cmluZywgcHJvbXB0OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgICAgICBjb25zdCBwcmltYXJ5TW9kZWwgPSB0aGlzLnNldHRpbmdzLmdvb2dsZV9tb2RlbDtcbiAgICAgICAgY29uc3QgYmFja3VwTW9kZWwgPSB0aGlzLnNldHRpbmdzLmdvb2dsZV9iYWNrdXBfbW9kZWw7XG4gICAgICAgIFxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5fbWFrZUdvb2dsZUFQSVJlcXVlc3Qoa2V5LCBwcm9tcHQsIHByaW1hcnlNb2RlbCk7XG4gICAgICAgICAgICB0aGlzLl9yZXNldENvb2xkb3duKGtleSwgXCJnb29nbGVcIik7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9IGNhdGNoIChlOiB1bmtub3duKSB7IC8vIEZpeGVkOiB1bmtub3duXG4gICAgICAgICAgICBjb25zdCBwcmltYXJ5RXJyb3IgPSBlO1xuICAgICAgICAgICAgY29uc3QgcHJpbWFyeU1zZyA9IChlIGluc3RhbmNlb2YgRXJyb3IpID8gZS5tZXNzYWdlIDogU3RyaW5nKGUpO1xuICAgICAgICAgICAgY29uc29sZS53YXJuKGBHb29nbGUgcHJpbWFyeSBtb2RlbCAnJHtwcmltYXJ5TW9kZWx9JyBmYWlsZWQgZm9yIGtleSAuLi4ke2tleS5zbGljZSgtNCl9OmAsIHByaW1hcnlNc2cpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoYmFja3VwTW9kZWwpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBiYWNrdXBSZXN1bHQgPSBhd2FpdCB0aGlzLl9tYWtlR29vZ2xlQVBJUmVxdWVzdChrZXksIHByb21wdCwgYmFja3VwTW9kZWwpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZXNldENvb2xkb3duKGtleSwgXCJnb29nbGVcIik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBiYWNrdXBSZXN1bHQ7IFxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUyOiB1bmtub3duKSB7IC8vIEZpeGVkOiB1bmtub3duXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGJhY2t1cE1zZyA9IChlMiBpbnN0YW5jZW9mIEVycm9yKSA/IGUyLm1lc3NhZ2UgOiBTdHJpbmcoZTIpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBHb29nbGUgYmFja3VwIG1vZGVsICcke2JhY2t1cE1vZGVsfScgYWxzbyBmYWlsZWQgZm9yIGtleSAuLi4ke2tleS5zbGljZSgtNCl9OmAsIGJhY2t1cE1zZyk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5faXNRdW90YUVycm9yKHByaW1hcnlFcnJvcikgfHwgdGhpcy5faXNRdW90YUVycm9yKGUyKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY29vbGRvd25LZXkoa2V5LCBcImdvb2dsZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgQXBpS2V5RXhoYXVzdGVkRXJyb3IoYEdvb2dsZSBrZXkgZmFpbGVkIChib3RoIHByaW1hcnkgYW5kIGJhY2t1cCBtb2RlbHMpLmApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKHRoaXMuX2lzUXVvdGFFcnJvcihwcmltYXJ5RXJyb3IpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY29vbGRvd25LZXkoa2V5LCBcImdvb2dsZVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRocm93IG5ldyBBcGlLZXlFeGhhdXN0ZWRFcnJvcihgR29vZ2xlIGtleSBmYWlsZWQgKHByaW1hcnkgbW9kZWwgZmFpbGVkLCBubyBiYWNrdXApOiAke3ByaW1hcnlNc2d9YCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgY2FsbChwcm9tcHQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIHRoaXMudXBkYXRlS2V5cygpO1xuICAgICAgICBsZXQgbGFzdEVycm9yOiBFcnJvciB8IG51bGwgPSBudWxsO1xuICAgICAgICBsZXQgb3BlbkFJS2V5c0F0dGVtcHRlZCA9IGZhbHNlO1xuXG4gICAgICAgIGNvbnN0IG9wZW5BSUVuYWJsZWQgPSB0aGlzLm9wZW5haV9rZXlzLmxlbmd0aCA+IDAgJiYgISEodGhpcy5zZXR0aW5ncy5vcGVuYWlfbW9kZWwgfHwgdGhpcy5zZXR0aW5ncy5vcGVuYWlfYmFja3VwX21vZGVsKTtcbiAgICAgICAgY29uc3QgZ29vZ2xlRW5hYmxlZCA9IHRoaXMuZ29vZ2xlX2tleXMubGVuZ3RoID4gMCAmJiAhISh0aGlzLnNldHRpbmdzLmdvb2dsZV9tb2RlbCB8fCB0aGlzLnNldHRpbmdzLmdvb2dsZV9iYWNrdXBfbW9kZWwpO1xuXG4gICAgICAgIGlmIChvcGVuQUlFbmFibGVkKSB7XG4gICAgICAgICAgICBvcGVuQUlLZXlzQXR0ZW1wdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5vcGVuYWlfa2V5cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGtleSA9IHRoaXMuX3NlbGVjdEtleSh0aGlzLm9wZW5haV9rZXlzLCBcIm9wZW5haVwiKTtcbiAgICAgICAgICAgICAgICBpZiAoa2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKGBUcnlpbmcgT3BlbkFJIGtleSAuLi4ke2tleS5zbGljZSgtNCl9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5fY2FsbE9wZW5BSShrZXksIHByb21wdCk7XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGU6IHVua25vd24pIHsgLy8gRml4ZWQ6IHVua25vd25cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVyciA9IGUgYXMgRXJyb3I7XG4gICAgICAgICAgICAgICAgICAgICAgICBsYXN0RXJyb3IgPSBlcnI7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKGBPcGVuQUkga2V5IC4uLiR7a2V5LnNsaWNlKC00KX0gZmFpbGVkLiBUcnlpbmcgbmV4dC5gKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLm9wZW5haV9rZXlzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIG9wZW5BSUtleXNBdHRlbXB0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgbGFzdEVycm9yID0gbmV3IEVycm9yKFwiT3BlbkFJOiBLZXlzIHByb3ZpZGVkIGJ1dCBubyBtb2RlbHMgZGVmaW5lZC5cIik7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4obGFzdEVycm9yLm1lc3NhZ2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGdvb2dsZUVuYWJsZWQpIHtcbiAgICAgICAgICAgIGlmIChvcGVuQUlLZXlzQXR0ZW1wdGVkICYmICF0aGlzLmhhc05vdGlmaWVkRmFpbG92ZXIpIHtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKFwiQWxsIE9wZW5BSSBrZXlzIGZhaWxlZCBvciB1bmF2YWlsYWJsZS4gU3dpdGNoaW5nIHRvIEdvb2dsZSBHZW1pbmkuLi5cIik7XG4gICAgICAgICAgICAgICAgdGhpcy5oYXNOb3RpZmllZEZhaWxvdmVyID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5nb29nbGVfa2V5cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGtleSA9IHRoaXMuX3NlbGVjdEtleSh0aGlzLmdvb2dsZV9rZXlzLCBcImdvb2dsZVwiKTtcbiAgICAgICAgICAgICAgICBpZiAoa2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKGBUcnlpbmcgR29vZ2xlIEdlbWluaSBrZXkgLi4uJHtrZXkuc2xpY2UoLTQpfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuX2NhbGxHb29nbGVBUEkoa2V5LCBwcm9tcHQpO1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlOiB1bmtub3duKSB7IC8vIEZpeGVkOiB1bmtub3duXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlcnIgPSBlIGFzIEVycm9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGFzdEVycm9yID0gZXJyO1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZShgR29vZ2xlIEdlbWluaSBrZXkgLi4uJHtrZXkuc2xpY2UoLTQpfSBmYWlsZWQuIFRyeWluZyBuZXh0LmApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZ29vZ2xlX2tleXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgbGFzdEVycm9yID0gbGFzdEVycm9yIHx8IG5ldyBFcnJvcihcIkdvb2dsZTogS2V5cyBwcm92aWRlZCBidXQgbm8gbW9kZWxzIGRlZmluZWQuXCIpO1xuICAgICAgICAgICAgY29uc29sZS53YXJuKGxhc3RFcnJvci5tZXNzYWdlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghb3BlbkFJRW5hYmxlZCAmJiAhZ29vZ2xlRW5hYmxlZCAmJiAodGhpcy5vcGVuYWlfa2V5cy5sZW5ndGggPiAwIHx8IHRoaXMuZ29vZ2xlX2tleXMubGVuZ3RoID4gMCkpIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJQbGVhc2UgcHJvdmlkZSBBUEkga2V5cyBhbmQgYXQgbGVhc3Qgb25lIG1vZGVsIG5hbWUgaW4gc2V0dGluZ3MuXCIpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFsbE1vZGVsc0ZhaWxlZEVycm9yKFwiS2V5cyBwcm92aWRlZCBidXQgbm8gbW9kZWxzIGRlZmluZWQuXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhyb3cgbmV3IEFsbE1vZGVsc0ZhaWxlZEVycm9yKGBBbGwgQVBJIHByb3ZpZGVycyBmYWlsZWQuIExhc3QgZXJyb3I6ICR7bGFzdEVycm9yPy5tZXNzYWdlfWApO1xuICAgIH1cbn0iLCAiLy8gY3JpdGljLnRzXG5cbmltcG9ydCBLbm93bGVkZ2VHcmFwaFBsdWdpbiBmcm9tICcuL21haW4nO1xuaW1wb3J0IHsgQVBJSGFuZGxlciB9IGZyb20gJy4vYXBpSGFuZGxlcic7XG5cbmV4cG9ydCBjbGFzcyBDcml0aWMge1xuICAgIHByaXZhdGUgcGx1Z2luOiBLbm93bGVkZ2VHcmFwaFBsdWdpbjtcbiAgICBwcml2YXRlIGFwaUhhbmRsZXI6IEFQSUhhbmRsZXI7XG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IEtub3dsZWRnZUdyYXBoUGx1Z2luKSB7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgICAgICB0aGlzLmFwaUhhbmRsZXIgPSBuZXcgQVBJSGFuZGxlcihwbHVnaW4pOyAvLyBDcml0aWMgY2FuIGhhdmUgaXRzIG93biBoYW5kbGVyIGlmIG5lZWRlZFxuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBqdWRnZShjb250ZW50OiBzdHJpbmcpOiBQcm9taXNlPHsgaXNBcHByb3ZlZDogYm9vbGVhbiwgcmVhc29uOiBzdHJpbmcgfT4ge1xuICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuY3JpdGljX21vZGUgPT09ICdhaScpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9qdWRnZUJ5QUkoY29udGVudCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX2p1ZGdlQnlIZXVyaXN0aWMoY29udGVudCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfanVkZ2VCeUhldXJpc3RpYyhjb250ZW50OiBzdHJpbmcpOiB7IGlzQXBwcm92ZWQ6IGJvb2xlYW4sIHJlYXNvbjogc3RyaW5nIH0ge1xuICAgICAgICBjb25zdCByZWFzb25zOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBjb25zdCBjb250ZW50TG93ZXIgPSBjb250ZW50LnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgICAgLy8gMS4gQ2hlY2sgZm9yIHJlcXVpcmVkIGhlYWRlcnNcbiAgICAgICAgY29uc3QgcmVxdWlyZWRIZWFkZXJzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3JpdGljX3JlcXVpcmVkX2hlYWRlcnNcbiAgICAgICAgICAgIC5zcGxpdCgnXFxuJykubWFwKGggPT4gaC50cmltKCkudG9Mb3dlckNhc2UoKSkuZmlsdGVyKEJvb2xlYW4pO1xuICAgICAgICBjb25zdCBtaXNzaW5nSGVhZGVycyA9IHJlcXVpcmVkSGVhZGVycy5maWx0ZXIoaCA9PiAhY29udGVudExvd2VyLmluY2x1ZGVzKGgpKTtcbiAgICAgICAgaWYgKG1pc3NpbmdIZWFkZXJzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHJlYXNvbnMucHVzaChgXHU3RjNBXHU1QzExXHU1RkM1XHU5NzAwXHU3Njg0XHU2ODA3XHU5ODk4OiAke21pc3NpbmdIZWFkZXJzLmpvaW4oJywgJyl9YCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyAyLiBDaGVjayBmb3IgbWluIGxlbmd0aFxuICAgICAgICBpZiAoY29udGVudC5sZW5ndGggPCB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jcml0aWNfbWluX2NvbnRlbnRfbGVuZ3RoKSB7XG4gICAgICAgICAgICByZWFzb25zLnB1c2goYFx1NTE4NVx1NUJCOVx1OEZDN1x1NzdFRCAoXHU1RjUzXHU1MjREOiAke2NvbnRlbnQubGVuZ3RofSwgXHU4OTgxXHU2QzQyOiAke3RoaXMucGx1Z2luLnNldHRpbmdzLmNyaXRpY19taW5fY29udGVudF9sZW5ndGh9KWApO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gMy4gQ2hlY2sgZm9yIHJlZnVzYWwgcGF0dGVybnNcbiAgICAgICAgY29uc3QgcmVmdXNhbFBhdHRlcm5zID0gW1wiXHU0RjVDXHU0RTNBXHU0RTAwP1x1NEUyQUFJXCIsIFwiXHU0RjVDXHU0RTNBXHU4QkVEXHU4QTAwXHU2QTIxXHU1NzhCXCIsIFwiXHU2MjExXHU0RTBEXHU4MEZEXCIsIFwiXHU2MjExXHU2NUUwXHU2Q0Q1XCIsIFwiXHU1Rjg4XHU2MkIxXHU2QjQ5XCJdO1xuICAgICAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgcmVmdXNhbFBhdHRlcm5zKSB7XG4gICAgICAgICAgICBpZiAobmV3IFJlZ0V4cChwYXR0ZXJuLCAnaScpLnRlc3QoY29udGVudCkpIHtcbiAgICAgICAgICAgICAgICByZWFzb25zLnB1c2goYFx1NTMwNVx1NTQyQkFJXHU2MkQyXHU3RUREXHU4QkVEIChcdTUzMzlcdTkxNEQ6ICcke3BhdHRlcm59JylgKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlzQXBwcm92ZWQ6IHJlYXNvbnMubGVuZ3RoID09PSAwLFxuICAgICAgICAgICAgcmVhc29uOiByZWFzb25zLmxlbmd0aCA+IDAgPyByZWFzb25zLmpvaW4oJzsgJykgOiBcIlx1OTAxQVx1OEZDN1x1NjI0MFx1NjcwOVx1NTQyRlx1NTNEMVx1NUYwRlx1ODlDNFx1NTIxOVx1NjhDMFx1NjdFNVx1MzAwMlwiXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBfanVkZ2VCeUFJKGNvbnRlbnQ6IHN0cmluZyk6IFByb21pc2U8eyBpc0FwcHJvdmVkOiBib29sZWFuLCByZWFzb246IHN0cmluZyB9PiB7XG4gICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnByb21wdF9jcml0aWMucmVwbGFjZSgne2NvbnRlbnR9JywgY29udGVudCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuYXBpSGFuZGxlci5jYWxsKHByb21wdCk7XG4gICAgICAgICAgICBjb25zdCBkZWNpc2lvbk1hdGNoID0gcmVzcG9uc2UubWF0Y2goL0RFQ0lTSU9OOlxccyooS0VFUHxESVNDQVJEKS9pKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gXHUzMDEwXHUzMDEwXHUzMDEwIFx1NURGMlx1NEZFRVx1NTkwRFx1RkYxQVx1NkRGQlx1NTJBMCAvaSBcdTY4MDdcdTVGRDdcdUZGMENcdTRGN0ZcdTUxNzZcdTRFMERcdTUzM0FcdTUyMDZcdTU5MjdcdTVDMEZcdTUxOTkgXHUzMDExXHUzMDExXHUzMDExXG4gICAgICAgICAgICBjb25zdCByZWFzb25NYXRjaCA9IHJlc3BvbnNlLm1hdGNoKC9cXFtSRUFTT046XFxzKihbXlxcXV0rKVxcXS9pKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgaXNBcHByb3ZlZCA9IGRlY2lzaW9uTWF0Y2ggPyBkZWNpc2lvbk1hdGNoWzFdLnRvVXBwZXJDYXNlKCkgPT09ICdLRUVQJyA6IGZhbHNlO1xuICAgICAgICAgICAgY29uc3QgcmVhc29uID0gcmVhc29uTWF0Y2ggPyByZWFzb25NYXRjaFsxXS50cmltKCkgOiAoaXNBcHByb3ZlZCA/IFwiQUkgXHU2Mjc5XHU1MUM2XCIgOiBcIkFJIFx1NjJEMlx1N0VERFx1RkYwQ1x1NjcyQVx1NjNEMFx1NEY5Qlx1NjYwRVx1Nzg2RVx1NzQwNlx1NzUzMVwiKTtcblxuICAgICAgICAgICAgcmV0dXJuIHsgaXNBcHByb3ZlZCwgcmVhc29uIH07XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiQUkgQ3JpdGljIGNhbGwgZmFpbGVkOlwiLCBlcnJvcik7XG4gICAgICAgICAgICByZXR1cm4geyBpc0FwcHJvdmVkOiBmYWxzZSwgcmVhc29uOiBgQUkgXHU1QkExXHU2ODM4XHU1NjY4XHU4QzAzXHU3NTI4XHU1OTMxXHU4RDI1OiAke2Vycm9yLm1lc3NhZ2V9YCB9O1xuICAgICAgICB9XG4gICAgfVxufVxuIiwgIi8vIHJldmlzZXIudHNcblxuaW1wb3J0IEtub3dsZWRnZUdyYXBoUGx1Z2luIGZyb20gJy4vbWFpbic7XG5cbmV4cG9ydCBjbGFzcyBSZXZpc2VyIHtcbiAgICBwcml2YXRlIHBsdWdpbjogS25vd2xlZGdlR3JhcGhQbHVnaW47XG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IEtub3dsZWRnZUdyYXBoUGx1Z2luKSB7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgIH1cblxuICAgIHB1YmxpYyBjcmVhdGVSZXZpc2lvblByb21wdChpZGVhOiBzdHJpbmcsIG9yaWdpbmFsQ29udGVudDogc3RyaW5nLCByZWplY3Rpb25SZWFzb246IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGxldCBwcm9tcHQgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9tcHRfcmV2aXNlcjtcbiAgICAgICAgcHJvbXB0ID0gcHJvbXB0LnJlcGxhY2UoJ3tjb25jZXB0fScsIGlkZWEpO1xuICAgICAgICBwcm9tcHQgPSBwcm9tcHQucmVwbGFjZSgne29yaWdpbmFsX2NvbnRlbnR9Jywgb3JpZ2luYWxDb250ZW50KTtcbiAgICAgICAgcHJvbXB0ID0gcHJvbXB0LnJlcGxhY2UoJ3tyZWplY3Rpb25fcmVhc29ufScsIHJlamVjdGlvblJlYXNvbik7XG4gICAgICAgIHJldHVybiBwcm9tcHQ7XG4gICAgfVxufVxuIiwgIi8vIHNyYy9wZXJzaXN0ZW5jZS50c1xuXG5pbXBvcnQgeyBBcHAsIG5vcm1hbGl6ZVBhdGggfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBQbHVnaW5EYXRhLCBUYXNrRGF0YSB9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IEtub3dsZWRnZUdyYXBoUGx1Z2luIGZyb20gJy4vbWFpbic7XG5pbXBvcnQgeyBMb2dnZXIgfSBmcm9tICcuL3V0aWxzJztcblxuZXhwb3J0IGNsYXNzIFBlcnNpc3RlbmNlIHtcbiAgICBwcml2YXRlIHBsdWdpbjogS25vd2xlZGdlR3JhcGhQbHVnaW47XG4gICAgcHJpdmF0ZSBhcHA6IEFwcDtcbiAgICBwcml2YXRlIGNhY2hlRGlyOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBxdWV1ZUZpbGU6IHN0cmluZztcblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogS25vd2xlZGdlR3JhcGhQbHVnaW4pIHtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgICAgIHRoaXMuYXBwID0gcGx1Z2luLmFwcDtcbiAgICAgICAgLy8gXHU2M0QyXHU0RUY2XHU5MTREXHU3RjZFXHU3NkVFXHU1RjU1XHU0RTBCXHU3Njg0XHU3RjEzXHU1QjU4XHU2NTg3XHU0RUY2XHU1OTM5XG4gICAgICAgIHRoaXMuY2FjaGVEaXIgPSBub3JtYWxpemVQYXRoKGAke3RoaXMuYXBwLnZhdWx0LmNvbmZpZ0Rpcn0vcGx1Z2lucy8ke3RoaXMucGx1Z2luLm1hbmlmZXN0LmlkfS90YXNrX2NhY2hlYCk7XG4gICAgICAgIC8vIFx1NzJFQ1x1N0FDQlx1NzY4NFx1OTYxRlx1NTIxN1x1NjU3MFx1NjM2RVx1NjU4N1x1NEVGNlxuICAgICAgICB0aGlzLnF1ZXVlRmlsZSA9IG5vcm1hbGl6ZVBhdGgoYCR7dGhpcy5hcHAudmF1bHQuY29uZmlnRGlyfS9wbHVnaW5zLyR7dGhpcy5wbHVnaW4ubWFuaWZlc3QuaWR9L3F1ZXVlcy5qc29uYCk7XG4gICAgfVxuXG4gICAgYXN5bmMgaW5pdCgpIHtcbiAgICAgICAgLy8gXHU3ODZFXHU0RkREXHU3RjEzXHU1QjU4XHU3NkVFXHU1RjU1XHU1QjU4XHU1NzI4XG4gICAgICAgIGNvbnN0IGFkYXB0ZXIgPSB0aGlzLmFwcC52YXVsdC5hZGFwdGVyO1xuICAgICAgICBpZiAoIShhd2FpdCBhZGFwdGVyLmV4aXN0cyh0aGlzLmNhY2hlRGlyKSkpIHtcbiAgICAgICAgICAgIGF3YWl0IGFkYXB0ZXIubWtkaXIodGhpcy5jYWNoZURpcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyAtLS0gXHU5NjFGXHU1MjE3XHU1MTQzXHU2NTcwXHU2MzZFIChcdThGN0JcdTkxQ0ZcdTdFQTcpIC0tLVxuXG4gICAgYXN5bmMgbG9hZFF1ZXVlRGF0YSgpOiBQcm9taXNlPFBsdWdpbkRhdGEgfCBudWxsPiB7XG4gICAgICAgIGNvbnN0IGFkYXB0ZXIgPSB0aGlzLmFwcC52YXVsdC5hZGFwdGVyO1xuICAgICAgICBpZiAoYXdhaXQgYWRhcHRlci5leGlzdHModGhpcy5xdWV1ZUZpbGUpKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCBhZGFwdGVyLnJlYWQodGhpcy5xdWV1ZUZpbGUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKGNvbnRlbnQpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIExvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBsb2FkIHF1ZXVlIGRhdGE6XCIsIGUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGFzeW5jIHNhdmVRdWV1ZURhdGEoZGF0YTogUGx1Z2luRGF0YSkge1xuICAgICAgICAvLyBcdTZERjFcdTYyRjdcdThEMURcdTY1NzBcdTYzNkVcdUZGMENcdTc5RkJcdTk2NjQgY29udGVudCBcdTVCNTdcdTZCQjVcdUZGMENcdTk2MzJcdTZCNjJcdTU5MjdcdTY1ODdcdTY3MkNcdTUxOTlcdTUxNjUgSlNPTlxuICAgICAgICBjb25zdCBjbGVhbkRhdGEgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGRhdGEpKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHN0cmlwQ29udGVudCA9IChxdWV1ZTogVGFza0RhdGFbXSkgPT4ge1xuICAgICAgICAgICAgcXVldWUuZm9yRWFjaCh0YXNrID0+IHtcbiAgICAgICAgICAgICAgICBkZWxldGUgdGFzay5jb250ZW50OyAvLyBcdTRFQzVcdTRGRERcdTc1NTlcdTUxNDNcdTY1NzBcdTYzNkVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIHN0cmlwQ29udGVudChjbGVhbkRhdGEucmV2aWV3UXVldWUpO1xuICAgICAgICBzdHJpcENvbnRlbnQoY2xlYW5EYXRhLnJldmlzaW9uUXVldWUpO1xuICAgICAgICBzdHJpcENvbnRlbnQoY2xlYW5EYXRhLmRpc2NhcmRlZFBpbGUpO1xuXG4gICAgICAgIGNvbnN0IGFkYXB0ZXIgPSB0aGlzLmFwcC52YXVsdC5hZGFwdGVyO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgYWRhcHRlci53cml0ZSh0aGlzLnF1ZXVlRmlsZSwgSlNPTi5zdHJpbmdpZnkoY2xlYW5EYXRhLCBudWxsLCAyKSk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIExvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBzYXZlIHF1ZXVlIGRhdGE6XCIsIGUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gLS0tIFx1NEVGQlx1NTJBMVx1NTE4NVx1NUJCOSAoXHU5MUNEXHU5MUNGXHU3RUE3IC0gXHU3MkVDXHU3QUNCXHU2NTg3XHU0RUY2KSAtLS1cblxuICAgIHByaXZhdGUgZ2V0Q2FjaGVQYXRoKGlkZWE6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIC8vIFx1NEY3Rlx1NzUyOCBzYW5pdGl6ZUZpbGVuYW1lIFx1Nzg2RVx1NEZERFx1NjU4N1x1NEVGNlx1NTQwRFx1NTQwOFx1NkNENVx1RkYwQ1x1NEY0Nlx1ODk4MVx1OTA3Rlx1NTE0RFx1NTFCMlx1N0E4MVx1RkYwQ1x1NjcwMFx1NTk3RFx1NTJBMFx1NEUyQSBoYXNoIFx1NjIxNlx1NEZERFx1NjMwMVx1N0I4MFx1NTM1NVxuICAgICAgICAvLyBcdThGRDlcdTkxQ0NcdTUwNDdcdThCQkUgc2FuaXRpemVGaWxlbmFtZSBcdThEQjNcdTU5MUZcdTVCODlcdTUxNjhcbiAgICAgICAgY29uc3Qgc2FmZU5hbWUgPSBpZGVhLnJlcGxhY2UoL1tcXFxcLyo/OlwiPD58XS9nLCBcIlwiKS50cmltKCkuc2xpY2UoMCwgMTAwKTtcbiAgICAgICAgcmV0dXJuIGAke3RoaXMuY2FjaGVEaXJ9LyR7c2FmZU5hbWV9Lm1kYDtcbiAgICB9XG5cbiAgICBhc3luYyBzYXZlVGFza0NvbnRlbnQoaWRlYTogc3RyaW5nLCBjb250ZW50OiBzdHJpbmcpIHtcbiAgICAgICAgY29uc3QgcGF0aCA9IHRoaXMuZ2V0Q2FjaGVQYXRoKGlkZWEpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQuYWRhcHRlci53cml0ZShwYXRoLCBjb250ZW50KTtcbiAgICAgICAgICAgIExvZ2dlci5sb2coYFNhdmVkIGNvbnRlbnQgY2FjaGUgZm9yOiAke2lkZWF9YCk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIExvZ2dlci5lcnJvcihgRmFpbGVkIHRvIHNhdmUgY29udGVudCBjYWNoZSBmb3IgJHtpZGVhfTpgLCBlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIGxvYWRUYXNrQ29udGVudChpZGVhOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgICAgICBjb25zdCBwYXRoID0gdGhpcy5nZXRDYWNoZVBhdGgoaWRlYSk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoYXdhaXQgdGhpcy5hcHAudmF1bHQuYWRhcHRlci5leGlzdHMocGF0aCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5hcHAudmF1bHQuYWRhcHRlci5yZWFkKHBhdGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBMb2dnZXIuZXJyb3IoYEZhaWxlZCB0byBsb2FkIGNvbnRlbnQgY2FjaGUgZm9yICR7aWRlYX06YCwgZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFwiXCI7IC8vIFx1NTk4Mlx1Njc5Q1x1NEUyMlx1NTkzMVx1NjIxNlx1OEJGQlx1NTNENlx1NTkzMVx1OEQyNVx1RkYwQ1x1OEZENFx1NTZERVx1N0E3QVxuICAgIH1cblxuICAgIGFzeW5jIGRlbGV0ZVRhc2tDb250ZW50KGlkZWE6IHN0cmluZykge1xuICAgICAgICBjb25zdCBwYXRoID0gdGhpcy5nZXRDYWNoZVBhdGgoaWRlYSk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoYXdhaXQgdGhpcy5hcHAudmF1bHQuYWRhcHRlci5leGlzdHMocGF0aCkpIHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5hZGFwdGVyLnJlbW92ZShwYXRoKTtcbiAgICAgICAgICAgICAgICBMb2dnZXIubG9nKGBEZWxldGVkIGNvbnRlbnQgY2FjaGUgZm9yOiAke2lkZWF9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIExvZ2dlci53YXJuKGBGYWlsZWQgdG8gZGVsZXRlIGNvbnRlbnQgY2FjaGUgZm9yICR7aWRlYX0gKG1pZ2h0IGFsbG93IGNsZWFudXAgbGF0ZXIpOmAsIGUpO1xuICAgICAgICB9XG4gICAgfVxufSJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQSxJQUFBQSxtQkFBdUI7OztBQ0F2QixJQUFBQyxtQkFBdUQ7OztBQ0F2RCxzQkFBb0M7QUFJN0IsSUFBTSx1QkFBTixjQUFtQyxzQkFBTTtBQUFBLEVBc0I1QyxZQUFZLEtBQVUsUUFBOEI7QUFDaEQsVUFBTSxHQUFHO0FBbkJiO0FBQUEsU0FBUSxjQUF5QztBQUFBLE1BQzdDLEtBQUs7QUFBQSxNQUNMLEtBQUs7QUFBQSxNQUNMLEtBQUs7QUFBQSxNQUNMLEtBQUs7QUFBQSxJQUNUO0FBR0E7QUFBQSxTQUFRLGlCQUE2QztBQUFBLE1BQ2pELEtBQUs7QUFBQSxNQUNMLEtBQUs7QUFBQSxNQUNM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
