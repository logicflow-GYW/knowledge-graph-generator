/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => KnowledgeGraphPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian5 = require("obsidian");

// settings.ts
var import_obsidian2 = require("obsidian");
var import_obsidian = require("obsidian");
var QueueManagementModal = class extends import_obsidian.Modal {
  constructor(app, plugin) {
    super(app);
    this.searchTerms = {
      gen: "",
      rev: "",
      rep: "",
      dis: ""
    };
    this.collapseStates = {
      gen: false,
      // 默认折叠
      rev: false,
      // 默认折叠
      rep: false,
      // 默认折叠
      dis: false
      // 默认折叠
    };
    this.plugin = plugin;
    this.refreshContent = this.onOpen.bind(this);
  }
  onOpen() {
    const { contentEl } = this;
    this.app.workspace.off("kg-data-updated", this.refreshContent);
    contentEl.empty();
    contentEl.addClass("kg-modal");
    contentEl.createEl("h2", { text: "\u961F\u5217\u7BA1\u7406\u4EEA\u8868\u76D8" });
    const status = this.plugin.data.status;
    const statusText = `\u72B6\u6001: ${status.toUpperCase()} | ${this.plugin.statusBarEl.getText()}`;
    new import_obsidian.Setting(contentEl).setName(status === "running" ? "\u5F15\u64CE\u8FD0\u884C\u4E2D" : "\u5F15\u64CE\u5DF2\u6682\u505C").setDesc(statusText).addButton(
      (button) => button.setButtonText(status === "running" ? "\u6682\u505C\u5F15\u64CE" : "\u542F\u52A8\u5F15\u64CE").setCta(status !== "running").onClick(() => {
        this.plugin.engine.toggleEngineState();
        this.onOpen();
      })
    );
    this.renderQueueSection(
      contentEl,
      "gen",
      "\u5F85\u751F\u6210 (Generation)",
      this.plugin.data.generationQueue,
      this.renderGenerationItem.bind(this)
    );
    this.renderQueueSection(
      contentEl,
      "rev",
      "\u5F85\u5BA1\u6838 (Review)",
      this.plugin.data.reviewQueue,
      this.renderReviewItem.bind(this)
    );
    this.renderQueueSection(
      contentEl,
      "rep",
      "\u5F85\u4FEE\u6B63 (Revision)",
      this.plugin.data.revisionQueue,
      this.renderRevisionItem.bind(this)
    );
    this.renderQueueSection(
      contentEl,
      "dis",
      "\u5DF2\u4E22\u5F03 (Discarded)",
      this.plugin.data.discardedPile,
      this.renderDiscardedItem.bind(this)
    );
    this.app.workspace.on("kg-data-updated", this.refreshContent);
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
    this.app.workspace.off("kg-data-updated", this.refreshContent);
  }
  /**
   * 渲染一个队列区域 (带搜索和展开/折叠)
   */
  renderQueueSection(containerEl, key, title, data, renderFn) {
    const displayLimit = 100;
    const filter = this.searchTerms[key];
    const filteredData = data.filter((item) => {
      if (!filter)
        return true;
      const needle = filter.toLowerCase();
      if (typeof item === "string") {
        return item.toLowerCase().includes(needle);
      }
      return item.idea.toLowerCase().includes(needle);
    });
    const total = data.length;
    const filteredTotal = filteredData.length;
    const titleText = `${title} (${filteredTotal}${total !== filteredTotal ? " / " + total : ""} \u9879)`;
    const details = containerEl.createEl("details");
    details.open = this.collapseStates[key];
    const summary = details.createEl("summary", { text: titleText });
    summary.style.fontWeight = "bold";
    summary.style.fontSize = "var(--font-ui-large)";
    summary.style.cursor = "pointer";
    summary.style.padding = "5px 0";
    details.addEventListener("toggle", () => {
      this.collapseStates[key] = details.open;
    });
    new import_obsidian.Setting(details).setDesc(`\u641C\u7D22 ${title}...`).addText((text) => {
      text.setPlaceholder("\u8F93\u5165\u5173\u952E\u8BCD...").setValue(this.searchTerms[key]).onChange((value) => {
        this.searchTerms[key] = value;
        this.onOpen();
      });
    });
    const truncatedData = filteredData.slice(0, displayLimit);
    if (truncatedData.length === 0) {
      const desc = details.createEl("p", { text: "\u6B64\u961F\u5217\u4E3A\u7A7A\uFF0C\u6216\u672A\u627E\u5230\u5339\u914D\u9879\u3002", cls: "setting-item-description" });
      desc.style.paddingLeft = "10px";
      return;
    }
    const listContainer = details.createDiv("kg-list-container");
    listContainer.style.maxHeight = "200px";
    listContainer.style.overflowY = "auto";
    listContainer.style.border = "1px solid var(--background-modifier-border)";
    listContainer.style.padding = "5px";
    listContainer.style.marginLeft = "10px";
    truncatedData.forEach((item, index) => {
      renderFn(listContainer, item, index);
    });
    if (filteredData.length > displayLimit) {
      const truncatedInfo = details.createEl("p", {
        text: `... \u4EC5\u663E\u793A\u524D ${displayLimit} \u9879 (\u5171 ${filteredData.length} \u9879)\uFF0C\u8BF7\u4F7F\u7528\u641C\u7D22\u67E5\u627E\u66F4\u591A\u3002`,
        cls: "setting-item-description"
      });
      truncatedInfo.style.paddingLeft = "10px";
    }
  }
  // --- 单项渲染函数 (保持不变) ---
  renderGenerationItem(container, item) {
    new import_obsidian.Setting(container).setName(item).addButton(
      (btn) => btn.setIcon("trash").setTooltip("\u5220\u9664\u6B64\u6982\u5FF5").onClick(async () => {
        const queue = this.plugin.data.generationQueue;
        const index = queue.indexOf(item);
        if (index > -1) {
          queue.splice(index, 1);
          await this.plugin.savePluginData();
          this.plugin.engine.updateStatusBar();
          this.onOpen();
        }
      })
    );
  }
  renderReviewItem(container, item) {
    const task = item;
    new import_obsidian.Setting(container).setName(`[\u5BA1\u6838] ${task.idea}`).addButton(
      (btn) => btn.setIcon("trash").setTooltip("\u4E22\u5F03\u6B64\u4EFB\u52A1").onClick(async () => {
        this.plugin.data.reviewQueue.splice(this.plugin.data.reviewQueue.indexOf(task), 1);
        this.plugin.data.discardedPile.push(task);
        await this.plugin.savePluginData();
        this.plugin.engine.updateStatusBar();
        this.onOpen();
      })
    );
  }
  renderRevisionItem(container, item) {
    const task = item;
    new import_obsidian.Setting(container).setName(`[\u4FEE\u6B63] ${task.idea}`).setDesc(`\u539F\u56E0: ${task.reason || "\u672A\u77E5"}`).addButton(
      (btn) => btn.setIcon("trash").setTooltip("\u4E22\u5F03\u6B64\u4EFB\u52A1").onClick(async () => {
        this.plugin.data.revisionQueue.splice(this.plugin.data.revisionQueue.indexOf(task), 1);
        this.plugin.data.discardedPile.push(task);
        await this.plugin.savePluginData();
        this.plugin.engine.updateStatusBar();
        this.onOpen();
      })
    );
  }
  renderDiscardedItem(container, item) {
    const task = item;
    new import_obsidian.Setting(container).setName(`[\u5DF2\u4E22\u5F03] ${task.idea}`).setDesc(`\u6700\u540E\u539F\u56E0: ${task.reason || "\u672A\u77E5"}`).addButton(
      (btn) => btn.setIcon("refresh-cw").setTooltip("\u91CD\u65B0\u6392\u961F (\u653E\u56DE\u751F\u6210\u961F\u5217)").onClick(async () => {
        this.plugin.data.discardedPile.splice(this.plugin.data.discardedPile.indexOf(task), 1);
        this.plugin.engine.addConceptsToQueue([task.idea]);
        this.onOpen();
      })
    );
  }
};
var PROMPT_GENERATOR_DEFAULT = `# Role: \u77E5\u8BC6\u7CFB\u7EDF\u6784\u5EFA\u4E13\u5BB6...`;
var PROMPT_CRITIC_DEFAULT = `# Role: \u77E5\u8BC6\u56FE\u8C31\u8D28\u91CF\u5BA1\u6838\u5458...`;
var PROMPT_REVISER_DEFAULT = `# \u89D2\u8272: \u8D44\u6DF1\u77E5\u8BC6\u7F16\u8F91\u4E0E\u5185\u5BB9\u4F18\u5316\u4E13\u5BB6...`;
var DEFAULT_SETTINGS = {
  // API
  openai_api_keys: "",
  openai_base_url: "https://api.openai.com/v1",
  openai_model: "gpt-4-turbo-preview",
  openai_backup_model: "",
  // 【 新增：OpenAI 备用模型 】
  google_api_keys: "",
  google_model: "gemini-1.5-pro-latest",
  google_backup_model: "",
  // 【 新增：Google 备用模型 】
  failover_cooldown_seconds: 300,
  // 参数
  generation_temperature: 0.7,
  generation_max_tokens: 4096,
  // 路径
  output_dir: "KnowledgeGraphNotes",
  // 系统
  max_workers: 2,
  generation_batch_size: 5,
  request_delay: 5,
  // Critic
  critic_mode: "heuristic",
  critic_required_headers: "# \u{1F9E0}\n> \n## \u{1F4DD} \u6838\u5FC3\u601D\u60F3\n## \u{1F3AF} \u9002\u7528\u573A\u666F\n## \u{1F6E0}\uFE0F \u4F7F\u7528\u6B65\u9AA4/\u6784\u6210\u8981\u7D20\n## \u{1F680} \u6848\u4F8B\u5206\u6790\n## \u{1F44D} \u4F18\u70B9 & \u{1F44E} \u7F3A\u70B9\n## \u{1F517} \u5173\u8054\u6A21\u578B",
  critic_min_content_length: 400,
  // Reviser
  max_revision_retries: 2,
  // Prompts
  prompt_generator: PROMPT_GENERATOR_DEFAULT,
  prompt_critic: PROMPT_CRITIC_DEFAULT,
  prompt_reviser: PROMPT_REVISER_DEFAULT,
  // 播种箱
  seedConcepts: "",
  // 【【【 新增配置项 】】】
  // 默认关闭新概念提取
  extract_new_concepts: false
};
async function getDefaultPrompts() {
  return {
    prompt_generator: PROMPT_GENERATOR_DEFAULT,
    prompt_critic: PROMPT_CRITIC_DEFAULT,
    prompt_reviser: PROMPT_REVISER_DEFAULT
  };
}
var KGsSettingTab = class extends import_obsidian2.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "\u77E5\u8BC6\u56FE\u8C31\u751F\u6210\u5668 - \u8BBE\u7F6E" });
    new import_obsidian2.Setting(containerEl).setName("\u5F15\u64CE\u4EEA\u8868\u76D8").setDesc("\u7BA1\u7406\u5F85\u751F\u6210\u3001\u5F85\u5BA1\u6838\u548C\u5DF2\u4E22\u5F03\u7684\u4EFB\u52A1\u3002").addButton(
      (button) => button.setButtonText("\u6253\u5F00\u961F\u5217\u7BA1\u7406\u5668").setCta().onClick(() => {
        new QueueManagementModal(this.app, this.plugin).open();
      })
    );
    new import_obsidian2.Setting(containerEl).setName("API \u8BBE\u7F6E").setHeading();
    containerEl.createEl("h3", { text: "OpenAI" });
    new import_obsidian2.Setting(containerEl).setName("OpenAI API Keys").setDesc("\u6BCF\u884C\u4E00\u4E2A Key\u3002\u63D2\u4EF6\u5C06\u81EA\u52A8\u8F6E\u6362\u548C\u51B7\u5374\u4F7F\u7528\u3002").addTextArea((text) => text.setPlaceholder("sk-...").setValue(this.plugin.settings.openai_api_keys).onChange(async (value) => {
      this.plugin.settings.openai_api_keys = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("OpenAI Base URL").setDesc("\u5982\u679C\u4F60\u4F7F\u7528\u7B2C\u4E09\u65B9\u4EE3\u7406\uFF0C\u8BF7\u5728\u6B64\u5904\u586B\u5165\u4EE3\u7406\u5730\u5740\u3002").addText((text) => text.setPlaceholder("https://api.openai.com/v1").setValue(this.plugin.settings.openai_base_url).onChange(async (value) => {
      this.plugin.settings.openai_base_url = value.trim();
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("OpenAI Model (\u4E3B\u6A21\u578B)").setDesc("\u8F93\u5165\u4F60\u60F3\u4F7F\u7528\u7684 OpenAI \u4E3B\u8981\u6A21\u578B\u540D\u79F0\u3002").addText((text) => text.setPlaceholder("gpt-4-turbo-preview").setValue(this.plugin.settings.openai_model).onChange(async (value) => {
      this.plugin.settings.openai_model = value.trim();
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("OpenAI \u5907\u7528\u6A21\u578B (Backup Model)").setDesc("(\u53EF\u9009) \u5F53\u4E3B\u6A21\u578B\u989D\u5EA6\u8017\u5C3D\u6216\u5931\u8D25\u65F6\uFF0C\u5C06\u81EA\u52A8\u5C1D\u8BD5\u6B64\u5907\u7528\u6A21\u578B\u3002").addText((text) => text.setPlaceholder("gpt-3.5-turbo").setValue(this.plugin.settings.openai_backup_model).onChange(async (value) => {
      this.plugin.settings.openai_backup_model = value.trim();
      await this.plugin.saveSettings();
    }));
    containerEl.createEl("h3", { text: "Google Gemini" });
    new import_obsidian2.Setting(containerEl).setName("Google Gemini API Keys").setDesc("\u6BCF\u884C\u4E00\u4E2A Key\u3002").addTextArea((text) => text.setPlaceholder("AIzaSy...").setValue(this.plugin.settings.google_api_keys).onChange(async (value) => {
      this.plugin.settings.google_api_keys = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("Google Gemini Model (\u4E3B\u6A21\u578B)").setDesc("\u8F93\u5165\u4F60\u60F3\u4F7F\u7528\u7684 Google \u4E3B\u8981\u6A21\u578B\u540D\u79F0\u3002").addText((text) => text.setPlaceholder("gemini-1.5-pro-latest").setValue(this.plugin.settings.google_model).onChange(async (value) => {
      this.plugin.settings.google_model = value.trim();
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("Google Gemini \u5907\u7528\u6A21\u578B (Backup Model)").setDesc("(\u53EF\u9009) \u5F53\u4E3B\u6A21\u578B\u989D\u5EA6\u8017\u5C3D\u6216\u5931\u8D25\u65F6\uFF0C\u5C06\u81EA\u52A8\u5C1D\u8BD5\u6B64\u5907\u7528\u6A21\u578B\u3002").addText((text) => text.setPlaceholder("gemini-1.0-pro").setValue(this.plugin.settings.google_backup_model).onChange(async (value) => {
      this.plugin.settings.google_backup_model = value.trim();
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("Key \u51B7\u5374\u65F6\u95F4 (\u79D2)").setDesc("API Key \u5931\u8D25\u540E\uFF0C\u9700\u8981\u7B49\u5F85\u591A\u5C11\u79D2\u624D\u80FD\u518D\u6B21\u4F7F\u7528\u3002").addText((text) => text.setValue(String(this.plugin.settings.failover_cooldown_seconds)).onChange(async (value) => {
      const num = parseInt(value, 10);
      if (!isNaN(num) && num >= 0) {
        this.plugin.settings.failover_cooldown_seconds = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("LLM \u53C2\u6570\u8BBE\u7F6E").setHeading();
    new import_obsidian2.Setting(containerEl).setName("\u751F\u6210\u6E29\u5EA6 (Temperature)").setDesc("\u63A7\u5236\u751F\u6210\u5185\u5BB9\u7684\u968F\u673A\u6027\u3002\u8F83\u4F4E\u7684\u503C\uFF08\u5982 0.2\uFF09\u66F4\u5177\u786E\u5B9A\u6027\uFF0C\u8F83\u9AD8\u7684\u503C\uFF08\u5982 0.8\uFF09\u66F4\u5177\u521B\u9020\u6027\u3002").addText((text) => text.setValue(String(this.plugin.settings.generation_temperature)).onChange(async (value) => {
      const num = parseFloat(value);
      if (!isNaN(num) && num >= 0 && num <= 2) {
        this.plugin.settings.generation_temperature = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("\u6700\u5927 Token \u6570 (Max Tokens)").setDesc("API \u4E00\u6B21\u8C03\u7528\u5141\u8BB8\u751F\u6210\u7684\u6700\u5927 Token \u6570\u91CF\u3002").addText((text) => text.setValue(String(this.plugin.settings.generation_max_tokens)).onChange(async (value) => {
      const num = parseInt(value, 10);
      if (!isNaN(num) && num > 0) {
        this.plugin.settings.generation_max_tokens = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("\u5F15\u64CE\u8BBE\u7F6E").setHeading();
    new import_obsidian2.Setting(containerEl).setName("\u8F93\u51FA\u6587\u4EF6\u5939").setDesc("\u6240\u6709\u751F\u6210\u7684\u7B14\u8BB0\u5C06\u4FDD\u5B58\u5230\u6B64\u6587\u4EF6\u5939\u3002").addText((text) => text.setPlaceholder("KnowledgeGraphNotes").setValue(this.plugin.settings.output_dir).onChange(async (value) => {
      this.plugin.settings.output_dir = value.trim().replace(/\/$/, "");
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("\u6700\u5927\u5E76\u53D1\u6570 (Max Workers)").setDesc("\uFF08\u6CE8\u610F\uFF1A\u5F53\u524D V2.2 \u5F15\u64CE\u4E3A\u5355\u7EBF\u7A0B\u6D41\u6C34\u7EBF\uFF0C\u6B64\u8BBE\u7F6E\u6682\u672A\u751F\u6548\uFF09").addText((text) => text.setValue(String(this.plugin.settings.max_workers)).onChange(async (value) => {
      const num = parseInt(value, 10);
      if (!isNaN(num) && num > 0) {
        this.plugin.settings.max_workers = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("\u751F\u6210\u6279\u5904\u7406\u5927\u5C0F").setDesc("\u5F15\u64CE\u6BCF\u4E00\u8F6E\u4ECE\u201C\u5F85\u751F\u6210\u961F\u5217\u201D\u4E2D\u53D6\u51FA\u7684\u4EFB\u52A1\u6570\u91CF\u3002").addText((text) => text.setValue(String(this.plugin.settings.generation_batch_size)).onChange(async (value) => {
      const num = parseInt(value, 10);
      if (!isNaN(num) && num > 0) {
        this.plugin.settings.generation_batch_size = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("\u6BCF\u8F6E\u8BF7\u6C42\u5EF6\u8FDF (\u79D2)").setDesc("\u5F15\u64CE\u5728\u5904\u7406\u5B8C\u4E00\u4E2A\u6279\u6B21\u540E\uFF0C\u7B49\u5F85\u591A\u5C11\u79D2\u518D\u5F00\u59CB\u4E0B\u4E00\u4E2A\u6279\u6B21\u3002").addText((text) => text.setValue(String(this.plugin.settings.request_delay)).onChange(async (value) => {
      const num = parseInt(value, 10);
      if (!isNaN(num) && num >= 0) {
        this.plugin.settings.request_delay = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("\u6700\u5927\u4FEE\u6B63\u6B21\u6570").setDesc("\u4E00\u7BC7\u7B14\u8BB0\u5728\u88AB\u653E\u5F03\uFF08\u79FB\u5165 Discarded Pile\uFF09\u524D\uFF0C\u6700\u591A\u5141\u8BB8\u88AB\u4FEE\u6B63\u7684\u6B21\u6570\u3002").addText((text) => text.setValue(String(this.plugin.settings.max_revision_retries)).onChange(async (value) => {
      const num = parseInt(value, 10);
      if (!isNaN(num) && num >= 0) {
        this.plugin.settings.max_revision_retries = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("\u81EA\u52A8\u63D0\u53D6\u65B0\u6982\u5FF5 (Extract New Concepts)").setDesc("\u5F00\u542F\u540E\uFF0C\u5C06\u81EA\u52A8\u4ECE\u5DF2\u6279\u51C6\u7B14\u8BB0\u7684\u5185\u5BB9\u4E2D\u63D0\u53D6 [[Wikilinks]] \u4F5C\u4E3A\u65B0\u6982\u5FF5\u52A0\u5165\u201C\u5F85\u751F\u6210\u961F\u5217\u201D\u3002(\u9ED8\u8BA4\u5173\u95ED)").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.extract_new_concepts).onChange(async (value) => {
        this.plugin.settings.extract_new_concepts = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian2.Setting(containerEl).setName("\u5BA1\u6838\u6A21\u5F0F (Critic Mode)").setDesc("\u9009\u62E9\u5185\u5BB9\u5BA1\u6838\u7684\u65B9\u5F0F\u3002\u542F\u53D1\u5F0F\u6A21\u5F0F\u901F\u5EA6\u5FEB\u4E14\u514D\u8D39\uFF0C\u4F46\u53EA\u68C0\u67E5\u683C\u5F0F\uFF1BAI\u6A21\u5F0F\u66F4\u667A\u80FD\uFF0C\u4F46\u4F1A\u6D88\u8017API\u989D\u5EA6\u3002").addDropdown((dropdown) => dropdown.addOption("heuristic", "\u542F\u53D1\u5F0F (Heuristic)").addOption("ai", "\u4EBA\u5DE5\u667A\u80FD (AI)").setValue(this.plugin.settings.critic_mode).onChange(async (value) => {
      this.plugin.settings.critic_mode = value;
      await this.plugin.saveSettings();
      this.display();
    }));
    if (this.plugin.settings.critic_mode === "heuristic") {
      new import_obsidian2.Setting(containerEl).setName("\u542F\u53D1\u5F0F\u5BA1\u6838\uFF1A\u5FC5\u987B\u7684\u6807\u9898").setDesc("\u5728\u542F\u53D1\u5F0F\u6A21\u5F0F\u4E0B\uFF0C\u68C0\u67E5\u7B14\u8BB0\u662F\u5426\u5305\u542B\u6240\u6709\u8FD9\u4E9B\u6807\u9898\uFF08\u6BCF\u884C\u4E00\u4E2A\uFF09\u3002").addTextArea((text) => text.setValue(this.plugin.settings.critic_required_headers).onChange(async (value) => {
        this.plugin.settings.critic_required_headers = value;
        await this.plugin.saveSettings();
      }).inputEl.style.height = "150px");
      new import_obsidian2.Setting(containerEl).setName("\u542F\u53D1\u5F0F\u5BA1\u6838\uFF1A\u6700\u5C0F\u5185\u5BB9\u957F\u5EA6").setDesc("\u5728\u542F\u53D1\u5F0F\u6A21\u5F0F\u4E0B\uFF0C\u7B14\u8BB0\u5185\u5BB9\u5FC5\u987B\u8FBE\u5230\u7684\u6700\u5C0F\u5B57\u7B26\u6570\u3002").addText((text) => text.setValue(String(this.plugin.settings.critic_min_content_length)).onChange(async (value) => {
        const num = parseInt(value, 10);
        if (!isNaN(num) && num >= 0) {
          this.plugin.settings.critic_min_content_length = num;
          await this.plugin.saveSettings();
        }
      }));
    }
    new import_obsidian2.Setting(containerEl).setName("\u6982\u5FF5\u64AD\u79CD (Concept Seeding)").setHeading();
    new import_obsidian2.Setting(containerEl).setName("\u6982\u5FF5\u64AD\u79CD\u7BB1").setDesc("\u5728\u6B64\u5904\u7C98\u8D34\u6216\u8F93\u5165\u60A8\u60F3\u8981\u751F\u6210\u521D\u59CB\u7B14\u8BB0\u7684\u6982\u5FF5\u5217\u8868\uFF0C\u6BCF\u884C\u4E00\u4E2A\u6982\u5FF5\u3002").addTextArea(
      (text) => text.setPlaceholder("\u4F8B\u5982\uFF1A\n\u7B2C\u4E00\u6027\u539F\u7406\n\u5965\u5361\u59C6\u5243\u5200\n\u523B\u610F\u7EC3\u4E60\n...").setValue(this.plugin.settings.seedConcepts).onChange(async (value) => {
        this.plugin.settings.seedConcepts = value;
        await this.plugin.saveSettings();
      }).inputEl.style.height = "200px"
    );
    new import_obsidian2.Setting(containerEl).addButton(
      (button) => button.setButtonText("\u64AD\u79CD\u5230\u5F85\u751F\u6210\u961F\u5217").setCta().onClick(async () => {
        const rawText = this.plugin.settings.seedConcepts;
        if (!rawText.trim()) {
          new import_obsidian2.Notice("\u64AD\u79CD\u7BB1\u4E3A\u7A7A\uFF0C\u65E0\u9700\u64CD\u4F5C\u3002");
          return;
        }
        const conceptsToSeed = [...new Set(rawText.split("\n").map((line) => line.trim()).filter(Boolean))];
        const addedCount = this.plugin.engine.addConceptsToQueue(conceptsToSeed);
        const ignoredCount = conceptsToSeed.length - addedCount;
        let noticeMessage = `\u6210\u529F\u6DFB\u52A0 ${addedCount} \u4E2A\u65B0\u6982\u5FF5\u5230\u961F\u5217\u3002`;
        if (ignoredCount > 0) {
          noticeMessage += `
${ignoredCount} \u4E2A\u6982\u5FF5\u56E0\u5DF2\u5B58\u5728\u6216\u91CD\u590D\u800C\u88AB\u5FFD\u7565\u3002`;
        }
        new import_obsidian2.Notice(noticeMessage, 5e3);
        this.plugin.settings.seedConcepts = "";
        await this.plugin.saveSettings();
        this.display();
      })
    );
    new import_obsidian2.Setting(containerEl).setName("Prompts \u8BBE\u7F6E").setHeading();
    new import_obsidian2.Setting(containerEl).setName("\u751F\u6210 Prompt").setDesc("\u7528\u4E8E\u751F\u6210\u65B0\u6982\u5FF5\u5185\u5BB9\u7684 Prompt\u3002").addTextArea((text) => text.setValue(this.plugin.settings.prompt_generator).onChange(async (value) => {
      this.plugin.settings.prompt_generator = value;
      await this.plugin.saveSettings();
    }).inputEl.style.height = "300px");
    if (this.plugin.settings.critic_mode === "ai") {
      new import_obsidian2.Setting(containerEl).setName("\u5BA1\u6838 Prompt (Critic)").setDesc("\u7528\u4E8E AI \u6A21\u5F0F\u4E0B\u5BA1\u6838\u751F\u6210\u5185\u5BB9\u7684 Prompt\u3002").addTextArea((text) => text.setValue(this.plugin.settings.prompt_critic).onChange(async (value) => {
        this.plugin.settings.prompt_critic = value;
        await this.plugin.saveSettings();
      }).inputEl.style.height = "300px");
    }
    new import_obsidian2.Setting(containerEl).setName("\u4FEE\u6B63 Prompt (Reviser)").setDesc("\u7528\u4E8E\u4FEE\u6B63\u88AB\u5BA1\u6838\u5458\u62D2\u7EDD\u5185\u5BB9\u7684 Prompt\u3002").addTextArea((text) => text.setValue(this.plugin.settings.prompt_reviser).onChange(async (value) => {
      this.plugin.settings.prompt_reviser = value;
      await this.plugin.saveSettings();
    }).inputEl.style.height = "300px");
  }
};

// engine.ts
var import_obsidian4 = require("obsidian");

// apiHandler.ts
var import_obsidian3 = require("obsidian");
var ApiKeyExhaustedError = class extends Error {
  constructor(message) {
    super(message);
    this.name = "ApiKeyExhaustedError";
  }
};
var AllModelsFailedError = class extends Error {
  constructor(message) {
    super(message);
    this.name = "AllModelsFailedError";
  }
};
var APIHandler = class {
  constructor(plugin) {
    this.keyUsageOpenAI = /* @__PURE__ */ new Map();
    this.keyUsageGoogle = /* @__PURE__ */ new Map();
    this.hasNotifiedFailover = false;
    this.plugin = plugin;
    this.settings = plugin.settings;
    this.updateKeys();
  }
  updateKeys() {
    this.openai_keys = this.settings.openai_api_keys.split("\n").map((k) => k.trim()).filter(Boolean);
    this.google_keys = this.settings.google_api_keys.split("\n").map((k) => k.trim()).filter(Boolean);
    this.openai_keys.forEach((key) => {
      if (!this.keyUsageOpenAI.has(key)) {
        this.keyUsageOpenAI.set(key, { fails: 0, cooldown_until: 0 });
      }
    });
    this.google_keys.forEach((key) => {
      if (!this.keyUsageGoogle.has(key)) {
        this.keyUsageGoogle.set(key, { fails: 0, cooldown_until: 0 });
      }
    });
  }
  _selectKey(keys, provider) {
    const keyUsageMap = provider === "openai" ? this.keyUsageOpenAI : this.keyUsageGoogle;
    const currentTime = Date.now() / 1e3;
    for (const key of keys) {
      const usage = keyUsageMap.get(key);
      if (usage && currentTime >= usage.cooldown_until) {
        return key;
      }
    }
    return null;
  }
  // --- 【【【 新增：辅助函数 (API 请求) 】】】 ---
  /**
   * 实际执行 OpenAI API 请求
   */
  async _makeOpenAIRequest(key, prompt, modelName) {
    const response = await (0, import_obsidian3.requestUrl)({
      url: `${this.settings.openai_base_url}/chat/completions`,
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${key}`
      },
      body: JSON.stringify({
        model: modelName,
        // 使用传入的 modelName
        messages: [{ role: "user", content: prompt }],
        temperature: this.settings.generation_temperature,
        max_tokens: this.settings.generation_max_tokens
      })
    });
    return response.json.choices[0].message.content.trim();
  }
  /**
   * 实际执行 Google Gemini API 请求
   */
  async _makeGoogleAPIRequest(key, prompt, modelName) {
    const url = `https://generativelanguage.googleapis.com/v1beta/models/${modelName}:generateContent?key=${key}`;
    const response = await (0, import_obsidian3.requestUrl)({
      url,
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        contents: [{ parts: [{ text: prompt }] }],
        generationConfig: {
          temperature: this.settings.generation_temperature,
          maxOutputTokens: this.settings.generation_max_tokens
        }
      })
    });
    const data = response.json;
    if (!data.candidates || data.candidates.length === 0) {
      throw new Error("API response is missing candidates. Full response: " + JSON.stringify(data));
    }
    return data.candidates[0].content.parts[0].text.trim();
  }
  // --- 【【【 新增：辅助函数 (错误处理) 】】】 ---
  /**
   * 检查是否是额度/权限类错误 (已应用 429 健壮性修复)
   */
  _isQuotaError(error) {
    var _a;
    const httpStatus = error.status;
    const errorMessage = ((_a = error.message) == null ? void 0 : _a.toLowerCase()) || "";
    if (httpStatus === 401 || httpStatus === 403 || httpStatus === 429) {
      return true;
    }
    if (errorMessage.includes("insufficient_quota") || errorMessage.includes("rate limit") || errorMessage.includes("quota") || errorMessage.includes("permission") || errorMessage.includes("429")) {
      return true;
    }
    return false;
  }
  /**
   * 冷却一个 Key
   */
  _cooldownKey(key, provider) {
    const keyUsageMap = provider === "openai" ? this.keyUsageOpenAI : this.keyUsageGoogle;
    const keyUsage = keyUsageMap.get(key);
    if (keyUsage) {
      console.warn(`Key ...${key.slice(-4)} (${provider}) failed due to quota/auth error. Applying cooldown.`);
      keyUsage.cooldown_until = Date.now() / 1e3 + this.settings.failover_cooldown_seconds;
    }
  }
  /**
   * 重置一个 Key 的冷却 (调用成功时)
   */
  _resetCooldown(key, provider) {
    const keyUsageMap = provider === "openai" ? this.keyUsageOpenAI : this.keyUsageGoogle;
    const keyUsage = keyUsageMap.get(key);
    if (keyUsage)
      keyUsage.cooldown_until = 0;
    this.hasNotifiedFailover = false;
  }
  // --- 【【【 已重构：_callOpenAI (应用 404 修复) 】】】 ---
  async _callOpenAI(key, prompt) {
    const primaryModel = this.settings.openai_model;
    const backupModel = this.settings.openai_backup_model;
    try {
      const result = await this._makeOpenAIRequest(key, prompt, primaryModel);
      this._resetCooldown(key, "openai");
      return result;
    } catch (primaryError) {
      console.warn(`OpenAI primary model '${primaryModel}' failed for key ...${key.slice(-4)}:`, primaryError.message);
      if (backupModel) {
        try {
          const backupResult = await this._makeOpenAIRequest(key, prompt, backupModel);
          this._resetCooldown(key, "openai");
          return backupResult;
        } catch (backupError) {
          console.error(`OpenAI backup model '${backupModel}' also failed for key ...${key.slice(-4)}:`, backupError.message);
          if (this._isQuotaError(primaryError) || this._isQuotaError(backupError)) {
            this._cooldownKey(key, "openai");
          }
          throw new ApiKeyExhaustedError(`OpenAI key failed (both primary and backup models).`);
        }
      }
      if (this._isQuotaError(primaryError)) {
        this._cooldownKey(key, "openai");
      }
      throw new ApiKeyExhaustedError(`OpenAI key failed (primary model failed, no backup): ${primaryError.message}`);
    }
  }
  // --- 【【【 已重构：_callGoogleAPI (应用 404 修复) 】】】 ---
  async _callGoogleAPI(key, prompt) {
    const primaryModel = this.settings.google_model;
    const backupModel = this.settings.google_backup_model;
    try {
      const result = await this._makeGoogleAPIRequest(key, prompt, primaryModel);
      this._resetCooldown(key, "google");
      return result;
    } catch (primaryError) {
      console.warn(`Google primary model '${primaryModel}' failed for key ...${key.slice(-4)}:`, primaryError.message);
      if (backupModel) {
        try {
          const backupResult = await this._makeGoogleAPIRequest(key, prompt, backupModel);
          this._resetCooldown(key, "google");
          return backupResult;
        } catch (backupError) {
          console.error(`Google backup model '${backupModel}' also failed for key ...${key.slice(-4)}:`, backupError.message);
          if (this._isQuotaError(primaryError) || this._isQuotaError(backupError)) {
            this._cooldownKey(key, "google");
          }
          throw new ApiKeyExhaustedError(`Google key failed (both primary and backup models).`);
        }
      }
      if (this._isQuotaError(primaryError)) {
        this._cooldownKey(key, "google");
      }
      throw new ApiKeyExhaustedError(`Google key failed (primary model failed, no backup): ${primaryError.message}`);
    }
  }
  // --- 【【【 call 方法已重构：修复“刷屏”BUG 】】】 ---
  async call(prompt) {
    this.updateKeys();
    let lastError = null;
    let openAIKeysAttempted = false;
    const openAIEnabled = this.openai_keys.length > 0 && !!(this.settings.openai_model || this.settings.openai_backup_model);
    const googleEnabled = this.google_keys.length > 0 && !!(this.settings.google_model || this.settings.google_backup_model);
    if (openAIEnabled) {
      openAIKeysAttempted = true;
      for (let i = 0; i < this.openai_keys.length; i++) {
        const key = this._selectKey(this.openai_keys, "openai");
        if (key) {
          try {
            console.log(`Trying OpenAI key ...${key.slice(-4)}`);
            return await this._callOpenAI(key, prompt);
          } catch (e) {
            lastError = e;
            new import_obsidian3.Notice(`OpenAI key ...${key.slice(-4)} failed. Trying next.`);
          }
        }
      }
    } else if (this.openai_keys.length > 0) {
      openAIKeysAttempted = true;
      lastError = new Error("OpenAI: \u63D0\u4F9B\u4E86 Key \u4F46\u672A\u6307\u5B9A\u6A21\u578B\u3002");
      console.warn(lastError.message);
    }
    if (googleEnabled) {
      if (openAIKeysAttempted && !this.hasNotifiedFailover) {
        new import_obsidian3.Notice("All OpenAI keys failed or unavailable. Switching to Google Gemini...");
        this.hasNotifiedFailover = true;
      }
      for (let i = 0; i < this.google_keys.length; i++) {
        const key = this._selectKey(this.google_keys, "google");
        if (key) {
          try {
            console.log(`Trying Google Gemini key ...${key.slice(-4)}`);
            return await this._callGoogleAPI(key, prompt);
          } catch (e) {
            lastError = e;
            new import_obsidian3.Notice(`Google Gemini key ...${key.slice(-4)} failed. Trying next.`);
          }
        }
      }
    } else if (this.google_keys.length > 0) {
      lastError = lastError || new Error("Google: \u63D0\u4F9B\u4E86 Key \u4F46\u672A\u6307\u5B9A\u6A21\u578B\u3002");
      console.warn(lastError.message);
    }
    if (!openAIEnabled && !googleEnabled && (this.openai_keys.length > 0 || this.google_keys.length > 0)) {
      new import_obsidian3.Notice("\u8BF7\u5728\u8BBE\u7F6E\u4E2D\u63D0\u4F9BAPI Key\u548C\u81F3\u5C11\u4E00\u4E2A\u6A21\u578B\u540D\u79F0\u3002");
      throw new AllModelsFailedError("\u63D0\u4F9B\u4E86 Key \u4F46\u672A\u6307\u5B9A\u6A21\u578B\u3002");
    }
    throw new AllModelsFailedError(`All API providers failed. Last error: ${lastError == null ? void 0 : lastError.message}`);
  }
};

// critic.ts
var Critic = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.apiHandler = new APIHandler(plugin);
  }
  async judge(content) {
    if (this.plugin.settings.critic_mode === "ai") {
      return this._judgeByAI(content);
    }
    return this._judgeByHeuristic(content);
  }
  _judgeByHeuristic(content) {
    const reasons = [];
    const contentLower = content.toLowerCase();
    const requiredHeaders = this.plugin.settings.critic_required_headers.split("\n").map((h) => h.trim().toLowerCase()).filter(Boolean);
    const missingHeaders = requiredHeaders.filter((h) => !contentLower.includes(h));
    if (missingHeaders.length > 0) {
      reasons.push(`\u7F3A\u5C11\u5FC5\u9700\u7684\u6807\u9898: ${missingHeaders.join(", ")}`);
    }
    if (content.length < this.plugin.settings.critic_min_content_length) {
      reasons.push(`\u5185\u5BB9\u8FC7\u77ED (\u5F53\u524D: ${content.length}, \u8981\u6C42: ${this.plugin.settings.critic_min_content_length})`);
    }
    const refusalPatterns = ["\u4F5C\u4E3A\u4E00?\u4E2AAI", "\u4F5C\u4E3A\u8BED\u8A00\u6A21\u578B", "\u6211\u4E0D\u80FD", "\u6211\u65E0\u6CD5", "\u5F88\u62B1\u6B49"];
    for (const pattern of refusalPatterns) {
      if (new RegExp(pattern, "i").test(content)) {
        reasons.push(`\u5305\u542BAI\u62D2\u7EDD\u8BED (\u5339\u914D: '${pattern}')`);
        break;
      }
    }
    return {
      isApproved: reasons.length === 0,
      reason: reasons.length > 0 ? reasons.join("; ") : "\u901A\u8FC7\u6240\u6709\u542F\u53D1\u5F0F\u89C4\u5219\u68C0\u67E5\u3002"
    };
  }
  async _judgeByAI(content) {
    const prompt = this.plugin.settings.prompt_critic.replace("{content}", content);
    try {
      const response = await this.apiHandler.call(prompt);
      const decisionMatch = response.match(/DECISION:\s*(KEEP|DISCARD)/i);
      const reasonMatch = response.match(/\[REASON:\s*([^\]]+)\]/i);
      const isApproved = decisionMatch ? decisionMatch[1].toUpperCase() === "KEEP" : false;
      const reason = reasonMatch ? reasonMatch[1].trim() : isApproved ? "AI \u6279\u51C6" : "AI \u62D2\u7EDD\uFF0C\u672A\u63D0\u4F9B\u660E\u786E\u7406\u7531";
      return { isApproved, reason };
    } catch (error) {
      console.error("AI Critic call failed:", error);
      return { isApproved: false, reason: `AI \u5BA1\u6838\u5668\u8C03\u7528\u5931\u8D25: ${error.message}` };
    }
  }
};

// reviser.ts
var Reviser = class {
  constructor(plugin) {
    this.plugin = plugin;
  }
  createRevisionPrompt(idea, originalContent, rejectionReason) {
    let prompt = this.plugin.settings.prompt_reviser;
    prompt = prompt.replace("{concept}", idea);
    prompt = prompt.replace("{original_content}", originalContent);
    prompt = prompt.replace("{rejection_reason}", rejectionReason);
    return prompt;
  }
};

// utils.ts
function sanitizeFilename(name) {
  let cleanName = name.replace(/\s*\(.*\)/g, "").trim();
  cleanName = cleanName.replace(/[\\/*?:"<>|]/g, "");
  return cleanName.slice(0, 100);
}
function extractNewIdeas(content) {
  const matches = content.match(/\[\[([^\]]+)\]\]/g);
  if (!matches) {
    return [];
  }
  const ideas = matches.map((match) => {
    return match.slice(2, -2).split("|")[0].trim();
  });
  return [...new Set(ideas)];
}
function cleanMarkdownOutput(content) {
  const trimmed = content.trim();
  if (trimmed.startsWith("```markdown") && trimmed.endsWith("```")) {
    let cleaned = trimmed.substring("```markdown".length, trimmed.length - "```".length);
    return cleaned.trim();
  }
  return trimmed;
}

// engine.ts
var Engine = class {
  constructor(plugin) {
    this.isRunning = false;
    this.timerId = null;
    this.plugin = plugin;
    this.app = plugin.app;
    this.apiHandler = new APIHandler(plugin);
    this.critic = new Critic(plugin);
    this.reviser = new Reviser(plugin);
  }
  // --- Public Controls ---
  /**
   * 切换引擎的运行/暂停状态
   */
  toggleEngineState() {
    if (this.isRunning) {
      this.stop();
    } else {
      this.start();
    }
  }
  /**
   * 添加单个概念到队列，并显示通知
   * @returns {boolean} 是否成功添加
   */
  addConceptToQueue(concept) {
    const added = this.addConceptsToQueue([concept]);
    if (added > 0) {
      new import_obsidian4.Notice(`'${concept}' \u5DF2\u6DFB\u52A0\u5230\u751F\u6210\u961F\u5217\u3002`);
      this.updateStatusBar();
      return true;
    }
    new import_obsidian4.Notice(`'${concept}' \u5DF2\u5B58\u5728\u4E8E\u961F\u5217\u6216\u4ED3\u5E93\u4E2D\uFF0C\u672A\u6DFB\u52A0\u3002`);
    return false;
  }
  /**
   * 添加多个概念到生成队列，会进行去重和检查文件是否存在
   * @param {string[]} concepts - 要添加的概念列表
   * @returns {number} 实际添加的新概念数量
   */
  addConceptsToQueue(concepts) {
    const currentQueue = new Set(this.plugin.data.generationQueue);
    const existingFiles = new Set(this.app.vault.getMarkdownFiles().map((f) => f.basename));
    let addedCount = 0;
    for (const concept of concepts) {
      const sanitized = sanitizeFilename(concept);
      if (!currentQueue.has(concept) && !existingFiles.has(sanitized)) {
        this.plugin.data.generationQueue.push(concept);
        currentQueue.add(concept);
        addedCount++;
      }
    }
    if (addedCount > 0) {
      this.plugin.savePluginData();
      this.updateStatusBar();
    }
    return addedCount;
  }
  // --- Core Loop ---
  /**
   * 启动引擎
   */
  async start() {
    if (this.isRunning)
      return;
    this.isRunning = true;
    this.plugin.data.status = "running";
    new import_obsidian4.Notice("\u77E5\u8BC6\u56FE\u8C31\u5F15\u64CE\u5DF2\u542F\u52A8\uFF01");
    this.updateStatusBar();
    this.tick();
  }
  /**
   * 停止引擎
   */
  stop() {
    if (!this.isRunning)
      return;
    this.isRunning = false;
    this.plugin.data.status = "paused";
    if (this.timerId) {
      clearTimeout(this.timerId);
      this.timerId = null;
    }
    new import_obsidian4.Notice("\u77E5\u8BC6\u56FE\u8C31\u5F15\u64CE\u5DF2\u6682\u505C\u3002");
    this.updateStatusBar();
    this.plugin.savePluginData();
  }
  /**
   * 安排下一个 tick
   */
  scheduleNextTick() {
    if (!this.isRunning)
      return;
    const delay = this.plugin.settings.request_delay * 1e3;
    this.timerId = setTimeout(() => this.tick(), delay);
  }
  /**
   * 引擎的核心“心跳”
   * 它会按优先级（修正 > 审核 > 生成）处理一个批次的任务
   */
  async tick() {
    if (!this.isRunning)
      return;
    try {
      let taskProcessed = false;
      if (this.plugin.data.revisionQueue.length > 0) {
        taskProcessed = await this.runRevisionPhase();
      } else if (this.plugin.data.reviewQueue.length > 0) {
        taskProcessed = await this.runCriticPhase();
      } else if (this.plugin.data.generationQueue.length > 0) {
        taskProcessed = await this.runGenerationPhase();
      }
      if (!taskProcessed && this.plugin.data.generationQueue.length === 0 && this.plugin.data.reviewQueue.length === 0 && this.plugin.data.revisionQueue.length === 0) {
        new import_obsidian4.Notice("\u{1F389} \u6240\u6709\u4EFB\u52A1\u5B8C\u6210\uFF01\u5F15\u64CE\u5DF2\u505C\u6B62\u3002");
        this.isRunning = false;
        this.plugin.data.status = "idle";
        this.updateStatusBar();
        await this.plugin.savePluginData();
        return;
      }
    } catch (error) {
      console.error("\u5F15\u64CE Tick \u53D1\u751F\u4E25\u91CD\u9519\u8BEF:", error);
      new import_obsidian4.Notice("\u5F15\u64CE\u9047\u5230\u9519\u8BEF\uFF0C\u5DF2\u6682\u505C\u3002\u8BF7\u68C0\u67E5\u63A7\u5236\u53F0\u3002");
      this.stop();
      return;
    }
    this.scheduleNextTick();
  }
  // --- Phases ---
  /**
   * 运行“生成”阶段
   * @returns {Promise<boolean>} 是否处理了任务
   */
  async runGenerationPhase() {
    const queue = this.plugin.data.generationQueue;
    if (queue.length === 0)
      return false;
    const batchSize = this.plugin.settings.generation_batch_size;
    const batch = queue.splice(0, Math.min(queue.length, batchSize));
    this.updateStatusBar();
    await this.plugin.savePluginData();
    const tasks = batch.map((idea) => this.generationTask(idea));
    await Promise.allSettled(tasks);
    await this.plugin.savePluginData();
    return true;
  }
  /**
   * 单个生成任务
   */
  async generationTask(idea) {
    const prompt = this.plugin.settings.prompt_generator.replace("{concept}", idea);
    try {
      const content = await this.apiHandler.call(prompt);
      const cleanedContent = cleanMarkdownOutput(content);
      this.plugin.data.reviewQueue.push({ idea, content: cleanedContent });
      console.log(`\u2705 [\u751F\u6210\u6210\u529F]: ${idea}`);
    } catch (e) {
      if (e instanceof AllModelsFailedError) {
        console.error(`\u274C [\u751F\u6210\u5931\u8D25]: ${idea} - ${e.message}`);
        this.plugin.data.generationQueue.unshift(idea);
      }
    }
  }
  /**
   * 运行“审核”阶段
   * @returns {Promise<boolean>} 是否处理了任务
   */
  async runCriticPhase() {
    const queue = this.plugin.data.reviewQueue;
    if (queue.length === 0)
      return false;
    const batchSize = this.plugin.settings.generation_batch_size;
    const tasksToReview = queue.splice(0, Math.min(queue.length, batchSize));
    this.updateStatusBar();
    await this.plugin.savePluginData();
    let newIdeasFound = /* @__PURE__ */ new Set();
    for (const task of tasksToReview) {
      const { isApproved, reason } = await this.critic.judge(task.content);
      if (isApproved) {
        await this.saveNote(task.idea, task.content);
        if (this.plugin.settings.extract_new_concepts) {
          const ideas = extractNewIdeas(task.content);
          ideas.forEach((idea) => newIdeasFound.add(idea));
        }
        console.log(`\u{1F44D} [\u5BA1\u6838\u901A\u8FC7]: ${task.idea}`);
      } else {
        task.reason = reason;
        task.retries = (task.retries || 0) + 1;
        this.plugin.data.revisionQueue.push(task);
        console.warn(`\u{1F44E} [\u5BA1\u6838\u62D2\u7EDD]: ${task.idea} - ${reason}`);
      }
    }
    if (newIdeasFound.size > 0) {
      this.addConceptsToQueue(Array.from(newIdeasFound));
    }
    await this.plugin.savePluginData();
    return true;
  }
  /**
   * 运行“修正”阶段
   * @returns {Promise<boolean>} 是否处理了任务
   */
  async runRevisionPhase() {
    const queue = this.plugin.data.revisionQueue;
    if (queue.length === 0)
      return false;
    const batchSize = this.plugin.settings.generation_batch_size;
    const tasksToRevise = queue.splice(0, Math.min(queue.length, batchSize));
    this.updateStatusBar();
    await this.plugin.savePluginData();
    for (const task of tasksToRevise) {
      if ((task.retries || 0) >= this.plugin.settings.max_revision_retries) {
        this.plugin.data.discardedPile.push(task);
        console.error(`\u{1F480} [\u653E\u5F03\u4FEE\u6B63]: ${task.idea} \u5DF2\u8FBE\u6700\u5927\u91CD\u8BD5\u6B21\u6570\u3002`);
        continue;
      }
      await this.revisionTask(task);
    }
    await this.plugin.savePluginData();
    return true;
  }
  /**
   * 单个修正任务
   */
  async revisionTask(task) {
    const prompt = this.reviser.createRevisionPrompt(task.idea, task.content, task.reason || "\u672A\u77E5\u539F\u56E0");
    try {
      const newContent = await this.apiHandler.call(prompt);
      const cleanedContent = cleanMarkdownOutput(newContent);
      const revisedTask = { ...task, content: cleanedContent };
      this.plugin.data.reviewQueue.push(revisedTask);
      console.log(`\u{1F504} [\u4FEE\u6B63\u5B8C\u6210]: ${task.idea}`);
    } catch (e) {
      console.error(`\u274C [\u4FEE\u6B63\u5931\u8D25]: ${task.idea} - ${e.message}`);
      this.plugin.data.revisionQueue.unshift(task);
    }
  }
  // --- File & UI ---
  /**
   * 保存笔记到文件系统
   */
  async saveNote(idea, content) {
    const filename = sanitizeFilename(idea);
    const folderPath = this.plugin.settings.output_dir;
    if (!(this.app.vault.getAbstractFileByPath(folderPath) instanceof import_obsidian4.TFolder)) {
      try {
        await this.app.vault.createFolder(folderPath);
      } catch (error) {
        console.error(`\u521B\u5EFA\u6587\u4EF6\u5939\u5931\u8D25: ${folderPath}`, error);
        new import_obsidian4.Notice(`\u65E0\u6CD5\u521B\u5EFA\u8F93\u51FA\u6587\u4EF6\u5939: ${folderPath}`);
        return;
      }
    }
    const filePath = (0, import_obsidian4.normalizePath)(`${folderPath}/${filename}.md`);
    const file = this.app.vault.getAbstractFileByPath(filePath);
    try {
      if (file instanceof import_obsidian4.TFile) {
        await this.app.vault.modify(file, content);
        new import_obsidian4.Notice(`\u7B14\u8BB0\u5DF2\u66F4\u65B0: ${filename}`);
      } else {
        await this.app.vault.create(filePath, content);
        new import_obsidian4.Notice(`\u7B14\u8BB0\u5DF2\u521B\u5EFA: ${filename}`);
      }
    } catch (error) {
      console.error(`\u4FDD\u5B58\u7B14\u8BB0\u5931\u8D25: ${filePath}`, error);
      new import_obsidian4.Notice(`\u65E0\u6CD5\u4FDD\u5B58\u7B14\u8BB0: ${filename}`);
    }
  }
  /**
   * 更新状态栏显示
   */
  updateStatusBar() {
    if (!this.plugin.statusBarEl)
      return;
    const { generationQueue, reviewQueue, revisionQueue } = this.plugin.data;
    const total = generationQueue.length + reviewQueue.length + revisionQueue.length;
    this.plugin.statusBarEl.setText(
      `KG: ${this.plugin.data.status} | G:${generationQueue.length} | C:${reviewQueue.length} | R:${revisionQueue.length} | Total:${total}`
    );
    this.app.workspace.trigger("kg-data-updated");
  }
};

// main.ts
var DEFAULT_PLUGIN_DATA = {
  status: "idle",
  generationQueue: [],
  reviewQueue: [],
  revisionQueue: [],
  discardedPile: []
};
var KnowledgeGraphPlugin = class extends import_obsidian5.Plugin {
  async onload() {
    await this.loadSettings();
    await this.loadPluginData();
    this.engine = new Engine(this);
    const ribbonIconEl = this.addRibbonIcon("brain-circuit", "\u77E5\u8BC6\u56FE\u8C31\u751F\u6210\u5668", (evt) => {
      this.engine.toggleEngineState();
    });
    ribbonIconEl.addClass("knowledge-graph-plugin-ribbon-class");
    this.statusBarEl = this.addStatusBarItem();
    this.engine.updateStatusBar();
    this.addSettingTab(new KGsSettingTab(this.app, this));
    this.addCommand({
      id: "toggle-knowledge-graph-engine",
      name: "\u542F\u52A8/\u6682\u505C \u77E5\u8BC6\u56FE\u8C31\u751F\u6210",
      callback: () => {
        this.engine.toggleEngineState();
      }
    });
    this.addCommand({
      id: "add-current-note-to-queue",
      name: "\u5C06\u5F53\u524D\u7B14\u8BB0\u6807\u9898\u6DFB\u52A0\u5230\u751F\u6210\u961F\u5217",
      checkCallback: (checking) => {
        const file = this.app.workspace.getActiveFile();
        if (file) {
          if (!checking) {
            this.engine.addConceptToQueue(file.basename);
          }
          return true;
        }
        return false;
      }
    });
    console.log("\u77E5\u8BC6\u56FE\u8C31\u63D2\u4EF6\u5DF2\u52A0\u8F7D\uFF01");
  }
  onunload() {
    console.log("\u77E5\u8BC6\u56FE\u8C31\u63D2\u4EF6\u5DF2\u5378\u8F7D\u3002");
  }
  /**
   * 加载插件的配置。
   * 它会合并默认设置、默认提示和用户保存的设置。
   * 这个方法需要兼容旧版本的数据结构。
   */
  async loadSettings() {
    const defaultPrompts = await getDefaultPrompts();
    const savedData = await this.loadData();
    const savedSettings = savedData || {};
    this.settings = Object.assign({}, DEFAULT_SETTINGS, defaultPrompts, savedSettings);
  }
  /**
   * 保存插件的配置和状态。
   * 这是唯一一个直接写入文件的方法，它将所有数据打包在一起。
   */
  async saveSettings() {
    const dataToSave = { ...this.settings, pluginState: this.data };
    await this.saveData(dataToSave);
  }
  /**
   * 加载插件的运行时状态。
   * 它会从保存的数据中提取 pluginState 部分。
   */
  async loadPluginData() {
    const savedData = await this.loadData();
    const savedState = (savedData == null ? void 0 : savedData.pluginState) || {};
    this.data = Object.assign({}, DEFAULT_PLUGIN_DATA, savedState);
  }
  /**
   * 保存插件的运行时状态。
   * 这个方法只是一个方便的别名，它实际上调用 saveSettings。
   * 这保证了状态和配置总是在一起被原子性地保存。
   */
  async savePluginData() {
    await this.saveSettings();
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzZXR0aW5ncy50cyIsICJlbmdpbmUudHMiLCAiYXBpSGFuZGxlci50cyIsICJjcml0aWMudHMiLCAicmV2aXNlci50cyIsICJ1dGlscy50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBQbHVnaW4sIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcsIE5vdGljZSwgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBLbm93bGVkZ2VHcmFwaFBsdWdpblNldHRpbmdzLCBQbHVnaW5EYXRhIH0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQgeyBLR3NTZXR0aW5nVGFiLCBERUZBVUxUX1NFVFRJTkdTLCBnZXREZWZhdWx0UHJvbXB0cyB9IGZyb20gJy4vc2V0dGluZ3MnO1xuaW1wb3J0IHsgRW5naW5lIH0gZnJvbSAnLi9lbmdpbmUnO1xuXG5jb25zdCBERUZBVUxUX1BMVUdJTl9EQVRBOiBQbHVnaW5EYXRhID0ge1xuICAgIHN0YXR1czogJ2lkbGUnLFxuICAgIGdlbmVyYXRpb25RdWV1ZTogW10sXG4gICAgcmV2aWV3UXVldWU6IFtdLFxuICAgIHJldmlzaW9uUXVldWU6IFtdLFxuICAgIGRpc2NhcmRlZFBpbGU6IFtdLFxufTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgS25vd2xlZGdlR3JhcGhQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuICAgIHNldHRpbmdzOiBLbm93bGVkZ2VHcmFwaFBsdWdpblNldHRpbmdzO1xuICAgIGRhdGE6IFBsdWdpbkRhdGE7XG4gICAgZW5naW5lOiBFbmdpbmU7XG4gICAgc3RhdHVzQmFyRWw6IEhUTUxFbGVtZW50O1xuXG4gICAgYXN5bmMgb25sb2FkKCkge1xuICAgICAgICAvLyAxLiBcdTk5OTZcdTUxNDhcdTUyQTBcdThGN0RcdThCQkVcdTdGNkUgKHNldHRpbmdzKVxuICAgICAgICBhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuXG4gICAgICAgIC8vIDIuIFx1NzEzNlx1NTQwRVx1NTJBMFx1OEY3RFx1NjNEMlx1NEVGNlx1NzJCNlx1NjAwMVxuICAgICAgICBhd2FpdCB0aGlzLmxvYWRQbHVnaW5EYXRhKCk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLmVuZ2luZSA9IG5ldyBFbmdpbmUodGhpcyk7XG5cbiAgICAgICAgLy8gXHU3RjBFXHU1RTI2XHU1NkZFXHU2ODA3XG4gICAgICAgIGNvbnN0IHJpYmJvbkljb25FbCA9IHRoaXMuYWRkUmliYm9uSWNvbignYnJhaW4tY2lyY3VpdCcsICdcdTc3RTVcdThCQzZcdTU2RkVcdThDMzFcdTc1MUZcdTYyMTBcdTU2NjgnLCAoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICAgICAgICB0aGlzLmVuZ2luZS50b2dnbGVFbmdpbmVTdGF0ZSgpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmliYm9uSWNvbkVsLmFkZENsYXNzKCdrbm93bGVkZ2UtZ3JhcGgtcGx1Z2luLXJpYmJvbi1jbGFzcycpO1xuXG4gICAgICAgIC8vIFx1NzJCNlx1NjAwMVx1NjgwRlxuICAgICAgICB0aGlzLnN0YXR1c0JhckVsID0gdGhpcy5hZGRTdGF0dXNCYXJJdGVtKCk7XG4gICAgICAgIHRoaXMuZW5naW5lLnVwZGF0ZVN0YXR1c0JhcigpO1xuXG4gICAgICAgIC8vIFx1OEJCRVx1N0Y2RVx1OTAwOVx1OTg3OVx1NTM2MVxuICAgICAgICB0aGlzLmFkZFNldHRpbmdUYWIobmV3IEtHc1NldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcblxuICAgICAgICAvLyBcdTU0N0RcdTRFRTRcbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAndG9nZ2xlLWtub3dsZWRnZS1ncmFwaC1lbmdpbmUnLFxuICAgICAgICAgICAgbmFtZTogJ1x1NTQyRlx1NTJBOC9cdTY2ODJcdTUwNUMgXHU3N0U1XHU4QkM2XHU1NkZFXHU4QzMxXHU3NTFGXHU2MjEwJyxcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5lbmdpbmUudG9nZ2xlRW5naW5lU3RhdGUoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogJ2FkZC1jdXJyZW50LW5vdGUtdG8tcXVldWUnLFxuICAgICAgICAgICAgbmFtZTogJ1x1NUMwNlx1NUY1M1x1NTI0RFx1N0IxNFx1OEJCMFx1NjgwN1x1OTg5OFx1NkRGQlx1NTJBMFx1NTIzMFx1NzUxRlx1NjIxMFx1OTYxRlx1NTIxNycsXG4gICAgICAgICAgICBjaGVja0NhbGxiYWNrOiAoY2hlY2tpbmc6IGJvb2xlYW4pID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgICAgICAgICBpZiAoZmlsZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWNoZWNraW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVuZ2luZS5hZGRDb25jZXB0VG9RdWV1ZShmaWxlLmJhc2VuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc29sZS5sb2coJ1x1NzdFNVx1OEJDNlx1NTZGRVx1OEMzMVx1NjNEMlx1NEVGNlx1NURGMlx1NTJBMFx1OEY3RFx1RkYwMScpO1xuICAgIH1cblxuICAgIG9udW5sb2FkKCkge1xuICAgICAgICBjb25zb2xlLmxvZygnXHU3N0U1XHU4QkM2XHU1NkZFXHU4QzMxXHU2M0QyXHU0RUY2XHU1REYyXHU1Mzc4XHU4RjdEXHUzMDAyJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogXHU1MkEwXHU4RjdEXHU2M0QyXHU0RUY2XHU3Njg0XHU5MTREXHU3RjZFXHUzMDAyXG4gICAgICogXHU1QjgzXHU0RjFBXHU1NDA4XHU1RTc2XHU5RUQ4XHU4QkE0XHU4QkJFXHU3RjZFXHUzMDAxXHU5RUQ4XHU4QkE0XHU2M0QwXHU3OTNBXHU1NDhDXHU3NTI4XHU2MjM3XHU0RkREXHU1QjU4XHU3Njg0XHU4QkJFXHU3RjZFXHUzMDAyXG4gICAgICogXHU4RkQ5XHU0RTJBXHU2NUI5XHU2Q0Q1XHU5NzAwXHU4OTgxXHU1MTdDXHU1QkI5XHU2NUU3XHU3MjQ4XHU2NzJDXHU3Njg0XHU2NTcwXHU2MzZFXHU3RUQzXHU2Nzg0XHUzMDAyXG4gICAgICovXG4gICAgYXN5bmMgbG9hZFNldHRpbmdzKCkge1xuICAgICAgICBjb25zdCBkZWZhdWx0UHJvbXB0cyA9IGF3YWl0IGdldERlZmF1bHRQcm9tcHRzKCk7XG4gICAgICAgIC8vIGxvYWREYXRhKCkgXHU0RjFBXHU4QkZCXHU1M0Q2XHU2NTc0XHU0RTJBIGRhdGEuanNvbiBcdTY1ODdcdTRFRjZcbiAgICAgICAgY29uc3Qgc2F2ZWREYXRhID0gYXdhaXQgdGhpcy5sb2FkRGF0YSgpO1xuICAgICAgICAvLyBcdTRFQ0VcdTRGRERcdTVCNThcdTc2ODRcdTY1NzBcdTYzNkVcdTRFMkRcdTYzRDBcdTUzRDZcdThCQkVcdTdGNkVcdTkwRThcdTUyMDZcbiAgICAgICAgY29uc3Qgc2F2ZWRTZXR0aW5ncyA9IHNhdmVkRGF0YSB8fCB7fTtcbiAgICAgICAgXG4gICAgICAgIC8vIFx1NTQwOFx1NUU3Nlx1NjI0MFx1NjcwOVx1OEJCRVx1N0Y2RVx1RkYwQ1x1Nzg2RVx1NEZERFx1NjI0MFx1NjcwOVx1OTE0RFx1N0Y2RVx1OTg3OVx1OTBGRFx1NjcwOVx1NTAzQ1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgZGVmYXVsdFByb21wdHMsIHNhdmVkU2V0dGluZ3MpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFx1NEZERFx1NUI1OFx1NjNEMlx1NEVGNlx1NzY4NFx1OTE0RFx1N0Y2RVx1NTQ4Q1x1NzJCNlx1NjAwMVx1MzAwMlxuICAgICAqIFx1OEZEOVx1NjYyRlx1NTUyRlx1NEUwMFx1NEUwMFx1NEUyQVx1NzZGNFx1NjNBNVx1NTE5OVx1NTE2NVx1NjU4N1x1NEVGNlx1NzY4NFx1NjVCOVx1NkNENVx1RkYwQ1x1NUI4M1x1NUMwNlx1NjI0MFx1NjcwOVx1NjU3MFx1NjM2RVx1NjI1M1x1NTMwNVx1NTcyOFx1NEUwMFx1OEQ3N1x1MzAwMlxuICAgICAqL1xuICAgIGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcbiAgICAgICAgY29uc3QgZGF0YVRvU2F2ZSA9IHsgLi4udGhpcy5zZXR0aW5ncywgcGx1Z2luU3RhdGU6IHRoaXMuZGF0YSB9O1xuICAgICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKGRhdGFUb1NhdmUpO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBcdTUyQTBcdThGN0RcdTYzRDJcdTRFRjZcdTc2ODRcdThGRDBcdTg4NENcdTY1RjZcdTcyQjZcdTYwMDFcdTMwMDJcbiAgICAgKiBcdTVCODNcdTRGMUFcdTRFQ0VcdTRGRERcdTVCNThcdTc2ODRcdTY1NzBcdTYzNkVcdTRFMkRcdTYzRDBcdTUzRDYgcGx1Z2luU3RhdGUgXHU5MEU4XHU1MjA2XHUzMDAyXG4gICAgICovXG4gICAgYXN5bmMgbG9hZFBsdWdpbkRhdGEoKSB7XG4gICAgICAgIC8vIGxvYWREYXRhKCkgXHU0RjFBXHU4QkZCXHU1M0Q2XHU2NTc0XHU0RTJBIGRhdGEuanNvbiBcdTY1ODdcdTRFRjZcbiAgICAgICAgY29uc3Qgc2F2ZWREYXRhID0gYXdhaXQgdGhpcy5sb2FkRGF0YSgpO1xuICAgICAgICAvLyBcdTRFQ0VcdTRGRERcdTVCNThcdTc2ODRcdTY1NzBcdTYzNkVcdTRFMkRcdTYzRDBcdTUzRDZcdTcyQjZcdTYwMDFcdTkwRThcdTUyMDZcbiAgICAgICAgY29uc3Qgc2F2ZWRTdGF0ZSA9IHNhdmVkRGF0YT8ucGx1Z2luU3RhdGUgfHwge307XG4gICAgICAgIFxuICAgICAgICAvLyBcdTU0MDhcdTVFNzZcdTlFRDhcdThCQTRcdTcyQjZcdTYwMDFcdTU0OENcdTc1MjhcdTYyMzdcdTRGRERcdTVCNThcdTc2ODRcdTcyQjZcdTYwMDFcbiAgICAgICAgdGhpcy5kYXRhID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9QTFVHSU5fREFUQSwgc2F2ZWRTdGF0ZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogXHU0RkREXHU1QjU4XHU2M0QyXHU0RUY2XHU3Njg0XHU4RkQwXHU4ODRDXHU2NUY2XHU3MkI2XHU2MDAxXHUzMDAyXG4gICAgICogXHU4RkQ5XHU0RTJBXHU2NUI5XHU2Q0Q1XHU1M0VBXHU2NjJGXHU0RTAwXHU0RTJBXHU2NUI5XHU0RkJGXHU3Njg0XHU1MjJCXHU1NDBEXHVGRjBDXHU1QjgzXHU1QjlFXHU5NjQ1XHU0RTBBXHU4QzAzXHU3NTI4IHNhdmVTZXR0aW5nc1x1MzAwMlxuICAgICAqIFx1OEZEOVx1NEZERFx1OEJDMVx1NEU4Nlx1NzJCNlx1NjAwMVx1NTQ4Q1x1OTE0RFx1N0Y2RVx1NjAzQlx1NjYyRlx1NTcyOFx1NEUwMFx1OEQ3N1x1ODhBQlx1NTM5Rlx1NUI1MFx1NjAyN1x1NTczMFx1NEZERFx1NUI1OFx1MzAwMlxuICAgICAqL1xuICAgIGFzeW5jIHNhdmVQbHVnaW5EYXRhKCkge1xuICAgICAgICBhd2FpdCB0aGlzLnNhdmVTZXR0aW5ncygpO1xuICAgIH1cbn1cbiIsICIvLyBzZXR0aW5ncy50c1xudmFyIGltcG9ydF9vYnNpZGlhbjIgPSByZXF1aXJlKFwib2JzaWRpYW5cIik7XG5cbi8vIFF1ZXVlTW9kYWwudHNcbnZhciBpbXBvcnRfb2JzaWRpYW4gPSByZXF1aXJlKFwib2JzaWRpYW5cIik7XG5cbi8vIChcdThGRDlcdTRFMkEgTW9kYWwgXHU0RTBEXHU5NzAwXHU4OTgxIGV4cG9ydFx1RkYwQ1x1NTZFMFx1NEUzQVx1NUI4M1x1NTNFQVx1NTcyOCBLR3NTZXR0aW5nVGFiIFx1NTE4NVx1OTBFOFx1NEY3Rlx1NzUyOClcbnZhciBRdWV1ZU1hbmFnZW1lbnRNb2RhbCA9IGNsYXNzIGV4dGVuZHMgaW1wb3J0X29ic2lkaWFuLk1vZGFsIHtcbiAgLy8gXHUzMDEwXHUzMDEwXHUzMDEwIFx1NjVCMFx1NTg5RVx1RkYxQVx1NzUyOFx1NEU4RVx1N0VEMVx1NUI5QVx1NzY4NFx1NTIzN1x1NjVCMFx1NTFGRFx1NjU3MCBcdTMwMTFcdTMwMTFcdTMwMTFcbiAgcmVmcmVzaENvbnRlbnQ6ICgpID0+IHZvaWQ7XG5cbiAgY29uc3RydWN0b3IoYXBwLCBwbHVnaW4pIHtcbiAgICBzdXBlcihhcHApO1xuICAgIC8vIFx1NzUyOFx1NEU4RVx1NEZERFx1NUI1OFx1NjQxQ1x1N0QyMlx1OEJDRFxuICAgIHRoaXMuc2VhcmNoVGVybXMgPSB7XG4gICAgICBnZW46IFwiXCIsXG4gICAgICByZXY6IFwiXCIsXG4gICAgICByZXA6IFwiXCIsXG4gICAgICBkaXM6IFwiXCJcbiAgICB9O1xuICAgIC8vIFx1MzAxMFx1MzAxMFx1MzAxMCBcdTVERjJcdTRGRUVcdTY1MzlcdUZGMUFcdTlFRDhcdThCQTRcdTUxNjhcdTkwRThcdTYyOThcdTUzRTAgXHUzMDExXHUzMDExXHUzMDExXG4gICAgdGhpcy5jb2xsYXBzZVN0YXRlcyA9IHtcbiAgICAgIGdlbjogZmFsc2UsXG4gICAgICAvLyBcdTlFRDhcdThCQTRcdTYyOThcdTUzRTBcbiAgICAgIHJldjogZmFsc2UsXG4gICAgICAvLyBcdTlFRDhcdThCQTRcdTYyOThcdTUzRTBcbiAgICAgIHJlcDogZmFsc2UsXG4gICAgICAvLyBcdTlFRDhcdThCQTRcdTYyOThcdTUzRTBcbiAgICAgIGRpczogZmFsc2VcbiAgICAgIC8vIFx1OUVEOFx1OEJBNFx1NjI5OFx1NTNFMFxuICAgIH07XG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgXG4gICAgLy8gXHUzMDEwXHUzMDEwXHUzMDEwIFx1NUI5RVx1NjVGNlx1NTIzN1x1NjVCMFx1NEZFRVx1NjUzOVx1RkYxQVx1NTIxQlx1NUVGQVx1NEUwMFx1NEUyQVx1N0VEMVx1NUI5QVx1NzY4NFx1NTFGRFx1NjU3MFx1NUYxNVx1NzUyOFx1RkYwQ1x1NzUyOFx1NEU4RVx1NTIzN1x1NjVCMCBcdTMwMTFcdTMwMTFcdTMwMTFcbiAgICAvLyBcdTYyMTFcdTRFRUNcdTVDMDZcdTU5MERcdTc1Mjggb25PcGVuKCkgXHU2NzY1XHU1MjM3XHU2NUIwXHVGRjBDXHU1NkUwXHU0RTNBXHU1QjgzXHU0RjFBXHU0RkREXHU3NTU5IHRoaXMuc2VhcmNoVGVybXMgXHU1NDhDIHRoaXMuY29sbGFwc2VTdGF0ZXMgXHU3Njg0XHU3MkI2XHU2MDAxXG4gICAgdGhpcy5yZWZyZXNoQ29udGVudCA9IHRoaXMub25PcGVuLmJpbmQodGhpcyk7XG4gIH1cbiAgXG4gIG9uT3BlbigpIHtcbiAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcblxuICAgIC8vIFx1MzAxMFx1MzAxMFx1MzAxMCBcdTVCOUVcdTY1RjZcdTUyMzdcdTY1QjBcdTRGRUVcdTY1MzlcdUZGMUFcdTRFM0FcdTRFODZcdTVCODlcdTUxNjhcdUZGMENcdTUxNDhcdTZDRThcdTk1MDBcdTY1RTdcdTc2ODRcdTc2RDFcdTU0MkNcdTU2NjggXHUzMDExXHUzMDExXHUzMDExXG4gICAgLy8gXHU5NjMyXHU2QjYyXHU5MUNEXHU1OTBEXHU2MjUzXHU1RjAwXHU2NUY2XHU2Q0U4XHU1MThDXHU1OTFBXHU0RTJBXHU3NkQxXHU1NDJDXHU1NjY4XG4gICAgdGhpcy5hcHAud29ya3NwYWNlLm9mZihcImtnLWRhdGEtdXBkYXRlZFwiLCB0aGlzLnJlZnJlc2hDb250ZW50KTtcbiAgICBcbiAgICBjb250ZW50RWwuZW1wdHkoKTtcbiAgICBjb250ZW50RWwuYWRkQ2xhc3MoXCJrZy1tb2RhbFwiKTtcbiAgICBjb250ZW50RWwuY3JlYXRlRWwoXCJoMlwiLCB7IHRleHQ6IFwiXFx1OTYxRlxcdTUyMTdcXHU3QkExXFx1NzQwNlxcdTRFRUFcXHU4ODY4XFx1NzZEOFwiIH0pO1xuICAgIGNvbnN0IHN0YXR1cyA9IHRoaXMucGx1Z2luLmRhdGEuc3RhdHVzO1xuICAgIGNvbnN0IHN0YXR1c1RleHQgPSBgXFx1NzJCNlxcdTYwMDE6ICR7c3RhdHVzLnRvVXBwZXJDYXNlKCl9IHwgJHt0aGlzLnBsdWdpbi5zdGF0dXNCYXJFbC5nZXRUZXh0KCl9YDtcbiAgICBuZXcgaW1wb3J0X29ic2lkaWFuLlNldHRpbmcoY29udGVudEVsKS5zZXROYW1lKHN0YXR1cyA9PT0gXCJydW5uaW5nXCIgPyBcIlxcdTVGMTVcXHU2NENFXFx1OEZEMFxcdTg4NENcXHU0RTJEXCIgOiBcIlxcdTVGMTVcXHU2NENFXFx1NURGMlxcdTY2ODJcXHU1MDVDXCIpLnNldERlc2Moc3RhdHVzVGV4dCkuYWRkQnV0dG9uKFxuICAgICAgKGJ1dHRvbikgPT4gYnV0dG9uLnNldEJ1dHRvblRleHQoc3RhdHVzID09PSBcInJ1bm5pbmdcIiA/IFwiXFx1NjY4MlxcdTUwNUNcXHU1RjE1XFx1NjRDRVwiIDogXCJcXHU1NDJGXFx1NTJBOFxcdTVGMTVcXHU2NENFXCIpLnNldEN0YShzdGF0dXMgIT09IFwicnVubmluZ1wiKS5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgdGhpcy5wbHVnaW4uZW5naW5lLnRvZ2dsZUVuZ2luZVN0YXRlKCk7XG4gICAgICAgIHRoaXMub25PcGVuKCk7XG4gICAgICB9KVxuICAgICk7XG4gICAgdGhpcy5yZW5kZXJRdWV1ZVNlY3Rpb24oXG4gICAgICBjb250ZW50RWwsXG4gICAgICBcImdlblwiLFxuICAgICAgXCJcXHU1Rjg1XFx1NzUxRlxcdTYyMTAgKEdlbmVyYXRpb24pXCIsXG4gICAgICB0aGlzLnBsdWdpbi5kYXRhLmdlbmVyYXRpb25RdWV1ZSxcbiAgICAgIHRoaXMucmVuZGVyR2VuZXJhdGlvbkl0ZW0uYmluZCh0aGlzKVxuICAgICk7XG4gICAgdGhpcy5yZW5kZXJRdWV1ZVNlY3Rpb24oXG4gICAgICBjb250ZW50RWwsXG4gICAgICBcInJldlwiLFxuICAgICAgXCJcXHU1Rjg1XFx1NUJBMVxcdTY4MzggKFJldmlldylcIixcbiAgICAgIHRoaXMucGx1Z2luLmRhdGEucmV2aWV3UXVldWUsXG4gICAgICB0aGlzLnJlbmRlclJldmlld0l0ZW0uYmluZCh0aGlzKVxuICAgICk7XG4gICAgdGhpcy5yZW5kZXJRdWV1ZVNlY3Rpb24oXG4gICAgICBjb250ZW50RWwsXG4gICAgICBcInJlcFwiLFxuICAgICAgXCJcXHU1Rjg1XFx1NEZFRVxcdTZCNjMgKFJldmlzaW9uKVwiLFxuICAgICAgdGhpcy5wbHVnaW4uZGF0YS5yZXZpc2lvblF1ZXVlLFxuICAgICAgdGhpcy5yZW5kZXJSZXZpc2lvbkl0ZW0uYmluZCh0aGlzKVxuICAgICk7XG4gICAgdGhpcy5yZW5kZXJRdWV1ZVNlY3Rpb24oXG4gICAgICBjb250ZW50RWwsXG4gICAgICBcImRpc1wiLFxuICAgICAgXCJcXHU1REYyXFx1NEUyMlxcdTVGMDMgKERpc2NhcmRlZClcIixcbiAgICAgIHRoaXMucGx1Z2luLmRhdGEuZGlzY2FyZGVkUGlsZSxcbiAgICAgIHRoaXMucmVuZGVyRGlzY2FyZGVkSXRlbS5iaW5kKHRoaXMpXG4gICAgKTtcblxuICAgIC8vIFx1MzAxMFx1MzAxMFx1MzAxMCBcdTVCOUVcdTY1RjZcdTUyMzdcdTY1QjBcdTRGRUVcdTY1MzlcdUZGMUFcdTU3Mjggb25PcGVuIFx1NzY4NFx1NjcyQlx1NUMzRSwgXHU2Q0U4XHU1MThDXHU2NUIwXHU3Njg0XHU3NkQxXHU1NDJDXHU1NjY4IFx1MzAxMVx1MzAxMVx1MzAxMVxuICAgIC8vIFx1NUY1M1x1NUYxNVx1NjRDRVx1NTNEMVx1OTAwMSAna2ctZGF0YS11cGRhdGVkJyBcdTRGRTFcdTUzRjdcdTY1RjYsIFx1ODFFQVx1NTJBOFx1OEMwM1x1NzUyOCB0aGlzLnJlZnJlc2hDb250ZW50IChcdTRFNUZcdTVDMzFcdTY2MkYgb25PcGVuKVxuICAgIHRoaXMuYXBwLndvcmtzcGFjZS5vbihcImtnLWRhdGEtdXBkYXRlZFwiLCB0aGlzLnJlZnJlc2hDb250ZW50KTtcbiAgfVxuICBcbiAgb25DbG9zZSgpIHtcbiAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICBjb250ZW50RWwuZW1wdHkoKTtcbiAgICBcbiAgICAvLyBcdTMwMTBcdTMwMTBcdTMwMTAgXHU1QjlFXHU2NUY2XHU1MjM3XHU2NUIwXHU0RkVFXHU2NTM5XHVGRjFBXHU1NzI4IE1vZGFsIFx1NTE3M1x1OTVFRFx1NjVGNiwgXHU1RkM1XHU5ODdCXHU2Q0U4XHU5NTAwXHU3NkQxXHU1NDJDXHU1NjY4IFx1MzAxMVx1MzAxMVx1MzAxMVxuICAgIHRoaXMuYXBwLndvcmtzcGFjZS5vZmYoXCJrZy1kYXRhLXVwZGF0ZWRcIiwgdGhpcy5yZWZyZXNoQ29udGVudCk7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBcdTZFMzJcdTY3RDNcdTRFMDBcdTRFMkFcdTk2MUZcdTUyMTdcdTUzM0FcdTU3REYgKFx1NUUyNlx1NjQxQ1x1N0QyMlx1NTQ4Q1x1NUM1NVx1NUYwMC9cdTYyOThcdTUzRTApXG4gICAqL1xuICByZW5kZXJRdWV1ZVNlY3Rpb24oY29udGFpbmVyRWwsIGtleSwgdGl0bGUsIGRhdGEsIHJlbmRlckZuKSB7XG4gICAgY29uc3QgZGlzcGxheUxpbWl0ID0gMTAwO1xuICAgIGNvbnN0IGZpbHRlciA9IHRoaXMuc2VhcmNoVGVybXNba2V5XTtcbiAgICBjb25zdCBmaWx0ZXJlZERhdGEgPSBkYXRhLmZpbHRlcigoaXRlbSkgPT4ge1xuICAgICAgaWYgKCFmaWx0ZXIpXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgY29uc3QgbmVlZGxlID0gZmlsdGVyLnRvTG93ZXJDYXNlKCk7XG4gICAgICBpZiAodHlwZW9mIGl0ZW0gPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgcmV0dXJuIGl0ZW0udG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhuZWVkbGUpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGl0ZW0uaWRlYS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKG5lZWRsZSk7XG4gICAgfSk7XG4gICAgY29uc3QgdG90YWwgPSBkYXRhLmxlbmd0aDtcbiAgICBjb25zdCBmaWx0ZXJlZFRvdGFsID0gZmlsdGVyZWREYXRhLmxlbmd0aDtcbiAgICBjb25zdCB0aXRsZVRleHQgPSBgJHt0aXRsZX0gKCR7ZmlsdGVyZWRUb3RhbH0ke3RvdGFsICE9PSBmaWx0ZXJlZFRvdGFsID8gXCIgLyBcIiArIHRvdGFsIDogXCJcIn0gXFx1OTg3OSlgO1xuICAgIGNvbnN0IGRldGFpbHMgPSBjb250YWluZXJFbC5jcmVhdGVFbChcImRldGFpbHNcIik7XG4gICAgZGV0YWlscy5vcGVuID0gdGhpcy5jb2xsYXBzZVN0YXRlc1trZXldO1xuICAgIGNvbnN0IHN1bW1hcnkgPSBkZXRhaWxzLmNyZWF0ZUVsKFwic3VtbWFyeVwiLCB7IHRleHQ6IHRpdGxlVGV4dCB9KTtcbiAgICBzdW1tYXJ5LnN0eWxlLmZvbnRXZWlnaHQgPSBcImJvbGRcIjtcbiAgICBzdW1tYXJ5LnN0eWxlLmZvbnRTaXplID0gXCJ2YXIoLS1mb250LXVpLWxhcmdlKVwiO1xuICAgIHN1bW1hcnkuc3R5bGUuY3Vyc29yID0gXCJwb2ludGVyXCI7XG4gICAgc3VtbWFyeS5zdHlsZS5wYWRkaW5nID0gXCI1cHggMFwiO1xuICAgIGRldGFpbHMuYWRkRXZlbnRMaXN0ZW5lcihcInRvZ2dsZVwiLCAoKSA9PiB7XG4gICAgICB0aGlzLmNvbGxhcHNlU3RhdGVzW2tleV0gPSBkZXRhaWxzLm9wZW47XG4gICAgfSk7XG4gICAgbmV3IGltcG9ydF9vYnNpZGlhbi5TZXR0aW5nKGRldGFpbHMpLnNldERlc2MoYFxcdTY0MUNcXHU3RDIyICR7dGl0bGV9Li4uYCkuYWRkVGV4dCgodGV4dCkgPT4ge1xuICAgICAgdGV4dC5zZXRQbGFjZWhvbGRlcihcIlxcdThGOTNcXHU1MTY1XFx1NTE3M1xcdTk1MkVcXHU4QkNELi4uXCIpLnNldFZhbHVlKHRoaXMuc2VhcmNoVGVybXNba2V5XSkub25DaGFuZ2UoKHZhbHVlKSA9PiB7XG4gICAgICAgIHRoaXMuc2VhcmNoVGVybXNba2V5XSA9IHZhbHVlO1xuICAgICAgICB0aGlzLm9uT3BlbigpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gICAgY29uc3QgdHJ1bmNhdGVkRGF0YSA9IGZpbHRlcmVkRGF0YS5zbGljZSgwLCBkaXNwbGF5TGltaXQpO1xuICAgIGlmICh0cnVuY2F0ZWREYXRhLmxlbmd0aCA9PT0gMCkge1xuICAgICAgY29uc3QgZGVzYyA9IGRldGFpbHMuY3JlYXRlRWwoXCJwXCIsIHsgdGV4dDogXCJcXHU2QjY0XFx1OTYxRlxcdTUyMTdcXHU0RTNBXFx1N0E3QVxcdUZGMENcXHU2MjE2XFx1NjcyQVxcdTYyN0VcXHU1MjMwXFx1NTMzOVxcdTkxNERcXHU5ODc5XFx1MzAwMlwiLCBjbHM6IFwic2V0dGluZy1pdGVtLWRlc2NyaXB0aW9uXCIgfSk7XG4gICAgICBkZXNjLnN0eWxlLnBhZGRpbmdMZWZ0ID0gXCIxMHB4XCI7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGxpc3RDb250YWluZXIgPSBkZXRhaWxzLmNyZWF0ZURpdihcImtnLWxpc3QtY29udGFpbmVyXCIpO1xuICAgIGxpc3RDb250YWluZXIuc3R5bGUubWF4SGVpZ2h0ID0gXCIyMDBweFwiO1xuICAgIGxpc3RDb250YWluZXIuc3R5bGUub3ZlcmZsb3dZID0gXCJhdXRvXCI7XG4gICAgbGlzdENvbnRhaW5lci5zdHlsZS5ib3JkZXIgPSBcIjFweCBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcilcIjtcbiAgICBsaXN0Q29udGFpbmVyLnN0eWxlLnBhZGRpbmcgPSBcIjVweFwiO1xuICAgIGxpc3RDb250YWluZXIuc3R5bGUubWFyZ2luTGVmdCA9IFwiMTBweFwiO1xuICAgIHRydW5jYXRlZERhdGEuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHtcbiAgICAgIHJlbmRlckZuKGxpc3RDb250YWluZXIsIGl0ZW0sIGluZGV4KTtcbiAgICB9KTtcbiAgICBpZiAoZmlsdGVyZWREYXRhLmxlbmd0aCA+IGRpc3BsYXlMaW1pdCkge1xuICAgICAgY29uc3QgdHJ1bmNhdGVkSW5mbyA9IGRldGFpbHMuY3JlYXRlRWwoXCJwXCIsIHtcbiAgICAgICAgdGV4dDogYC4uLiBcXHU0RUM1XFx1NjYzRVxcdTc5M0FcXHU1MjREICR7ZGlzcGxheUxpbWl0fSBcXHU5ODc5IChcXHU1MTcxICR7ZmlsdGVyZWREYXRhLmxlbmd0aH0gXFx1OTg3OSlcXHVGRjBDXFx1OEJGN1xcdTRGN0ZcXHU3NTI4XFx1NjQxQ1xcdTdEMjJcXHU2N0U1XFx1NjI3RVxcdTY2RjRcXHU1OTFBXFx1MzAwMmAsXG4gICAgICAgIGNsczogXCJzZXR0aW5nLWl0ZW0tZGVzY3JpcHRpb25cIlxuICAgICAgfSk7XG4gICAgICB0cnVuY2F0ZWRJbmZvLnN0eWxlLnBhZGRpbmdMZWZ0ID0gXCIxMHB4XCI7XG4gICAgfVxuICB9XG4gIC8vIC0tLSBcdTUzNTVcdTk4NzlcdTZFMzJcdTY3RDNcdTUxRkRcdTY1NzAgKFx1NEZERFx1NjMwMVx1NEUwRFx1NTNEOCkgLS0tXG4gIHJlbmRlckdlbmVyYXRpb25JdGVtKGNvbnRhaW5lciwgaXRlbSkge1xuICAgIG5ldyBpbXBvcnRfb2JzaWRpYW4uU2V0dGluZyhjb250YWluZXIpLnNldE5hbWUoaXRlbSkuYWRkQnV0dG9uKFxuICAgICAgKGJ0bikgPT4gYnRuLnNldEljb24oXCJ0cmFzaFwiKS5zZXRUb29sdGlwKFwiXFx1NTIyMFxcdTk2NjRcXHU2QjY0XFx1Njk4MlxcdTVGRjVcIikub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHF1ZXVlID0gdGhpcy5wbHVnaW4uZGF0YS5nZW5lcmF0aW9uUXVldWU7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gcXVldWUuaW5kZXhPZihpdGVtKTtcbiAgICAgICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgICAgICBxdWV1ZS5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVQbHVnaW5EYXRhKCk7XG4gICAgICAgICAgdGhpcy5wbHVnaW4uZW5naW5lLnVwZGF0ZVN0YXR1c0JhcigpO1xuICAgICAgICAgIHRoaXMub25PcGVuKCk7XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgKTtcbiAgfVxuICByZW5kZXJSZXZpZXdJdGVtKGNvbnRhaW5lciwgaXRlbSkge1xuICAgIGNvbnN0IHRhc2sgPSBpdGVtO1xuICAgIG5ldyBpbXBvcnRfb2JzaWRpYW4uU2V0dGluZyhjb250YWluZXIpLnNldE5hbWUoYFtcXHU1QkExXFx1NjgzOF0gJHt0YXNrLmlkZWF9YCkuYWRkQnV0dG9uKFxuICAgICAgKGJ0bikgPT4gYnRuLnNldEljb24oXCJ0cmFzaFwiKS5zZXRUb29sdGlwKFwiXFx1NEUyMlxcdTVGMDNcXHU2QjY0XFx1NEVGQlxcdTUyQTFcIikub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgIHRoaXMucGx1Z2luLmRhdGEucmV2aWV3UXVldWUuc3BsaWNlKHRoaXMucGx1Z2luLmRhdGEucmV2aWV3UXVldWUuaW5kZXhPZih0YXNrKSwgMSk7XG4gICAgICAgIHRoaXMucGx1Z2luLmRhdGEuZGlzY2FyZGVkUGlsZS5wdXNoKHRhc2spO1xuICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlUGx1Z2luRGF0YSgpO1xuICAgICAgICB0aGlzLnBsdWdpbi5lbmdpbmUudXBkYXRlU3RhdHVzQmFyKCk7XG4gICAgICAgIHRoaXMub25PcGVuKCk7XG4gICAgICB9KVxuICAgICk7XG4gIH1cbiAgcmVuZGVyUmV2aXNpb25JdGVtKGNvbnRhaW5lciwgaXRlbSkge1xuICAgIGNvbnN0IHRhc2sgPSBpdGVtO1xuICAgIG5ldyBpbXBvcnRfb2JzaWRpYW4uU2V0dGluZyhjb250YWluZXIpLnNldE5hbWUoYFtcXHU0RkVFXFx1NkI2M10gJHt0YXNrLmlkZWF9YCkuc2V0RGVzYyhgXFx1NTM5RlxcdTU2RTA6ICR7dGFzay5yZWFzb24gfHwgXCJcXHU2NzJBXFx1NzdFNVwifWApLmFkZEJ1dHRvbihcbiAgICAgIChidG4pID0+IGJ0bi5zZXRJY29uKFwidHJhc2hcIikuc2V0VG9vbHRpcChcIlxcdTRFMjJcXHU1RjAzXFx1NkI2NFxcdTRFRkJcXHU1MkExXCIpLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLnJldmlzaW9uUXVldWUuc3BsaWNlKHRoaXMucGx1Z2luLmRhdGEucmV2aXNpb25RdWV1ZS5pbmRleE9mKHRhc2spLCAxKTtcbiAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5kaXNjYXJkZWRQaWxlLnB1c2godGFzayk7XG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVQbHVnaW5EYXRhKCk7XG4gICAgICAgIHRoaXMucGx1Z2luLmVuZ2luZS51cGRhdGVTdGF0dXNCYXIoKTtcbiAgICAgICAgdGhpcy5vbk9wZW4oKTtcbiAgICAgIH0pXG4gICAgKTtcbiAgfVxuICByZW5kZXJEaXNjYXJkZWRJdGVtKGNvbnRhaW5lciwgaXRlbSkge1xuICAgIGNvbnN0IHRhc2sgPSBpdGVtO1xuICAgIG5ldyBpbXBvcnRfb2JzaWRpYW4uU2V0dGluZyhjb250YWluZXIpLnNldE5hbWUoYFtcXHU1REYyXFx1NEUyMlxcdTVGMDNdICR7dGFzay5pZGVhfWApLnNldERlc2MoYFxcdTY3MDBcXHU1NDBFXFx1NTM5RlxcdTU2RTA6ICR7dGFzay5yZWFzb24gfHwgXCJcXHU2NzJBXFx1NzdFNVwifWApLmFkZEJ1dHRvbihcbiAgICAgIChidG4pID0+IGJ0bi5zZXRJY29uKFwicmVmcmVzaC1jd1wiKS5zZXRUb29sdGlwKFwiXFx1OTFDRFxcdTY1QjBcXHU2MzkyXFx1OTYxRiAoXFx1NjUzRVxcdTU2REVcXHU3NTFGXFx1NjIxMFxcdTk2MUZcXHU1MjE3KVwiKS5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5kaXNjYXJkZWRQaWxlLnNwbGljZSh0aGlzLnBsdWdpbi5kYXRhLmRpc2NhcmRlZFBpbGUuaW5kZXhPZih0YXNrKSwgMSk7XG4gICAgICAgIHRoaXMucGx1Z2luLmVuZ2luZS5hZGRDb25jZXB0c1RvUXVldWUoW3Rhc2suaWRlYV0pO1xuICAgICAgICB0aGlzLm9uT3BlbigpO1xuICAgICAgfSlcbiAgICApO1xuICB9XG59O1xuXG4vLyAtLS0gXHU5RUQ4XHU4QkE0IFByb21wdHMgKFx1NEUwRFx1OTcwMFx1ODk4MSBleHBvcnQpIC0tLVxudmFyIFBST01QVF9HRU5FUkFUT1JfREVGQVVMVCA9IGAjIFJvbGU6IFxcdTc3RTVcXHU4QkM2XFx1N0NGQlxcdTdFREZcXHU2Nzg0XFx1NUVGQVxcdTRFMTNcXHU1QkI2Li4uYDtcbnZhciBQUk9NUFRfQ1JJVElDX0RFRkFVTFQgPSBgIyBSb2xlOiBcXHU3N0U1XFx1OEJDNlxcdTU2RkVcXHU4QzMxXFx1OEQyOFxcdTkxQ0ZcXHU1QkExXFx1NjgzOFxcdTU0NTguLi5gO1xudmFyIFBST01QVF9SRVZJU0VSX0RFRkFVTFQgPSBgIyBcXHU4OUQyXFx1ODI3MjogXFx1OEQ0NFxcdTZERjFcXHU3N0U1XFx1OEJDNlxcdTdGMTZcXHU4RjkxXFx1NEUwRVxcdTUxODVcXHU1QkI5XFx1NEYxOFxcdTUzMTZcXHU0RTEzXFx1NUJCNi4uLmA7XG5cbi8vIC0tLSBcdTMwMTBcdTMwMTBcdTMwMTAgXHU0RkVFXHU2QjYzXHVGRjFBXHU2REZCXHU1MkEwIGV4cG9ydCBcdTMwMTFcdTMwMTFcdTMwMTEgLS0tXG5leHBvcnQgdmFyIERFRkFVTFRfU0VUVElOR1MgPSB7XG4gIC8vIEFQSVxuICBvcGVuYWlfYXBpX2tleXM6IFwiXCIsXG4gIG9wZW5haV9iYXNlX3VybDogXCJodHRwczovL2FwaS5vcGVuYWkuY29tL3YxXCIsXG4gIG9wZW5haV9tb2RlbDogXCJncHQtNC10dXJiby1wcmV2aWV3XCIsXG4gIG9wZW5haV9iYWNrdXBfbW9kZWw6IFwiXCIsXG4gIC8vIFx1MzAxMCBcdTY1QjBcdTU4OUVcdUZGMUFPcGVuQUkgXHU1OTA3XHU3NTI4XHU2QTIxXHU1NzhCIFx1MzAxMVxuICBnb29nbGVfYXBpX2tleXM6IFwiXCIsXG4gIGdvb2dsZV9tb2RlbDogXCJnZW1pbmktMS41LXByby1sYXRlc3RcIixcbiAgZ29vZ2xlX2JhY2t1cF9tb2RlbDogXCJcIixcbiAgLy8gXHUzMDEwIFx1NjVCMFx1NTg5RVx1RkYxQUdvb2dsZSBcdTU5MDdcdTc1MjhcdTZBMjFcdTU3OEIgXHUzMDExXG4gIGZhaWxvdmVyX2Nvb2xkb3duX3NlY29uZHM6IDMwMCxcbiAgLy8gXHU1M0MyXHU2NTcwXG4gIGdlbmVyYXRpb25fdGVtcGVyYXR1cmU6IDAuNyxcbiAgZ2VuZXJhdGlvbl9tYXhfdG9rZW5zOiA0MDk2LFxuICAvLyBcdThERUZcdTVGODRcbiAgb3V0cHV0X2RpcjogXCJLbm93bGVkZ2VHcmFwaE5vdGVzXCIsXG4gIC8vIFx1N0NGQlx1N0VERlxuICBtYXhfd29ya2VyczogMixcbiAgZ2VuZXJhdGlvbl9iYXRjaF9zaXplOiA1LFxuICByZXF1ZXN0X2RlbGF5OiA1LFxuICAvLyBDcml0aWNcbiAgY3JpdGljX21vZGU6IFwiaGV1cmlzdGljXCIsXG4gIGNyaXRpY19yZXF1aXJlZF9oZWFkZXJzOiBcIiMgXFx1ezFGOUUwfVxcbj4gXFxuIyMgXFx1ezFGNEREfSBcXHU2ODM4XFx1NUZDM1xcdTYwMURcXHU2MEYzXFxuIyMgXFx1ezFGM0FGfSBcXHU5MDAyXFx1NzUyOFxcdTU3M0FcXHU2NjZGXFxuIyMgXFx1ezFGNkUwfVxcdUZFMEYgXFx1NEY3RlxcdTc1MjhcXHU2QjY1XFx1OUFBNC9cXHU2Nzg0XFx1NjIxMFxcdTg5ODFcXHU3RDIwXFxuIyMgXFx1ezFGNjgwfSBcXHU2ODQ4XFx1NEY4QlxcdTUyMDZcXHU2NzkwXFxuIyMgXFx1ezFGNDREfSBcXHU0RjE4XFx1NzBCOSAmIFxcdXsxRjQ0RX0gXFx1N0YzQVxcdTcwQjlcXG4jIyBcXHV7MUY1MTd9IFxcdTUxNzNcXHU4MDU0XFx1NkEyMVxcdTU3OEJcIixcbiAgY3JpdGljX21pbl9jb250ZW50X2xlbmd0aDogNDAwLFxuICAvLyBSZXZpc2VyXG4gIG1heF9yZXZpc2lvbl9yZXRyaWVzOiAyLFxuICAvLyBQcm9tcHRzXG4gIHByb21wdF9nZW5lcmF0b3I6IFBST01QVF9HRU5FUkFUT1JfREVGQVVMVCxcbiAgcHJvbXB0X2NyaXRpYzogUFJPTVBUX0NSSVRJQ19ERUZBVUxULFxuICBwcm9tcHRfcmV2aXNlcjogUFJPTVBUX1JFVklTRVJfREVGQVVMVCxcbiAgLy8gXHU2NEFEXHU3OUNEXHU3QkIxXG4gIHNlZWRDb25jZXB0czogXCJcIixcbiAgLy8gXHUzMDEwXHUzMDEwXHUzMDEwIFx1NjVCMFx1NTg5RVx1OTE0RFx1N0Y2RVx1OTg3OSBcdTMwMTFcdTMwMTFcdTMwMTFcbiAgLy8gXHU5RUQ4XHU4QkE0XHU1MTczXHU5NUVEXHU2NUIwXHU2OTgyXHU1RkY1XHU2M0QwXHU1M0Q2XG4gIGV4dHJhY3RfbmV3X2NvbmNlcHRzOiBmYWxzZVxufTtcblxuLy8gLS0tIFx1MzAxMFx1MzAxMFx1MzAxMCBcdTRGRUVcdTZCNjNcdUZGMUFcdTZERkJcdTUyQTAgZXhwb3J0IFx1MzAxMVx1MzAxMVx1MzAxMSAtLS1cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXREZWZhdWx0UHJvbXB0cygpIHtcbiAgcmV0dXJuIHtcbiAgICBwcm9tcHRfZ2VuZXJhdG9yOiBQUk9NUFRfR0VORVJBVE9SX0RFRkFVTFQsXG4gICAgcHJvbXB0X2NyaXRpYzogUFJPTVBUX0NSSVRJQ19ERUZBVUxULFxuICAgIHByb21wdF9yZXZpc2VyOiBQUk9NUFRfUkVWSVNFUl9ERUZBVUxUXG4gIH07XG59XG5cbi8vIC0tLSBcdTMwMTBcdTMwMTBcdTMwMTAgXHU0RkVFXHU2QjYzXHVGRjFBXHU2REZCXHU1MkEwIGV4cG9ydCBcdTMwMTFcdTMwMTFcdTMwMTEgLS0tXG5leHBvcnQgdmFyIEtHc1NldHRpbmdUYWIgPSBjbGFzcyBleHRlbmRzIGltcG9ydF9vYnNpZGlhbjIuUGx1Z2luU2V0dGluZ1RhYiB7XG4gIGNvbnN0cnVjdG9yKGFwcCwgcGx1Z2luKSB7XG4gICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICB9XG4gIGRpc3BsYXkoKSB7XG4gICAgY29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcbiAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiaDJcIiwgeyB0ZXh0OiBcIlxcdTc3RTVcXHU4QkM2XFx1NTZGRVxcdThDMzFcXHU3NTFGXFx1NjIxMFxcdTU2NjggLSBcXHU4QkJFXFx1N0Y2RVwiIH0pO1xuICAgIG5ldyBpbXBvcnRfb2JzaWRpYW4yLlNldHRpbmcoY29udGFpbmVyRWwpLnNldE5hbWUoXCJcXHU1RjE1XFx1NjRDRVxcdTRFRUFcXHU4ODY4XFx1NzZEOFwiKS5zZXREZXNjKFwiXFx1N0JBMVxcdTc0MDZcXHU1Rjg1XFx1NzUxRlxcdTYyMTBcXHUzMDAxXFx1NUY4NVxcdTVCQTFcXHU2ODM4XFx1NTQ4Q1xcdTVERjJcXHU0RTIyXFx1NUYwM1xcdTc2ODRcXHU0RUZCXFx1NTJBMVxcdTMwMDJcIikuYWRkQnV0dG9uKFxuICAgICAgKGJ1dHRvbikgPT4gYnV0dG9uLnNldEJ1dHRvblRleHQoXCJcXHU2MjUzXFx1NUYwMFxcdTk2MUZcXHU1MjE3XFx1N0JBMVxcdTc0MDZcXHU1NjY4XCIpLnNldEN0YSgpLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICBuZXcgUXVldWVNYW5hZ2VtZW50TW9kYWwodGhpcy5hcHAsIHRoaXMucGx1Z2luKS5vcGVuKCk7XG4gICAgICB9KVxuICAgICk7XG4gICAgbmV3IGltcG9ydF9vYnNpZGlhbjIuU2V0dGluZyhjb250YWluZXJFbCkuc2V0TmFtZShcIkFQSSBcXHU4QkJFXFx1N0Y2RVwiKS5zZXRIZWFkaW5nKCk7XG4gICAgY29udGFpbmVyRWwuY3JlYXRlRWwoXCJoM1wiLCB7IHRleHQ6IFwiT3BlbkFJXCIgfSk7XG4gICAgbmV3IGltcG9ydF9vYnNpZGlhbjIuU2V0dGluZyhjb250YWluZXJFbCkuc2V0TmFtZShcIk9wZW5BSSBBUEkgS2V5c1wiKS5zZXREZXNjKFwiXFx1NkJDRlxcdTg4NENcXHU0RTAwXFx1NEUyQSBLZXlcXHUzMDAyXFx1NjNEMlxcdTRFRjZcXHU1QzA2XFx1ODFFQVxcdTUyQThcXHU4RjZFXFx1NjM2MlxcdTU0OENcXHU1MUI3XFx1NTM3NFxcdTRGN0ZcXHU3NTI4XFx1MzAwMlwiKS5hZGRUZXh0QXJlYSgodGV4dCkgPT4gdGV4dC5zZXRQbGFjZWhvbGRlcihcInNrLS4uLlwiKS5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5vcGVuYWlfYXBpX2tleXMpLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Mub3BlbmFpX2FwaV9rZXlzID0gdmFsdWU7XG4gICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICB9KSk7XG4gICAgbmV3IGltcG9ydF9vYnNpZGlhbjIuU2V0dGluZyhjb250YWluZXJFbCkuc2V0TmFtZShcIk9wZW5BSSBCYXNlIFVSTFwiKS5zZXREZXNjKFwiXFx1NTk4MlxcdTY3OUNcXHU0RjYwXFx1NEY3RlxcdTc1MjhcXHU3QjJDXFx1NEUwOVxcdTY1QjlcXHU0RUUzXFx1NzQwNlxcdUZGMENcXHU4QkY3XFx1NTcyOFxcdTZCNjRcXHU1OTA0XFx1NTg2QlxcdTUxNjVcXHU0RUUzXFx1NzQwNlxcdTU3MzBcXHU1NzQwXFx1MzAwMlwiKS5hZGRUZXh0KCh0ZXh0KSA9PiB0ZXh0LnNldFBsYWNlaG9sZGVyKFwiaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MVwiKS5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5vcGVuYWlfYmFzZV91cmwpLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Mub3BlbmFpX2Jhc2VfdXJsID0gdmFsdWUudHJpbSgpO1xuICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgfSkpO1xuICAgIFxuICAgIC8vIC0tLSBcdTMwMTBcdTMwMTBcdTMwMTAgXHU2NkY0XHU2NUIwXHVGRjFBT3BlbkFJIFx1NkEyMVx1NTc4Qlx1OEJCRVx1N0Y2RSBcdTMwMTFcdTMwMTFcdTMwMTEgLS0tXG4gICAgbmV3IGltcG9ydF9vYnNpZGlhbjIuU2V0dGluZyhjb250YWluZXJFbCkuc2V0TmFtZShcIk9wZW5BSSBNb2RlbCAoXFx1NEUzQlxcdTZBMjFcXHU1NzhCKVwiKS5zZXREZXNjKFwiXFx1OEY5M1xcdTUxNjVcXHU0RjYwXFx1NjBGM1xcdTRGN0ZcXHU3NTI4XFx1NzY4NCBPcGVuQUkgXFx1NEUzQlxcdTg5ODFcXHU2QTIxXFx1NTc4QlxcdTU0MERcXHU3OUYwXFx1MzAwMlwiKS5hZGRUZXh0KCh0ZXh0KSA9PiB0ZXh0LnNldFBsYWNlaG9sZGVyKFwiZ3B0LTQtdHVyYm8tcHJldmlld1wiKS5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5vcGVuYWlfbW9kZWwpLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Mub3BlbmFpX21vZGVsID0gdmFsdWUudHJpbSgpO1xuICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgfSkpO1xuICAgIG5ldyBpbXBvcnRfb2JzaWRpYW4yLlNldHRpbmcoY29udGFpbmVyRWwpLnNldE5hbWUoXCJPcGVuQUkgXFx1NTkwN1xcdTc1MjhcXHU2QTIxXFx1NTc4QiAoQmFja3VwIE1vZGVsKVwiKS5zZXREZXNjKFwiKFxcdTUzRUZcXHU5MDA5KSBcXHU1RjUzXFx1NEUzQlxcdTZBMjFcXHU1NzhCXFx1OTg5RFxcdTVFQTZcXHU4MDE3XFx1NUMzRFxcdTYyMTZcXHU1OTMxXFx1OEQyNVxcdTY1RjZcXHVGRjBDXFx1NUMwNlxcdTgxRUFcXHU1MkE4XFx1NUMxRFxcdThCRDVcXHU2QjY0XFx1NTkwN1xcdTc1MjhcXHU2QTIxXFx1NTc4QlxcdTMwMDJcIikuYWRkVGV4dCgodGV4dCkgPT4gdGV4dC5zZXRQbGFjZWhvbGRlcihcImdwdC0zLjUtdHVyYm9cIikuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Mub3BlbmFpX2JhY2t1cF9tb2RlbCkub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5vcGVuYWlfYmFja3VwX21vZGVsID0gdmFsdWUudHJpbSgpO1xuICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgfSkpO1xuXG4gICAgY29udGFpbmVyRWwuY3JlYXRlRWwoXCJoM1wiLCB7IHRleHQ6IFwiR29vZ2xlIEdlbWluaVwiIH0pO1xuICAgIG5ldyBpbXBvcnRfb2JzaWRpYW4yLlNldHRpbmcoY29udGFpbmVyRWwpLnNldE5hbWUoXCJHb29nbGUgR2VtaW5pIEFQSSBLZXlzXCIpLnNldERlc2MoXCJcXHU2QkNGXFx1ODg0Q1xcdTRFMDBcXHU0RTJBIEtleVxcdTMwMDJcIikuYWRkVGV4dEFyZWEoKHRleHQpID0+IHRleHQuc2V0UGxhY2Vob2xkZXIoXCJBSXphU3kuLi5cIikuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZ29vZ2xlX2FwaV9rZXlzKS5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmdvb2dsZV9hcGlfa2V5cyA9IHZhbHVlO1xuICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgfSkpO1xuICAgIFxuICAgIC8vIC0tLSBcdTMwMTBcdTMwMTBcdTMwMTAgXHU2NkY0XHU2NUIwXHVGRjFBR29vZ2xlIFx1NkEyMVx1NTc4Qlx1OEJCRVx1N0Y2RSBcdTMwMTFcdTMwMTFcdTMwMTEgLS0tXG4gICAgbmV3IGltcG9ydF9vYnNpZGlhbjIuU2V0dGluZyhjb250YWluZXJFbCkuc2V0TmFtZShcIkdvb2dsZSBHZW1pbmkgTW9kZWwgKFxcdTRFM0JcXHU2QTIxXFx1NTc4QilcIikuc2V0RGVzYyhcIlxcdThGOTNcXHU1MTY1XFx1NEY2MFxcdTYwRjNcXHU0RjdGXFx1NzUyOFxcdTc2ODQgR29vZ2xlIFxcdTRFM0JcXHU4OTgxXFx1NkEyMVxcdTU3OEJcXHU1NDBEXFx1NzlGMFxcdTMwMDJcIikuYWRkVGV4dCgodGV4dCkgPT4gdGV4dC5zZXRQbGFjZWhvbGRlcihcImdlbWluaS0xLjUtcHJvLWxhdGVzdFwiKS5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nb29nbGVfbW9kZWwpLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ29vZ2xlX21vZGVsID0gdmFsdWUudHJpbSgpO1xuICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgfSkpO1xuICAgIG5ldyBpbXBvcnRfb2JzaWRpYW4yLlNldHRpbmcoY29udGFpbmVyRWwpLnNldE5hbWUoXCJHb29nbGUgR2VtaW5pIFxcdTU5MDdcXHU3NTI4XFx1NkEyMVxcdTU3OEIgKEJhY2t1cCBNb2RlbClcIikuc2V0RGVzYyhcIihcXHU1M0VGXFx1OTAwOSkgXFx1NUY1M1xcdTRFM0JcXHU2QTIxXFx1NTc4QlxcdTk4OURcXHU1RUE2XFx1ODAxN1xcdTVDM0RcXHU2MjE2XFx1NTkzMVxcdThEMjVcXHU2NUY2XFx1RkYwQ1xcdTVDMDZcXHU4MUVBXFx1NTJBOFxcdTVDMURcXHU4QkQ1XFx1NkI2NFxcdTU5MDdcXHU3NTI4XFx1NkEyMVxcdTU3OEJcXHUzMDAyXCIpLmFkZFRleHQoKHRleHQpID0+IHRleHQuc2V0UGxhY2Vob2xkZXIoXCJnZW1pbmktMS4wLXByb1wiKS5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nb29nbGVfYmFja3VwX21vZGVsKS5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmdvb2dsZV9iYWNrdXBfbW9kZWwgPSB2YWx1ZS50cmltKCk7XG4gICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICB9KSk7XG4gICAgXG4gICAgbmV3IGltcG9ydF9vYnNpZGlhbjIuU2V0dGluZyhjb250YWluZXJFbCkuc2V0TmFtZShcIktleSBcXHU1MUI3XFx1NTM3NFxcdTY1RjZcXHU5NUY0IChcXHU3OUQyKVwiKS5zZXREZXNjKFwiQVBJIEtleSBcXHU1OTMxXFx1OEQyNVxcdTU0MEVcXHVGRjBDXFx1OTcwMFxcdTg5ODFcXHU3QjQ5XFx1NUY4NVxcdTU5MUFcXHU1QzExXFx1NzlEMlxcdTYyNERcXHU4MEZEXFx1NTE4RFxcdTZCMjFcXHU0RjdGXFx1NzUyOFxcdTMwMDJcIikuYWRkVGV4dCgodGV4dCkgPT4gdGV4dC5zZXRWYWx1ZShTdHJpbmcodGhpcy5wbHVnaW4uc2V0dGluZ3MuZmFpbG92ZXJfY29vbGRvd25fc2Vjb25kcykpLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgY29uc3QgbnVtID0gcGFyc2VJbnQodmFsdWUsIDEwKTtcbiAgICAgIGlmICghaXNOYU4obnVtKSAmJiBudW0gPj0gMCkge1xuICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5mYWlsb3Zlcl9jb29sZG93bl9zZWNvbmRzID0gbnVtO1xuICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgIH1cbiAgICB9KSk7XG4gICAgbmV3IGltcG9ydF9vYnNpZGlhbjIuU2V0dGluZyhjb250YWluZXJFbCkuc2V0TmFtZShcIkxMTSBcXHU1M0MyXFx1NjU3MFxcdThCQkVcXHU3RjZFXCIpLnNldEhlYWRpbmcoKTtcbiAgICBuZXcgaW1wb3J0X29ic2lkaWFuMi5TZXR0aW5nKGNvbnRhaW5lckVsKS5zZXROYW1lKFwiXFx1NzUxRlxcdTYyMTBcXHU2RTI5XFx1NUVBNiAoVGVtcGVyYXR1cmUpXCIpLnNldERlc2MoXCJcXHU2M0E3XFx1NTIzNlxcdTc1MUZcXHU2MjEwXFx1NTE4NVxcdTVCQjlcXHU3Njg0XFx1OTY4RlxcdTY3M0FcXHU2MDI3XFx1MzAwMlxcdThGODNcXHU0RjRFXFx1NzY4NFxcdTUwM0NcXHVGRjA4XFx1NTk4MiAwLjJcXHVGRjA5XFx1NjZGNFxcdTUxNzdcXHU3ODZFXFx1NUI5QVxcdTYwMjdcXHVGRjBDXFx1OEY4M1xcdTlBRDhcXHU3Njg0XFx1NTAzQ1xcdUZGMDhcXHU1OTgyIDAuOFxcdUZGMDlcXHU2NkY0XFx1NTE3N1xcdTUyMUJcXHU5MDIwXFx1NjAyN1xcdTMwMDJcIikuYWRkVGV4dCgodGV4dCkgPT4gdGV4dC5zZXRWYWx1ZShTdHJpbmcodGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhdGlvbl90ZW1wZXJhdHVyZSkpLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgY29uc3QgbnVtID0gcGFyc2VGbG9hdCh2YWx1ZSk7XG4gICAgICBpZiAoIWlzTmFOKG51bSkgJiYgbnVtID49IDAgJiYgbnVtIDw9IDIpIHtcbiAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhdGlvbl90ZW1wZXJhdHVyZSA9IG51bTtcbiAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICB9XG4gICAgfSkpO1xuICAgIG5ldyBpbXBvcnRfb2JzaWRpYW4yLlNldHRpbmcoY29udGFpbmVyRWwpLnNldE5hbWUoXCJcXHU2NzAwXFx1NTkyNyBUb2tlbiBcXHU2NTcwIChNYXggVG9rZW5zKVwiKS5zZXREZXNjKFwiQVBJIFxcdTRFMDBcXHU2QjIxXFx1OEMwM1xcdTc1MjhcXHU1MTQxXFx1OEJCOFxcdTc1MUZcXHU2MjEwXFx1NzY4NFxcdTY3MDBcXHU1OTI3IFRva2VuIFxcdTY1NzBcXHU5MUNGXFx1MzAwMlwiKS5hZGRUZXh0KCh0ZXh0KSA9PiB0ZXh0LnNldFZhbHVlKFN0cmluZyh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW5lcmF0aW9uX21heF90b2tlbnMpKS5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgIGNvbnN0IG51bSA9IHBhcnNlSW50KHZhbHVlLCAxMCk7XG4gICAgICBpZiAoIWlzTmFOKG51bSkgJiYgbnVtID4gMCkge1xuICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW5lcmF0aW9uX21heF90b2tlbnMgPSBudW07XG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgfVxuICAgIH0pKTtcbiAgICBuZXcgaW1wb3J0X29ic2lkaWFuMi5TZXR0aW5nKGNvbnRhaW5lckVsKS5zZXROYW1lKFwiXFx1NUYxNVxcdTY0Q0VcXHU4QkJFXFx1N0Y2RVwiKS5zZXRIZWFkaW5nKCk7XG4gICAgbmV3IGltcG9ydF9vYnNpZGlhbjIuU2V0dGluZyhjb250YWluZXJFbCkuc2V0TmFtZShcIlxcdThGOTNcXHU1MUZBXFx1NjU4N1xcdTRFRjZcXHU1OTM5XCIpLnNldERlc2MoXCJcXHU2MjQwXFx1NjcwOVxcdTc1MUZcXHU2MjEwXFx1NzY4NFxcdTdCMTRcXHU4QkIwXFx1NUMwNlxcdTRGRERcXHU1QjU4XFx1NTIzMFxcdTZCNjRcXHU2NTg3XFx1NEVGNlxcdTU5MzlcXHUzMDAyXCIpLmFkZFRleHQoKHRleHQpID0+IHRleHQuc2V0UGxhY2Vob2xkZXIoXCJLbm93bGVkZ2VHcmFwaE5vdGVzXCIpLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm91dHB1dF9kaXIpLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Mub3V0cHV0X2RpciA9IHZhbHVlLnRyaW0oKS5yZXBsYWNlKC9cXC8kLywgXCJcIik7XG4gICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICB9KSk7XG4gICAgbmV3IGltcG9ydF9vYnNpZGlhbjIuU2V0dGluZyhjb250YWluZXJFbCkuc2V0TmFtZShcIlxcdTY3MDBcXHU1OTI3XFx1NUU3NlxcdTUzRDFcXHU2NTcwIChNYXggV29ya2VycylcIikuc2V0RGVzYyhcIlxcdUZGMDhcXHU2Q0U4XFx1NjEwRlxcdUZGMUFcXHU1RjUzXFx1NTI0RCBWMi4yIFxcdTVGMTVcXHU2NENFXFx1NEUzQVxcdTUzNTVcXHU3RUJGXFx1N0EwQlxcdTZENDFcXHU2QzM0XFx1N0VCRlxcdUZGMENcXHU2QjY0XFx1OEJCRVxcdTdGNkVcXHU2NjgyXFx1NjcyQVxcdTc1MUZcXHU2NTQ4XFx1RkYwOVwiKS5hZGRUZXh0KCh0ZXh0KSA9PiB0ZXh0LnNldFZhbHVlKFN0cmluZyh0aGlzLnBsdWdpbi5zZXR0aW5ncy5tYXhfd29ya2VycykpLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgY29uc3QgbnVtID0gcGFyc2VJbnQodmFsdWUsIDEwKTtcbiAgICAgIGlmICghaXNOYU4obnVtKSAmJiBudW0gPiAwKSB7XG4gICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm1heF93b3JrZXJzID0gbnVtO1xuICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgIH1cbiAgICB9KSk7XG4gICAgbmV3IGltcG9ydF9vYnNpZGlhbjIuU2V0dGluZyhjb250YWluZXJFbCkuc2V0TmFtZShcIlxcdTc1MUZcXHU2MjEwXFx1NjI3OVxcdTU5MDRcXHU3NDA2XFx1NTkyN1xcdTVDMEZcIikuc2V0RGVzYyhcIlxcdTVGMTVcXHU2NENFXFx1NkJDRlxcdTRFMDBcXHU4RjZFXFx1NEVDRVxcdTIwMUNcXHU1Rjg1XFx1NzUxRlxcdTYyMTBcXHU5NjFGXFx1NTIxN1xcdTIwMURcXHU0RTJEXFx1NTNENlxcdTUxRkFcXHU3Njg0XFx1NEVGQlxcdTUyQTFcXHU2NTcwXFx1OTFDRlxcdTMwMDJcIikuYWRkVGV4dCgodGV4dCkgPT4gdGV4dC5zZXRWYWx1ZShTdHJpbmcodGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhdGlvbl9iYXRjaF9zaXplKSkub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICBjb25zdCBudW0gPSBwYXJzZUludCh2YWx1ZSwgMTApO1xuICAgICAgaWYgKCFpc05hTihudW0pICYmIG51bSA+IDApIHtcbiAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhdGlvbl9iYXRjaF9zaXplID0gbnVtO1xuICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgIH1cbiAgICB9KSk7XG4gICAgbmV3IGltcG9ydF9vYnNpZGlhbjIuU2V0dGluZyhjb250YWluZXJFbCkuc2V0TmFtZShcIlxcdTZCQ0ZcXHU4RjZFXFx1OEJGN1xcdTZDNDJcXHU1RUY2XFx1OEZERiAoXFx1NzlEMilcIikuc2V0RGVzYyhcIlxcdTVGMTVcXHU2NENFXFx1NTcyOFxcdTU5MDRcXHU3NDA2XFx1NUI4Q1xcdTRFMDBcXHU0RTJBXFx1NjI3OVxcdTZCMjFcXHU1NDBFXFx1RkYwQ1xcdTdCNDlcXHU1Rjg1XFx1NTkxQVxcdTVDMTFcXHU3OUQyXFx1NTE4RFxcdTVGMDBcXHU1OUNCXFx1NEUwQlxcdTRFMDBcXHU0RTJBXFx1NjI3OVxcdTZCMjFcXHUzMDAyXCIpLmFkZFRleHQoKHRleHQpID0+IHRleHQuc2V0VmFsdWUoU3RyaW5nKHRoaXMucGx1Z2luLnNldHRpbmdzLnJlcXVlc3RfZGVsYXkpKS5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgIGNvbnN0IG51bSA9IHBhcnNlSW50KHZhbHVlLCAxMCk7XG4gICAgICBpZiAoIWlzTmFOKG51bSkgJiYgbnVtID49IDApIHtcbiAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucmVxdWVzdF9kZWxheSA9IG51bTtcbiAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICB9XG4gICAgfSkpO1xuICAgIG5ldyBpbXBvcnRfb2JzaWRpYW4yLlNldHRpbmcoY29udGFpbmVyRWwpLnNldE5hbWUoXCJcXHU2NzAwXFx1NTkyN1xcdTRGRUVcXHU2QjYzXFx1NkIyMVxcdTY1NzBcIikuc2V0RGVzYyhcIlxcdTRFMDBcXHU3QkM3XFx1N0IxNFxcdThCQjBcXHU1NzI4XFx1ODhBQlxcdTY1M0VcXHU1RjAzXFx1RkYwOFxcdTc5RkJcXHU1MTY1IERpc2NhcmRlZCBQaWxlXFx1RkYwOVxcdTUyNERcXHVGRjBDXFx1NjcwMFxcdTU5MUFcXHU1MTQxXFx1OEJCOFxcdTg4QUJcXHU0RkVFXFx1NkI2M1xcdTc2ODRcXHU2QjIxXFx1NjU3MFxcdTMwMDJcIikuYWRkVGV4dCgodGV4dCkgPT4gdGV4dC5zZXRWYWx1ZShTdHJpbmcodGhpcy5wbHVnaW4uc2V0dGluZ3MubWF4X3JldmlzaW9uX3JldHJpZXMpKS5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgIGNvbnN0IG51bSA9IHBhcnNlSW50KHZhbHVlLCAxMCk7XG4gICAgICBpZiAoIWlzTmFOKG51bSkgJiYgbnVtID49IDApIHtcbiAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubWF4X3JldmlzaW9uX3JldHJpZXMgPSBudW07XG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgfVxuICAgIH0pKTtcbiAgICBuZXcgaW1wb3J0X29ic2lkaWFuMi5TZXR0aW5nKGNvbnRhaW5lckVsKS5zZXROYW1lKFwiXFx1ODFFQVxcdTUyQThcXHU2M0QwXFx1NTNENlxcdTY1QjBcXHU2OTgyXFx1NUZGNSAoRXh0cmFjdCBOZXcgQ29uY2VwdHMpXCIpLnNldERlc2MoXCJcXHU1RjAwXFx1NTQyRlxcdTU0MEVcXHVGRjBDXFx1NUMwNlxcdTgxRUFcXHU1MkE4XFx1NEVDRVxcdTVERjJcXHU2Mjc5XFx1NTFDNlxcdTdCMTRcXHU4QkIwXFx1NzY4NFxcdTUxODVcXHU1QkI5XFx1NEUyRFxcdTYzRDBcXHU1M0Q2IFtbV2lraWxpbmtzXV0gXFx1NEY1Q1xcdTRFM0FcXHU2NUIwXFx1Njk4MlxcdTVGRjVcXHU1MkEwXFx1NTE2NVxcdTIwMUNcXHU1Rjg1XFx1NzUxRlxcdTYyMTBcXHU5NjFGXFx1NTIxN1xcdTIwMURcXHUzMDAyKFxcdTlFRDhcXHU4QkE0XFx1NTE3M1xcdTk1RUQpXCIpLmFkZFRvZ2dsZShcbiAgICAgICh0b2dnbGUpID0+IHRvZ2dsZS5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5leHRyYWN0X25ld19jb25jZXB0cykub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmV4dHJhY3RfbmV3X2NvbmNlcHRzID0gdmFsdWU7XG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgfSlcbiAgICApO1xuICAgIG5ldyBpbXBvcnRfb2JzaWRpYW4yLlNldHRpbmcoY29udGFpbmVyRWwpLnNldE5hbWUoXCJcXHU1QkExXFx1NjgzOFxcdTZBMjFcXHU1RjBGIChDcml0aWMgTW9kZSlcIikuc2V0RGVzYyhcIlxcdTkwMDlcXHU2MkU5XFx1NTE4NVxcdTVCQjlcXHU1QkExXFx1NjgzOFxcdTc2ODRcXHU2NUI5XFx1NUYwRlxcdTMwMDJcXHU1NDJGXFx1NTNEMVxcdTVGMEZcXHU2QTIxXFx1NUYwRlxcdTkwMUZcXHU1RUE2XFx1NUZFQlxcdTRFMTRcXHU1MTREXFx1OEQzOVxcdUZGMENcXHU0RjQ2XFx1NTNFQVxcdTY4QzBcXHU2N0U1XFx1NjgzQ1xcdTVGMEZcXHVGRjFCQUlcXHU2QTIxXFx1NUYwRlxcdTY2RjRcXHU2NjdBXFx1ODBGRFxcdUZGMENcXHU0RjQ2XFx1NEYxQVxcdTZEODhcXHU4MDE3QVBJXFx1OTg5RFxcdTVFQTZcXHUzMDAyXCIpLmFkZERyb3Bkb3duKChkcm9wZG93bikgPT4gZHJvcGRvd24uYWRkT3B0aW9uKFwiaGV1cmlzdGljXCIsIFwiXFx1NTQyRlxcdTUzRDFcXHU1RjBGIChIZXVyaXN0aWMpXCIpLmFkZE9wdGlvbihcImFpXCIsIFwiXFx1NEVCQVxcdTVERTVcXHU2NjdBXFx1ODBGRCAoQUkpXCIpLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmNyaXRpY19tb2RlKS5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmNyaXRpY19tb2RlID0gdmFsdWU7XG4gICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgIHRoaXMuZGlzcGxheSgpO1xuICAgIH0pKTtcbiAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuY3JpdGljX21vZGUgPT09IFwiaGV1cmlzdGljXCIpIHtcbiAgICAgIG5ldyBpbXBvcnRfb2JzaWRpYW4yLlNldHRpbmcoY29udGFpbmVyRWwpLnNldE5hbWUoXCJcXHU1NDJGXFx1NTNEMVxcdTVGMEZcXHU1QkExXFx1NjgzOFxcdUZGMUFcXHU1RkM1XFx1OTg3QlxcdTc2ODRcXHU2ODA3XFx1OTg5OFwiKS5zZXREZXNjKFwiXFx1NTcyOFxcdTU0MkZcXHU1M0QxXFx1NUYwRlxcdTZBMjFcXHU1RjBGXFx1NEUwQlxcdUZGMENcXHU2OEMwXFx1NjdFNVxcdTdCMTRcXHU4QkIwXFx1NjYyRlxcdTU0MjZcXHU1MzA1XFx1NTQyQlxcdTYyNDBcXHU2NzA5XFx1OEZEOVxcdTRFOUJcXHU2ODA3XFx1OTg5OFxcdUZGMDhcXHU2QkNGXFx1ODg0Q1xcdTRFMDBcXHU0RTJBXFx1RkYwOVxcdTMwMDJcIikuYWRkVGV4dEFyZWEoKHRleHQpID0+IHRleHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuY3JpdGljX3JlcXVpcmVkX2hlYWRlcnMpLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jcml0aWNfcmVxdWlyZWRfaGVhZGVycyA9IHZhbHVlO1xuICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgIH0pLmlucHV0RWwuc3R5bGUuaGVpZ2h0ID0gXCIxNTBweFwiKTtcbiAgICAgIG5ldyBpbXBvcnRfb2JzaWRpYW4yLlNldHRpbmcoY29udGFpbmVyRWwpLnNldE5hbWUoXCJcXHU1NDJGXFx1NTNEMVxcdTVGMEZcXHU1QkExXFx1NjgzOFxcdUZGMUFcXHU2NzAwXFx1NUMwRlxcdTUxODVcXHU1QkI5XFx1OTU3RlxcdTVFQTZcIikuc2V0RGVzYyhcIlxcdTU3MjhcXHU1NDJGXFx1NTNEMVxcdTVGMEZcXHU2QTIxXFx1NUYwRlxcdTRFMEJcXHVGRjBDXFx1N0IxNFxcdThCQjBcXHU1MTg1XFx1NUJCOVxcdTVGQzVcXHU5ODdCXFx1OEZCRVxcdTUyMzBcXHU3Njg0XFx1NjcwMFxcdTVDMEZcXHU1QjU3XFx1N0IyNlxcdTY1NzBcXHUzMDAyXCIpLmFkZFRleHQoKHRleHQpID0+IHRleHQuc2V0VmFsdWUoU3RyaW5nKHRoaXMucGx1Z2luLnNldHRpbmdzLmNyaXRpY19taW5fY29udGVudF9sZW5ndGgpKS5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgY29uc3QgbnVtID0gcGFyc2VJbnQodmFsdWUsIDEwKTtcbiAgICAgICAgaWYgKCFpc05hTihudW0pICYmIG51bSA+PSAwKSB7XG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3JpdGljX21pbl9jb250ZW50X2xlbmd0aCA9IG51bTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgfVxuICAgICAgfSkpO1xuICAgIH1cbiAgICBuZXcgaW1wb3J0X29ic2lkaWFuMi5TZXR0aW5nKGNvbnRhaW5lckVsKS5zZXROYW1lKFwiXFx1Njk4MlxcdTVGRjVcXHU2NEFEXFx1NzlDRCAoQ29uY2VwdCBTZWVkaW5nKVwiKS5zZXRIZWFkaW5nKCk7XG4gICAgbmV3IGltcG9ydF9vYnNpZGlhbjIuU2V0dGluZyhjb250YWluZXJFbCkuc2V0TmFtZShcIlxcdTY5ODJcXHU1RkY1XFx1NjRBRFxcdTc5Q0RcXHU3QkIxXCIpLnNldERlc2MoXCJcXHU1NzI4XFx1NkI2NFxcdTU5MDRcXHU3Qzk4XFx1OEQzNFxcdTYyMTZcXHU4RjkzXFx1NTE2NVxcdTYwQThcXHU2MEYzXFx1ODk4MVxcdTc1MUZcXHU2MjEwXFx1NTIxRFxcdTU5Q0JcXHU3QjE0XFx1OEJCMFxcdTc2ODRcXHU2OTgyXFx1NUZGNVxcdTUyMTdcXHU4ODY4XFx1RkYwQ1xcdTZCQ0ZcXHU4ODRDXFx1NEUwMFxcdTRFMkFcXHU2OTgyXFx1NUZGNVxcdTMwMDJcIikuYWRkVGV4dEFyZWEoXG4gICAgICAodGV4dCkgPT4gdGV4dC5zZXRQbGFjZWhvbGRlcihcIlxcdTRGOEJcXHU1OTgyXFx1RkYxQVxcblxcdTdCMkNcXHU0RTAwXFx1NjAyN1xcdTUzOUZcXHU3NDA2XFxuXFx1NTk2NVxcdTUzNjFcXHU1OUM2XFx1NTI0M1xcdTUyMDBcXG5cXHU1MjNCXFx1NjEwRlxcdTdFQzNcXHU0RTYwXFxuLi4uXCIpLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnNlZWRDb25jZXB0cykub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnNlZWRDb25jZXB0cyA9IHZhbHVlO1xuICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgIH0pLmlucHV0RWwuc3R5bGUuaGVpZ2h0ID0gXCIyMDBweFwiXG4gICAgKTtcbiAgICBuZXcgaW1wb3J0X29ic2lkaWFuMi5TZXR0aW5nKGNvbnRhaW5lckVsKS5hZGRCdXR0b24oXG4gICAgICAoYnV0dG9uKSA9PiBidXR0b24uc2V0QnV0dG9uVGV4dChcIlxcdTY0QURcXHU3OUNEXFx1NTIzMFxcdTVGODVcXHU3NTFGXFx1NjIxMFxcdTk2MUZcXHU1MjE3XCIpLnNldEN0YSgpLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCByYXdUZXh0ID0gdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VlZENvbmNlcHRzO1xuICAgICAgICBpZiAoIXJhd1RleHQudHJpbSgpKSB7XG4gICAgICAgICAgbmV3IGltcG9ydF9vYnNpZGlhbjIuTm90aWNlKFwiXFx1NjRBRFxcdTc5Q0RcXHU3QkIxXFx1NEUzQVxcdTdBN0FcXHVGRjBDXFx1NjVFMFxcdTk3MDBcXHU2NENEXFx1NEY1Q1xcdTMwMDJcIik7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNvbmNlcHRzVG9TZWVkID0gWy4uLm5ldyBTZXQocmF3VGV4dC5zcGxpdChcIlxcblwiKS5tYXAoKGxpbmUpID0+IGxpbmUudHJpbSgpKS5maWx0ZXIoQm9vbGVhbikpXTtcbiAgICAgICAgY29uc3QgYWRkZWRDb3VudCA9IHRoaXMucGx1Z2luLmVuZ2luZS5hZGRDb25jZXB0c1RvUXVldWUoY29uY2VwdHNUb1NlZWQpO1xuICAgICAgICBjb25zdCBpZ25vcmVkQ291bnQgPSBjb25jZXB0c1RvU2VlZC5sZW5ndGggLSBhZGRlZENvdW50O1xuICAgICAgICBsZXQgbm90aWNlTWVzc2FnZSA9IGBcXHU2MjEwXFx1NTI5RlxcdTZERkJcXHU1MkEwICR7YWRkZWRDb3VudH0gXFx1NEUyQVxcdTY1QjBcXHU2OTgyXFx1NUZGNVxcdTUyMzBcXHU5NjFGXFx1NTIxN1xcdTMwMDJgO1xuICAgICAgICBpZiAoaWdub3JlZENvdW50ID4gMCkge1xuICAgICAgICAgIG5vdGljZU1lc3NhZ2UgKz0gYFxuJHtpZ25vcmVkQ291bnR9IFxcdTRFMkFcXHU2OTgyXFx1NUZGNVxcdTU2RTBcXHU1REYyXFx1NUI1OFxcdTU3MjhcXHU2MjE2XFx1OTFDRFxcdTU5MERcXHU4MDBDXFx1ODhBQlxcdTVGRkRcXHU3NTY1XFx1MzAwMmA7XG4gICAgICAgIH1cbiAgICAgICAgbmV3IGltcG9ydF9vYnNpZGlhbjIuTm90aWNlKG5vdGljZU1lc3NhZ2UsIDVlMyk7XG4gICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnNlZWRDb25jZXB0cyA9IFwiXCI7XG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICB0aGlzLmRpc3BsYXkoKTtcbiAgICAgIH0pXG4gICAgKTtcbiAgICBuZXcgaW1wb3J0X29ic2lkaWFuMi5TZXR0aW5nKGNvbnRhaW5lckVsKS5zZXROYW1lKFwiUHJvbXB0cyBcXHU4QkJFXFx1N0Y2RVwiKS5zZXRIZWFkaW5nKCk7XG4gICAgbmV3IGltcG9ydF9vYnNpZGlhbjIuU2V0dGluZyhjb250YWluZXJFbCkuc2V0TmFtZShcIlxcdTc1MUZcXHU2MjEwIFByb21wdFwiKS5zZXREZXNjKFwiXFx1NzUyOFxcdTRFOEVcXHU3NTFGXFx1NjIxMFxcdTY1QjBcXHU2OTgyXFx1NUZGNVxcdTUxODVcXHU1QkI5XFx1NzY4NCBQcm9tcHRcXHUzMDAyXCIpLmFkZFRleHRBcmVhKCh0ZXh0KSA9PiB0ZXh0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnByb21wdF9nZW5lcmF0b3IpLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvbXB0X2dlbmVyYXRvciA9IHZhbHVlO1xuICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgfSkuaW5wdXRFbC5zdHlsZS5oZWlnaHQgPSBcIjMwMHB4XCIpO1xuICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jcml0aWNfbW9kZSA9PT0gXCJhaVwiKSB7XG4gICAgICBuZXcgaW1wb3J0X29ic2lkaWFuMi5TZXR0aW5nKGNvbnRhaW5lckVsKS5zZXROYW1lKFwiXFx1NUJBMVxcdTY4MzggUHJvbXB0IChDcml0aWMpXCIpLnNldERlc2MoXCJcXHU3NTI4XFx1NEU4RSBBSSBcXHU2QTIxXFx1NUYwRlxcdTRFMEJcXHU1QkExXFx1NjgzOFxcdTc1MUZcXHU2MjEwXFx1NTE4NVxcdTVCQjlcXHU3Njg0IFByb21wdFxcdTMwMDJcIikuYWRkVGV4dEFyZWEoKHRleHQpID0+IHRleHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvbXB0X2NyaXRpYykub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnByb21wdF9jcml0aWMgPSB2YWx1ZTtcbiAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICB9KS5pbnB1dEVsLnN0eWxlLmhlaWdodCA9IFwiMzAwcHhcIik7XG4gICAgfVxuICAgIG5ldyBpbXBvcnRfb2JzaWRpYW4yLlNldHRpbmcoY29udGFpbmVyRWwpLnNldE5hbWUoXCJcXHU0RkVFXFx1NkI2MyBQcm9tcHQgKFJldmlzZXIpXCIpLnNldERlc2MoXCJcXHU3NTI4XFx1NEU4RVxcdTRGRUVcXHU2QjYzXFx1ODhBQlxcdTVCQTFcXHU2ODM4XFx1NTQ1OFxcdTYyRDJcXHU3RUREXFx1NTE4NVxcdTVCQjlcXHU3Njg0IFByb21wdFxcdTMwMDJcIikuYWRkVGV4dEFyZWEoKHRleHQpID0+IHRleHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvbXB0X3JldmlzZXIpLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvbXB0X3JldmlzZXIgPSB2YWx1ZTtcbiAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgIH0pLmlucHV0RWwuc3R5bGUuaGVpZ2h0ID0gXCIzMDBweFwiKTtcbiAgfVxufTtcbiIsICIvLyBlbmdpbmUudHNcblxuaW1wb3J0IHsgTm90aWNlLCBURmlsZSwgVEZvbGRlciwgbm9ybWFsaXplUGF0aCwgQXBwIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgS25vd2xlZGdlR3JhcGhQbHVnaW4gZnJvbSBcIi4vbWFpblwiO1xuaW1wb3J0IHsgQVBJSGFuZGxlciwgQWxsTW9kZWxzRmFpbGVkRXJyb3IgfSBmcm9tIFwiLi9hcGlIYW5kbGVyXCI7XG5pbXBvcnQgeyBDcml0aWMgfSBmcm9tIFwiLi9jcml0aWNcIjtcbmltcG9ydCB7IFJldmlzZXIgfSBmcm9tIFwiLi9yZXZpc2VyXCI7XG5pbXBvcnQgeyBzYW5pdGl6ZUZpbGVuYW1lLCBleHRyYWN0TmV3SWRlYXMsIGNsZWFuTWFya2Rvd25PdXRwdXQgfSBmcm9tIFwiLi91dGlsc1wiO1xuLy8gXHU1QkZDXHU1MTY1IFRhc2tEYXRhIFx1N0M3Qlx1NTc4QlxuaW1wb3J0IHsgVGFza0RhdGEgfSBmcm9tIFwiLi90eXBlc1wiO1xuXG5leHBvcnQgY2xhc3MgRW5naW5lIHtcbiAgICBwbHVnaW46IEtub3dsZWRnZUdyYXBoUGx1Z2luO1xuICAgIGFwcDogQXBwO1xuICAgIGFwaUhhbmRsZXI6IEFQSUhhbmRsZXI7XG4gICAgY3JpdGljOiBDcml0aWM7XG4gICAgcmV2aXNlcjogUmV2aXNlcjtcbiAgICBwcml2YXRlIGlzUnVubmluZzogYm9vbGVhbiA9IGZhbHNlO1xuICAgIHByaXZhdGUgdGltZXJJZDogTm9kZUpTLlRpbWVvdXQgfCBudWxsID0gbnVsbDtcblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogS25vd2xlZGdlR3JhcGhQbHVnaW4pIHtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgICAgIHRoaXMuYXBwID0gcGx1Z2luLmFwcDtcbiAgICAgICAgdGhpcy5hcGlIYW5kbGVyID0gbmV3IEFQSUhhbmRsZXIocGx1Z2luKTtcbiAgICAgICAgdGhpcy5jcml0aWMgPSBuZXcgQ3JpdGljKHBsdWdpbik7XG4gICAgICAgIHRoaXMucmV2aXNlciA9IG5ldyBSZXZpc2VyKHBsdWdpbik7XG4gICAgfVxuXG4gICAgLy8gLS0tIFB1YmxpYyBDb250cm9scyAtLS1cbiAgICAvKipcbiAgICAgKiBcdTUyMDdcdTYzNjJcdTVGMTVcdTY0Q0VcdTc2ODRcdThGRDBcdTg4NEMvXHU2NjgyXHU1MDVDXHU3MkI2XHU2MDAxXG4gICAgICovXG4gICAgcHVibGljIHRvZ2dsZUVuZ2luZVN0YXRlKCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5pc1J1bm5pbmcpIHtcbiAgICAgICAgICAgIHRoaXMuc3RvcCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zdGFydCgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogXHU2REZCXHU1MkEwXHU1MzU1XHU0RTJBXHU2OTgyXHU1RkY1XHU1MjMwXHU5NjFGXHU1MjE3XHVGRjBDXHU1RTc2XHU2NjNFXHU3OTNBXHU5MDFBXHU3N0U1XG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFx1NjYyRlx1NTQyNlx1NjIxMFx1NTI5Rlx1NkRGQlx1NTJBMFxuICAgICAqL1xuICAgIHB1YmxpYyBhZGRDb25jZXB0VG9RdWV1ZShjb25jZXB0OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgYWRkZWQgPSB0aGlzLmFkZENvbmNlcHRzVG9RdWV1ZShbY29uY2VwdF0pO1xuICAgICAgICBpZiAoYWRkZWQgPiAwKSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKGAnJHtjb25jZXB0fScgXHU1REYyXHU2REZCXHU1MkEwXHU1MjMwXHU3NTFGXHU2MjEwXHU5NjFGXHU1MjE3XHUzMDAyYCk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVN0YXR1c0JhcigpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgbmV3IE5vdGljZShgJyR7Y29uY2VwdH0nIFx1NURGMlx1NUI1OFx1NTcyOFx1NEU4RVx1OTYxRlx1NTIxN1x1NjIxNlx1NEVEM1x1NUU5M1x1NEUyRFx1RkYwQ1x1NjcyQVx1NkRGQlx1NTJBMFx1MzAwMmApO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogXHU2REZCXHU1MkEwXHU1OTFBXHU0RTJBXHU2OTgyXHU1RkY1XHU1MjMwXHU3NTFGXHU2MjEwXHU5NjFGXHU1MjE3XHVGRjBDXHU0RjFBXHU4RkRCXHU4ODRDXHU1M0JCXHU5MUNEXHU1NDhDXHU2OEMwXHU2N0U1XHU2NTg3XHU0RUY2XHU2NjJGXHU1NDI2XHU1QjU4XHU1NzI4XG4gICAgICogQHBhcmFtIHtzdHJpbmdbXX0gY29uY2VwdHMgLSBcdTg5ODFcdTZERkJcdTUyQTBcdTc2ODRcdTY5ODJcdTVGRjVcdTUyMTdcdTg4NjhcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBcdTVCOUVcdTk2NDVcdTZERkJcdTUyQTBcdTc2ODRcdTY1QjBcdTY5ODJcdTVGRjVcdTY1NzBcdTkxQ0ZcbiAgICAgKi9cbiAgICBwdWJsaWMgYWRkQ29uY2VwdHNUb1F1ZXVlKGNvbmNlcHRzOiBzdHJpbmdbXSk6IG51bWJlciB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRRdWV1ZSA9IG5ldyBTZXQodGhpcy5wbHVnaW4uZGF0YS5nZW5lcmF0aW9uUXVldWUpO1xuICAgICAgICAvLyBcdTgzQjdcdTUzRDZcdTRFMDBcdTRFMkFTZXRcdUZGMENcdTUzMDVcdTU0MkJcdTYyNDBcdTY3MDlcdTVERjJcdTVCNThcdTU3MjhcdTdCMTRcdThCQjBcdTc2ODQgYmFzZW5hbWUgKFx1NjVFMCAubWQgXHU1NDBFXHU3RjAwKVxuICAgICAgICBjb25zdCBleGlzdGluZ0ZpbGVzID0gbmV3IFNldCh0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCkubWFwKGYgPT4gZi5iYXNlbmFtZSkpO1xuXG4gICAgICAgIGxldCBhZGRlZENvdW50ID0gMDtcbiAgICAgICAgZm9yIChjb25zdCBjb25jZXB0IG9mIGNvbmNlcHRzKSB7XG4gICAgICAgICAgICBjb25zdCBzYW5pdGl6ZWQgPSBzYW5pdGl6ZUZpbGVuYW1lKGNvbmNlcHQpO1xuICAgICAgICAgICAgLy8gXHU2OEMwXHU2N0U1XHVGRjFBMS4gXHU5NjFGXHU1MjE3XHU0RTJEXHU2Q0ExXHU2NzA5IDIuIFx1NEVEM1x1NUU5M1x1NEUyRFx1NEU1Rlx1NkNBMVx1NjcwOVx1NTQwQ1x1NTQwRFx1NjU4N1x1NEVGNlxuICAgICAgICAgICAgaWYgKCFjdXJyZW50UXVldWUuaGFzKGNvbmNlcHQpICYmICFleGlzdGluZ0ZpbGVzLmhhcyhzYW5pdGl6ZWQpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5nZW5lcmF0aW9uUXVldWUucHVzaChjb25jZXB0KTtcbiAgICAgICAgICAgICAgICBjdXJyZW50UXVldWUuYWRkKGNvbmNlcHQpOyAvLyBcdTRGRERcdTYzMDEgU2V0IFx1NTQwQ1x1NkI2NVx1RkYwQ1x1NzUyOFx1NEU4RVx1NTM1NVx1NkIyMVx1OEZEMFx1ODg0Q1x1NEUyRFx1NzY4NFx1NTNCQlx1OTFDRFxuICAgICAgICAgICAgICAgIGFkZGVkQ291bnQrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChhZGRlZENvdW50ID4gMCkge1xuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVBsdWdpbkRhdGEoKTsgLy8gXHU0RkREXHU1QjU4XHU1REYyXHU2NkY0XHU2NUIwXHU3Njg0XHU5NjFGXHU1MjE3XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVN0YXR1c0JhcigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhZGRlZENvdW50O1xuICAgIH1cblxuICAgIC8vIC0tLSBDb3JlIExvb3AgLS0tXG4gICAgLyoqXG4gICAgICogXHU1NDJGXHU1MkE4XHU1RjE1XHU2NENFXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBzdGFydCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKHRoaXMuaXNSdW5uaW5nKSByZXR1cm47XG4gICAgICAgIHRoaXMuaXNSdW5uaW5nID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5zdGF0dXMgPSBcInJ1bm5pbmdcIjtcbiAgICAgICAgbmV3IE5vdGljZShcIlx1NzdFNVx1OEJDNlx1NTZGRVx1OEMzMVx1NUYxNVx1NjRDRVx1NURGMlx1NTQyRlx1NTJBOFx1RkYwMVwiKTtcbiAgICAgICAgdGhpcy51cGRhdGVTdGF0dXNCYXIoKTtcbiAgICAgICAgLy8gXHU3QUNCXHU1MzczXHU1RjAwXHU1OUNCXHU3QjJDXHU0RTAwXHU0RTJBIHRpY2tcbiAgICAgICAgdGhpcy50aWNrKCk7IFxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFx1NTA1Q1x1NkI2Mlx1NUYxNVx1NjRDRVxuICAgICAqL1xuICAgIHByaXZhdGUgc3RvcCgpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzUnVubmluZykgcmV0dXJuO1xuICAgICAgICB0aGlzLmlzUnVubmluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLnN0YXR1cyA9IFwicGF1c2VkXCI7XG4gICAgICAgIGlmICh0aGlzLnRpbWVySWQpIHtcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVySWQpO1xuICAgICAgICAgICAgdGhpcy50aW1lcklkID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBuZXcgTm90aWNlKFwiXHU3N0U1XHU4QkM2XHU1NkZFXHU4QzMxXHU1RjE1XHU2NENFXHU1REYyXHU2NjgyXHU1MDVDXHUzMDAyXCIpO1xuICAgICAgICB0aGlzLnVwZGF0ZVN0YXR1c0JhcigpO1xuICAgICAgICB0aGlzLnBsdWdpbi5zYXZlUGx1Z2luRGF0YSgpOyAvLyBcdTU3MjhcdTY2ODJcdTUwNUNcdTY1RjZcdTRGRERcdTVCNThcdTcyQjZcdTYwMDFcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBcdTVCODlcdTYzOTJcdTRFMEJcdTRFMDBcdTRFMkEgdGlja1xuICAgICAqL1xuICAgIHByaXZhdGUgc2NoZWR1bGVOZXh0VGljaygpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzUnVubmluZykgcmV0dXJuO1xuICAgICAgICBjb25zdCBkZWxheSA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnJlcXVlc3RfZGVsYXkgKiAxMDAwO1xuICAgICAgICB0aGlzLnRpbWVySWQgPSBzZXRUaW1lb3V0KCgpID0+IHRoaXMudGljaygpLCBkZWxheSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogXHU1RjE1XHU2NENFXHU3Njg0XHU2ODM4XHU1RkMzXHUyMDFDXHU1RkMzXHU4REYzXHUyMDFEXG4gICAgICogXHU1QjgzXHU0RjFBXHU2MzA5XHU0RjE4XHU1MTQ4XHU3RUE3XHVGRjA4XHU0RkVFXHU2QjYzID4gXHU1QkExXHU2ODM4ID4gXHU3NTFGXHU2MjEwXHVGRjA5XHU1OTA0XHU3NDA2XHU0RTAwXHU0RTJBXHU2Mjc5XHU2QjIxXHU3Njg0XHU0RUZCXHU1MkExXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyB0aWNrKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAoIXRoaXMuaXNSdW5uaW5nKSByZXR1cm47XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGxldCB0YXNrUHJvY2Vzc2VkID0gZmFsc2U7XG5cbiAgICAgICAgICAgIC8vIDEuIFx1NEYxOFx1NTE0OFx1NTkwNFx1NzQwNlx1NEZFRVx1NkI2M1x1OTYxRlx1NTIxN1xuICAgICAgICAgICAgaWYgKHRoaXMucGx1Z2luLmRhdGEucmV2aXNpb25RdWV1ZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgdGFza1Byb2Nlc3NlZCA9IGF3YWl0IHRoaXMucnVuUmV2aXNpb25QaGFzZSgpO1xuICAgICAgICAgICAgfSBcbiAgICAgICAgICAgIC8vIDIuIFx1NTE3Nlx1NkIyMVx1NTkwNFx1NzQwNlx1NUJBMVx1NjgzOFx1OTYxRlx1NTIxN1xuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5wbHVnaW4uZGF0YS5yZXZpZXdRdWV1ZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgdGFza1Byb2Nlc3NlZCA9IGF3YWl0IHRoaXMucnVuQ3JpdGljUGhhc2UoKTtcbiAgICAgICAgICAgIH0gXG4gICAgICAgICAgICAvLyAzLiBcdTY3MDBcdTU0MEVcdTU5MDRcdTc0MDZcdTc1MUZcdTYyMTBcdTk2MUZcdTUyMTdcbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMucGx1Z2luLmRhdGEuZ2VuZXJhdGlvblF1ZXVlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICB0YXNrUHJvY2Vzc2VkID0gYXdhaXQgdGhpcy5ydW5HZW5lcmF0aW9uUGhhc2UoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gXHU2OEMwXHU2N0U1XHU2NjJGXHU1NDI2XHU2MjQwXHU2NzA5XHU5NjFGXHU1MjE3XHU5MEZEXHU1REYyXHU2RTA1XHU3QTdBXG4gICAgICAgICAgICBpZiAoIXRhc2tQcm9jZXNzZWQgJiZcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLmdlbmVyYXRpb25RdWV1ZS5sZW5ndGggPT09IDAgJiZcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLnJldmlld1F1ZXVlLmxlbmd0aCA9PT0gMCAmJlxuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmRhdGEucmV2aXNpb25RdWV1ZS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKFwiXHVEODNDXHVERjg5IFx1NjI0MFx1NjcwOVx1NEVGQlx1NTJBMVx1NUI4Q1x1NjIxMFx1RkYwMVx1NUYxNVx1NjRDRVx1NURGMlx1NTA1Q1x1NkI2Mlx1MzAwMlwiKTtcbiAgICAgICAgICAgICAgICB0aGlzLmlzUnVubmluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmRhdGEuc3RhdHVzID0gXCJpZGxlXCI7IC8vIFx1OEJCRVx1NEUzQVx1N0E3QVx1OTVGMlx1NzJCNlx1NjAwMVxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlU3RhdHVzQmFyKCk7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVBsdWdpbkRhdGEoKTsgLy8gXHU0RkREXHU1QjU4XHU2NzAwXHU3RUM4XHU3MkI2XHU2MDAxXG4gICAgICAgICAgICAgICAgcmV0dXJuOyAvLyBcdTUwNUNcdTZCNjIgdGljayBcdTVGQUFcdTczQUZcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIlx1NUYxNVx1NjRDRSBUaWNrIFx1NTNEMVx1NzUxRlx1NEUyNVx1OTFDRFx1OTUxOVx1OEJFRjpcIiwgZXJyb3IpO1xuICAgICAgICAgICAgbmV3IE5vdGljZShcIlx1NUYxNVx1NjRDRVx1OTA0N1x1NTIzMFx1OTUxOVx1OEJFRlx1RkYwQ1x1NURGMlx1NjY4Mlx1NTA1Q1x1MzAwMlx1OEJGN1x1NjhDMFx1NjdFNVx1NjNBN1x1NTIzNlx1NTNGMFx1MzAwMlwiKTtcbiAgICAgICAgICAgIHRoaXMuc3RvcCgpOyAvLyBcdTUzRDFcdTc1MUZcdTRFMjVcdTkxQ0RcdTk1MTlcdThCRUZcdTY1RjZcdTUwNUNcdTZCNjJcdTVGMTVcdTY0Q0VcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFx1NTk4Mlx1Njc5Q1x1NUYxNVx1NjRDRVx1NEVDRFx1NTcyOFx1OEZEMFx1ODg0Q1x1RkYwQ1x1NTIxOVx1NUI4OVx1NjM5Mlx1NEUwQlx1NEUwMFx1NkIyMVx1NUZDM1x1OERGM1xuICAgICAgICB0aGlzLnNjaGVkdWxlTmV4dFRpY2soKTtcbiAgICB9XG5cbiAgICAvLyAtLS0gUGhhc2VzIC0tLVxuICAgIC8qKlxuICAgICAqIFx1OEZEMFx1ODg0Q1x1MjAxQ1x1NzUxRlx1NjIxMFx1MjAxRFx1OTYzNlx1NkJCNVxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPGJvb2xlYW4+fSBcdTY2MkZcdTU0MjZcdTU5MDRcdTc0MDZcdTRFODZcdTRFRkJcdTUyQTFcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIHJ1bkdlbmVyYXRpb25QaGFzZSgpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICAgICAgY29uc3QgcXVldWUgPSB0aGlzLnBsdWdpbi5kYXRhLmdlbmVyYXRpb25RdWV1ZTtcbiAgICAgICAgaWYgKHF1ZXVlLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgIGNvbnN0IGJhdGNoU2l6ZSA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYXRpb25fYmF0Y2hfc2l6ZTtcbiAgICAgICAgLy8gXHU1M0Q2XHU1MUZBXHU0RTAwXHU0RTJBXHU2Mjc5XHU2QjIxXHU3Njg0XHU0RUZCXHU1MkExXG4gICAgICAgIGNvbnN0IGJhdGNoID0gcXVldWUuc3BsaWNlKDAsIE1hdGgubWluKHF1ZXVlLmxlbmd0aCwgYmF0Y2hTaXplKSk7XG5cbiAgICAgICAgdGhpcy51cGRhdGVTdGF0dXNCYXIoKTtcbiAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVBsdWdpbkRhdGEoKTsgLy8gXHU0RkREXHU1QjU4XHU1REYyXHU1M0Q2XHU1MUZBXHU0RUZCXHU1MkExXHU3Njg0XHU5NjFGXHU1MjE3XG5cbiAgICAgICAgLy8gXHU1RTc2XHU4ODRDXHU1OTA0XHU3NDA2XHU4RkQ5XHU0RTAwXHU2Mjc5XHU2QjIxXHU3Njg0XHU2MjQwXHU2NzA5XHU0RUZCXHU1MkExXG4gICAgICAgIGNvbnN0IHRhc2tzID0gYmF0Y2gubWFwKGlkZWEgPT4gdGhpcy5nZW5lcmF0aW9uVGFzayhpZGVhKSk7XG4gICAgICAgIGF3YWl0IFByb21pc2UuYWxsU2V0dGxlZCh0YXNrcyk7XG5cbiAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVBsdWdpbkRhdGEoKTsgLy8gXHU0RkREXHU1QjU4XHVGRjA4XHU1M0VGXHU4MEZEXHVGRjA5XHU1REYyXHU2M0E4XHU1MTY1XHU1QkExXHU2ODM4XHU5NjFGXHU1MjE3XHU3Njg0XHU2NUIwXHU2NTcwXHU2MzZFXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFx1NTM1NVx1NEUyQVx1NzUxRlx1NjIxMFx1NEVGQlx1NTJBMVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGlvblRhc2soaWRlYTogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnByb21wdF9nZW5lcmF0b3IucmVwbGFjZShcIntjb25jZXB0fVwiLCBpZGVhKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwaUhhbmRsZXIuY2FsbChwcm9tcHQpO1xuICAgICAgICAgICAgY29uc3QgY2xlYW5lZENvbnRlbnQgPSBjbGVhbk1hcmtkb3duT3V0cHV0KGNvbnRlbnQpO1xuICAgICAgICAgICAgLy8gXHU2MjEwXHU1MjlGXHU1NDBFXHVGRjBDXHU2M0E4XHU1MTY1XHU1QkExXHU2ODM4XHU5NjFGXHU1MjE3XG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLnJldmlld1F1ZXVlLnB1c2goeyBpZGVhLCBjb250ZW50OiBjbGVhbmVkQ29udGVudCB9KTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBcdTI3MDUgW1x1NzUxRlx1NjIxMFx1NjIxMFx1NTI5Rl06ICR7aWRlYX1gKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBBbGxNb2RlbHNGYWlsZWRFcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYFx1Mjc0QyBbXHU3NTFGXHU2MjEwXHU1OTMxXHU4RDI1XTogJHtpZGVhfSAtICR7ZS5tZXNzYWdlfWApO1xuICAgICAgICAgICAgICAgIC8vIFx1NTkzMVx1OEQyNVx1NTQwRVx1RkYwQ1x1NjUzRVx1NTZERVx1OTYxRlx1NTIxN1x1NTkzNFx1OTBFOFx1RkYwQ1x1NEVFNVx1NEZCRlx1NEUwQlx1NkIyMVx1OTFDRFx1OEJENVxuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmRhdGEuZ2VuZXJhdGlvblF1ZXVlLnVuc2hpZnQoaWRlYSk7IFxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogXHU4RkQwXHU4ODRDXHUyMDFDXHU1QkExXHU2ODM4XHUyMDFEXHU5NjM2XHU2QkI1XG4gICAgICogQHJldHVybnMge1Byb21pc2U8Ym9vbGVhbj59IFx1NjYyRlx1NTQyNlx1NTkwNFx1NzQwNlx1NEU4Nlx1NEVGQlx1NTJBMVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgcnVuQ3JpdGljUGhhc2UoKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgICAgIGNvbnN0IHF1ZXVlID0gdGhpcy5wbHVnaW4uZGF0YS5yZXZpZXdRdWV1ZTtcbiAgICAgICAgaWYgKHF1ZXVlLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgIGNvbnN0IGJhdGNoU2l6ZSA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYXRpb25fYmF0Y2hfc2l6ZTtcbiAgICAgICAgY29uc3QgdGFza3NUb1JldmlldyA9IHF1ZXVlLnNwbGljZSgwLCBNYXRoLm1pbihxdWV1ZS5sZW5ndGgsIGJhdGNoU2l6ZSkpO1xuXG4gICAgICAgIHRoaXMudXBkYXRlU3RhdHVzQmFyKCk7XG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVQbHVnaW5EYXRhKCk7IC8vIFx1NEZERFx1NUI1OFx1NURGMlx1NTNENlx1NTFGQVx1NEVGQlx1NTJBMVx1NzY4NFx1OTYxRlx1NTIxN1xuXG4gICAgICAgIGxldCBuZXdJZGVhc0ZvdW5kOiBTZXQ8c3RyaW5nPiA9IG5ldyBTZXQoKTtcblxuICAgICAgICBmb3IgKGNvbnN0IHRhc2sgb2YgdGFza3NUb1Jldmlldykge1xuICAgICAgICAgICAgY29uc3QgeyBpc0FwcHJvdmVkLCByZWFzb24gfSA9IGF3YWl0IHRoaXMuY3JpdGljLmp1ZGdlKHRhc2suY29udGVudCk7XG4gICAgICAgICAgICBpZiAoaXNBcHByb3ZlZCkge1xuICAgICAgICAgICAgICAgIC8vIDEuIFx1NjI3OVx1NTFDNlx1RkYwQ1x1NEZERFx1NUI1OFx1N0IxNFx1OEJCMFxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuc2F2ZU5vdGUodGFzay5pZGVhLCB0YXNrLmNvbnRlbnQpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFx1MzAxMFx1MzAxMFx1MzAxMCBcdTY1QjBcdTUyOUZcdTgwRkQgXHUzMDExXHUzMDExXHUzMDExXG4gICAgICAgICAgICAgICAgLy8gXHU0RUM1XHU1NzI4XHU1RjAwXHU1NDJGXHU4QkJFXHU3RjZFXHU1NDBFXHU2MjREXHU2M0QwXHU1M0Q2XHU2NUIwXHU2OTgyXHU1RkY1XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmV4dHJhY3RfbmV3X2NvbmNlcHRzKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGlkZWFzID0gZXh0cmFjdE5ld0lkZWFzKHRhc2suY29udGVudCk7XG4gICAgICAgICAgICAgICAgICAgIGlkZWFzLmZvckVhY2goaWRlYSA9PiBuZXdJZGVhc0ZvdW5kLmFkZChpZGVhKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIFx1MzAxMFx1MzAxMFx1MzAxMCBcdTY1QjBcdTUyOUZcdTgwRkRcdTdFRDNcdTY3NUYgXHUzMDExXHUzMDExXHUzMDExXG5cbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgXHVEODNEXHVEQzREIFtcdTVCQTFcdTY4MzhcdTkwMUFcdThGQzddOiAke3Rhc2suaWRlYX1gKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gMi4gXHU2MkQyXHU3RUREXHVGRjBDXHU4QkJFXHU3RjZFXHU1MzlGXHU1NkUwXHUzMDAxXHU5MUNEXHU4QkQ1XHU2QjIxXHU2NTcwXHVGRjBDXHU2M0E4XHU1MTY1XHU0RkVFXHU2QjYzXHU5NjFGXHU1MjE3XG4gICAgICAgICAgICAgICAgdGFzay5yZWFzb24gPSByZWFzb247XG4gICAgICAgICAgICAgICAgdGFzay5yZXRyaWVzID0gKHRhc2sucmV0cmllcyB8fCAwKSArIDE7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5yZXZpc2lvblF1ZXVlLnB1c2godGFzayk7XG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBcdUQ4M0RcdURDNEUgW1x1NUJBMVx1NjgzOFx1NjJEMlx1N0VERF06ICR7dGFzay5pZGVhfSAtICR7cmVhc29ufWApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gXHU1OTgyXHU2NzlDXHU2MjdFXHU1MjMwXHU0RTg2XHU2NUIwXHU2OTgyXHU1RkY1XHVGRjBDXHU1QzA2XHU1QjgzXHU0RUVDXHU2Mjc5XHU5MUNGXHU1MkEwXHU1MTY1XHU3NTFGXHU2MjEwXHU5NjFGXHU1MjE3XG4gICAgICAgIGlmIChuZXdJZGVhc0ZvdW5kLnNpemUgPiAwKSB7XG4gICAgICAgICAgICB0aGlzLmFkZENvbmNlcHRzVG9RdWV1ZShBcnJheS5mcm9tKG5ld0lkZWFzRm91bmQpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVQbHVnaW5EYXRhKCk7IC8vIFx1NEZERFx1NUI1OFx1NUJBMVx1NjgzOC9cdTRGRUVcdTZCNjMvXHU3NTFGXHU2MjEwXHU5NjFGXHU1MjE3XHU3Njg0XHU3MkI2XHU2MDAxXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFx1OEZEMFx1ODg0Q1x1MjAxQ1x1NEZFRVx1NkI2M1x1MjAxRFx1OTYzNlx1NkJCNVxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPGJvb2xlYW4+fSBcdTY2MkZcdTU0MjZcdTU5MDRcdTc0MDZcdTRFODZcdTRFRkJcdTUyQTFcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIHJ1blJldmlzaW9uUGhhc2UoKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgICAgIGNvbnN0IHF1ZXVlID0gdGhpcy5wbHVnaW4uZGF0YS5yZXZpc2lvblF1ZXVlO1xuICAgICAgICBpZiAocXVldWUubGVuZ3RoID09PSAwKSByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgY29uc3QgYmF0Y2hTaXplID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhdGlvbl9iYXRjaF9zaXplO1xuICAgICAgICBjb25zdCB0YXNrc1RvUmV2aXNlID0gcXVldWUuc3BsaWNlKDAsIE1hdGgubWluKHF1ZXVlLmxlbmd0aCwgYmF0Y2hTaXplKSk7XG5cbiAgICAgICAgdGhpcy51cGRhdGVTdGF0dXNCYXIoKTtcbiAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVBsdWdpbkRhdGEoKTsgLy8gXHU0RkREXHU1QjU4XHU1REYyXHU1M0Q2XHU1MUZBXHU0RUZCXHU1MkExXHU3Njg0XHU5NjFGXHU1MjE3XG5cbiAgICAgICAgZm9yIChjb25zdCB0YXNrIG9mIHRhc2tzVG9SZXZpc2UpIHtcbiAgICAgICAgICAgIC8vIFx1NjhDMFx1NjdFNVx1NjYyRlx1NTQyNlx1OEZCRVx1NTIzMFx1NjcwMFx1NTkyN1x1OTFDRFx1OEJENVx1NkIyMVx1NjU3MFxuICAgICAgICAgICAgaWYgKCh0YXNrLnJldHJpZXMgfHwgMCkgPj0gdGhpcy5wbHVnaW4uc2V0dGluZ3MubWF4X3JldmlzaW9uX3JldHJpZXMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLmRpc2NhcmRlZFBpbGUucHVzaCh0YXNrKTsgLy8gXHU2NTNFXHU1MTY1XHU0RTIyXHU1RjAzXHU1ODA2XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgXHVEODNEXHVEQzgwIFtcdTY1M0VcdTVGMDNcdTRGRUVcdTZCNjNdOiAke3Rhc2suaWRlYX0gXHU1REYyXHU4RkJFXHU2NzAwXHU1OTI3XHU5MUNEXHU4QkQ1XHU2QjIxXHU2NTcwXHUzMDAyYCk7XG4gICAgICAgICAgICAgICAgY29udGludWU7IC8vIFx1NEUwRFx1NTE4RFx1NTkwNFx1NzQwNlx1NkI2NFx1NEVGQlx1NTJBMVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gXHU2NzJBXHU4RkJFXHU2QjIxXHU2NTcwXHVGRjBDXHU2MjY3XHU4ODRDXHU0RkVFXHU2QjYzXHU0RUZCXHU1MkExXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnJldmlzaW9uVGFzayh0YXNrKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVQbHVnaW5EYXRhKCk7IC8vIFx1NEZERFx1NUI1OFx1NEZFRVx1NkI2My9cdTVCQTFcdTY4MzgvXHU0RTIyXHU1RjAzXHU1ODA2XHU3Njg0XHU3MkI2XHU2MDAxXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFx1NTM1NVx1NEUyQVx1NEZFRVx1NkI2M1x1NEVGQlx1NTJBMVxuICAgICAqL1xuICAgIHByaXZhdGUgYXN5bmMgcmV2aXNpb25UYXNrKHRhc2s6IFRhc2tEYXRhKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IHByb21wdCA9IHRoaXMucmV2aXNlci5jcmVhdGVSZXZpc2lvblByb21wdCh0YXNrLmlkZWEsIHRhc2suY29udGVudCwgdGFzay5yZWFzb24gfHwgXCJcdTY3MkFcdTc3RTVcdTUzOUZcdTU2RTBcIik7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBuZXdDb250ZW50ID0gYXdhaXQgdGhpcy5hcGlIYW5kbGVyLmNhbGwocHJvbXB0KTtcbiAgICAgICAgICAgIGNvbnN0IGNsZWFuZWRDb250ZW50ID0gY2xlYW5NYXJrZG93bk91dHB1dChuZXdDb250ZW50KTtcbiAgICAgICAgICAgIGNvbnN0IHJldmlzZWRUYXNrOiBUYXNrRGF0YSA9IHsgLi4udGFzaywgY29udGVudDogY2xlYW5lZENvbnRlbnQgfTtcbiAgICAgICAgICAgIC8vIFx1NEZFRVx1NkI2M1x1NTQwRVx1RkYwQ1x1NjUzRVx1NTZERVx1NUJBMVx1NjgzOFx1OTYxRlx1NTIxN1xuICAgICAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5yZXZpZXdRdWV1ZS5wdXNoKHJldmlzZWRUYXNrKTsgXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgXHVEODNEXHVERDA0IFtcdTRGRUVcdTZCNjNcdTVCOENcdTYyMTBdOiAke3Rhc2suaWRlYX1gKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihgXHUyNzRDIFtcdTRGRUVcdTZCNjNcdTU5MzFcdThEMjVdOiAke3Rhc2suaWRlYX0gLSAke2UubWVzc2FnZX1gKTtcbiAgICAgICAgICAgIC8vIFx1NTkzMVx1OEQyNVx1NTQwRVx1RkYwQ1x1NjUzRVx1NTZERVx1NEZFRVx1NkI2M1x1OTYxRlx1NTIxN1x1NTkzNFx1OTBFOFx1RkYwQ1x1NEVFNVx1NEZCRlx1NEUwQlx1NkIyMVx1OTFDRFx1OEJENVxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5yZXZpc2lvblF1ZXVlLnVuc2hpZnQodGFzayk7IFxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gLS0tIEZpbGUgJiBVSSAtLS1cbiAgICAvKipcbiAgICAgKiBcdTRGRERcdTVCNThcdTdCMTRcdThCQjBcdTUyMzBcdTY1ODdcdTRFRjZcdTdDRkJcdTdFREZcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIHNhdmVOb3RlKGlkZWE6IHN0cmluZywgY29udGVudDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGZpbGVuYW1lID0gc2FuaXRpemVGaWxlbmFtZShpZGVhKTtcbiAgICAgICAgY29uc3QgZm9sZGVyUGF0aCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLm91dHB1dF9kaXI7XG5cbiAgICAgICAgLy8gXHU2OEMwXHU2N0U1XHU2NTg3XHU0RUY2XHU1OTM5XHU2NjJGXHU1NDI2XHU1QjU4XHU1NzI4XHVGRjBDXHU0RTBEXHU1QjU4XHU1NzI4XHU1MjE5XHU1MjFCXHU1RUZBXG4gICAgICAgIGlmICghKHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmb2xkZXJQYXRoKSBpbnN0YW5jZW9mIFRGb2xkZXIpKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZUZvbGRlcihmb2xkZXJQYXRoKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgXHU1MjFCXHU1RUZBXHU2NTg3XHU0RUY2XHU1OTM5XHU1OTMxXHU4RDI1OiAke2ZvbGRlclBhdGh9YCwgZXJyb3IpO1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYFx1NjVFMFx1NkNENVx1NTIxQlx1NUVGQVx1OEY5M1x1NTFGQVx1NjU4N1x1NEVGNlx1NTkzOTogJHtmb2xkZXJQYXRofWApO1xuICAgICAgICAgICAgICAgIHJldHVybjsgLy8gXHU2NUUwXHU2Q0Q1XHU1MjFCXHU1RUZBXHU2NTg3XHU0RUY2XHU1OTM5XHVGRjBDXHU1MDVDXHU2QjYyXHU0RkREXHU1QjU4XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZpbGVQYXRoID0gbm9ybWFsaXplUGF0aChgJHtmb2xkZXJQYXRofS8ke2ZpbGVuYW1lfS5tZGApO1xuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVQYXRoKTtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xuICAgICAgICAgICAgICAgIC8vIFx1NjU4N1x1NEVGNlx1NURGMlx1NUI1OFx1NTcyOFx1RkYwQ1x1NEZFRVx1NjUzOVx1NTE4NVx1NUJCOVxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBjb250ZW50KTtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKGBcdTdCMTRcdThCQjBcdTVERjJcdTY2RjRcdTY1QjA6ICR7ZmlsZW5hbWV9YCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIFx1NjU4N1x1NEVGNlx1NEUwRFx1NUI1OFx1NTcyOFx1RkYwQ1x1NTIxQlx1NUVGQVx1NjVCMFx1NjU4N1x1NEVGNlxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZShmaWxlUGF0aCwgY29udGVudCk7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShgXHU3QjE0XHU4QkIwXHU1REYyXHU1MjFCXHU1RUZBOiAke2ZpbGVuYW1lfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihgXHU0RkREXHU1QjU4XHU3QjE0XHU4QkIwXHU1OTMxXHU4RDI1OiAke2ZpbGVQYXRofWAsIGVycm9yKTtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYFx1NjVFMFx1NkNENVx1NEZERFx1NUI1OFx1N0IxNFx1OEJCMDogJHtmaWxlbmFtZX1gKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFx1NjZGNFx1NjVCMFx1NzJCNlx1NjAwMVx1NjgwRlx1NjYzRVx1NzkzQVxuICAgICAqL1xuICAgIHB1YmxpYyB1cGRhdGVTdGF0dXNCYXIoKTogdm9pZCB7XG4gICAgICAgIGlmICghdGhpcy5wbHVnaW4uc3RhdHVzQmFyRWwpIHJldHVybjtcbiAgICAgICAgY29uc3QgeyBnZW5lcmF0aW9uUXVldWUsIHJldmlld1F1ZXVlLCByZXZpc2lvblF1ZXVlIH0gPSB0aGlzLnBsdWdpbi5kYXRhO1xuICAgICAgICBjb25zdCB0b3RhbCA9IGdlbmVyYXRpb25RdWV1ZS5sZW5ndGggKyByZXZpZXdRdWV1ZS5sZW5ndGggKyByZXZpc2lvblF1ZXVlLmxlbmd0aDtcbiAgICAgICAgLy8gXHU2NjNFXHU3OTNBOiBLRzogW1x1NzJCNlx1NjAwMV0gfCBHOltcdTVGODVcdTc1MUZcdTYyMTBdIHwgQzpbXHU1Rjg1XHU1QkExXHU2ODM4XSB8IFI6W1x1NUY4NVx1NEZFRVx1NkI2M10gfCBUb3RhbDpbXHU2MDNCXHU2NTcwXVxuICAgICAgICB0aGlzLnBsdWdpbi5zdGF0dXNCYXJFbC5zZXRUZXh0KFxuICAgICAgICAgICAgYEtHOiAke3RoaXMucGx1Z2luLmRhdGEuc3RhdHVzfSB8IEc6JHtnZW5lcmF0aW9uUXVldWUubGVuZ3RofSB8IEM6JHtyZXZpZXdRdWV1ZS5sZW5ndGh9IHwgUjoke3JldmlzaW9uUXVldWUubGVuZ3RofSB8IFRvdGFsOiR7dG90YWx9YFxuICAgICAgICApO1xuICAgICAgICBcbiAgICAgICAgLy8gXHUzMDEwXHUzMDEwXHUzMDEwIFx1NUI5RVx1NjVGNlx1NTIzN1x1NjVCMFx1NEZFRVx1NjUzOVx1RkYxQVx1NTcyOFx1NkI2NFx1NTkwNFx1NUU3Rlx1NjRBRFx1NjU3MFx1NjM2RVx1NURGMlx1NjZGNFx1NjVCMFx1NzY4NFx1NEZFMVx1NTNGNyBcdTMwMTFcdTMwMTFcdTMwMTFcbiAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLnRyaWdnZXIoXCJrZy1kYXRhLXVwZGF0ZWRcIik7XG4gICAgfVxufVxuIiwgIi8vIGFwaUhhbmRsZXIudHNcbnZhciBpbXBvcnRfb2JzaWRpYW4zID0gcmVxdWlyZShcIm9ic2lkaWFuXCIpO1xuXG4vLyAtLS0gXHUzMDEwXHUzMDEwXHUzMDEwIFx1NEZFRVx1NkI2M1x1RkYxQVx1NkRGQlx1NTJBMCBleHBvcnQgXHUzMDExXHUzMDExXHUzMDExIC0tLVxuZXhwb3J0IHZhciBBcGlLZXlFeGhhdXN0ZWRFcnJvciA9IGNsYXNzIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlKSB7XG4gICAgc3VwZXIobWVzc2FnZSk7XG4gICAgdGhpcy5uYW1lID0gXCJBcGlLZXlFeGhhdXN0ZWRFcnJvclwiO1xuICB9XG59O1xuXG4vLyAtLS0gXHUzMDEwXHUzMDEwXHUzMDEwIFx1NEZFRVx1NkI2M1x1RkYxQVx1NkRGQlx1NTJBMCBleHBvcnQgXHUzMDExXHUzMDExXHUzMDExIC0tLVxuZXhwb3J0IHZhciBBbGxNb2RlbHNGYWlsZWRFcnJvciA9IGNsYXNzIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlKSB7XG4gICAgc3VwZXIobWVzc2FnZSk7XG4gICAgdGhpcy5uYW1lID0gXCJBbGxNb2RlbHNGYWlsZWRFcnJvclwiO1xuICB9XG59O1xuXG4vLyAtLS0gXHUzMDEwXHUzMDEwXHUzMDEwIFx1NEZFRVx1NkI2M1x1RkYxQVx1NkRGQlx1NTJBMCBleHBvcnQgXHUzMDExXHUzMDExXHUzMDExIC0tLVxuZXhwb3J0IHZhciBBUElIYW5kbGVyID0gY2xhc3Mge1xuICBjb25zdHJ1Y3RvcihwbHVnaW4pIHtcbiAgICB0aGlzLmtleVVzYWdlT3BlbkFJID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbiAgICB0aGlzLmtleVVzYWdlR29vZ2xlID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbiAgICAvLyBcdTc1MjhcdTRFOEVcdThEREZcdThFMkFcdTY2MkZcdTU0MjZcdTVERjJcdTdFQ0ZcdTkwMUFcdTc3RTVcdThGQzdcdTY1NDVcdTk2OUNcdTUyMDdcdTYzNjJcbiAgICB0aGlzLmhhc05vdGlmaWVkRmFpbG92ZXIgPSBmYWxzZTtcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICB0aGlzLnNldHRpbmdzID0gcGx1Z2luLnNldHRpbmdzO1xuICAgIHRoaXMudXBkYXRlS2V5cygpO1xuICB9XG4gIHVwZGF0ZUtleXMoKSB7XG4gICAgdGhpcy5vcGVuYWlfa2V5cyA9IHRoaXMuc2V0dGluZ3Mub3BlbmFpX2FwaV9rZXlzLnNwbGl0KFwiXFxuXCIpLm1hcCgoaykgPT4gay50cmltKCkpLmZpbHRlcihCb29sZWFuKTtcbiAgICB0aGlzLmdvb2dsZV9rZXlzID0gdGhpcy5zZXR0aW5ncy5nb29nbGVfYXBpX2tleXMuc3BsaXQoXCJcXG5cIikubWFwKChrKSA9PiBrLnRyaW0oKSkuZmlsdGVyKEJvb2xlYW4pO1xuICAgIHRoaXMub3BlbmFpX2tleXMuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgICBpZiAoIXRoaXMua2V5VXNhZ2VPcGVuQUkuaGFzKGtleSkpIHtcbiAgICAgICAgdGhpcy5rZXlVc2FnZU9wZW5BSS5zZXQoa2V5LCB7IGZhaWxzOiAwLCBjb29sZG93bl91bnRpbDogMCB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICB0aGlzLmdvb2dsZV9rZXlzLmZvckVhY2goKGtleSkgPT4ge1xuICAgICAgaWYgKCF0aGlzLmtleVVzYWdlR29vZ2xlLmhhcyhrZXkpKSB7XG4gICAgICAgIHRoaXMua2V5VXNhZ2VHb29nbGUuc2V0KGtleSwgeyBmYWlsczogMCwgY29vbGRvd25fdW50aWw6IDAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbiAgX3NlbGVjdEtleShrZXlzLCBwcm92aWRlcikge1xuICAgIGNvbnN0IGtleVVzYWdlTWFwID0gcHJvdmlkZXIgPT09IFwib3BlbmFpXCIgPyB0aGlzLmtleVVzYWdlT3BlbkFJIDogdGhpcy5rZXlVc2FnZUdvb2dsZTtcbiAgICBjb25zdCBjdXJyZW50VGltZSA9IERhdGUubm93KCkgLyAxZTM7XG4gICAgZm9yIChjb25zdCBrZXkgb2Yga2V5cykge1xuICAgICAgY29uc3QgdXNhZ2UgPSBrZXlVc2FnZU1hcC5nZXQoa2V5KTtcbiAgICAgIGlmICh1c2FnZSAmJiBjdXJyZW50VGltZSA+PSB1c2FnZS5jb29sZG93bl91bnRpbCkge1xuICAgICAgICByZXR1cm4ga2V5O1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICAvLyAtLS0gXHUzMDEwXHUzMDEwXHUzMDEwIFx1NjVCMFx1NTg5RVx1RkYxQVx1OEY4NVx1NTJBOVx1NTFGRFx1NjU3MCAoQVBJIFx1OEJGN1x1NkM0MikgXHUzMDExXHUzMDExXHUzMDExIC0tLVxuICAvKipcbiAgICogXHU1QjlFXHU5NjQ1XHU2MjY3XHU4ODRDIE9wZW5BSSBBUEkgXHU4QkY3XHU2QzQyXG4gICAqL1xuICBhc3luYyBfbWFrZU9wZW5BSVJlcXVlc3Qoa2V5LCBwcm9tcHQsIG1vZGVsTmFtZSkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgKDAsIGltcG9ydF9vYnNpZGlhbjMucmVxdWVzdFVybCkoe1xuICAgICAgdXJsOiBgJHt0aGlzLnNldHRpbmdzLm9wZW5haV9iYXNlX3VybH0vY2hhdC9jb21wbGV0aW9uc2AsXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgXCJBdXRob3JpemF0aW9uXCI6IGBCZWFyZXIgJHtrZXl9YFxuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbW9kZWw6IG1vZGVsTmFtZSxcbiAgICAgICAgLy8gXHU0RjdGXHU3NTI4XHU0RjIwXHU1MTY1XHU3Njg0IG1vZGVsTmFtZVxuICAgICAgICBtZXNzYWdlczogW3sgcm9sZTogXCJ1c2VyXCIsIGNvbnRlbnQ6IHByb21wdCB9XSxcbiAgICAgICAgdGVtcGVyYXR1cmU6IHRoaXMuc2V0dGluZ3MuZ2VuZXJhdGlvbl90ZW1wZXJhdHVyZSxcbiAgICAgICAgbWF4X3Rva2VuczogdGhpcy5zZXR0aW5ncy5nZW5lcmF0aW9uX21heF90b2tlbnNcbiAgICAgIH0pXG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3BvbnNlLmpzb24uY2hvaWNlc1swXS5tZXNzYWdlLmNvbnRlbnQudHJpbSgpO1xuICB9XG4gIC8qKlxuICAgKiBcdTVCOUVcdTk2NDVcdTYyNjdcdTg4NEMgR29vZ2xlIEdlbWluaSBBUEkgXHU4QkY3XHU2QzQyXG4gICAqL1xuICBhc3luYyBfbWFrZUdvb2dsZUFQSVJlcXVlc3Qoa2V5LCBwcm9tcHQsIG1vZGVsTmFtZSkge1xuICAgIGNvbnN0IHVybCA9IGBodHRwczovL2dlbmVyYXRpdmVsYW5ndWFnZS5nb29nbGVhcGlzLmNvbS92MWJldGEvbW9kZWxzLyR7bW9kZWxOYW1lfTpnZW5lcmF0ZUNvbnRlbnQ/a2V5PSR7a2V5fWA7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCAoMCwgaW1wb3J0X29ic2lkaWFuMy5yZXF1ZXN0VXJsKSh7XG4gICAgICB1cmwsXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogeyBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIiB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBjb250ZW50czogW3sgcGFydHM6IFt7IHRleHQ6IHByb21wdCB9XSB9XSxcbiAgICAgICAgZ2VuZXJhdGlvbkNvbmZpZzoge1xuICAgICAgICAgIHRlbXBlcmF0dXJlOiB0aGlzLnNldHRpbmdzLmdlbmVyYXRpb25fdGVtcGVyYXR1cmUsXG4gICAgICAgICAgbWF4T3V0cHV0VG9rZW5zOiB0aGlzLnNldHRpbmdzLmdlbmVyYXRpb25fbWF4X3Rva2Vuc1xuICAgICAgICB9XG4gICAgICB9KVxuICAgIH0pO1xuICAgIGNvbnN0IGRhdGEgPSByZXNwb25zZS5qc29uO1xuICAgIGlmICghZGF0YS5jYW5kaWRhdGVzIHx8IGRhdGEuY2FuZGlkYXRlcy5sZW5ndGggPT09IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkFQSSByZXNwb25zZSBpcyBtaXNzaW5nIGNhbmRpZGF0ZXMuIEZ1bGwgcmVzcG9uc2U6IFwiICsgSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xuICAgIH1cbiAgICByZXR1cm4gZGF0YS5jYW5kaWRhdGVzWzBdLmNvbnRlbnQucGFydHNbMF0udGV4dC50cmltKCk7XG4gIH1cbiAgXG4gIC8vIC0tLSBcdTMwMTBcdTMwMTBcdTMwMTAgXHU2NUIwXHU1ODlFXHVGRjFBXHU4Rjg1XHU1MkE5XHU1MUZEXHU2NTcwIChcdTk1MTlcdThCRUZcdTU5MDRcdTc0MDYpIFx1MzAxMVx1MzAxMVx1MzAxMSAtLS1cbiAgXG4gIC8qKlxuICAgKiBcdTY4QzBcdTY3RTVcdTY2MkZcdTU0MjZcdTY2MkZcdTk4OURcdTVFQTYvXHU2NzQzXHU5NjUwXHU3QzdCXHU5NTE5XHU4QkVGIChcdTVERjJcdTVFOTRcdTc1MjggNDI5IFx1NTA2NVx1NThFRVx1NjAyN1x1NEZFRVx1NTkwRClcbiAgICovXG4gIF9pc1F1b3RhRXJyb3IoZXJyb3IpIHtcbiAgICB2YXIgX2E7XG4gICAgY29uc3QgaHR0cFN0YXR1cyA9IGVycm9yLnN0YXR1cztcbiAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSAoKF9hID0gZXJyb3IubWVzc2FnZSkgPT0gbnVsbCA/IHZvaWQgMCA6IF9hLnRvTG93ZXJDYXNlKCkpIHx8IFwiXCI7XG4gICAgXG4gICAgaWYgKGh0dHBTdGF0dXMgPT09IDQwMSB8fCBodHRwU3RhdHVzID09PSA0MDMgfHwgaHR0cFN0YXR1cyA9PT0gNDI5KSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgXG4gICAgaWYgKGVycm9yTWVzc2FnZS5pbmNsdWRlcyhcImluc3VmZmljaWVudF9xdW90YVwiKSB8fCBlcnJvck1lc3NhZ2UuaW5jbHVkZXMoXCJyYXRlIGxpbWl0XCIpIHx8IGVycm9yTWVzc2FnZS5pbmNsdWRlcyhcInF1b3RhXCIpIHx8IGVycm9yTWVzc2FnZS5pbmNsdWRlcyhcInBlcm1pc3Npb25cIikgfHwgZXJyb3JNZXNzYWdlLmluY2x1ZGVzKFwiNDI5XCIpKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIFxuICAvKipcbiAgICogXHU1MUI3XHU1Mzc0XHU0RTAwXHU0RTJBIEtleVxuICAgKi9cbiAgX2Nvb2xkb3duS2V5KGtleSwgcHJvdmlkZXIpIHtcbiAgICBjb25zdCBrZXlVc2FnZU1hcCA9IHByb3ZpZGVyID09PSBcIm9wZW5haVwiID8gdGhpcy5rZXlVc2FnZU9wZW5BSSA6IHRoaXMua2V5VXNhZ2VHb29nbGU7XG4gICAgY29uc3Qga2V5VXNhZ2UgPSBrZXlVc2FnZU1hcC5nZXQoa2V5KTtcbiAgICBpZiAoa2V5VXNhZ2UpIHtcbiAgICAgIGNvbnNvbGUud2FybihgS2V5IC4uLiR7a2V5LnNsaWNlKC00KX0gKCR7cHJvdmlkZXJ9KSBmYWlsZWQgZHVlIHRvIHF1b3RhL2F1dGggZXJyb3IuIEFwcGx5aW5nIGNvb2xkb3duLmApO1xuICAgICAga2V5VXNhZ2UuY29vbGRvd25fdW50aWwgPSBEYXRlLm5vdygpIC8gMWUzICsgdGhpcy5zZXR0aW5ncy5mYWlsb3Zlcl9jb29sZG93bl9zZWNvbmRzO1xuICAgIH1cbiAgfVxuICAvKipcbiAgICogXHU5MUNEXHU3RjZFXHU0RTAwXHU0RTJBIEtleSBcdTc2ODRcdTUxQjdcdTUzNzQgKFx1OEMwM1x1NzUyOFx1NjIxMFx1NTI5Rlx1NjVGNilcbiAgICovXG4gIF9yZXNldENvb2xkb3duKGtleSwgcHJvdmlkZXIpIHtcbiAgICBjb25zdCBrZXlVc2FnZU1hcCA9IHByb3ZpZGVyID09PSBcIm9wZW5haVwiID8gdGhpcy5rZXlVc2FnZU9wZW5BSSA6IHRoaXMua2V5VXNhZ2VHb29nbGU7XG4gICAgY29uc3Qga2V5VXNhZ2UgPSBrZXlVc2FnZU1hcC5nZXQoa2V5KTtcbiAgICBpZiAoa2V5VXNhZ2UpXG4gICAgICBrZXlVc2FnZS5jb29sZG93bl91bnRpbCA9IDA7XG4gICAgdGhpcy5oYXNOb3RpZmllZEZhaWxvdmVyID0gZmFsc2U7XG4gIH1cbiAgXG4gIC8vIC0tLSBcdTMwMTBcdTMwMTBcdTMwMTAgXHU1REYyXHU5MUNEXHU2Nzg0XHVGRjFBX2NhbGxPcGVuQUkgKFx1NUU5NFx1NzUyOCA0MDQgXHU0RkVFXHU1OTBEKSBcdTMwMTFcdTMwMTFcdTMwMTEgLS0tXG4gIGFzeW5jIF9jYWxsT3BlbkFJKGtleSwgcHJvbXB0KSB7XG4gICAgY29uc3QgcHJpbWFyeU1vZGVsID0gdGhpcy5zZXR0aW5ncy5vcGVuYWlfbW9kZWw7XG4gICAgY29uc3QgYmFja3VwTW9kZWwgPSB0aGlzLnNldHRpbmdzLm9wZW5haV9iYWNrdXBfbW9kZWw7XG4gICAgXG4gICAgLy8gMS4gXHU1QzFEXHU4QkQ1XHU0RTNCXHU2QTIxXHU1NzhCXG4gICAgdHJ5IHtcbiAgICAgIC8vIChcdTU5ODJcdTY3OUNcdTRFM0JcdTZBMjFcdTU3OEJcdTRFM0FcdTdBN0FcdUZGMENcdThGRDlcdTkxQ0NcdTRGMUFcdTgxRUFcdTcxMzZcdTU5MzFcdThEMjVcdUZGMENcdTRGOEJcdTU5ODIgNDA0KVxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5fbWFrZU9wZW5BSVJlcXVlc3Qoa2V5LCBwcm9tcHQsIHByaW1hcnlNb2RlbCk7XG4gICAgICB0aGlzLl9yZXNldENvb2xkb3duKGtleSwgXCJvcGVuYWlcIik7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0gY2F0Y2ggKHByaW1hcnlFcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKGBPcGVuQUkgcHJpbWFyeSBtb2RlbCAnJHtwcmltYXJ5TW9kZWx9JyBmYWlsZWQgZm9yIGtleSAuLi4ke2tleS5zbGljZSgtNCl9OmAsIHByaW1hcnlFcnJvci5tZXNzYWdlKTtcbiAgICAgIFxuICAgICAgLy8gXHUzMDEwXHUzMDEwXHUzMDEwIFx1NTE3M1x1OTUyRVx1OTAzQlx1OEY5MVx1NEZFRVx1NTkwRCBcdTMwMTFcdTMwMTFcdTMwMTFcbiAgICAgIC8vIFx1NTNFQVx1ODk4MVx1NEUzQlx1NkEyMVx1NTc4Qlx1NTkzMVx1OEQyNSAoXHU2NUUwXHU4QkJBXHU0RjU1XHU3OUNEXHU1MzlGXHU1NkUwKSBcdTVFNzZcdTRFMTRcdTVCNThcdTU3MjhcdTU5MDdcdTc1MjhcdTZBMjFcdTU3OEJcdUZGMENcdTVDMzFcdTVDMURcdThCRDVcdTU5MDdcdTc1MjhcdTZBMjFcdTU3OEJcdTMwMDJcbiAgICAgIGlmIChiYWNrdXBNb2RlbCkgeyBcbiAgICAgICAgXG4gICAgICAgIC8vIChcdTVERjJcdTc5RkJcdTk2NjQgVVggXHU2MjUzXHU2MjcwKVxuICAgICAgICBcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAvLyAyLiBcdTVDMURcdThCRDVcdTU5MDdcdTc1MjhcdTZBMjFcdTU3OEJcbiAgICAgICAgICBjb25zdCBiYWNrdXBSZXN1bHQgPSBhd2FpdCB0aGlzLl9tYWtlT3BlbkFJUmVxdWVzdChrZXksIHByb21wdCwgYmFja3VwTW9kZWwpO1xuICAgICAgICAgIHRoaXMuX3Jlc2V0Q29vbGRvd24oa2V5LCBcIm9wZW5haVwiKTtcbiAgICAgICAgICByZXR1cm4gYmFja3VwUmVzdWx0OyAvLyBcdTU5MDdcdTc1MjhcdTZBMjFcdTU3OEJcdTYyMTBcdTUyOUZcbiAgICAgICAgfSBjYXRjaCAoYmFja3VwRXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKGBPcGVuQUkgYmFja3VwIG1vZGVsICcke2JhY2t1cE1vZGVsfScgYWxzbyBmYWlsZWQgZm9yIGtleSAuLi4ke2tleS5zbGljZSgtNCl9OmAsIGJhY2t1cEVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIDMuIFx1NEUzQlx1NTkwN1x1OTBGRFx1NTkzMVx1OEQyNVx1NEU4Nlx1RkYwQ1x1NkI2NFx1NjVGNlx1NjI0RFx1NjhDMFx1NjdFNVx1NjYyRlx1NTQyNlx1OTcwMFx1ODk4MVx1NTFCN1x1NTM3NCAoXHU1N0ZBXHU0RThFICpcdTRFRkJcdTRGNTUqIFx1NEUwMFx1NEUyQVx1OTUxOVx1OEJFRilcbiAgICAgICAgICBpZiAodGhpcy5faXNRdW90YUVycm9yKHByaW1hcnlFcnJvcikgfHwgdGhpcy5faXNRdW90YUVycm9yKGJhY2t1cEVycm9yKSkge1xuICAgICAgICAgICAgdGhpcy5fY29vbGRvd25LZXkoa2V5LCBcIm9wZW5haVwiKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gXHU2MjlCXHU1MUZBXHU5NTE5XHU4QkVGXHVGRjBDXHU5MDFBXHU3N0U1IGNhbGwoKSBcdTZCNjQgS2V5IFx1NUY3Qlx1NUU5NVx1NTkzMVx1OEQyNVxuICAgICAgICAgIHRocm93IG5ldyBBcGlLZXlFeGhhdXN0ZWRFcnJvcihgT3BlbkFJIGtleSBmYWlsZWQgKGJvdGggcHJpbWFyeSBhbmQgYmFja3VwIG1vZGVscykuYCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gNC4gXHU0RTNCXHU2QTIxXHU1NzhCXHU1OTMxXHU4RDI1XHVGRjBDXHU0RTE0ICpcdTZDQTFcdTY3MDkqIFx1NTkwN1x1NzUyOFx1NkEyMVx1NTc4QlxuICAgICAgaWYgKHRoaXMuX2lzUXVvdGFFcnJvcihwcmltYXJ5RXJyb3IpKSB7XG4gICAgICAgIHRoaXMuX2Nvb2xkb3duS2V5KGtleSwgXCJvcGVuYWlcIik7XG4gICAgICB9XG4gICAgICAvLyBcdTYyOUJcdTUxRkFcdTk1MTlcdThCRUZcdUZGMENcdTkwMUFcdTc3RTUgY2FsbCgpIFx1NkI2NCBLZXkgXHU1RjdCXHU1RTk1XHU1OTMxXHU4RDI1XG4gICAgICB0aHJvdyBuZXcgQXBpS2V5RXhoYXVzdGVkRXJyb3IoYE9wZW5BSSBrZXkgZmFpbGVkIChwcmltYXJ5IG1vZGVsIGZhaWxlZCwgbm8gYmFja3VwKTogJHtwcmltYXJ5RXJyb3IubWVzc2FnZX1gKTtcbiAgICB9XG4gIH1cbiAgXG4gIC8vIC0tLSBcdTMwMTBcdTMwMTBcdTMwMTAgXHU1REYyXHU5MUNEXHU2Nzg0XHVGRjFBX2NhbGxHb29nbGVBUEkgKFx1NUU5NFx1NzUyOCA0MDQgXHU0RkVFXHU1OTBEKSBcdTMwMTFcdTMwMTFcdTMwMTEgLS0tXG4gIGFzeW5jIF9jYWxsR29vZ2xlQVBJKGtleSwgcHJvbXB0KSB7XG4gICAgY29uc3QgcHJpbWFyeU1vZGVsID0gdGhpcy5zZXR0aW5ncy5nb29nbGVfbW9kZWw7XG4gICAgY29uc3QgYmFja3VwTW9kZWwgPSB0aGlzLnNldHRpbmdzLmdvb2dsZV9iYWNrdXBfbW9kZWw7XG4gICAgXG4gICAgLy8gMS4gXHU1QzFEXHU4QkQ1XHU0RTNCXHU2QTIxXHU1NzhCXG4gICAgdHJ5IHtcbiAgICAgIC8vIChcdTU5ODJcdTY3OUNcdTRFM0JcdTZBMjFcdTU3OEJcdTRFM0FcdTdBN0FcdUZGMENcdThGRDlcdTkxQ0NcdTRGMUFcdTgxRUFcdTcxMzZcdTU5MzFcdThEMjVcdUZGMENcdTRGOEJcdTU5ODIgNDA0KVxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5fbWFrZUdvb2dsZUFQSVJlcXVlc3Qoa2V5LCBwcm9tcHQsIHByaW1hcnlNb2RlbCk7XG4gICAgICB0aGlzLl9yZXNldENvb2xkb3duKGtleSwgXCJnb29nbGVcIik7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0gY2F0Y2ggKHByaW1hcnlFcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKGBHb29nbGUgcHJpbWFyeSBtb2RlbCAnJHtwcmltYXJ5TW9kZWx9JyBmYWlsZWQgZm9yIGtleSAuLi4ke2tleS5zbGljZSgtNCl9OmAsIHByaW1hcnlFcnJvci5tZXNzYWdlKTtcbiAgICAgIFxuICAgICAgLy8gXHUzMDEwXHUzMDEwXHUzMDEwIFx1NTE3M1x1OTUyRVx1OTAzQlx1OEY5MVx1NEZFRVx1NTkwRCBcdTMwMTFcdTMwMTFcdTMwMTFcbiAgICAgIC8vIFx1NTNFQVx1ODk4MVx1NEUzQlx1NkEyMVx1NTc4Qlx1NTkzMVx1OEQyNSAoXHU2NUUwXHU4QkJBXHU0RjU1XHU3OUNEXHU1MzlGXHU1NkUwKSBcdTVFNzZcdTRFMTRcdTVCNThcdTU3MjhcdTU5MDdcdTc1MjhcdTZBMjFcdTU3OEJcdUZGMENcdTVDMzFcdTVDMURcdThCRDVcdTU5MDdcdTc1MjhcdTZBMjFcdTU3OEJcdTMwMDJcbiAgICAgIGlmIChiYWNrdXBNb2RlbCkge1xuICAgICAgICBcbiAgICAgICAgLy8gKFx1NURGMlx1NzlGQlx1OTY2NCBVWCBcdTYyNTNcdTYyNzApXG4gICAgICAgIFxuICAgICAgICB0cnkge1xuICAgICAgICAgIC8vIDIuIFx1NUMxRFx1OEJENVx1NTkwN1x1NzUyOFx1NkEyMVx1NTc4QlxuICAgICAgICAgIGNvbnN0IGJhY2t1cFJlc3VsdCA9IGF3YWl0IHRoaXMuX21ha2VHb29nbGVBUElSZXF1ZXN0KGtleSwgcHJvbXB0LCBiYWNrdXBNb2RlbCk7XG4gICAgICAgICAgdGhpcy5fcmVzZXRDb29sZG93bihrZXksIFwiZ29vZ2xlXCIpO1xuICAgICAgICAgIHJldHVybiBiYWNrdXBSZXN1bHQ7IC8vIFx1NTkwN1x1NzUyOFx1NkEyMVx1NTc4Qlx1NjIxMFx1NTI5RlxuICAgICAgICB9IGNhdGNoIChiYWNrdXBFcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEdvb2dsZSBiYWNrdXAgbW9kZWwgJyR7YmFja3VwTW9kZWx9JyBhbHNvIGZhaWxlZCBmb3Iga2V5IC4uLiR7a2V5LnNsaWNlKC00KX06YCwgYmFja3VwRXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gMy4gXHU0RTNCXHU1OTA3XHU5MEZEXHU1OTMxXHU4RDI1XHU0RTg2XHVGRjBDXHU2QjY0XHU2NUY2XHU2MjREXHU2OEMwXHU2N0U1XHU2NjJGXHU1NDI2XHU5NzAwXHU4OTgxXHU1MUI3XHU1Mzc0IChcdTU3RkFcdTRFOEUgKlx1NEVGQlx1NEY1NSogXHU0RTAwXHU0RTJBXHU5NTE5XHU4QkVGKVxuICAgICAgICAgIGlmICh0aGlzLl9pc1F1b3RhRXJyb3IocHJpbWFyeUVycm9yKSB8fCB0aGlzLl9pc1F1b3RhRXJyb3IoYmFja3VwRXJyb3IpKSB7XG4gICAgICAgICAgICB0aGlzLl9jb29sZG93bktleShrZXksIFwiZ29vZ2xlXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvLyBcdTYyOUJcdTUxRkFcdTk1MTlcdThCRUZcdUZGMENcdTkwMUFcdTc3RTUgY2FsbCgpIFx1NkI2NCBLZXkgXHU1RjdCXHU1RTk1XHU1OTMxXHU4RDI1XG4gICAgICAgICAgdGhyb3cgbmV3IEFwaUtleUV4aGF1c3RlZEVycm9yKGBHb29nbGUga2V5IGZhaWxlZCAoYm90aCBwcmltYXJ5IGFuZCBiYWNrdXAgbW9kZWxzKS5gKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyA0LiBcdTRFM0JcdTZBMjFcdTU3OEJcdTU5MzFcdThEMjVcdUZGMENcdTRFMTQgKlx1NkNBMVx1NjcwOSogXHU1OTA3XHU3NTI4XHU2QTIxXHU1NzhCXG4gICAgICBpZiAodGhpcy5faXNRdW90YUVycm9yKHByaW1hcnlFcnJvcikpIHtcbiAgICAgICAgdGhpcy5fY29vbGRvd25LZXkoa2V5LCBcImdvb2dsZVwiKTtcbiAgICAgIH1cbiAgICAgIC8vIFx1NjI5Qlx1NTFGQVx1OTUxOVx1OEJFRlx1RkYwQ1x1OTAxQVx1NzdFNSBjYWxsKCkgXHU2QjY0IEtleSBcdTVGN0JcdTVFOTVcdTU5MzFcdThEMjVcbiAgICAgIHRocm93IG5ldyBBcGlLZXlFeGhhdXN0ZWRFcnJvcihgR29vZ2xlIGtleSBmYWlsZWQgKHByaW1hcnkgbW9kZWwgZmFpbGVkLCBubyBiYWNrdXApOiAke3ByaW1hcnlFcnJvci5tZXNzYWdlfWApO1xuICAgIH1cbiAgfVxuXG4gIC8vIC0tLSBcdTMwMTBcdTMwMTBcdTMwMTAgY2FsbCBcdTY1QjlcdTZDRDVcdTVERjJcdTkxQ0RcdTY3ODRcdUZGMUFcdTRGRUVcdTU5MERcdTIwMUNcdTUyMzdcdTVDNEZcdTIwMURCVUcgXHUzMDExXHUzMDExXHUzMDExIC0tLVxuICBhc3luYyBjYWxsKHByb21wdCkge1xuICAgIHRoaXMudXBkYXRlS2V5cygpO1xuICAgIGxldCBsYXN0RXJyb3IgPSBudWxsO1xuICAgIGxldCBvcGVuQUlLZXlzQXR0ZW1wdGVkID0gZmFsc2U7XG5cbiAgICAvLyBcdTMwMTBcdTMwMTBcdTMwMTAgXHU0RkVFXHU1OTBEXHVGRjFBXHU2OEMwXHU2N0U1IEtleSBcdTU0OEMgTW9kZWwgXHU2NjJGXHU1NDI2XHU5MEZEXHU1QjU4XHU1NzI4IFx1MzAxMVx1MzAxMVx1MzAxMVxuICAgIC8vICEhKCAuLi4gKSBcdTVDMDZcdTVCNTdcdTdCMjZcdTRFMzJcdThGNkNcdTRFM0FcdTVFMDNcdTVDMTRcdTUwM0NcdUZGMENcdTdBN0FcdTVCNTdcdTdCMjZcdTRFMzIgXCJcIiBcdTRFM0EgZmFsc2VcbiAgICBjb25zdCBvcGVuQUlFbmFibGVkID0gdGhpcy5vcGVuYWlfa2V5cy5sZW5ndGggPiAwICYmICEhKHRoaXMuc2V0dGluZ3Mub3BlbmFpX21vZGVsIHx8IHRoaXMuc2V0dGluZ3Mub3BlbmFpX2JhY2t1cF9tb2RlbCk7XG4gICAgY29uc3QgZ29vZ2xlRW5hYmxlZCA9IHRoaXMuZ29vZ2xlX2tleXMubGVuZ3RoID4gMCAmJiAhISh0aGlzLnNldHRpbmdzLmdvb2dsZV9tb2RlbCB8fCB0aGlzLnNldHRpbmdzLmdvb2dsZV9iYWNrdXBfbW9kZWwpO1xuXG4gICAgLy8gMS4gXHU1QzFEXHU4QkQ1IE9wZW5BSVxuICAgIGlmIChvcGVuQUlFbmFibGVkKSB7XG4gICAgICBvcGVuQUlLZXlzQXR0ZW1wdGVkID0gdHJ1ZTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5vcGVuYWlfa2V5cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBrZXkgPSB0aGlzLl9zZWxlY3RLZXkodGhpcy5vcGVuYWlfa2V5cywgXCJvcGVuYWlcIik7XG4gICAgICAgIGlmIChrZXkpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYFRyeWluZyBPcGVuQUkga2V5IC4uLiR7a2V5LnNsaWNlKC00KX1gKTtcbiAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLl9jYWxsT3BlbkFJKGtleSwgcHJvbXB0KTtcbiAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBsYXN0RXJyb3IgPSBlO1xuICAgICAgICAgICAgbmV3IGltcG9ydF9vYnNpZGlhbjMuTm90aWNlKGBPcGVuQUkga2V5IC4uLiR7a2V5LnNsaWNlKC00KX0gZmFpbGVkLiBUcnlpbmcgbmV4dC5gKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHRoaXMub3BlbmFpX2tleXMubGVuZ3RoID4gMCkge1xuICAgICAgLy8gXHU2NzA5IEtleSBcdTRGNDZcdTZDQTEgTW9kZWxcdUZGMENcdTY4MDdcdThCQjBcdTRFM0FcdTIwMUNcdTVERjJcdTVDMURcdThCRDVcdTIwMURcdTRFRTVcdTRGQkZcdTUyMDdcdTYzNjJcdTUyMzAgR29vZ2xlXHVGRjBDXHU1RTc2XHU4QkIwXHU1RjU1XHU5NTE5XHU4QkVGXG4gICAgICBvcGVuQUlLZXlzQXR0ZW1wdGVkID0gdHJ1ZTtcbiAgICAgIGxhc3RFcnJvciA9IG5ldyBFcnJvcihcIk9wZW5BSTogXHU2M0QwXHU0RjlCXHU0RTg2IEtleSBcdTRGNDZcdTY3MkFcdTYzMDdcdTVCOUFcdTZBMjFcdTU3OEJcdTMwMDJcIik7XG4gICAgICBjb25zb2xlLndhcm4obGFzdEVycm9yLm1lc3NhZ2UpO1xuICAgIH1cblxuICAgIC8vIDIuIFx1NUMxRFx1OEJENSBHb29nbGVcbiAgICBpZiAoZ29vZ2xlRW5hYmxlZCkge1xuICAgICAgLy8gXHU0RUM1XHU1NzI4IE9wZW5BSSBcIlx1NUMxRFx1OEJENVx1OEZDN1wiIChcdTY1RTBcdThCQkFcdTY2MkZcdTc3MUZcdTU5MzFcdThEMjVcdThGRDhcdTY2MkZcdTU2RTBcdTkxNERcdTdGNkVcdTk1MTlcdThCRUZcdTg4QUJcdThERjNcdThGQzcpIFx1NjVGNlx1NjI0RFx1OTAxQVx1NzdFNVx1NTIwN1x1NjM2MlxuICAgICAgaWYgKG9wZW5BSUtleXNBdHRlbXB0ZWQgJiYgIXRoaXMuaGFzTm90aWZpZWRGYWlsb3Zlcikge1xuICAgICAgICBuZXcgaW1wb3J0X29ic2lkaWFuMy5Ob3RpY2UoXCJBbGwgT3BlbkFJIGtleXMgZmFpbGVkIG9yIHVuYXZhaWxhYmxlLiBTd2l0Y2hpbmcgdG8gR29vZ2xlIEdlbWluaS4uLlwiKTtcbiAgICAgICAgdGhpcy5oYXNOb3RpZmllZEZhaWxvdmVyID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5nb29nbGVfa2V5cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBrZXkgPSB0aGlzLl9zZWxlY3RLZXkodGhpcy5nb29nbGVfa2V5cywgXCJnb29nbGVcIik7XG4gICAgICAgIGlmIChrZXkpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYFRyeWluZyBHb29nbGUgR2VtaW5pIGtleSAuLi4ke2tleS5zbGljZSgtNCl9YCk7XG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5fY2FsbEdvb2dsZUFQSShrZXksIHByb21wdCk7XG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgbGFzdEVycm9yID0gZTtcbiAgICAgICAgICAgIG5ldyBpbXBvcnRfb2JzaWRpYW4zLk5vdGljZShgR29vZ2xlIEdlbWluaSBrZXkgLi4uJHtrZXkuc2xpY2UoLTQpfSBmYWlsZWQuIFRyeWluZyBuZXh0LmApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodGhpcy5nb29nbGVfa2V5cy5sZW5ndGggPiAwKSB7XG4gICAgICAvLyBcdTY3MDkgS2V5IFx1NEY0Nlx1NkNBMSBNb2RlbFx1RkYwQ1x1OEJCMFx1NUY1NVx1OTUxOVx1OEJFRlxuICAgICAgbGFzdEVycm9yID0gbGFzdEVycm9yIHx8IG5ldyBFcnJvcihcIkdvb2dsZTogXHU2M0QwXHU0RjlCXHU0RTg2IEtleSBcdTRGNDZcdTY3MkFcdTYzMDdcdTVCOUFcdTZBMjFcdTU3OEJcdTMwMDJcIik7XG4gICAgICBjb25zb2xlLndhcm4obGFzdEVycm9yLm1lc3NhZ2UpO1xuICAgIH1cblxuICAgIC8vIDMuIFx1NjcwMFx1N0VDOFx1NTkzMVx1OEQyNVxuICAgIC8vIFx1NTk4Mlx1Njc5Q1x1NEUyNFx1NEUyQSBwcm92aWRlciBcdTkwRkRcdTU2RTBcdTRFM0FcdTkxNERcdTdGNkVcdTRFMERcdTUxNjhcdTgwMENcdTg4QUJcdThERjNcdThGQzdcbiAgICBpZiAoIW9wZW5BSUVuYWJsZWQgJiYgIWdvb2dsZUVuYWJsZWQgJiYgKHRoaXMub3BlbmFpX2tleXMubGVuZ3RoID4gMCB8fCB0aGlzLmdvb2dsZV9rZXlzLmxlbmd0aCA+IDApKSB7XG4gICAgICBuZXcgaW1wb3J0X29ic2lkaWFuMy5Ob3RpY2UoXCJcdThCRjdcdTU3MjhcdThCQkVcdTdGNkVcdTRFMkRcdTYzRDBcdTRGOUJBUEkgS2V5XHU1NDhDXHU4MUYzXHU1QzExXHU0RTAwXHU0RTJBXHU2QTIxXHU1NzhCXHU1NDBEXHU3OUYwXHUzMDAyXCIpO1xuICAgICAgdGhyb3cgbmV3IEFsbE1vZGVsc0ZhaWxlZEVycm9yKFwiXHU2M0QwXHU0RjlCXHU0RTg2IEtleSBcdTRGNDZcdTY3MkFcdTYzMDdcdTVCOUFcdTZBMjFcdTU3OEJcdTMwMDJcIik7XG4gICAgfVxuXG4gICAgLy8gXHU1OTgyXHU2NzlDXHU2NjJGXHU1MTc2XHU0RUQ2XHU1MzlGXHU1NkUwXHU1OTMxXHU4RDI1XG4gICAgdGhyb3cgbmV3IEFsbE1vZGVsc0ZhaWxlZEVycm9yKGBBbGwgQVBJIHByb3ZpZGVycyBmYWlsZWQuIExhc3QgZXJyb3I6ICR7bGFzdEVycm9yID09IG51bGwgPyB2b2lkIDAgOiBsYXN0RXJyb3IubWVzc2FnZX1gKTtcbiAgfVxufTtcbiIsICIvLyBjcml0aWMudHNcblxuaW1wb3J0IEtub3dsZWRnZUdyYXBoUGx1Z2luIGZyb20gJy4vbWFpbic7XG5pbXBvcnQgeyBBUElIYW5kbGVyIH0gZnJvbSAnLi9hcGlIYW5kbGVyJztcblxuZXhwb3J0IGNsYXNzIENyaXRpYyB7XG4gICAgcHJpdmF0ZSBwbHVnaW46IEtub3dsZWRnZUdyYXBoUGx1Z2luO1xuICAgIHByaXZhdGUgYXBpSGFuZGxlcjogQVBJSGFuZGxlcjtcblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogS25vd2xlZGdlR3JhcGhQbHVnaW4pIHtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgICAgIHRoaXMuYXBpSGFuZGxlciA9IG5ldyBBUElIYW5kbGVyKHBsdWdpbik7IC8vIENyaXRpYyBjYW4gaGF2ZSBpdHMgb3duIGhhbmRsZXIgaWYgbmVlZGVkXG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIGp1ZGdlKGNvbnRlbnQ6IHN0cmluZyk6IFByb21pc2U8eyBpc0FwcHJvdmVkOiBib29sZWFuLCByZWFzb246IHN0cmluZyB9PiB7XG4gICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jcml0aWNfbW9kZSA9PT0gJ2FpJykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2p1ZGdlQnlBSShjb250ZW50KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fanVkZ2VCeUhldXJpc3RpYyhjb250ZW50KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIF9qdWRnZUJ5SGV1cmlzdGljKGNvbnRlbnQ6IHN0cmluZyk6IHsgaXNBcHByb3ZlZDogYm9vbGVhbiwgcmVhc29uOiBzdHJpbmcgfSB7XG4gICAgICAgIGNvbnN0IHJlYXNvbnM6IHN0cmluZ1tdID0gW107XG4gICAgICAgIGNvbnN0IGNvbnRlbnRMb3dlciA9IGNvbnRlbnQudG9Mb3dlckNhc2UoKTtcblxuICAgICAgICAvLyAxLiBDaGVjayBmb3IgcmVxdWlyZWQgaGVhZGVyc1xuICAgICAgICBjb25zdCByZXF1aXJlZEhlYWRlcnMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jcml0aWNfcmVxdWlyZWRfaGVhZGVyc1xuICAgICAgICAgICAgLnNwbGl0KCdcXG4nKS5tYXAoaCA9PiBoLnRyaW0oKS50b0xvd2VyQ2FzZSgpKS5maWx0ZXIoQm9vbGVhbik7XG4gICAgICAgIGNvbnN0IG1pc3NpbmdIZWFkZXJzID0gcmVxdWlyZWRIZWFkZXJzLmZpbHRlcihoID0+ICFjb250ZW50TG93ZXIuaW5jbHVkZXMoaCkpO1xuICAgICAgICBpZiAobWlzc2luZ0hlYWRlcnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgcmVhc29ucy5wdXNoKGBcdTdGM0FcdTVDMTFcdTVGQzVcdTk3MDBcdTc2ODRcdTY4MDdcdTk4OTg6ICR7bWlzc2luZ0hlYWRlcnMuam9pbignLCAnKX1gKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIDIuIENoZWNrIGZvciBtaW4gbGVuZ3RoXG4gICAgICAgIGlmIChjb250ZW50Lmxlbmd0aCA8IHRoaXMucGx1Z2luLnNldHRpbmdzLmNyaXRpY19taW5fY29udGVudF9sZW5ndGgpIHtcbiAgICAgICAgICAgIHJlYXNvbnMucHVzaChgXHU1MTg1XHU1QkI5XHU4RkM3XHU3N0VEIChcdTVGNTNcdTUyNEQ6ICR7Y29udGVudC5sZW5ndGh9LCBcdTg5ODFcdTZDNDI6ICR7dGhpcy5wbHVnaW4uc2V0dGluZ3MuY3JpdGljX21pbl9jb250ZW50X2xlbmd0aH0pYCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyAzLiBDaGVjayBmb3IgcmVmdXNhbCBwYXR0ZXJuc1xuICAgICAgICBjb25zdCByZWZ1c2FsUGF0dGVybnMgPSBbXCJcdTRGNUNcdTRFM0FcdTRFMDA/XHU0RTJBQUlcIiwgXCJcdTRGNUNcdTRFM0FcdThCRURcdThBMDBcdTZBMjFcdTU3OEJcIiwgXCJcdTYyMTFcdTRFMERcdTgwRkRcIiwgXCJcdTYyMTFcdTY1RTBcdTZDRDVcIiwgXCJcdTVGODhcdTYyQjFcdTZCNDlcIl07XG4gICAgICAgIGZvciAoY29uc3QgcGF0dGVybiBvZiByZWZ1c2FsUGF0dGVybnMpIHtcbiAgICAgICAgICAgIGlmIChuZXcgUmVnRXhwKHBhdHRlcm4sICdpJykudGVzdChjb250ZW50KSkge1xuICAgICAgICAgICAgICAgIHJlYXNvbnMucHVzaChgXHU1MzA1XHU1NDJCQUlcdTYyRDJcdTdFRERcdThCRUQgKFx1NTMzOVx1OTE0RDogJyR7cGF0dGVybn0nKWApO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaXNBcHByb3ZlZDogcmVhc29ucy5sZW5ndGggPT09IDAsXG4gICAgICAgICAgICByZWFzb246IHJlYXNvbnMubGVuZ3RoID4gMCA/IHJlYXNvbnMuam9pbignOyAnKSA6IFwiXHU5MDFBXHU4RkM3XHU2MjQwXHU2NzA5XHU1NDJGXHU1M0QxXHU1RjBGXHU4OUM0XHU1MjE5XHU2OEMwXHU2N0U1XHUzMDAyXCJcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIF9qdWRnZUJ5QUkoY29udGVudDogc3RyaW5nKTogUHJvbWlzZTx7IGlzQXBwcm92ZWQ6IGJvb2xlYW4sIHJlYXNvbjogc3RyaW5nIH0+IHtcbiAgICAgICAgY29uc3QgcHJvbXB0ID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvbXB0X2NyaXRpYy5yZXBsYWNlKCd7Y29udGVudH0nLCBjb250ZW50KTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5hcGlIYW5kbGVyLmNhbGwocHJvbXB0KTtcbiAgICAgICAgICAgIGNvbnN0IGRlY2lzaW9uTWF0Y2ggPSByZXNwb25zZS5tYXRjaCgvREVDSVNJT046XFxzKihLRUVQfERJU0NBUkQpL2kpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBcdTMwMTBcdTMwMTBcdTMwMTAgXHU1REYyXHU0RkVFXHU1OTBEXHVGRjFBXHU2REZCXHU1MkEwIC9pIFx1NjgwN1x1NUZEN1x1RkYwQ1x1NEY3Rlx1NTE3Nlx1NEUwRFx1NTMzQVx1NTIwNlx1NTkyN1x1NUMwRlx1NTE5OSBcdTMwMTFcdTMwMTFcdTMwMTFcbiAgICAgICAgICAgIGNvbnN0IHJlYXNvbk1hdGNoID0gcmVzcG9uc2UubWF0Y2goL1xcW1JFQVNPTjpcXHMqKFteXFxdXSspXFxdL2kpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCBpc0FwcHJvdmVkID0gZGVjaXNpb25NYXRjaCA/IGRlY2lzaW9uTWF0Y2hbMV0udG9VcHBlckNhc2UoKSA9PT0gJ0tFRVAnIDogZmFsc2U7XG4gICAgICAgICAgICBjb25zdCByZWFzb24gPSByZWFzb25NYXRjaCA/IHJlYXNvbk1hdGNoWzFdLnRyaW0oKSA6IChpc0FwcHJvdmVkID8gXCJBSSBcdTYyNzlcdTUxQzZcIiA6IFwiQUkgXHU2MkQyXHU3RUREXHVGRjBDXHU2NzJBXHU2M0QwXHU0RjlCXHU2NjBFXHU3ODZFXHU3NDA2XHU3NTMxXCIpO1xuXG4gICAgICAgICAgICByZXR1cm4geyBpc0FwcHJvdmVkLCByZWFzb24gfTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJBSSBDcml0aWMgY2FsbCBmYWlsZWQ6XCIsIGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiB7IGlzQXBwcm92ZWQ6IGZhbHNlLCByZWFzb246IGBBSSBcdTVCQTFcdTY4MzhcdTU2NjhcdThDMDNcdTc1MjhcdTU5MzFcdThEMjU6ICR7ZXJyb3IubWVzc2FnZX1gIH07XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCAiLy8gcmV2aXNlci50c1xuXG5pbXBvcnQgS25vd2xlZGdlR3JhcGhQbHVnaW4gZnJvbSAnLi9tYWluJztcblxuZXhwb3J0IGNsYXNzIFJldmlzZXIge1xuICAgIHByaXZhdGUgcGx1Z2luOiBLbm93bGVkZ2VHcmFwaFBsdWdpbjtcblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogS25vd2xlZGdlR3JhcGhQbHVnaW4pIHtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0ZVJldmlzaW9uUHJvbXB0KGlkZWE6IHN0cmluZywgb3JpZ2luYWxDb250ZW50OiBzdHJpbmcsIHJlamVjdGlvblJlYXNvbjogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgbGV0IHByb21wdCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnByb21wdF9yZXZpc2VyO1xuICAgICAgICBwcm9tcHQgPSBwcm9tcHQucmVwbGFjZSgne2NvbmNlcHR9JywgaWRlYSk7XG4gICAgICAgIHByb21wdCA9IHByb21wdC5yZXBsYWNlKCd7b3JpZ2luYWxfY29udGVudH0nLCBvcmlnaW5hbENvbnRlbnQpO1xuICAgICAgICBwcm9tcHQgPSBwcm9tcHQucmVwbGFjZSgne3JlamVjdGlvbl9yZWFzb259JywgcmVqZWN0aW9uUmVhc29uKTtcbiAgICAgICAgcmV0dXJuIHByb21wdDtcbiAgICB9XG59XG4iLCAiLy8gdXRpbHMudHMgKFx1NTM5Rlx1NTlDQlx1N0EzM1x1NUI5QVx1NzI0OClcblxuZXhwb3J0IGZ1bmN0aW9uIHNhbml0aXplRmlsZW5hbWUobmFtZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAvLyBcdTc5RkJcdTk2NjRcdTYyRUNcdTUzRjdcdTUzQ0FcdTUxNzZcdTUxODVcdTVCQjlcbiAgICBsZXQgY2xlYW5OYW1lID0gbmFtZS5yZXBsYWNlKC9cXHMqXFwoLipcXCkvZywgJycpLnRyaW0oKTtcbiAgICAvLyBcdTc5RkJcdTk2NjRcdTY1ODdcdTRFRjZcdTdDRkJcdTdFREZcdTRFMERcdTUxNDFcdThCQjhcdTc2ODRcdTVCNTdcdTdCMjZcbiAgICBjbGVhbk5hbWUgPSBjbGVhbk5hbWUucmVwbGFjZSgvW1xcXFwvKj86XCI8PnxdL2csIFwiXCIpO1xuICAgIC8vIFx1OTY1MFx1NTIzNlx1OTU3Rlx1NUVBNlxuICAgIHJldHVybiBjbGVhbk5hbWUuc2xpY2UoMCwgMTAwKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGV4dHJhY3ROZXdJZGVhcyhjb250ZW50OiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgbWF0Y2hlcyA9IGNvbnRlbnQubWF0Y2goL1xcW1xcWyhbXlxcXV0rKVxcXVxcXS9nKTtcbiAgICBpZiAoIW1hdGNoZXMpIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICAvLyBcdTRFQ0UgW1tMaW5rfEFsaWFzXV0gXHU2MjE2IFtbTGlua11dIFx1NEUyRFx1NjNEMFx1NTNENiBcIkxpbmtcIlxuICAgIGNvbnN0IGlkZWFzID0gbWF0Y2hlcy5tYXAobWF0Y2ggPT4ge1xuICAgICAgICByZXR1cm4gbWF0Y2guc2xpY2UoMiwgLTIpLnNwbGl0KCd8JylbMF0udHJpbSgpO1xuICAgIH0pO1xuICAgIHJldHVybiBbLi4ubmV3IFNldChpZGVhcyldOyAvLyBcdThGRDRcdTU2REVcdTUzQkJcdTkxQ0RcdTU0MEVcdTc2ODRcdTdFRDNcdTY3OUNcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFuTWFya2Rvd25PdXRwdXQoY29udGVudDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCB0cmltbWVkID0gY29udGVudC50cmltKCk7XG4gICAgaWYgKHRyaW1tZWQuc3RhcnRzV2l0aChcImBgYG1hcmtkb3duXCIpICYmIHRyaW1tZWQuZW5kc1dpdGgoXCJgYGBcIikpIHtcbiAgICAgICAgbGV0IGNsZWFuZWQgPSB0cmltbWVkLnN1YnN0cmluZyhcImBgYG1hcmtkb3duXCIubGVuZ3RoLCB0cmltbWVkLmxlbmd0aCAtIFwiYGBgXCIubGVuZ3RoKTtcbiAgICAgICAgcmV0dXJuIGNsZWFuZWQudHJpbSgpO1xuICAgIH1cbiAgICByZXR1cm4gdHJpbW1lZDtcbn1cbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7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
