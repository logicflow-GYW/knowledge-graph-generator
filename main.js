/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => KnowledgeGraphPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian5 = require("obsidian");

// settings.ts
var import_obsidian2 = require("obsidian");

// QueueModal.ts
var import_obsidian = require("obsidian");
var QueueManagementModal = class extends import_obsidian.Modal {
  constructor(app, plugin) {
    super(app);
    // 用于保存搜索词
    this.searchTerms = {
      gen: "",
      rev: "",
      rep: "",
      dis: ""
    };
    // 【【【 已修改：默认全部折叠 】】】
    this.collapseStates = {
      gen: false,
      // 默认折叠
      rev: false,
      // 默认折叠
      rep: false,
      // 默认折叠
      dis: false
      // 默认折叠
    };
    this.plugin = plugin;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.addClass("kg-modal");
    contentEl.createEl("h2", { text: "\u961F\u5217\u7BA1\u7406\u4EEA\u8868\u76D8" });
    const status = this.plugin.data.status;
    const statusText = `\u72B6\u6001: ${status.toUpperCase()} | ${this.plugin.statusBarEl.getText()}`;
    new import_obsidian.Setting(contentEl).setName(status === "running" ? "\u5F15\u64CE\u8FD0\u884C\u4E2D" : "\u5F15\u64CE\u5DF2\u6682\u505C").setDesc(statusText).addButton(
      (button) => button.setButtonText(status === "running" ? "\u6682\u505C\u5F15\u64CE" : "\u542F\u52A8\u5F15\u64CE").setCta(status !== "running").onClick(() => {
        this.plugin.engine.toggleEngineState();
        this.onOpen();
      })
    );
    this.renderQueueSection(
      contentEl,
      "gen",
      "\u5F85\u751F\u6210 (Generation)",
      this.plugin.data.generationQueue,
      this.renderGenerationItem.bind(this)
    );
    this.renderQueueSection(
      contentEl,
      "rev",
      "\u5F85\u5BA1\u6838 (Review)",
      this.plugin.data.reviewQueue,
      this.renderReviewItem.bind(this)
    );
    this.renderQueueSection(
      contentEl,
      "rep",
      "\u5F85\u4FEE\u6B63 (Revision)",
      this.plugin.data.revisionQueue,
      this.renderRevisionItem.bind(this)
    );
    this.renderQueueSection(
      contentEl,
      "dis",
      "\u5DF2\u4E22\u5F03 (Discarded)",
      this.plugin.data.discardedPile,
      this.renderDiscardedItem.bind(this)
    );
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
  /**
   * 渲染一个队列区域 (带搜索和展开/折叠)
   */
  renderQueueSection(containerEl, key, title, data, renderFn) {
    const displayLimit = 100;
    const filter = this.searchTerms[key];
    const filteredData = data.filter((item) => {
      if (!filter)
        return true;
      const needle = filter.toLowerCase();
      if (typeof item === "string") {
        return item.toLowerCase().includes(needle);
      }
      return item.idea.toLowerCase().includes(needle);
    });
    const total = data.length;
    const filteredTotal = filteredData.length;
    const titleText = `${title} (${filteredTotal}${total !== filteredTotal ? " / " + total : ""} \u9879)`;
    const details = containerEl.createEl("details");
    details.open = this.collapseStates[key];
    const summary = details.createEl("summary", { text: titleText });
    summary.style.fontWeight = "bold";
    summary.style.fontSize = "var(--font-ui-large)";
    summary.style.cursor = "pointer";
    summary.style.padding = "5px 0";
    details.addEventListener("toggle", () => {
      this.collapseStates[key] = details.open;
    });
    new import_obsidian.Setting(details).setDesc(`\u641C\u7D22 ${title}...`).addText((text) => {
      text.setPlaceholder("\u8F93\u5165\u5173\u952E\u8BCD...").setValue(this.searchTerms[key]).onChange((value) => {
        this.searchTerms[key] = value;
        this.onOpen();
      });
    });
    const truncatedData = filteredData.slice(0, displayLimit);
    if (truncatedData.length === 0) {
      const desc = details.createEl("p", { text: "\u6B64\u961F\u5217\u4E3A\u7A7A\uFF0C\u6216\u672A\u627E\u5230\u5339\u914D\u9879\u3002", cls: "setting-item-description" });
      desc.style.paddingLeft = "10px";
      return;
    }
    const listContainer = details.createDiv("kg-list-container");
    listContainer.style.maxHeight = "200px";
    listContainer.style.overflowY = "auto";
    listContainer.style.border = "1px solid var(--background-modifier-border)";
    listContainer.style.padding = "5px";
    listContainer.style.marginLeft = "10px";
    truncatedData.forEach((item, index) => {
      renderFn(listContainer, item, index);
    });
    if (filteredData.length > displayLimit) {
      const truncatedInfo = details.createEl("p", {
        text: `... \u4EC5\u663E\u793A\u524D ${displayLimit} \u9879 (\u5171 ${filteredData.length} \u9879)\uFF0C\u8BF7\u4F7F\u7528\u641C\u7D22\u67E5\u627E\u66F4\u591A\u3002`,
        cls: "setting-item-description"
      });
      truncatedInfo.style.paddingLeft = "10px";
    }
  }
  // --- 单项渲染函数 (保持不变) ---
  renderGenerationItem(container, item) {
    new import_obsidian.Setting(container).setName(item).addButton(
      (btn) => btn.setIcon("trash").setTooltip("\u5220\u9664\u6B64\u6982\u5FF5").onClick(async () => {
        const queue = this.plugin.data.generationQueue;
        const index = queue.indexOf(item);
        if (index > -1) {
          queue.splice(index, 1);
          await this.plugin.savePluginData();
          this.plugin.engine.updateStatusBar();
          this.onOpen();
        }
      })
    );
  }
  renderReviewItem(container, item) {
    const task = item;
    new import_obsidian.Setting(container).setName(`[\u5BA1\u6838] ${task.idea}`).addButton(
      (btn) => btn.setIcon("trash").setTooltip("\u4E22\u5F03\u6B64\u4EFB\u52A1").onClick(async () => {
        this.plugin.data.reviewQueue.splice(this.plugin.data.reviewQueue.indexOf(task), 1);
        this.plugin.data.discardedPile.push(task);
        await this.plugin.savePluginData();
        this.plugin.engine.updateStatusBar();
        this.onOpen();
      })
    );
  }
  renderRevisionItem(container, item) {
    const task = item;
    new import_obsidian.Setting(container).setName(`[\u4FEE\u6B63] ${task.idea}`).setDesc(`\u539F\u56E0: ${task.reason || "\u672A\u77E5"}`).addButton(
      (btn) => btn.setIcon("trash").setTooltip("\u4E22\u5F03\u6B64\u4EFB\u52A1").onClick(async () => {
        this.plugin.data.revisionQueue.splice(this.plugin.data.revisionQueue.indexOf(task), 1);
        this.plugin.data.discardedPile.push(task);
        await this.plugin.savePluginData();
        this.plugin.engine.updateStatusBar();
        this.onOpen();
      })
    );
  }
  renderDiscardedItem(container, item) {
    const task = item;
    new import_obsidian.Setting(container).setName(`[\u5DF2\u4E22\u5F03] ${task.idea}`).setDesc(`\u6700\u540E\u539F\u56E0: ${task.reason || "\u672A\u77E5"}`).addButton(
      (btn) => btn.setIcon("refresh-cw").setTooltip("\u91CD\u65B0\u6392\u961F (\u653E\u56DE\u751F\u6210\u961F\u5217)").onClick(async () => {
        this.plugin.data.discardedPile.splice(this.plugin.data.discardedPile.indexOf(task), 1);
        this.plugin.engine.addConceptsToQueue([task.idea]);
        this.onOpen();
      })
    );
  }
};

// settings.ts
var PROMPT_GENERATOR_DEFAULT = `# Role: \u77E5\u8BC6\u7CFB\u7EDF\u6784\u5EFA\u4E13\u5BB6...`;
var PROMPT_CRITIC_DEFAULT = `# Role: \u77E5\u8BC6\u56FE\u8C31\u8D28\u91CF\u5BA1\u6838\u5458...`;
var PROMPT_REVISER_DEFAULT = `# \u89D2\u8272: \u8D44\u6DF1\u77E5\u8BC6\u7F16\u8F91\u4E0E\u5185\u5BB9\u4F18\u5316\u4E13\u5BB6...`;
var DEFAULT_SETTINGS = {
  // API
  openai_api_keys: "",
  openai_base_url: "https://api.openai.com/v1",
  openai_model: "gpt-4-turbo-preview",
  google_api_keys: "",
  google_model: "gemini-1.5-pro-latest",
  failover_cooldown_seconds: 300,
  // 参数
  generation_temperature: 0.7,
  generation_max_tokens: 4096,
  // 路径
  output_dir: "KnowledgeGraphNotes",
  // 系统
  max_workers: 2,
  generation_batch_size: 5,
  request_delay: 5,
  // Critic
  critic_mode: "heuristic",
  critic_required_headers: "# \u{1F9E0}\n> \n## \u{1F4DD} \u6838\u5FC3\u601D\u60F3\n## \u{1F3AF} \u9002\u7528\u573A\u666F\n## \u{1F6E0}\uFE0F \u4F7F\u7528\u6B65\u9AA4/\u6784\u6210\u8981\u7D20\n## \u{1F680} \u6848\u4F8B\u5206\u6790\n## \u{1F44D} \u4F18\u70B9 & \u{1F44E} \u7F3A\u70B9\n## \u{1F517} \u5173\u8054\u6A21\u578B",
  critic_min_content_length: 400,
  // Reviser
  max_revision_retries: 2,
  // Prompts
  prompt_generator: PROMPT_GENERATOR_DEFAULT,
  prompt_critic: PROMPT_CRITIC_DEFAULT,
  prompt_reviser: PROMPT_REVISER_DEFAULT,
  // 播种箱
  seedConcepts: ""
};
async function getDefaultPrompts() {
  return {
    prompt_generator: PROMPT_GENERATOR_DEFAULT,
    prompt_critic: PROMPT_CRITIC_DEFAULT,
    prompt_reviser: PROMPT_REVISER_DEFAULT
  };
}
var KGsSettingTab = class extends import_obsidian2.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "\u77E5\u8BC6\u56FE\u8C31\u751F\u6210\u5668 - \u8BBE\u7F6E" });
    new import_obsidian2.Setting(containerEl).setName("\u5F15\u64CE\u4EEA\u8868\u76D8").setDesc("\u7BA1\u7406\u5F85\u751F\u6210\u3001\u5F85\u5BA1\u6838\u548C\u5DF2\u4E22\u5F03\u7684\u4EFB\u52A1\u3002").addButton(
      (button) => button.setButtonText("\u6253\u5F00\u961F\u5217\u7BA1\u7406\u5668").setCta().onClick(() => {
        new QueueManagementModal(this.app, this.plugin).open();
      })
    );
    new import_obsidian2.Setting(containerEl).setName("API \u8BBE\u7F6E").setHeading();
    containerEl.createEl("h3", { text: "OpenAI" });
    new import_obsidian2.Setting(containerEl).setName("OpenAI API Keys").setDesc("\u6BCF\u884C\u4E00\u4E2A Key\u3002\u63D2\u4EF6\u5C06\u81EA\u52A8\u8F6E\u6362\u548C\u51B7\u5374\u4F7F\u7528\u3002").addTextArea((text) => text.setPlaceholder("sk-...").setValue(this.plugin.settings.openai_api_keys).onChange(async (value) => {
      this.plugin.settings.openai_api_keys = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("OpenAI Base URL").setDesc("\u5982\u679C\u4F60\u4F7F\u7528\u7B2C\u4E09\u65B9\u4EE3\u7406\uFF0C\u8BF7\u5728\u6B64\u5904\u586B\u5165\u4EE3\u7406\u5730\u5740\u3002").addText((text) => text.setPlaceholder("https://api.openai.com/v1").setValue(this.plugin.settings.openai_base_url).onChange(async (value) => {
      this.plugin.settings.openai_base_url = value.trim();
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("OpenAI Model").setDesc("\u8F93\u5165\u4F60\u60F3\u4F7F\u7528\u7684 OpenAI \u6A21\u578B\u540D\u79F0\u3002").addText((text) => text.setPlaceholder("gpt-4-turbo-preview").setValue(this.plugin.settings.openai_model).onChange(async (value) => {
      this.plugin.settings.openai_model = value.trim();
      await this.plugin.saveSettings();
    }));
    containerEl.createEl("h3", { text: "Google Gemini" });
    new import_obsidian2.Setting(containerEl).setName("Google Gemini API Keys").setDesc("\u6BCF\u884C\u4E00\u4E2A Key\u3002").addTextArea((text) => text.setPlaceholder("AIzaSy...").setValue(this.plugin.settings.google_api_keys).onChange(async (value) => {
      this.plugin.settings.google_api_keys = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("Google Gemini Model").setDesc("\u8F93\u5165\u4F60\u60F3\u4F7F\u7528\u7684 Google \u6A21\u578B\u540D\u79F0\u3002").addText((text) => text.setPlaceholder("gemini-1.5-pro-latest").setValue(this.plugin.settings.google_model).onChange(async (value) => {
      this.plugin.settings.google_model = value.trim();
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("Key \u51B7\u5374\u65F6\u95F4 (\u79D2)").setDesc("API Key \u5931\u8D25\u540E\uFF0C\u9700\u8981\u7B49\u5F85\u591A\u5C11\u79D2\u624D\u80FD\u518D\u6B21\u4F7F\u7528\u3002").addText((text) => text.setValue(String(this.plugin.settings.failover_cooldown_seconds)).onChange(async (value) => {
      const num = parseInt(value, 10);
      if (!isNaN(num) && num >= 0) {
        this.plugin.settings.failover_cooldown_seconds = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("LLM \u53C2\u6570\u8BBE\u7F6E").setHeading();
    new import_obsidian2.Setting(containerEl).setName("\u751F\u6210\u6E29\u5EA6 (Temperature)").setDesc("\u63A7\u5236\u751F\u6210\u5185\u5BB9\u7684\u968F\u673A\u6027\u3002\u8F83\u4F4E\u7684\u503C\uFF08\u5982 0.2\uFF09\u66F4\u5177\u786E\u5B9A\u6027\uFF0C\u8F83\u9AD8\u7684\u503C\uFF08\u5982 0.8\uFF09\u66F4\u5177\u521B\u9020\u6027\u3002").addText((text) => text.setValue(String(this.plugin.settings.generation_temperature)).onChange(async (value) => {
      const num = parseFloat(value);
      if (!isNaN(num) && num >= 0 && num <= 2) {
        this.plugin.settings.generation_temperature = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("\u6700\u5927 Token \u6570 (Max Tokens)").setDesc("API \u4E00\u6B21\u8C03\u7528\u5141\u8BB8\u751F\u6210\u7684\u6700\u5927 Token \u6570\u91CF\u3002").addText((text) => text.setValue(String(this.plugin.settings.generation_max_tokens)).onChange(async (value) => {
      const num = parseInt(value, 10);
      if (!isNaN(num) && num > 0) {
        this.plugin.settings.generation_max_tokens = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("\u5F15\u64CE\u8BBE\u7F6E").setHeading();
    new import_obsidian2.Setting(containerEl).setName("\u8F93\u51FA\u6587\u4EF6\u5939").setDesc("\u6240\u6709\u751F\u6210\u7684\u7B14\u8BB0\u5C06\u4FDD\u5B58\u5230\u6B64\u6587\u4EF6\u5939\u3002").addText((text) => text.setPlaceholder("KnowledgeGraphNotes").setValue(this.plugin.settings.output_dir).onChange(async (value) => {
      this.plugin.settings.output_dir = value.trim().replace(/\/$/, "");
      await this.plugin.saveSettings();
    }));
    new import_obsidian2.Setting(containerEl).setName("\u6700\u5927\u5E76\u53D1\u6570 (Max Workers)").setDesc("\uFF08\u6CE8\u610F\uFF1A\u5F53\u524D V2.2 \u5F15\u64CE\u4E3A\u5355\u7EBF\u7A0B\u6D41\u6C34\u7EBF\uFF0C\u6B64\u8BBE\u7F6E\u6682\u672A\u751F\u6548\uFF09").addText((text) => text.setValue(String(this.plugin.settings.max_workers)).onChange(async (value) => {
      const num = parseInt(value, 10);
      if (!isNaN(num) && num > 0) {
        this.plugin.settings.max_workers = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("\u751F\u6210\u6279\u5904\u7406\u5927\u5C0F").setDesc("\u5F15\u64CE\u6BCF\u4E00\u8F6E\u4ECE\u201C\u5F85\u751F\u6210\u961F\u5217\u201D\u4E2D\u53D6\u51FA\u7684\u4EFB\u52A1\u6570\u91CF\u3002").addText((text) => text.setValue(String(this.plugin.settings.generation_batch_size)).onChange(async (value) => {
      const num = parseInt(value, 10);
      if (!isNaN(num) && num > 0) {
        this.plugin.settings.generation_batch_size = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("\u6BCF\u8F6E\u8BF7\u6C42\u5EF6\u8FDF (\u79D2)").setDesc("\u5F15\u64CE\u5728\u5904\u7406\u5B8C\u4E00\u4E2A\u6279\u6B21\u540E\uFF0C\u7B49\u5F85\u591A\u5C11\u79D2\u518D\u5F00\u59CB\u4E0B\u4E00\u4E2A\u6279\u6B21\u3002").addText((text) => text.setValue(String(this.plugin.settings.request_delay)).onChange(async (value) => {
      const num = parseInt(value, 10);
      if (!isNaN(num) && num >= 0) {
        this.plugin.settings.request_delay = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("\u6700\u5927\u4FEE\u6B63\u6B21\u6570").setDesc("\u4E00\u7BC7\u7B14\u8BB0\u5728\u88AB\u653E\u5F03\uFF08\u79FB\u5165 Discarded Pile\uFF09\u524D\uFF0C\u6700\u591A\u5141\u8BB8\u88AB\u4FEE\u6B63\u7684\u6B21\u6570\u3002").addText((text) => text.setValue(String(this.plugin.settings.max_revision_retries)).onChange(async (value) => {
      const num = parseInt(value, 10);
      if (!isNaN(num) && num >= 0) {
        this.plugin.settings.max_revision_retries = num;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("\u5BA1\u6838\u6A21\u5F0F (Critic Mode)").setDesc("\u9009\u62E9\u5185\u5BB9\u5BA1\u6838\u7684\u65B9\u5F0F\u3002\u542F\u53D1\u5F0F\u6A21\u5F0F\u901F\u5EA6\u5FEB\u4E14\u514D\u8D39\uFF0C\u4F46\u53EA\u68C0\u67E5\u683C\u5F0F\uFF1BAI\u6A21\u5F0F\u66F4\u667A\u80FD\uFF0C\u4F46\u4F1A\u6D88\u8017API\u989D\u5EA6\u3002").addDropdown((dropdown) => dropdown.addOption("heuristic", "\u542F\u53D1\u5F0F (Heuristic)").addOption("ai", "\u4EBA\u5DE5\u667A\u80FD (AI)").setValue(this.plugin.settings.critic_mode).onChange(async (value) => {
      this.plugin.settings.critic_mode = value;
      await this.plugin.saveSettings();
      this.display();
    }));
    if (this.plugin.settings.critic_mode === "heuristic") {
      new import_obsidian2.Setting(containerEl).setName("\u542F\u53D1\u5F0F\u5BA1\u6838\uFF1A\u5FC5\u9700\u7684\u6807\u9898").setDesc("\u5728\u542F\u53D1\u5F0F\u6A21\u5F0F\u4E0B\uFF0C\u68C0\u67E5\u7B14\u8BB0\u662F\u5426\u5305\u542B\u6240\u6709\u8FD9\u4E9B\u6807\u9898\uFF08\u6BCF\u884C\u4E00\u4E2A\uFF09\u3002").addTextArea((text) => text.setValue(this.plugin.settings.critic_required_headers).onChange(async (value) => {
        this.plugin.settings.critic_required_headers = value;
        await this.plugin.saveSettings();
      }).inputEl.style.height = "150px");
      new import_obsidian2.Setting(containerEl).setName("\u542F\u53D1\u5F0F\u5BA1\u6838\uFF1A\u6700\u5C0F\u5185\u5BB9\u957F\u5EA6").setDesc("\u5728\u542F\u53D1\u5F0F\u6A21\u5F0F\u4E0B\uFF0C\u7B14\u8BB0\u5185\u5BB9\u5FC5\u987B\u8FBE\u5230\u7684\u6700\u5C0F\u5B57\u7B26\u6570\u3002").addText((text) => text.setValue(String(this.plugin.settings.critic_min_content_length)).onChange(async (value) => {
        const num = parseInt(value, 10);
        if (!isNaN(num) && num >= 0) {
          this.plugin.settings.critic_min_content_length = num;
          await this.plugin.saveSettings();
        }
      }));
    }
    new import_obsidian2.Setting(containerEl).setName("\u6982\u5FF5\u64AD\u79CD (Concept Seeding)").setHeading();
    new import_obsidian2.Setting(containerEl).setName("\u6982\u5FF5\u64AD\u79CD\u7BB1").setDesc("\u5728\u6B64\u5904\u7C98\u8D34\u6216\u8F93\u5165\u60A8\u60F3\u8981\u751F\u6210\u521D\u59CB\u7B14\u8BB0\u7684\u6982\u5FF5\u5217\u8868\uFF0C\u6BCF\u884C\u4E00\u4E2A\u6982\u5FF5\u3002").addTextArea(
      (text) => text.setPlaceholder("\u4F8B\u5982\uFF1A\n\u7B2C\u4E00\u6027\u539F\u7406\n\u5965\u5361\u59C6\u5243\u5200\n\u523B\u610F\u7EC3\u4E60\n...").setValue(this.plugin.settings.seedConcepts).onChange(async (value) => {
        this.plugin.settings.seedConcepts = value;
        await this.plugin.saveSettings();
      }).inputEl.style.height = "200px"
    );
    new import_obsidian2.Setting(containerEl).addButton(
      (button) => button.setButtonText("\u64AD\u79CD\u5230\u5F85\u751F\u6210\u961F\u5217").setCta().onClick(async () => {
        const rawText = this.plugin.settings.seedConcepts;
        if (!rawText.trim()) {
          new import_obsidian2.Notice("\u64AD\u79CD\u7BB1\u4E3A\u7A7A\uFF0C\u65E0\u9700\u64CD\u4F5C\u3002");
          return;
        }
        const conceptsToSeed = [...new Set(rawText.split("\n").map((line) => line.trim()).filter(Boolean))];
        const addedCount = this.plugin.engine.addConceptsToQueue(conceptsToSeed);
        const ignoredCount = conceptsToSeed.length - addedCount;
        let noticeMessage = `\u6210\u529F\u6DFB\u52A0 ${addedCount} \u4E2A\u65B0\u6982\u5FF5\u5230\u961F\u5217\u3002`;
        if (ignoredCount > 0) {
          noticeMessage += `
${ignoredCount} \u4E2A\u6982\u5FF5\u56E0\u5DF2\u5B58\u5728\u6216\u91CD\u590D\u800C\u88AB\u5FFD\u7565\u3002`;
        }
        new import_obsidian2.Notice(noticeMessage, 5e3);
        this.plugin.settings.seedConcepts = "";
        await this.plugin.saveSettings();
        this.display();
      })
    );
    new import_obsidian2.Setting(containerEl).setName("Prompts \u8BBE\u7F6E").setHeading();
    new import_obsidian2.Setting(containerEl).setName("\u751F\u6210 Prompt").setDesc("\u7528\u4E8E\u751F\u6210\u65B0\u6982\u5FF5\u5185\u5BB9\u7684 Prompt\u3002").addTextArea((text) => text.setValue(this.plugin.settings.prompt_generator).onChange(async (value) => {
      this.plugin.settings.prompt_generator = value;
      await this.plugin.saveSettings();
    }).inputEl.style.height = "300px");
    if (this.plugin.settings.critic_mode === "ai") {
      new import_obsidian2.Setting(containerEl).setName("\u5BA1\u6838 Prompt (Critic)").setDesc("\u7528\u4E8E AI \u6A21\u5F0F\u4E0B\u5BA1\u6838\u751F\u6210\u5185\u5BB9\u7684 Prompt\u3002").addTextArea((text) => text.setValue(this.plugin.settings.prompt_critic).onChange(async (value) => {
        this.plugin.settings.prompt_critic = value;
        await this.plugin.saveSettings();
      }).inputEl.style.height = "300px");
    }
    new import_obsidian2.Setting(containerEl).setName("\u4FEE\u6B63 Prompt (Reviser)").setDesc("\u7528\u4E8E\u4FEE\u6B63\u88AB\u5BA1\u6838\u5458\u62D2\u7EDD\u5185\u5BB9\u7684 Prompt\u3002").addTextArea((text) => text.setValue(this.plugin.settings.prompt_reviser).onChange(async (value) => {
      this.plugin.settings.prompt_reviser = value;
      await this.plugin.saveSettings();
    }).inputEl.style.height = "300px");
  }
};

// engine.ts
var import_obsidian4 = require("obsidian");

// apiHandler.ts
var import_obsidian3 = require("obsidian");
var ApiKeyExhaustedError = class extends Error {
  constructor(message) {
    super(message);
    this.name = "ApiKeyExhaustedError";
  }
};
var AllModelsFailedError = class extends Error {
  constructor(message) {
    super(message);
    this.name = "AllModelsFailedError";
  }
};
var APIHandler = class {
  constructor(plugin) {
    this.keyUsageOpenAI = /* @__PURE__ */ new Map();
    this.keyUsageGoogle = /* @__PURE__ */ new Map();
    // 用于跟踪是否已经通知过故障切换
    this.hasNotifiedFailover = false;
    this.plugin = plugin;
    this.settings = plugin.settings;
    this.updateKeys();
  }
  updateKeys() {
    this.openai_keys = this.settings.openai_api_keys.split("\n").map((k) => k.trim()).filter(Boolean);
    this.google_keys = this.settings.google_api_keys.split("\n").map((k) => k.trim()).filter(Boolean);
    this.openai_keys.forEach((key) => {
      if (!this.keyUsageOpenAI.has(key)) {
        this.keyUsageOpenAI.set(key, { fails: 0, cooldown_until: 0 });
      }
    });
    this.google_keys.forEach((key) => {
      if (!this.keyUsageGoogle.has(key)) {
        this.keyUsageGoogle.set(key, { fails: 0, cooldown_until: 0 });
      }
    });
  }
  _selectKey(keys, provider) {
    const keyUsageMap = provider === "openai" ? this.keyUsageOpenAI : this.keyUsageGoogle;
    const currentTime = Date.now() / 1e3;
    for (const key of keys) {
      const usage = keyUsageMap.get(key);
      if (usage && currentTime >= usage.cooldown_until) {
        return key;
      }
    }
    return null;
  }
  async _callOpenAI(key, prompt) {
    var _a;
    try {
      const response = await (0, import_obsidian3.requestUrl)({
        url: `${this.settings.openai_base_url}/chat/completions`,
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "Authorization": `Bearer ${key}`
        },
        body: JSON.stringify({
          model: this.settings.openai_model,
          messages: [{ role: "user", content: prompt }],
          temperature: this.settings.generation_temperature,
          max_tokens: this.settings.generation_max_tokens
        })
      });
      const data = response.json;
      const keyUsage = this.keyUsageOpenAI.get(key);
      if (keyUsage)
        keyUsage.cooldown_until = 0;
      this.hasNotifiedFailover = false;
      return data.choices[0].message.content.trim();
    } catch (error) {
      console.error(`OpenAI API call failed for key ...${key.slice(-4)}:`, error);
      const keyUsage = this.keyUsageOpenAI.get(key);
      if (keyUsage) {
        const httpStatus = error.status;
        const errorMessage = ((_a = error.message) == null ? void 0 : _a.toLowerCase()) || "";
        if (httpStatus === 401 || httpStatus === 403 || httpStatus === 429 || errorMessage.includes("insufficient_quota") || errorMessage.includes("rate limit")) {
          console.warn(`Key ...${key.slice(-4)} exhausted. Applying full cooldown.`);
          keyUsage.cooldown_until = Date.now() / 1e3 + this.settings.failover_cooldown_seconds;
        } else {
          console.warn(`Key ...${key.slice(-4)} failed due to network/server error. No cooldown applied.`);
        }
      }
      throw new ApiKeyExhaustedError(`OpenAI key failed.`);
    }
  }
  async _callGoogleAPI(key, prompt) {
    var _a;
    const url = `https://generativelanguage.googleapis.com/v1beta/models/${this.settings.google_model}:generateContent?key=${key}`;
    try {
      const response = await (0, import_obsidian3.requestUrl)({
        url,
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          contents: [{ parts: [{ text: prompt }] }],
          generationConfig: {
            temperature: this.settings.generation_temperature,
            maxOutputTokens: this.settings.generation_max_tokens
          }
        })
      });
      const data = response.json;
      if (!data.candidates || data.candidates.length === 0) {
        throw new Error("API response is missing candidates. Full response: " + JSON.stringify(data));
      }
      const keyUsage = this.keyUsageGoogle.get(key);
      if (keyUsage)
        keyUsage.cooldown_until = 0;
      return data.candidates[0].content.parts[0].text.trim();
    } catch (error) {
      console.error(`Google Gemini API call failed for key ...${key.slice(-4)}:`, error);
      const keyUsage = this.keyUsageGoogle.get(key);
      if (keyUsage) {
        const httpStatus = error.status;
        const errorMessage = ((_a = error.message) == null ? void 0 : _a.toLowerCase()) || "";
        if (httpStatus === 401 || httpStatus === 403 || httpStatus === 429 || errorMessage.includes("quota") || errorMessage.includes("permission")) {
          console.warn(`Google Key ...${key.slice(-4)} exhausted. Applying full cooldown.`);
          keyUsage.cooldown_until = Date.now() / 1e3 + this.settings.failover_cooldown_seconds;
        } else {
          console.warn(`Google Key ...${key.slice(-4)} failed due to network/server error. No cooldown applied.`);
        }
      }
      throw new ApiKeyExhaustedError(`Google Gemini key failed.`);
    }
  }
  async call(prompt) {
    this.updateKeys();
    let lastError = null;
    let openAIKeysAttempted = false;
    if (this.openai_keys.length > 0) {
      openAIKeysAttempted = true;
      for (let i = 0; i < this.openai_keys.length; i++) {
        const key = this._selectKey(this.openai_keys, "openai");
        if (key) {
          try {
            console.log(`Trying OpenAI key ...${key.slice(-4)}`);
            return await this._callOpenAI(key, prompt);
          } catch (e) {
            lastError = e;
            new import_obsidian3.Notice(`OpenAI key ...${key.slice(-4)} failed. Trying next.`);
          }
        }
      }
    }
    if (this.google_keys.length > 0) {
      if (openAIKeysAttempted && !this.hasNotifiedFailover) {
        new import_obsidian3.Notice("All OpenAI keys failed or unavailable. Switching to Google Gemini...");
        this.hasNotifiedFailover = true;
      }
      for (let i = 0; i < this.google_keys.length; i++) {
        const key = this._selectKey(this.google_keys, "google");
        if (key) {
          try {
            console.log(`Trying Google Gemini key ...${key.slice(-4)}`);
            return await this._callGoogleAPI(key, prompt);
          } catch (e) {
            lastError = e;
            new import_obsidian3.Notice(`Google Gemini key ...${key.slice(-4)} failed. Trying next.`);
          }
        }
      }
    }
    throw new AllModelsFailedError(`All API providers failed. Last error: ${lastError == null ? void 0 : lastError.message}`);
  }
};

// critic.ts
var Critic = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.apiHandler = new APIHandler(plugin);
  }
  async judge(content) {
    if (this.plugin.settings.critic_mode === "ai") {
      return this._judgeByAI(content);
    }
    return this._judgeByHeuristic(content);
  }
  _judgeByHeuristic(content) {
    const reasons = [];
    const contentLower = content.toLowerCase();
    const requiredHeaders = this.plugin.settings.critic_required_headers.split("\n").map((h) => h.trim().toLowerCase()).filter(Boolean);
    const missingHeaders = requiredHeaders.filter((h) => !contentLower.includes(h));
    if (missingHeaders.length > 0) {
      reasons.push(`\u7F3A\u5C11\u5FC5\u9700\u7684\u6807\u9898: ${missingHeaders.join(", ")}`);
    }
    if (content.length < this.plugin.settings.critic_min_content_length) {
      reasons.push(`\u5185\u5BB9\u8FC7\u77ED (\u5F53\u524D: ${content.length}, \u8981\u6C42: ${this.plugin.settings.critic_min_content_length})`);
    }
    const refusalPatterns = ["\u4F5C\u4E3A\u4E00?\u4E2AAI", "\u4F5C\u4E3A\u8BED\u8A00\u6A21\u578B", "\u6211\u4E0D\u80FD", "\u6211\u65E0\u6CD5", "\u5F88\u62B1\u6B49"];
    for (const pattern of refusalPatterns) {
      if (new RegExp(pattern, "i").test(content)) {
        reasons.push(`\u5305\u542BAI\u62D2\u7EDD\u8BED (\u5339\u914D: '${pattern}')`);
        break;
      }
    }
    return {
      isApproved: reasons.length === 0,
      reason: reasons.length > 0 ? reasons.join("; ") : "\u901A\u8FC7\u6240\u6709\u542F\u53D1\u5F0F\u89C4\u5219\u68C0\u67E5\u3002"
    };
  }
  async _judgeByAI(content) {
    const prompt = this.plugin.settings.prompt_critic.replace("{content}", content);
    try {
      const response = await this.apiHandler.call(prompt);
      const decisionMatch = response.match(/DECISION:\s*(KEEP|DISCARD)/i);
      const reasonMatch = response.match(/\[REASON:\s*([^\]]+)\]/);
      const isApproved = decisionMatch ? decisionMatch[1].toUpperCase() === "KEEP" : false;
      const reason = reasonMatch ? reasonMatch[1].trim() : isApproved ? "AI \u6279\u51C6" : "AI \u62D2\u7EDD\uFF0C\u672A\u63D0\u4F9B\u660E\u786E\u7406\u7531";
      return { isApproved, reason };
    } catch (error) {
      console.error("AI Critic call failed:", error);
      return { isApproved: false, reason: `AI \u5BA1\u6838\u5668\u8C03\u7528\u5931\u8D25: ${error.message}` };
    }
  }
};

// reviser.ts
var Reviser = class {
  constructor(plugin) {
    this.plugin = plugin;
  }
  createRevisionPrompt(idea, originalContent, rejectionReason) {
    let prompt = this.plugin.settings.prompt_reviser;
    prompt = prompt.replace("{concept}", idea);
    prompt = prompt.replace("{original_content}", originalContent);
    prompt = prompt.replace("{rejection_reason}", rejectionReason);
    return prompt;
  }
};

// utils.ts
function sanitizeFilename(name) {
  let cleanName = name.replace(/\s*\(.*\)/g, "").trim();
  cleanName = cleanName.replace(/[\\/*?:"<>|]/g, "");
  return cleanName.slice(0, 100);
}
function extractNewIdeas(content) {
  const matches = content.match(/\[\[([^\]]+)\]\]/g);
  if (!matches) {
    return [];
  }
  const ideas = matches.map((match) => {
    return match.slice(2, -2).split("|")[0].trim();
  });
  return [...new Set(ideas)];
}
function cleanMarkdownOutput(content) {
  const trimmed = content.trim();
  if (trimmed.startsWith("```markdown") && trimmed.endsWith("```")) {
    let cleaned = trimmed.substring("```markdown".length, trimmed.length - "```".length);
    return cleaned.trim();
  }
  return trimmed;
}

// engine.ts
var Engine = class {
  constructor(plugin) {
    this.isRunning = false;
    this.timerId = null;
    this.plugin = plugin;
    this.app = plugin.app;
    this.apiHandler = new APIHandler(plugin);
    this.critic = new Critic(plugin);
    this.reviser = new Reviser(plugin);
  }
  // --- Public Controls ---
  toggleEngineState() {
    if (this.isRunning) {
      this.stop();
    } else {
      this.start();
    }
  }
  addConceptToQueue(concept) {
    const added = this.addConceptsToQueue([concept]);
    if (added > 0) {
      new import_obsidian4.Notice(`'${concept}' \u5DF2\u6DFB\u52A0\u5230\u751F\u6210\u961F\u5217\u3002`);
      this.updateStatusBar();
      return true;
    }
    new import_obsidian4.Notice(`'${concept}' \u5DF2\u5B58\u5728\u4E8E\u961F\u5217\u6216\u4ED3\u5E93\u4E2D\uFF0C\u672A\u6DFB\u52A0\u3002`);
    return false;
  }
  addConceptsToQueue(concepts) {
    const currentQueue = new Set(this.plugin.data.generationQueue);
    const existingFiles = new Set(this.app.vault.getMarkdownFiles().map((f) => f.basename));
    let addedCount = 0;
    for (const concept of concepts) {
      const sanitized = sanitizeFilename(concept);
      if (!currentQueue.has(concept) && !existingFiles.has(sanitized)) {
        this.plugin.data.generationQueue.push(concept);
        currentQueue.add(concept);
        addedCount++;
      }
    }
    if (addedCount > 0) {
      this.plugin.savePluginData();
      this.updateStatusBar();
    }
    return addedCount;
  }
  // --- Core Loop ---
  async start() {
    if (this.isRunning)
      return;
    this.isRunning = true;
    this.plugin.data.status = "running";
    new import_obsidian4.Notice("\u77E5\u8BC6\u56FE\u8C31\u5F15\u64CE\u5DF2\u542F\u52A8\uFF01");
    this.updateStatusBar();
    this.tick();
  }
  stop() {
    if (!this.isRunning)
      return;
    this.isRunning = false;
    this.plugin.data.status = "paused";
    if (this.timerId) {
      clearTimeout(this.timerId);
      this.timerId = null;
    }
    new import_obsidian4.Notice("\u77E5\u8BC6\u56FE\u8C31\u5F15\u64CE\u5DF2\u6682\u505C\u3002");
    this.updateStatusBar();
    this.plugin.savePluginData();
  }
  scheduleNextTick() {
    if (!this.isRunning)
      return;
    const delay = this.plugin.settings.request_delay * 1e3;
    this.timerId = setTimeout(() => this.tick(), delay);
  }
  async tick() {
    if (!this.isRunning)
      return;
    try {
      let taskProcessed = false;
      if (this.plugin.data.revisionQueue.length > 0) {
        taskProcessed = await this.runRevisionPhase();
      } else if (this.plugin.data.reviewQueue.length > 0) {
        taskProcessed = await this.runCriticPhase();
      } else if (this.plugin.data.generationQueue.length > 0) {
        taskProcessed = await this.runGenerationPhase();
      }
      if (!taskProcessed && this.plugin.data.generationQueue.length === 0 && this.plugin.data.reviewQueue.length === 0 && this.plugin.data.revisionQueue.length === 0) {
        new import_obsidian4.Notice("\u{1F389} \u6240\u6709\u4EFB\u52A1\u5B8C\u6210\uFF01\u5F15\u64CE\u5DF2\u505C\u6B62\u3002");
        this.isRunning = false;
        this.plugin.data.status = "idle";
        this.updateStatusBar();
        await this.plugin.savePluginData();
        return;
      }
    } catch (error) {
      console.error("\u5F15\u64CE Tick \u53D1\u751F\u4E25\u91CD\u9519\u8BEF:", error);
      new import_obsidian4.Notice("\u5F15\u64CE\u9047\u5230\u9519\u8BEF\uFF0C\u5DF2\u6682\u505C\u3002\u8BF7\u68C0\u67E5\u63A7\u5236\u53F0\u3002");
      this.stop();
      return;
    }
    this.scheduleNextTick();
  }
  // --- Phases ---
  async runGenerationPhase() {
    const queue = this.plugin.data.generationQueue;
    if (queue.length === 0)
      return false;
    const batchSize = this.plugin.settings.generation_batch_size;
    const batch = queue.splice(0, Math.min(queue.length, batchSize));
    this.updateStatusBar();
    await this.plugin.savePluginData();
    const tasks = batch.map((idea) => this.generationTask(idea));
    await Promise.allSettled(tasks);
    await this.plugin.savePluginData();
    return true;
  }
  async generationTask(idea) {
    const prompt = this.plugin.settings.prompt_generator.replace("{concept}", idea);
    try {
      const content = await this.apiHandler.call(prompt);
      const cleanedContent = cleanMarkdownOutput(content);
      this.plugin.data.reviewQueue.push({ idea, content: cleanedContent });
      console.log(`\u2705 [\u751F\u6210\u6210\u529F]: ${idea}`);
    } catch (e) {
      if (e instanceof AllModelsFailedError) {
        console.error(`\u274C [\u751F\u6210\u5931\u8D25]: ${idea} - ${e.message}`);
        this.plugin.data.generationQueue.unshift(idea);
      }
    }
  }
  async runCriticPhase() {
    const queue = this.plugin.data.reviewQueue;
    if (queue.length === 0)
      return false;
    const batchSize = this.plugin.settings.generation_batch_size;
    const tasksToReview = queue.splice(0, Math.min(queue.length, batchSize));
    this.updateStatusBar();
    await this.plugin.savePluginData();
    let newIdeasFound = /* @__PURE__ */ new Set();
    for (const task of tasksToReview) {
      const { isApproved, reason } = await this.critic.judge(task.content);
      if (isApproved) {
        await this.saveNote(task.idea, task.content);
        const ideas = extractNewIdeas(task.content);
        ideas.forEach((idea) => newIdeasFound.add(idea));
        console.log(`\u{1F44D} [\u5BA1\u6838\u901A\u8FC7]: ${task.idea}`);
      } else {
        task.reason = reason;
        task.retries = (task.retries || 0) + 1;
        this.plugin.data.revisionQueue.push(task);
        console.warn(`\u{1F44E} [\u5BA1\u6838\u62D2\u7EDD]: ${task.idea} - ${reason}`);
      }
    }
    if (newIdeasFound.size > 0) {
      this.addConceptsToQueue(Array.from(newIdeasFound));
    }
    await this.plugin.savePluginData();
    return true;
  }
  async runRevisionPhase() {
    const queue = this.plugin.data.revisionQueue;
    if (queue.length === 0)
      return false;
    const batchSize = this.plugin.settings.generation_batch_size;
    const tasksToRevise = queue.splice(0, Math.min(queue.length, batchSize));
    this.updateStatusBar();
    await this.plugin.savePluginData();
    for (const task of tasksToRevise) {
      if ((task.retries || 0) >= this.plugin.settings.max_revision_retries) {
        this.plugin.data.discardedPile.push(task);
        console.error(`\u{1F480} [\u653E\u5F03\u4FEE\u6B63]: ${task.idea} \u5DF2\u8FBE\u6700\u5927\u91CD\u8BD5\u6B21\u6570\u3002`);
        continue;
      }
      await this.revisionTask(task);
    }
    await this.plugin.savePluginData();
    return true;
  }
  async revisionTask(task) {
    const prompt = this.reviser.createRevisionPrompt(task.idea, task.content, task.reason || "\u672A\u77E5\u539F\u56E0");
    try {
      const newContent = await this.apiHandler.call(prompt);
      const cleanedContent = cleanMarkdownOutput(newContent);
      const revisedTask = { ...task, content: cleanedContent };
      this.plugin.data.reviewQueue.push(revisedTask);
      console.log(`\u{1F504} [\u4FEE\u6B63\u5B8C\u6210]: ${task.idea}`);
    } catch (e) {
      console.error(`\u274C [\u4FEE\u6B63\u5931\u8D25]: ${task.idea} - ${e.message}`);
      this.plugin.data.revisionQueue.unshift(task);
    }
  }
  // --- File & UI ---
  async saveNote(idea, content) {
    const filename = sanitizeFilename(idea);
    const folderPath = this.plugin.settings.output_dir;
    if (!(this.app.vault.getAbstractFileByPath(folderPath) instanceof import_obsidian4.TFolder)) {
      try {
        await this.app.vault.createFolder(folderPath);
      } catch (error) {
        console.error(`\u521B\u5EFA\u6587\u4EF6\u5939\u5931\u8D25: ${folderPath}`, error);
        new import_obsidian4.Notice(`\u65E0\u6CD5\u521B\u5EFA\u8F93\u51FA\u6587\u4EF6\u5939: ${folderPath}`);
        return;
      }
    }
    const filePath = (0, import_obsidian4.normalizePath)(`${folderPath}/${filename}.md`);
    const file = this.app.vault.getAbstractFileByPath(filePath);
    try {
      if (file instanceof import_obsidian4.TFile) {
        await this.app.vault.modify(file, content);
        new import_obsidian4.Notice(`\u7B14\u8BB0\u5DF2\u66F4\u65B0: ${filename}`);
      } else {
        await this.app.vault.create(filePath, content);
        new import_obsidian4.Notice(`\u7B14\u8BB0\u5DF2\u521B\u5EFA: ${filename}`);
      }
    } catch (error) {
      console.error(`\u4FDD\u5B58\u7B14\u8BB0\u5931\u8D25: ${filePath}`, error);
      new import_obsidian4.Notice(`\u65E0\u6CD5\u4FDD\u5B58\u7B14\u8BB0: ${filename}`);
    }
  }
  updateStatusBar() {
    if (!this.plugin.statusBarEl)
      return;
    const { generationQueue, reviewQueue, revisionQueue } = this.plugin.data;
    const total = generationQueue.length + reviewQueue.length + revisionQueue.length;
    this.plugin.statusBarEl.setText(`KG: ${this.plugin.data.status} | G:${generationQueue.length} | C:${reviewQueue.length} | R:${revisionQueue.length} | Total:${total}`);
  }
};

// main.ts
var DEFAULT_PLUGIN_DATA = {
  status: "idle",
  generationQueue: [],
  reviewQueue: [],
  revisionQueue: [],
  discardedPile: []
};
var KnowledgeGraphPlugin = class extends import_obsidian5.Plugin {
  async onload() {
    await this.loadSettings();
    await this.loadPluginData();
    this.engine = new Engine(this);
    const ribbonIconEl = this.addRibbonIcon("brain-circuit", "\u77E5\u8BC6\u56FE\u8C31\u751F\u6210\u5668", (evt) => {
      this.engine.toggleEngineState();
    });
    ribbonIconEl.addClass("knowledge-graph-plugin-ribbon-class");
    this.statusBarEl = this.addStatusBarItem();
    this.engine.updateStatusBar();
    this.addSettingTab(new KGsSettingTab(this.app, this));
    this.addCommand({
      id: "toggle-knowledge-graph-engine",
      name: "\u542F\u52A8/\u6682\u505C \u77E5\u8BC6\u56FE\u8C31\u751F\u6210",
      callback: () => {
        this.engine.toggleEngineState();
      }
    });
    this.addCommand({
      id: "add-current-note-to-queue",
      name: "\u5C06\u5F53\u524D\u7B14\u8BB0\u6807\u9898\u6DFB\u52A0\u5230\u751F\u6210\u961F\u5217",
      checkCallback: (checking) => {
        const file = this.app.workspace.getActiveFile();
        if (file) {
          if (!checking) {
            this.engine.addConceptToQueue(file.basename);
          }
          return true;
        }
        return false;
      }
    });
    console.log("\u77E5\u8BC6\u56FE\u8C31\u63D2\u4EF6\u5DF2\u52A0\u8F7D\uFF01");
  }
  onunload() {
    console.log("\u77E5\u8BC6\u56FE\u8C31\u63D2\u4EF6\u5DF2\u5378\u8F7D\u3002");
  }
  /**
   * 加载插件的配置。
   * 它会合并默认设置、默认提示和用户保存的设置。
   * 这个方法需要兼容旧版本的数据结构。
   */
  async loadSettings() {
    const defaultPrompts = await getDefaultPrompts();
    const savedData = await this.loadData();
    const savedSettings = savedData || {};
    this.settings = Object.assign({}, DEFAULT_SETTINGS, defaultPrompts, savedSettings);
  }
  /**
   * 保存插件的配置和状态。
   * 这是唯一一个直接写入文件的方法，它将所有数据打包在一起。
   */
  async saveSettings() {
    const dataToSave = { ...this.settings, pluginState: this.data };
    await this.saveData(dataToSave);
  }
  /**
   * 加载插件的运行时状态。
   * 它会从保存的数据中提取 pluginState 部分。
   */
  async loadPluginData() {
    const savedData = await this.loadData();
    const savedState = (savedData == null ? void 0 : savedData.pluginState) || {};
    this.data = Object.assign({}, DEFAULT_PLUGIN_DATA, savedState);
  }
  /**
   * 保存插件的运行时状态。
   * 这个方法只是一个方便的别名，它实际上调用 saveSettings。
   * 这保证了状态和配置总是在一起被原子性地保存。
   */
  async savePluginData() {
    await this.saveSettings();
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzZXR0aW5ncy50cyIsICJRdWV1ZU1vZGFsLnRzIiwgImVuZ2luZS50cyIsICJhcGlIYW5kbGVyLnRzIiwgImNyaXRpYy50cyIsICJyZXZpc2VyLnRzIiwgInV0aWxzLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBBcHAsIFBsdWdpbiwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZywgTm90aWNlLCBURmlsZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IEtub3dsZWRnZUdyYXBoUGx1Z2luU2V0dGluZ3MsIFBsdWdpbkRhdGEgfSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7IEtHc1NldHRpbmdUYWIsIERFRkFVTFRfU0VUVElOR1MsIGdldERlZmF1bHRQcm9tcHRzIH0gZnJvbSAnLi9zZXR0aW5ncyc7XG5pbXBvcnQgeyBFbmdpbmUgfSBmcm9tICcuL2VuZ2luZSc7XG5cbmNvbnN0IERFRkFVTFRfUExVR0lOX0RBVEE6IFBsdWdpbkRhdGEgPSB7XG4gICAgc3RhdHVzOiAnaWRsZScsXG4gICAgZ2VuZXJhdGlvblF1ZXVlOiBbXSxcbiAgICByZXZpZXdRdWV1ZTogW10sXG4gICAgcmV2aXNpb25RdWV1ZTogW10sXG4gICAgZGlzY2FyZGVkUGlsZTogW10sXG59O1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBLbm93bGVkZ2VHcmFwaFBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG4gICAgc2V0dGluZ3M6IEtub3dsZWRnZUdyYXBoUGx1Z2luU2V0dGluZ3M7XG4gICAgZGF0YTogUGx1Z2luRGF0YTtcbiAgICBlbmdpbmU6IEVuZ2luZTtcbiAgICBzdGF0dXNCYXJFbDogSFRNTEVsZW1lbnQ7XG5cbiAgICBhc3luYyBvbmxvYWQoKSB7XG4gICAgICAgIC8vIDEuIFx1OTk5Nlx1NTE0OFx1NTJBMFx1OEY3RFx1OEJCRVx1N0Y2RSAoc2V0dGluZ3MpXG4gICAgICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cbiAgICAgICAgLy8gMi4gXHU3MTM2XHU1NDBFXHU1MkEwXHU4RjdEXHU2M0QyXHU0RUY2XHU3MkI2XHU2MDAxXG4gICAgICAgIGF3YWl0IHRoaXMubG9hZFBsdWdpbkRhdGEoKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMuZW5naW5lID0gbmV3IEVuZ2luZSh0aGlzKTtcblxuICAgICAgICAvLyBcdTdGMEVcdTVFMjZcdTU2RkVcdTY4MDdcbiAgICAgICAgY29uc3QgcmliYm9uSWNvbkVsID0gdGhpcy5hZGRSaWJib25JY29uKCdicmFpbi1jaXJjdWl0JywgJ1x1NzdFNVx1OEJDNlx1NTZGRVx1OEMzMVx1NzUxRlx1NjIxMFx1NTY2OCcsIChldnQ6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZW5naW5lLnRvZ2dsZUVuZ2luZVN0YXRlKCk7XG4gICAgICAgIH0pO1xuICAgICAgICByaWJib25JY29uRWwuYWRkQ2xhc3MoJ2tub3dsZWRnZS1ncmFwaC1wbHVnaW4tcmliYm9uLWNsYXNzJyk7XG5cbiAgICAgICAgLy8gXHU3MkI2XHU2MDAxXHU2ODBGXG4gICAgICAgIHRoaXMuc3RhdHVzQmFyRWwgPSB0aGlzLmFkZFN0YXR1c0Jhckl0ZW0oKTtcbiAgICAgICAgdGhpcy5lbmdpbmUudXBkYXRlU3RhdHVzQmFyKCk7XG5cbiAgICAgICAgLy8gXHU4QkJFXHU3RjZFXHU5MDA5XHU5ODc5XHU1MzYxXG4gICAgICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgS0dzU2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xuXG4gICAgICAgIC8vIFx1NTQ3RFx1NEVFNFxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICd0b2dnbGUta25vd2xlZGdlLWdyYXBoLWVuZ2luZScsXG4gICAgICAgICAgICBuYW1lOiAnXHU1NDJGXHU1MkE4L1x1NjY4Mlx1NTA1QyBcdTc3RTVcdThCQzZcdTU2RkVcdThDMzFcdTc1MUZcdTYyMTAnLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmVuZ2luZS50b2dnbGVFbmdpbmVTdGF0ZSgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAnYWRkLWN1cnJlbnQtbm90ZS10by1xdWV1ZScsXG4gICAgICAgICAgICBuYW1lOiAnXHU1QzA2XHU1RjUzXHU1MjREXHU3QjE0XHU4QkIwXHU2ODA3XHU5ODk4XHU2REZCXHU1MkEwXHU1MjMwXHU3NTFGXHU2MjEwXHU5NjFGXHU1MjE3JyxcbiAgICAgICAgICAgIGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICAgICAgICAgIGlmIChmaWxlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghY2hlY2tpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW5naW5lLmFkZENvbmNlcHRUb1F1ZXVlKGZpbGUuYmFzZW5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zb2xlLmxvZygnXHU3N0U1XHU4QkM2XHU1NkZFXHU4QzMxXHU2M0QyXHU0RUY2XHU1REYyXHU1MkEwXHU4RjdEXHVGRjAxJyk7XG4gICAgfVxuXG4gICAgb251bmxvYWQoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdcdTc3RTVcdThCQzZcdTU2RkVcdThDMzFcdTYzRDJcdTRFRjZcdTVERjJcdTUzNzhcdThGN0RcdTMwMDInKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBcdTUyQTBcdThGN0RcdTYzRDJcdTRFRjZcdTc2ODRcdTkxNERcdTdGNkVcdTMwMDJcbiAgICAgKiBcdTVCODNcdTRGMUFcdTU0MDhcdTVFNzZcdTlFRDhcdThCQTRcdThCQkVcdTdGNkVcdTMwMDFcdTlFRDhcdThCQTRcdTYzRDBcdTc5M0FcdTU0OENcdTc1MjhcdTYyMzdcdTRGRERcdTVCNThcdTc2ODRcdThCQkVcdTdGNkVcdTMwMDJcbiAgICAgKiBcdThGRDlcdTRFMkFcdTY1QjlcdTZDRDVcdTk3MDBcdTg5ODFcdTUxN0NcdTVCQjlcdTY1RTdcdTcyNDhcdTY3MkNcdTc2ODRcdTY1NzBcdTYzNkVcdTdFRDNcdTY3ODRcdTMwMDJcbiAgICAgKi9cbiAgICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG4gICAgICAgIGNvbnN0IGRlZmF1bHRQcm9tcHRzID0gYXdhaXQgZ2V0RGVmYXVsdFByb21wdHMoKTtcbiAgICAgICAgLy8gbG9hZERhdGEoKSBcdTRGMUFcdThCRkJcdTUzRDZcdTY1NzRcdTRFMkEgZGF0YS5qc29uIFx1NjU4N1x1NEVGNlxuICAgICAgICBjb25zdCBzYXZlZERhdGEgPSBhd2FpdCB0aGlzLmxvYWREYXRhKCk7XG4gICAgICAgIC8vIFx1NEVDRVx1NEZERFx1NUI1OFx1NzY4NFx1NjU3MFx1NjM2RVx1NEUyRFx1NjNEMFx1NTNENlx1OEJCRVx1N0Y2RVx1OTBFOFx1NTIwNlxuICAgICAgICBjb25zdCBzYXZlZFNldHRpbmdzID0gc2F2ZWREYXRhIHx8IHt9O1xuICAgICAgICBcbiAgICAgICAgLy8gXHU1NDA4XHU1RTc2XHU2MjQwXHU2NzA5XHU4QkJFXHU3RjZFXHVGRjBDXHU3ODZFXHU0RkREXHU2MjQwXHU2NzA5XHU5MTREXHU3RjZFXHU5ODc5XHU5MEZEXHU2NzA5XHU1MDNDXG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBkZWZhdWx0UHJvbXB0cywgc2F2ZWRTZXR0aW5ncyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogXHU0RkREXHU1QjU4XHU2M0QyXHU0RUY2XHU3Njg0XHU5MTREXHU3RjZFXHU1NDhDXHU3MkI2XHU2MDAxXHUzMDAyXG4gICAgICogXHU4RkQ5XHU2NjJGXHU1NTJGXHU0RTAwXHU0RTAwXHU0RTJBXHU3NkY0XHU2M0E1XHU1MTk5XHU1MTY1XHU2NTg3XHU0RUY2XHU3Njg0XHU2NUI5XHU2Q0Q1XHVGRjBDXHU1QjgzXHU1QzA2XHU2MjQwXHU2NzA5XHU2NTcwXHU2MzZFXHU2MjUzXHU1MzA1XHU1NzI4XHU0RTAwXHU4RDc3XHUzMDAyXG4gICAgICovXG4gICAgYXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuICAgICAgICBjb25zdCBkYXRhVG9TYXZlID0geyAuLi50aGlzLnNldHRpbmdzLCBwbHVnaW5TdGF0ZTogdGhpcy5kYXRhIH07XG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEoZGF0YVRvU2F2ZSk7XG4gICAgfVxuICAgIFxuICAgIC8qKlxuICAgICAqIFx1NTJBMFx1OEY3RFx1NjNEMlx1NEVGNlx1NzY4NFx1OEZEMFx1ODg0Q1x1NjVGNlx1NzJCNlx1NjAwMVx1MzAwMlxuICAgICAqIFx1NUI4M1x1NEYxQVx1NEVDRVx1NEZERFx1NUI1OFx1NzY4NFx1NjU3MFx1NjM2RVx1NEUyRFx1NjNEMFx1NTNENiBwbHVnaW5TdGF0ZSBcdTkwRThcdTUyMDZcdTMwMDJcbiAgICAgKi9cbiAgICBhc3luYyBsb2FkUGx1Z2luRGF0YSgpIHtcbiAgICAgICAgLy8gbG9hZERhdGEoKSBcdTRGMUFcdThCRkJcdTUzRDZcdTY1NzRcdTRFMkEgZGF0YS5qc29uIFx1NjU4N1x1NEVGNlxuICAgICAgICBjb25zdCBzYXZlZERhdGEgPSBhd2FpdCB0aGlzLmxvYWREYXRhKCk7XG4gICAgICAgIC8vIFx1NEVDRVx1NEZERFx1NUI1OFx1NzY4NFx1NjU3MFx1NjM2RVx1NEUyRFx1NjNEMFx1NTNENlx1NzJCNlx1NjAwMVx1OTBFOFx1NTIwNlxuICAgICAgICBjb25zdCBzYXZlZFN0YXRlID0gc2F2ZWREYXRhPy5wbHVnaW5TdGF0ZSB8fCB7fTtcbiAgICAgICAgXG4gICAgICAgIC8vIFx1NTQwOFx1NUU3Nlx1OUVEOFx1OEJBNFx1NzJCNlx1NjAwMVx1NTQ4Q1x1NzUyOFx1NjIzN1x1NEZERFx1NUI1OFx1NzY4NFx1NzJCNlx1NjAwMVxuICAgICAgICB0aGlzLmRhdGEgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1BMVUdJTl9EQVRBLCBzYXZlZFN0YXRlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBcdTRGRERcdTVCNThcdTYzRDJcdTRFRjZcdTc2ODRcdThGRDBcdTg4NENcdTY1RjZcdTcyQjZcdTYwMDFcdTMwMDJcbiAgICAgKiBcdThGRDlcdTRFMkFcdTY1QjlcdTZDRDVcdTUzRUFcdTY2MkZcdTRFMDBcdTRFMkFcdTY1QjlcdTRGQkZcdTc2ODRcdTUyMkJcdTU0MERcdUZGMENcdTVCODNcdTVCOUVcdTk2NDVcdTRFMEFcdThDMDNcdTc1Mjggc2F2ZVNldHRpbmdzXHUzMDAyXG4gICAgICogXHU4RkQ5XHU0RkREXHU4QkMxXHU0RTg2XHU3MkI2XHU2MDAxXHU1NDhDXHU5MTREXHU3RjZFXHU2MDNCXHU2NjJGXHU1NzI4XHU0RTAwXHU4RDc3XHU4OEFCXHU1MzlGXHU1QjUwXHU2MDI3XHU1NzMwXHU0RkREXHU1QjU4XHUzMDAyXG4gICAgICovXG4gICAgYXN5bmMgc2F2ZVBsdWdpbkRhdGEoKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZVNldHRpbmdzKCk7XG4gICAgfVxufVxuIiwgIi8vIHNldHRpbmdzLnRzIChWMS4xIC0gXHU2REZCXHU1MkEwXHU0RTg2IE1vZGFsIFx1ODlFNlx1NTNEMVx1NjMwOVx1OTRBRSlcblxuaW1wb3J0IHsgQXBwLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nLCBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgS25vd2xlZGdlR3JhcGhQbHVnaW4gZnJvbSAnLi9tYWluJztcbmltcG9ydCB7IEtub3dsZWRnZUdyYXBoUGx1Z2luU2V0dGluZ3MgfSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7IFF1ZXVlTWFuYWdlbWVudE1vZGFsIH0gZnJvbSAnLi9RdWV1ZU1vZGFsJzsgLy8gXHUzMDEwXHUzMDEwXHUzMDEwIFx1NjVCMFx1NTg5RVx1NUJGQ1x1NTE2NSBcdTMwMTFcdTMwMTFcdTMwMTFcblxuLy8gXHU5RUQ4XHU4QkE0IFByb21wdCBcdTUxODVcdTVCQjlcbmV4cG9ydCBjb25zdCBQUk9NUFRfR0VORVJBVE9SX0RFRkFVTFQgPSBgIyBSb2xlOiBcdTc3RTVcdThCQzZcdTdDRkJcdTdFREZcdTY3ODRcdTVFRkFcdTRFMTNcdTVCQjYuLi5gO1xuZXhwb3J0IGNvbnN0IFBST01QVF9DUklUSUNfREVGQVVMVCA9IGAjIFJvbGU6IFx1NzdFNVx1OEJDNlx1NTZGRVx1OEMzMVx1OEQyOFx1OTFDRlx1NUJBMVx1NjgzOFx1NTQ1OC4uLmA7XG5leHBvcnQgY29uc3QgUFJPTVBUX1JFVklTRVJfREVGQVVMVCA9IGAjIFx1ODlEMlx1ODI3MjogXHU4RDQ0XHU2REYxXHU3N0U1XHU4QkM2XHU3RjE2XHU4RjkxXHU0RTBFXHU1MTg1XHU1QkI5XHU0RjE4XHU1MzE2XHU0RTEzXHU1QkI2Li4uYDtcblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IEtub3dsZWRnZUdyYXBoUGx1Z2luU2V0dGluZ3MgPSB7XG4gICAgLy8gQVBJXG4gICAgb3BlbmFpX2FwaV9rZXlzOiAnJyxcbiAgICBvcGVuYWlfYmFzZV91cmw6ICdodHRwczovL2FwaS5vcGVuYWkuY29tL3YxJyxcbiAgICBvcGVuYWlfbW9kZWw6ICdncHQtNC10dXJiby1wcmV2aWV3JyxcbiAgICBnb29nbGVfYXBpX2tleXM6ICcnLFxuICAgIGdvb2dsZV9tb2RlbDogJ2dlbWluaS0xLjUtcHJvLWxhdGVzdCcsXG4gICAgZmFpbG92ZXJfY29vbGRvd25fc2Vjb25kczogMzAwLFxuICAgIC8vIFx1NTNDMlx1NjU3MFxuICAgIGdlbmVyYXRpb25fdGVtcGVyYXR1cmU6IDAuNyxcbiAgICBnZW5lcmF0aW9uX21heF90b2tlbnM6IDQwOTYsXG4gICAgLy8gXHU4REVGXHU1Rjg0XG4gICAgb3V0cHV0X2RpcjogJ0tub3dsZWRnZUdyYXBoTm90ZXMnLFxuICAgIC8vIFx1N0NGQlx1N0VERlxuICAgIG1heF93b3JrZXJzOiAyLCBcbiAgICBnZW5lcmF0aW9uX2JhdGNoX3NpemU6IDUsXG4gICAgcmVxdWVzdF9kZWxheTogNSxcbiAgICAvLyBDcml0aWNcbiAgICBjcml0aWNfbW9kZTogJ2hldXJpc3RpYycsXG4gICAgY3JpdGljX3JlcXVpcmVkX2hlYWRlcnM6ICcjIFx1RDgzRVx1RERFMFxcbj4gXFxuIyMgXHVEODNEXHVEQ0REIFx1NjgzOFx1NUZDM1x1NjAxRFx1NjBGM1xcbiMjIFx1RDgzQ1x1REZBRiBcdTkwMDJcdTc1MjhcdTU3M0FcdTY2NkZcXG4jIyBcdUQ4M0RcdURFRTBcdUZFMEYgXHU0RjdGXHU3NTI4XHU2QjY1XHU5QUE0L1x1Njc4NFx1NjIxMFx1ODk4MVx1N0QyMFxcbiMjIFx1RDgzRFx1REU4MCBcdTY4NDhcdTRGOEJcdTUyMDZcdTY3OTBcXG4jIyBcdUQ4M0RcdURDNEQgXHU0RjE4XHU3MEI5ICYgXHVEODNEXHVEQzRFIFx1N0YzQVx1NzBCOVxcbiMjIFx1RDgzRFx1REQxNyBcdTUxNzNcdTgwNTRcdTZBMjFcdTU3OEInLFxuICAgIGNyaXRpY19taW5fY29udGVudF9sZW5ndGg6IDQwMCxcbiAgICAvLyBSZXZpc2VyXG4gICAgbWF4X3JldmlzaW9uX3JldHJpZXM6IDIsXG4gICAgLy8gUHJvbXB0c1xuICAgIHByb21wdF9nZW5lcmF0b3I6IFBST01QVF9HRU5FUkFUT1JfREVGQVVMVCxcbiAgICBwcm9tcHRfY3JpdGljOiBQUk9NUFRfQ1JJVElDX0RFRkFVTFQsXG4gICAgcHJvbXB0X3JldmlzZXI6IFBST01QVF9SRVZJU0VSX0RFRkFVTFQsXG4gICAgLy8gXHU2NEFEXHU3OUNEXHU3QkIxXG4gICAgc2VlZENvbmNlcHRzOiAnJyxcbn07XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXREZWZhdWx0UHJvbXB0cygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBwcm9tcHRfZ2VuZXJhdG9yOiBQUk9NUFRfR0VORVJBVE9SX0RFRkFVTFQsXG4gICAgICAgIHByb21wdF9jcml0aWM6IFBST01QVF9DUklUSUNfREVGQVVMVCxcbiAgICAgICAgcHJvbXB0X3JldmlzZXI6IFBST01QVF9SRVZJU0VSX0RFRkFVTFQsXG4gICAgfTtcbn1cblxuZXhwb3J0IGNsYXNzIEtHc1NldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcbiAgICBwbHVnaW46IEtub3dsZWRnZUdyYXBoUGx1Z2luO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogS25vd2xlZGdlR3JhcGhQbHVnaW4pIHtcbiAgICAgICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICB9XG5cbiAgICBkaXNwbGF5KCk6IHZvaWQge1xuICAgICAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ1x1NzdFNVx1OEJDNlx1NTZGRVx1OEMzMVx1NzUxRlx1NjIxMFx1NTY2OCAtIFx1OEJCRVx1N0Y2RScgfSk7XG5cbiAgICAgICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgLy8gXHUzMDEwXHUzMDEwXHUzMDEwIFx1NjVCMFx1NTg5RVx1RkYxQVx1OTYxRlx1NTIxN1x1N0JBMVx1NzQwNiBcdTMwMTFcdTMwMTFcdTMwMTFcbiAgICAgICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnXHU1RjE1XHU2NENFXHU0RUVBXHU4ODY4XHU3NkQ4JylcbiAgICAgICAgICAgIC5zZXREZXNjKCdcdTdCQTFcdTc0MDZcdTVGODVcdTc1MUZcdTYyMTBcdTMwMDFcdTVGODVcdTVCQTFcdTY4MzhcdTU0OENcdTVERjJcdTRFMjJcdTVGMDNcdTc2ODRcdTRFRkJcdTUyQTFcdTMwMDInKVxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXG4gICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ1x1NjI1M1x1NUYwMFx1OTYxRlx1NTIxN1x1N0JBMVx1NzQwNlx1NTY2OCcpXG4gICAgICAgICAgICAgICAgLnNldEN0YSgpIC8vIFx1OEJCRVx1N0Y2RVx1NEUzQVx1NEUzQlx1ODk4MVx1NjMwOVx1OTRBRVx1NjgzN1x1NUYwRlxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgbmV3IFF1ZXVlTWFuYWdlbWVudE1vZGFsKHRoaXMuYXBwLCB0aGlzLnBsdWdpbikub3BlbigpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuXG5cbiAgICAgICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgLy8gQVBJIFx1OEJCRVx1N0Y2RSAoXHU0RkREXHU3NTU5XHU1MzlGXHU2ODM3KVxuICAgICAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbCkuc2V0TmFtZSgnQVBJIFx1OEJCRVx1N0Y2RScpLnNldEhlYWRpbmcoKTtcbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnT3BlbkFJJyB9KTtcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnT3BlbkFJIEFQSSBLZXlzJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdcdTZCQ0ZcdTg4NENcdTRFMDBcdTRFMkEgS2V5XHUzMDAyXHU2M0QyXHU0RUY2XHU1QzA2XHU4MUVBXHU1MkE4XHU4RjZFXHU2MzYyXHU1NDhDXHU1MUI3XHU1Mzc0XHU0RjdGXHU3NTI4XHUzMDAyJylcbiAgICAgICAgICAgIC5hZGRUZXh0QXJlYSh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ3NrLS4uLicpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm9wZW5haV9hcGlfa2V5cylcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm9wZW5haV9hcGlfa2V5cyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgIFxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdPcGVuQUkgQmFzZSBVUkwnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1x1NTk4Mlx1Njc5Q1x1NEY2MFx1NEY3Rlx1NzUyOFx1N0IyQ1x1NEUwOVx1NjVCOVx1NEVFM1x1NzQwNlx1RkYwQ1x1OEJGN1x1NTcyOFx1NkI2NFx1NTkwNFx1NTg2Qlx1NTE2NVx1NEVFM1x1NzQwNlx1NTczMFx1NTc0MFx1MzAwMicpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ2h0dHBzOi8vYXBpLm9wZW5haS5jb20vdjEnKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5vcGVuYWlfYmFzZV91cmwpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5vcGVuYWlfYmFzZV91cmwgPSB2YWx1ZS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdPcGVuQUkgTW9kZWwnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1x1OEY5M1x1NTE2NVx1NEY2MFx1NjBGM1x1NEY3Rlx1NzUyOFx1NzY4NCBPcGVuQUkgXHU2QTIxXHU1NzhCXHU1NDBEXHU3OUYwXHUzMDAyJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignZ3B0LTQtdHVyYm8tcHJldmlldycpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm9wZW5haV9tb2RlbClcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm9wZW5haV9tb2RlbCA9IHZhbHVlLnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICBcbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnR29vZ2xlIEdlbWluaScgfSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnR29vZ2xlIEdlbWluaSBBUEkgS2V5cycpXG4gICAgICAgICAgICAuc2V0RGVzYygnXHU2QkNGXHU4ODRDXHU0RTAwXHU0RTJBIEtleVx1MzAwMicpXG4gICAgICAgICAgICAuYWRkVGV4dEFyZWEodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdBSXphU3kuLi4nKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nb29nbGVfYXBpX2tleXMpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5nb29nbGVfYXBpX2tleXMgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICBcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnR29vZ2xlIEdlbWluaSBNb2RlbCcpXG4gICAgICAgICAgICAuc2V0RGVzYygnXHU4RjkzXHU1MTY1XHU0RjYwXHU2MEYzXHU0RjdGXHU3NTI4XHU3Njg0IEdvb2dsZSBcdTZBMjFcdTU3OEJcdTU0MERcdTc5RjBcdTMwMDInKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdnZW1pbmktMS41LXByby1sYXRlc3QnKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nb29nbGVfbW9kZWwpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5nb29nbGVfbW9kZWwgPSB2YWx1ZS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ0tleSBcdTUxQjdcdTUzNzRcdTY1RjZcdTk1RjQgKFx1NzlEMiknKVxuICAgICAgICAgICAgLnNldERlc2MoJ0FQSSBLZXkgXHU1OTMxXHU4RDI1XHU1NDBFXHVGRjBDXHU5NzAwXHU4OTgxXHU3QjQ5XHU1Rjg1XHU1OTFBXHU1QzExXHU3OUQyXHU2MjREXHU4MEZEXHU1MThEXHU2QjIxXHU0RjdGXHU3NTI4XHUzMDAyJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZShTdHJpbmcodGhpcy5wbHVnaW4uc2V0dGluZ3MuZmFpbG92ZXJfY29vbGRvd25fc2Vjb25kcykpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBudW0gPSBwYXJzZUludCh2YWx1ZSwgMTApO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzTmFOKG51bSkgJiYgbnVtID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmZhaWxvdmVyX2Nvb2xkb3duX3NlY29uZHMgPSBudW07XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICAvLyBMTE0gXHU1M0MyXHU2NTcwXHU4QkJFXHU3RjZFIChcdTRGRERcdTc1NTlcdTUzOUZcdTY4MzcpXG4gICAgICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKS5zZXROYW1lKCdMTE0gXHU1M0MyXHU2NTcwXHU4QkJFXHU3RjZFJykuc2V0SGVhZGluZygpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1x1NzUxRlx1NjIxMFx1NkUyOVx1NUVBNiAoVGVtcGVyYXR1cmUpJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdcdTYzQTdcdTUyMzZcdTc1MUZcdTYyMTBcdTUxODVcdTVCQjlcdTc2ODRcdTk2OEZcdTY3M0FcdTYwMjdcdTMwMDJcdThGODNcdTRGNEVcdTc2ODRcdTUwM0NcdUZGMDhcdTU5ODIgMC4yXHVGRjA5XHU2NkY0XHU1MTc3XHU3ODZFXHU1QjlBXHU2MDI3XHVGRjBDXHU4RjgzXHU5QUQ4XHU3Njg0XHU1MDNDXHVGRjA4XHU1OTgyIDAuOFx1RkYwOVx1NjZGNFx1NTE3N1x1NTIxQlx1OTAyMFx1NjAyN1x1MzAwMicpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUoU3RyaW5nKHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYXRpb25fdGVtcGVyYXR1cmUpKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbnVtID0gcGFyc2VGbG9hdCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNOYU4obnVtKSAmJiBudW0gPj0gMC4wICYmIG51bSA8PSAyLjApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYXRpb25fdGVtcGVyYXR1cmUgPSBudW07XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdcdTY3MDBcdTU5MjcgVG9rZW4gXHU2NTcwIChNYXggVG9rZW5zKScpXG4gICAgICAgICAgICAuc2V0RGVzYygnQVBJIFx1NEUwMFx1NkIyMVx1OEMwM1x1NzUyOFx1NTE0MVx1OEJCOFx1NzUxRlx1NjIxMFx1NzY4NFx1NjcwMFx1NTkyNyBUb2tlbiBcdTY1NzBcdTkxQ0ZcdTMwMDInKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKFN0cmluZyh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW5lcmF0aW9uX21heF90b2tlbnMpKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbnVtID0gcGFyc2VJbnQodmFsdWUsIDEwKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc05hTihudW0pICYmIG51bSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYXRpb25fbWF4X3Rva2VucyA9IG51bTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIC8vIFx1NUYxNVx1NjRDRVx1OEJCRVx1N0Y2RSAoXHU0RkREXHU3NTU5XHU1MzlGXHU2ODM3KVxuICAgICAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbCkuc2V0TmFtZSgnXHU1RjE1XHU2NENFXHU4QkJFXHU3RjZFJykuc2V0SGVhZGluZygpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1x1OEY5M1x1NTFGQVx1NjU4N1x1NEVGNlx1NTkzOScpXG4gICAgICAgICAgICAuc2V0RGVzYygnXHU2MjQwXHU2NzA5XHU3NTFGXHU2MjEwXHU3Njg0XHU3QjE0XHU4QkIwXHU1QzA2XHU0RkREXHU1QjU4XHU1MjMwXHU2QjY0XHU2NTg3XHU0RUY2XHU1OTM5XHUzMDAyJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignS25vd2xlZGdlR3JhcGhOb3RlcycpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm91dHB1dF9kaXIpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5vdXRwdXRfZGlyID0gdmFsdWUudHJpbSgpLnJlcGxhY2UoL1xcLyQvLCAnJyk7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdcdTY3MDBcdTU5MjdcdTVFNzZcdTUzRDFcdTY1NzAgKE1heCBXb3JrZXJzKScpXG4gICAgICAgICAgICAuc2V0RGVzYygnXHVGRjA4XHU2Q0U4XHU2MTBGXHVGRjFBXHU1RjUzXHU1MjREIFYyLjIgXHU1RjE1XHU2NENFXHU0RTNBXHU1MzU1XHU3RUJGXHU3QTBCXHU2RDQxXHU2QzM0XHU3RUJGXHVGRjBDXHU2QjY0XHU4QkJFXHU3RjZFXHU2NjgyXHU2NzJBXHU3NTFGXHU2NTQ4XHVGRjA5JylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZShTdHJpbmcodGhpcy5wbHVnaW4uc2V0dGluZ3MubWF4X3dvcmtlcnMpKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbnVtID0gcGFyc2VJbnQodmFsdWUsIDEwKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc05hTihudW0pICYmIG51bSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm1heF93b3JrZXJzID0gbnVtO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgIFxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdcdTc1MUZcdTYyMTBcdTYyNzlcdTU5MDRcdTc0MDZcdTU5MjdcdTVDMEYnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1x1NUYxNVx1NjRDRVx1NkJDRlx1NEUwMFx1OEY2RVx1NEVDRVx1MjAxQ1x1NUY4NVx1NzUxRlx1NjIxMFx1OTYxRlx1NTIxN1x1MjAxRFx1NEUyRFx1NTNENlx1NTFGQVx1NzY4NFx1NEVGQlx1NTJBMVx1NjU3MFx1OTFDRlx1MzAwMicpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUoU3RyaW5nKHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYXRpb25fYmF0Y2hfc2l6ZSkpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBudW0gPSBwYXJzZUludCh2YWx1ZSwgMTApO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzTmFOKG51bSkgJiYgbnVtID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhdGlvbl9iYXRjaF9zaXplID0gbnVtO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgIFxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdcdTZCQ0ZcdThGNkVcdThCRjdcdTZDNDJcdTVFRjZcdThGREYgKFx1NzlEMiknKVxuICAgICAgICAgICAgLnNldERlc2MoJ1x1NUYxNVx1NjRDRVx1NTcyOFx1NTkwNFx1NzQwNlx1NUI4Q1x1NEUwMFx1NEUyQVx1NjI3OVx1NkIyMVx1NTQwRVx1RkYwQ1x1N0I0OVx1NUY4NVx1NTkxQVx1NUMxMVx1NzlEMlx1NTE4RFx1NUYwMFx1NTlDQlx1NEUwQlx1NEUwMFx1NEUyQVx1NjI3OVx1NkIyMVx1MzAwMicpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUoU3RyaW5nKHRoaXMucGx1Z2luLnNldHRpbmdzLnJlcXVlc3RfZGVsYXkpKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbnVtID0gcGFyc2VJbnQodmFsdWUsIDEwKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc05hTihudW0pICYmIG51bSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZXF1ZXN0X2RlbGF5ID0gbnVtO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgIFxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdcdTY3MDBcdTU5MjdcdTRGRUVcdTZCNjNcdTZCMjFcdTY1NzAnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1x1NEUwMFx1N0JDN1x1N0IxNFx1OEJCMFx1NTcyOFx1ODhBQlx1NjUzRVx1NUYwM1x1RkYwOFx1NzlGQlx1NTE2NSBEaXNjYXJkZWQgUGlsZVx1RkYwOVx1NTI0RFx1RkYwQ1x1NjcwMFx1NTkxQVx1NTE0MVx1OEJCOFx1ODhBQlx1NEZFRVx1NkI2M1x1NzY4NFx1NkIyMVx1NjU3MFx1MzAwMicpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUoU3RyaW5nKHRoaXMucGx1Z2luLnNldHRpbmdzLm1heF9yZXZpc2lvbl9yZXRyaWVzKSlcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG51bSA9IHBhcnNlSW50KHZhbHVlLCAxMCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNOYU4obnVtKSAmJiBudW0gPj0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubWF4X3JldmlzaW9uX3JldHJpZXMgPSBudW07XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdcdTVCQTFcdTY4MzhcdTZBMjFcdTVGMEYgKENyaXRpYyBNb2RlKScpXG4gICAgICAgICAgICAuc2V0RGVzYygnXHU5MDA5XHU2MkU5XHU1MTg1XHU1QkI5XHU1QkExXHU2ODM4XHU3Njg0XHU2NUI5XHU1RjBGXHUzMDAyXHU1NDJGXHU1M0QxXHU1RjBGXHU2QTIxXHU1RjBGXHU5MDFGXHU1RUE2XHU1RkVCXHU0RTE0XHU1MTREXHU4RDM5XHVGRjBDXHU0RjQ2XHU1M0VBXHU2OEMwXHU2N0U1XHU2ODNDXHU1RjBGXHVGRjFCQUlcdTZBMjFcdTVGMEZcdTY2RjRcdTY2N0FcdTgwRkRcdUZGMENcdTRGNDZcdTRGMUFcdTZEODhcdTgwMTdBUElcdTk4OURcdTVFQTZcdTMwMDInKVxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKGRyb3Bkb3duID0+IGRyb3Bkb3duXG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignaGV1cmlzdGljJywgJ1x1NTQyRlx1NTNEMVx1NUYwRiAoSGV1cmlzdGljKScpXG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignYWknLCAnXHU0RUJBXHU1REU1XHU2NjdBXHU4MEZEIChBSSknKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jcml0aWNfbW9kZSlcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiAnaGV1cmlzdGljJyB8ICdhaScpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3JpdGljX21vZGUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpOyAvLyBcdTkxQ0RcdTY1QjBcdTZFMzJcdTY3RDNcdTRFRTVcdTY2M0VcdTc5M0EvXHU5NjkwXHU4NUNGXHU3NkY4XHU1MTczXHU4QkJFXHU3RjZFXG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jcml0aWNfbW9kZSA9PT0gJ2hldXJpc3RpYycpIHtcbiAgICAgICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgICAgIC5zZXROYW1lKCdcdTU0MkZcdTUzRDFcdTVGMEZcdTVCQTFcdTY4MzhcdUZGMUFcdTVGQzVcdTk3MDBcdTc2ODRcdTY4MDdcdTk4OTgnKVxuICAgICAgICAgICAgICAgIC5zZXREZXNjKCdcdTU3MjhcdTU0MkZcdTUzRDFcdTVGMEZcdTZBMjFcdTVGMEZcdTRFMEJcdUZGMENcdTY4QzBcdTY3RTVcdTdCMTRcdThCQjBcdTY2MkZcdTU0MjZcdTUzMDVcdTU0MkJcdTYyNDBcdTY3MDlcdThGRDlcdTRFOUJcdTY4MDdcdTk4OThcdUZGMDhcdTZCQ0ZcdTg4NENcdTRFMDBcdTRFMkFcdUZGMDlcdTMwMDInKVxuICAgICAgICAgICAgICAgIC5hZGRUZXh0QXJlYSh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmNyaXRpY19yZXF1aXJlZF9oZWFkZXJzKVxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jcml0aWNfcmVxdWlyZWRfaGVhZGVycyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pLmlucHV0RWwuc3R5bGUuaGVpZ2h0ID0gJzE1MHB4Jyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgICAgIC5zZXROYW1lKCdcdTU0MkZcdTUzRDFcdTVGMEZcdTVCQTFcdTY4MzhcdUZGMUFcdTY3MDBcdTVDMEZcdTUxODVcdTVCQjlcdTk1N0ZcdTVFQTYnKVxuICAgICAgICAgICAgICAgIC5zZXREZXNjKCdcdTU3MjhcdTU0MkZcdTUzRDFcdTVGMEZcdTZBMjFcdTVGMEZcdTRFMEJcdUZGMENcdTdCMTRcdThCQjBcdTUxODVcdTVCQjlcdTVGQzVcdTk4N0JcdThGQkVcdTUyMzBcdTc2ODRcdTY3MDBcdTVDMEZcdTVCNTdcdTdCMjZcdTY1NzBcdTMwMDInKVxuICAgICAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUoU3RyaW5nKHRoaXMucGx1Z2luLnNldHRpbmdzLmNyaXRpY19taW5fY29udGVudF9sZW5ndGgpKVxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBudW0gPSBwYXJzZUludCh2YWx1ZSwgMTApO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc05hTihudW0pICYmIG51bSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3JpdGljX21pbl9jb250ZW50X2xlbmd0aCA9IG51bTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgLy8gXHU2OTgyXHU1RkY1XHU2NEFEXHU3OUNEIChcdTRGRERcdTc1NTlcdTUzOUZcdTY4MzcpXG4gICAgICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKS5zZXROYW1lKCdcdTY5ODJcdTVGRjVcdTY0QURcdTc5Q0QgKENvbmNlcHQgU2VlZGluZyknKS5zZXRIZWFkaW5nKCk7XG4gICAgICAgIFxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdcdTY5ODJcdTVGRjVcdTY0QURcdTc5Q0RcdTdCQjEnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1x1NTcyOFx1NkI2NFx1NTkwNFx1N0M5OFx1OEQzNFx1NjIxNlx1OEY5M1x1NTE2NVx1NjBBOFx1NjBGM1x1ODk4MVx1NzUxRlx1NjIxMFx1NTIxRFx1NTlDQlx1N0IxNFx1OEJCMFx1NzY4NFx1Njk4Mlx1NUZGNVx1NTIxN1x1ODg2OFx1RkYwQ1x1NkJDRlx1ODg0Q1x1NEUwMFx1NEUyQVx1Njk4Mlx1NUZGNVx1MzAwMicpXG4gICAgICAgICAgICAuYWRkVGV4dEFyZWEodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdcdTRGOEJcdTU5ODJcdUZGMUFcXG5cdTdCMkNcdTRFMDBcdTYwMjdcdTUzOUZcdTc0MDZcXG5cdTU5NjVcdTUzNjFcdTU5QzZcdTUyNDNcdTUyMDBcXG5cdTUyM0JcdTYxMEZcdTdFQzNcdTRFNjBcXG4uLi4nKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWVkQ29uY2VwdHMpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWVkQ29uY2VwdHMgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuaW5wdXRFbC5zdHlsZS5oZWlnaHQgPSAnMjAwcHgnXG4gICAgICAgICAgICApO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXG4gICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ1x1NjRBRFx1NzlDRFx1NTIzMFx1NUY4NVx1NzUxRlx1NjIxMFx1OTYxRlx1NTIxNycpXG4gICAgICAgICAgICAgICAgLnNldEN0YSgpXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByYXdUZXh0ID0gdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VlZENvbmNlcHRzO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXJhd1RleHQudHJpbSgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdcdTY0QURcdTc5Q0RcdTdCQjFcdTRFM0FcdTdBN0FcdUZGMENcdTY1RTBcdTk3MDBcdTY0Q0RcdTRGNUNcdTMwMDInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb25jZXB0c1RvU2VlZCA9IFsuLi5uZXcgU2V0KHJhd1RleHQuc3BsaXQoJ1xcbicpLm1hcChsaW5lID0+IGxpbmUudHJpbSgpKS5maWx0ZXIoQm9vbGVhbikpXTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYWRkZWRDb3VudCA9IHRoaXMucGx1Z2luLmVuZ2luZS5hZGRDb25jZXB0c1RvUXVldWUoY29uY2VwdHNUb1NlZWQpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBpZ25vcmVkQ291bnQgPSBjb25jZXB0c1RvU2VlZC5sZW5ndGggLSBhZGRlZENvdW50O1xuICAgICAgICAgICAgICAgICAgICBsZXQgbm90aWNlTWVzc2FnZSA9IGBcdTYyMTBcdTUyOUZcdTZERkJcdTUyQTAgJHthZGRlZENvdW50fSBcdTRFMkFcdTY1QjBcdTY5ODJcdTVGRjVcdTUyMzBcdTk2MUZcdTUyMTdcdTMwMDJgO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaWdub3JlZENvdW50ID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm90aWNlTWVzc2FnZSArPSBgXFxuJHtpZ25vcmVkQ291bnR9IFx1NEUyQVx1Njk4Mlx1NUZGNVx1NTZFMFx1NURGMlx1NUI1OFx1NTcyOFx1NjIxNlx1OTFDRFx1NTkwRFx1ODAwQ1x1ODhBQlx1NUZGRFx1NzU2NVx1MzAwMmA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZShub3RpY2VNZXNzYWdlLCA1MDAwKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VlZENvbmNlcHRzID0gJyc7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICAvLyBQcm9tcHRzIFx1OEJCRVx1N0Y2RSAoXHU0RkREXHU3NTU5XHU1MzlGXHU2ODM3KVxuICAgICAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbCkuc2V0TmFtZSgnUHJvbXB0cyBcdThCQkVcdTdGNkUnKS5zZXRIZWFkaW5nKCk7XG4gICAgICAgIFxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdcdTc1MUZcdTYyMTAgUHJvbXB0JylcbiAgICAgICAgICAgIC5zZXREZXNjKCdcdTc1MjhcdTRFOEVcdTc1MUZcdTYyMTBcdTY1QjBcdTY5ODJcdTVGRjVcdTUxODVcdTVCQjlcdTc2ODQgUHJvbXB0XHUzMDAyJylcbiAgICAgICAgICAgIC5hZGRUZXh0QXJlYSh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvbXB0X2dlbmVyYXRvcilcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnByb21wdF9nZW5lcmF0b3IgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkuaW5wdXRFbC5zdHlsZS5oZWlnaHQgPSAnMzAwcHgnKTtcbiAgICAgICAgXG4gICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jcml0aWNfbW9kZSA9PT0gJ2FpJykge1xuICAgICAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAgICAgLnNldE5hbWUoJ1x1NUJBMVx1NjgzOCBQcm9tcHQgKENyaXRpYyknKVxuICAgICAgICAgICAgICAgIC5zZXREZXNjKCdcdTc1MjhcdTRFOEUgQUkgXHU2QTIxXHU1RjBGXHU0RTBCXHU1QkExXHU2ODM4XHU3NTFGXHU2MjEwXHU1MTg1XHU1QkI5XHU3Njg0IFByb21wdFx1MzAwMicpXG4gICAgICAgICAgICAgICAgLmFkZFRleHRBcmVhKHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvbXB0X2NyaXRpYylcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvbXB0X2NyaXRpYyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pLmlucHV0RWwuc3R5bGUuaGVpZ2h0ID0gJzMwMHB4Jyk7XG4gICAgICAgIH1cblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdcdTRGRUVcdTZCNjMgUHJvbXB0IChSZXZpc2VyKScpXG4gICAgICAgICAgICAuc2V0RGVzYygnXHU3NTI4XHU0RThFXHU0RkVFXHU2QjYzXHU4OEFCXHU1QkExXHU2ODM4XHU1NDU4XHU2MkQyXHU3RUREXHU1MTg1XHU1QkI5XHU3Njg0IFByb21wdFx1MzAwMicpXG4gICAgICAgICAgICAuYWRkVGV4dEFyZWEodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnByb21wdF9yZXZpc2VyKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvbXB0X3JldmlzZXIgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkuaW5wdXRFbC5zdHlsZS5oZWlnaHQgPSAnMzAwcHgnKTtcbiAgICB9XG59XG4iLCAiLy8gTXlPYnNpZGlhblBsdWdpbi9RdWV1ZU1vZGFsLnRzIChWMS4yIC0gXHU5RUQ4XHU4QkE0XHU2Mjk4XHU1M0UwKVxuXG5pbXBvcnQgeyBBcHAsIE1vZGFsLCBTZXR0aW5nLCBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgS25vd2xlZGdlR3JhcGhQbHVnaW4gZnJvbSAnLi9tYWluJztcbmltcG9ydCB7IFRhc2tEYXRhIH0gZnJvbSAnLi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBRdWV1ZU1hbmFnZW1lbnRNb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgICBwbHVnaW46IEtub3dsZWRnZUdyYXBoUGx1Z2luO1xuXG4gICAgLy8gXHU3NTI4XHU0RThFXHU0RkREXHU1QjU4XHU2NDFDXHU3RDIyXHU4QkNEXG4gICAgcHJpdmF0ZSBzZWFyY2hUZXJtczogeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfSA9IHtcbiAgICAgICAgZ2VuOiAnJyxcbiAgICAgICAgcmV2OiAnJyxcbiAgICAgICAgcmVwOiAnJyxcbiAgICAgICAgZGlzOiAnJyxcbiAgICB9O1xuICAgIFxuICAgIC8vIFx1MzAxMFx1MzAxMFx1MzAxMCBcdTVERjJcdTRGRUVcdTY1MzlcdUZGMUFcdTlFRDhcdThCQTRcdTUxNjhcdTkwRThcdTYyOThcdTUzRTAgXHUzMDExXHUzMDExXHUzMDExXG4gICAgcHJpdmF0ZSBjb2xsYXBzZVN0YXRlczogeyBba2V5OiBzdHJpbmddOiBib29sZWFuIH0gPSB7XG4gICAgICAgIGdlbjogZmFsc2UsIC8vIFx1OUVEOFx1OEJBNFx1NjI5OFx1NTNFMFxuICAgICAgICByZXY6IGZhbHNlLCAvLyBcdTlFRDhcdThCQTRcdTYyOThcdTUzRTBcbiAgICAgICAgcmVwOiBmYWxzZSwgLy8gXHU5RUQ4XHU4QkE0XHU2Mjk4XHU1M0UwXG4gICAgICAgIGRpczogZmFsc2UsIC8vIFx1OUVEOFx1OEJBNFx1NjI5OFx1NTNFMFxuICAgIH07XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBLbm93bGVkZ2VHcmFwaFBsdWdpbikge1xuICAgICAgICBzdXBlcihhcHApO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICB9XG5cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcbiAgICAgICAgY29udGVudEVsLmFkZENsYXNzKCdrZy1tb2RhbCcpOyBcbiAgICAgICAgY29udGVudEVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ1x1OTYxRlx1NTIxN1x1N0JBMVx1NzQwNlx1NEVFQVx1ODg2OFx1NzZEOCcgfSk7XG5cbiAgICAgICAgY29uc3Qgc3RhdHVzID0gdGhpcy5wbHVnaW4uZGF0YS5zdGF0dXM7XG4gICAgICAgIGNvbnN0IHN0YXR1c1RleHQgPSBgXHU3MkI2XHU2MDAxOiAke3N0YXR1cy50b1VwcGVyQ2FzZSgpfSB8ICR7dGhpcy5wbHVnaW4uc3RhdHVzQmFyRWwuZ2V0VGV4dCgpfWA7XG4gICAgICAgIFxuICAgICAgICAvLyAxLiBcdTcyQjZcdTYwMDFcdTU0OENcdTU0MkZcdTUwNUNcdTYzMDlcdTk0QUVcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxuICAgICAgICAgICAgLnNldE5hbWUoc3RhdHVzID09PSAncnVubmluZycgPyAnXHU1RjE1XHU2NENFXHU4RkQwXHU4ODRDXHU0RTJEJyA6ICdcdTVGMTVcdTY0Q0VcdTVERjJcdTY2ODJcdTUwNUMnKVxuICAgICAgICAgICAgLnNldERlc2Moc3RhdHVzVGV4dClcbiAgICAgICAgICAgIC5hZGRCdXR0b24oYnV0dG9uID0+IGJ1dHRvblxuICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KHN0YXR1cyA9PT0gJ3J1bm5pbmcnID8gJ1x1NjY4Mlx1NTA1Q1x1NUYxNVx1NjRDRScgOiAnXHU1NDJGXHU1MkE4XHU1RjE1XHU2NENFJylcbiAgICAgICAgICAgICAgICAuc2V0Q3RhKHN0YXR1cyAhPT0gJ3J1bm5pbmcnKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uZW5naW5lLnRvZ2dsZUVuZ2luZVN0YXRlKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25PcGVuKCk7IC8vIFx1NTIzN1x1NjVCMCBNb2RhbCBcdTUxODVcdTkwRThcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAvLyAyLiBcdTZFMzJcdTY3RDNcdTU2REJcdTRFMkFcdTk2MUZcdTUyMTdcbiAgICAgICAgdGhpcy5yZW5kZXJRdWV1ZVNlY3Rpb24oXG4gICAgICAgICAgICBjb250ZW50RWwsIFxuICAgICAgICAgICAgJ2dlbicsIFxuICAgICAgICAgICAgJ1x1NUY4NVx1NzUxRlx1NjIxMCAoR2VuZXJhdGlvbiknLCBcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLmRhdGEuZ2VuZXJhdGlvblF1ZXVlLFxuICAgICAgICAgICAgdGhpcy5yZW5kZXJHZW5lcmF0aW9uSXRlbS5iaW5kKHRoaXMpXG4gICAgICAgICk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLnJlbmRlclF1ZXVlU2VjdGlvbihcbiAgICAgICAgICAgIGNvbnRlbnRFbCxcbiAgICAgICAgICAgICdyZXYnLFxuICAgICAgICAgICAgJ1x1NUY4NVx1NUJBMVx1NjgzOCAoUmV2aWV3KScsXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLnJldmlld1F1ZXVlLFxuICAgICAgICAgICAgdGhpcy5yZW5kZXJSZXZpZXdJdGVtLmJpbmQodGhpcylcbiAgICAgICAgKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMucmVuZGVyUXVldWVTZWN0aW9uKFxuICAgICAgICAgICAgY29udGVudEVsLFxuICAgICAgICAgICAgJ3JlcCcsXG4gICAgICAgICAgICAnXHU1Rjg1XHU0RkVFXHU2QjYzIChSZXZpc2lvbiknLFxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5yZXZpc2lvblF1ZXVlLFxuICAgICAgICAgICAgdGhpcy5yZW5kZXJSZXZpc2lvbkl0ZW0uYmluZCh0aGlzKVxuICAgICAgICApO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5yZW5kZXJRdWV1ZVNlY3Rpb24oXG4gICAgICAgICAgICBjb250ZW50RWwsXG4gICAgICAgICAgICAnZGlzJyxcbiAgICAgICAgICAgICdcdTVERjJcdTRFMjJcdTVGMDMgKERpc2NhcmRlZCknLFxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5kaXNjYXJkZWRQaWxlLFxuICAgICAgICAgICAgdGhpcy5yZW5kZXJEaXNjYXJkZWRJdGVtLmJpbmQodGhpcylcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBvbkNsb3NlKCkge1xuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICAgICAgY29udGVudEVsLmVtcHR5KCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogXHU2RTMyXHU2N0QzXHU0RTAwXHU0RTJBXHU5NjFGXHU1MjE3XHU1MzNBXHU1N0RGIChcdTVFMjZcdTY0MUNcdTdEMjJcdTU0OENcdTVDNTVcdTVGMDAvXHU2Mjk4XHU1M0UwKVxuICAgICAqL1xuICAgIHByaXZhdGUgcmVuZGVyUXVldWVTZWN0aW9uKFxuICAgICAgICBjb250YWluZXJFbDogSFRNTEVsZW1lbnQsXG4gICAgICAgIGtleTogJ2dlbicgfCAncmV2JyB8ICdyZXAnIHwgJ2RpcycsXG4gICAgICAgIHRpdGxlOiBzdHJpbmcsXG4gICAgICAgIGRhdGE6IChzdHJpbmcgfCBUYXNrRGF0YSlbXSxcbiAgICAgICAgcmVuZGVyRm46IChjb250YWluZXI6IEhUTUxFbGVtZW50LCBpdGVtOiBzdHJpbmcgfCBUYXNrRGF0YSwgaW5kZXg6IG51bWJlcikgPT4gdm9pZFxuICAgICkge1xuICAgICAgICBjb25zdCBkaXNwbGF5TGltaXQgPSAxMDA7IC8vIFx1NkJDRlx1NkIyMVx1NjcwMFx1NTkxQVx1NkUzMlx1NjdEMyAxMDAgXHU5ODc5XG4gICAgICAgIGNvbnN0IGZpbHRlciA9IHRoaXMuc2VhcmNoVGVybXNba2V5XTtcbiAgICAgICAgXG4gICAgICAgIC8vIDEuIFx1NjI2N1x1ODg0Q1x1OEZDN1x1NkVFNFxuICAgICAgICBjb25zdCBmaWx0ZXJlZERhdGEgPSBkYXRhLmZpbHRlcihpdGVtID0+IHtcbiAgICAgICAgICAgIGlmICghZmlsdGVyKSByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIGNvbnN0IG5lZWRsZSA9IGZpbHRlci50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBpdGVtID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMobmVlZGxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBpdGVtLmlkZWEudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhuZWVkbGUpO1xuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCB0b3RhbCA9IGRhdGEubGVuZ3RoO1xuICAgICAgICBjb25zdCBmaWx0ZXJlZFRvdGFsID0gZmlsdGVyZWREYXRhLmxlbmd0aDtcbiAgICAgICAgY29uc3QgdGl0bGVUZXh0ID0gYCR7dGl0bGV9ICgke2ZpbHRlcmVkVG90YWx9JHt0b3RhbCAhPT0gZmlsdGVyZWRUb3RhbCA/ICcgLyAnICsgdG90YWwgOiAnJ30gXHU5ODc5KWA7XG5cbiAgICAgICAgLy8gMi4gXHU0RjdGXHU3NTI4IDxkZXRhaWxzPiBcdTUxNDNcdTdEMjBcdTUyMUJcdTVFRkFcdTUzRUZcdTYyOThcdTUzRTBcdTUzM0FcdTU3REZcbiAgICAgICAgY29uc3QgZGV0YWlscyA9IGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdkZXRhaWxzJyk7XG4gICAgICAgIGRldGFpbHMub3BlbiA9IHRoaXMuY29sbGFwc2VTdGF0ZXNba2V5XTsgLy8gXHU4QkJFXHU3RjZFXHU1MjFEXHU1OUNCXHU1QzU1XHU1RjAwL1x1NjI5OFx1NTNFMFx1NzJCNlx1NjAwMVxuXG4gICAgICAgIC8vIDMuIFx1NjgwN1x1OTg5OCAoXHU3M0IwXHU1NzI4XHU2NjJGIDxzdW1tYXJ5Plx1RkYwQ1x1NTNFRlx1NEVFNVx1NzBCOVx1NTFGQilcbiAgICAgICAgY29uc3Qgc3VtbWFyeSA9IGRldGFpbHMuY3JlYXRlRWwoJ3N1bW1hcnknLCB7IHRleHQ6IHRpdGxlVGV4dCB9KTtcbiAgICAgICAgc3VtbWFyeS5zdHlsZS5mb250V2VpZ2h0ID0gJ2JvbGQnO1xuICAgICAgICBzdW1tYXJ5LnN0eWxlLmZvbnRTaXplID0gJ3ZhcigtLWZvbnQtdWktbGFyZ2UpJztcbiAgICAgICAgc3VtbWFyeS5zdHlsZS5jdXJzb3IgPSAncG9pbnRlcic7XG4gICAgICAgIHN1bW1hcnkuc3R5bGUucGFkZGluZyA9ICc1cHggMCc7XG5cbiAgICAgICAgLy8gNC4gXHU3NkQxXHU1NDJDXHU3MEI5XHU1MUZCXHU0RThCXHU0RUY2XHVGRjBDXHU0RkREXHU1QjU4XHU3MkI2XHU2MDAxXG4gICAgICAgIGRldGFpbHMuYWRkRXZlbnRMaXN0ZW5lcigndG9nZ2xlJywgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5jb2xsYXBzZVN0YXRlc1trZXldID0gZGV0YWlscy5vcGVuO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyA1LiBcdTY0MUNcdTdEMjJcdTY4NDYgKFx1NjUzRVx1NTcyOCBkZXRhaWxzIFx1NTE4NVx1OTBFOClcbiAgICAgICAgbmV3IFNldHRpbmcoZGV0YWlscylcbiAgICAgICAgICAgIC5zZXREZXNjKGBcdTY0MUNcdTdEMjIgJHt0aXRsZX0uLi5gKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB7XG4gICAgICAgICAgICAgICAgdGV4dC5zZXRQbGFjZWhvbGRlcignXHU4RjkzXHU1MTY1XHU1MTczXHU5NTJFXHU4QkNELi4uJylcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMuc2VhcmNoVGVybXNba2V5XSlcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoVGVybXNba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbk9wZW4oKTsgLy8gXHU1MjM3XHU2NUIwIE1vZGFsXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gNi4gXHU2MjJBXHU2NUFEXHU2NTcwXHU2MzZFXHU1RTc2XHU2RTMyXHU2N0QzXG4gICAgICAgIGNvbnN0IHRydW5jYXRlZERhdGEgPSBmaWx0ZXJlZERhdGEuc2xpY2UoMCwgZGlzcGxheUxpbWl0KTtcbiAgICAgICAgXG4gICAgICAgIGlmICh0cnVuY2F0ZWREYXRhLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgY29uc3QgZGVzYyA9IGRldGFpbHMuY3JlYXRlRWwoJ3AnLCB7IHRleHQ6ICdcdTZCNjRcdTk2MUZcdTUyMTdcdTRFM0FcdTdBN0FcdUZGMENcdTYyMTZcdTY3MkFcdTYyN0VcdTUyMzBcdTUzMzlcdTkxNERcdTk4NzlcdTMwMDInLCBjbHM6ICdzZXR0aW5nLWl0ZW0tZGVzY3JpcHRpb24nIH0pO1xuICAgICAgICAgICAgZGVzYy5zdHlsZS5wYWRkaW5nTGVmdCA9ICcxMHB4JztcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gNy4gXHU1MjE3XHU4ODY4XHU1QkI5XHU1NjY4IChcdTY1M0VcdTU3MjggZGV0YWlscyBcdTUxODVcdTkwRTgpXG4gICAgICAgIGNvbnN0IGxpc3RDb250YWluZXIgPSBkZXRhaWxzLmNyZWF0ZURpdigna2ctbGlzdC1jb250YWluZXInKTtcbiAgICAgICAgbGlzdENvbnRhaW5lci5zdHlsZS5tYXhIZWlnaHQgPSAnMjAwcHgnOyBcbiAgICAgICAgbGlzdENvbnRhaW5lci5zdHlsZS5vdmVyZmxvd1kgPSAnYXV0byc7IFxuICAgICAgICBsaXN0Q29udGFpbmVyLnN0eWxlLmJvcmRlciA9ICcxcHggc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpJztcbiAgICAgICAgbGlzdENvbnRhaW5lci5zdHlsZS5wYWRkaW5nID0gJzVweCc7XG4gICAgICAgIGxpc3RDb250YWluZXIuc3R5bGUubWFyZ2luTGVmdCA9ICcxMHB4JzsgLy8gXHU3RjI5XHU4RkRCXG5cbiAgICAgICAgdHJ1bmNhdGVkRGF0YS5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgcmVuZGVyRm4obGlzdENvbnRhaW5lciwgaXRlbSwgaW5kZXgpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyA4LiBcdTY2M0VcdTc5M0FcdTYyMkFcdTY1QURcdTYzRDBcdTc5M0FcbiAgICAgICAgaWYgKGZpbHRlcmVkRGF0YS5sZW5ndGggPiBkaXNwbGF5TGltaXQpIHtcbiAgICAgICAgICAgIGNvbnN0IHRydW5jYXRlZEluZm8gPSBkZXRhaWxzLmNyZWF0ZUVsKCdwJywgeyBcbiAgICAgICAgICAgICAgICB0ZXh0OiBgLi4uIFx1NEVDNVx1NjYzRVx1NzkzQVx1NTI0RCAke2Rpc3BsYXlMaW1pdH0gXHU5ODc5IChcdTUxNzEgJHtmaWx0ZXJlZERhdGEubGVuZ3RofSBcdTk4NzkpXHVGRjBDXHU4QkY3XHU0RjdGXHU3NTI4XHU2NDFDXHU3RDIyXHU2N0U1XHU2MjdFXHU2NkY0XHU1OTFBXHUzMDAyYCxcbiAgICAgICAgICAgICAgICBjbHM6ICdzZXR0aW5nLWl0ZW0tZGVzY3JpcHRpb24nXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRydW5jYXRlZEluZm8uc3R5bGUucGFkZGluZ0xlZnQgPSAnMTBweCc7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyAtLS0gXHU1MzU1XHU5ODc5XHU2RTMyXHU2N0QzXHU1MUZEXHU2NTcwIChcdTRGRERcdTYzMDFcdTRFMERcdTUzRDgpIC0tLVxuXG4gICAgcHJpdmF0ZSByZW5kZXJHZW5lcmF0aW9uSXRlbShjb250YWluZXI6IEhUTUxFbGVtZW50LCBpdGVtOiBzdHJpbmcgfCBUYXNrRGF0YSkge1xuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXIpXG4gICAgICAgICAgICAuc2V0TmFtZShpdGVtIGFzIHN0cmluZylcbiAgICAgICAgICAgIC5hZGRCdXR0b24oYnRuID0+IGJ0blxuICAgICAgICAgICAgICAgIC5zZXRJY29uKCd0cmFzaCcpXG4gICAgICAgICAgICAgICAgLnNldFRvb2x0aXAoJ1x1NTIyMFx1OTY2NFx1NkI2NFx1Njk4Mlx1NUZGNScpXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBxdWV1ZSA9IHRoaXMucGx1Z2luLmRhdGEuZ2VuZXJhdGlvblF1ZXVlO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBpbmRleCA9IHF1ZXVlLmluZGV4T2YoaXRlbSBhcyBzdHJpbmcpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcXVldWUuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVQbHVnaW5EYXRhKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5lbmdpbmUudXBkYXRlU3RhdHVzQmFyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uT3BlbigpOyAvLyBcdTUyMzdcdTY1QjBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuICAgIH1cblxuICAgIHByaXZhdGUgcmVuZGVyUmV2aWV3SXRlbShjb250YWluZXI6IEhUTUxFbGVtZW50LCBpdGVtOiBzdHJpbmcgfCBUYXNrRGF0YSkge1xuICAgICAgICBjb25zdCB0YXNrID0gaXRlbSBhcyBUYXNrRGF0YTtcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyKVxuICAgICAgICAgICAgLnNldE5hbWUoYFtcdTVCQTFcdTY4MzhdICR7dGFzay5pZGVhfWApXG4gICAgICAgICAgICAuYWRkQnV0dG9uKGJ0biA9PiBidG5cbiAgICAgICAgICAgICAgICAuc2V0SWNvbigndHJhc2gnKVxuICAgICAgICAgICAgICAgIC5zZXRUb29sdGlwKCdcdTRFMjJcdTVGMDNcdTZCNjRcdTRFRkJcdTUyQTEnKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5yZXZpZXdRdWV1ZS5zcGxpY2UodGhpcy5wbHVnaW4uZGF0YS5yZXZpZXdRdWV1ZS5pbmRleE9mKHRhc2spLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5kaXNjYXJkZWRQaWxlLnB1c2godGFzayk7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVQbHVnaW5EYXRhKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmVuZ2luZS51cGRhdGVTdGF0dXNCYXIoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbk9wZW4oKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcbiAgICB9XG4gICAgXG4gICAgcHJpdmF0ZSByZW5kZXJSZXZpc2lvbkl0ZW0oY29udGFpbmVyOiBIVE1MRWxlbWVudCwgaXRlbTogc3RyaW5nIHwgVGFza0RhdGEpIHtcbiAgICAgICAgY29uc3QgdGFzayA9IGl0ZW0gYXMgVGFza0RhdGE7XG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lcilcbiAgICAgICAgICAgIC5zZXROYW1lKGBbXHU0RkVFXHU2QjYzXSAke3Rhc2suaWRlYX1gKVxuICAgICAgICAgICAgLnNldERlc2MoYFx1NTM5Rlx1NTZFMDogJHt0YXNrLnJlYXNvbiB8fCAnXHU2NzJBXHU3N0U1J31gKVxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidG4gPT4gYnRuXG4gICAgICAgICAgICAgICAgLnNldEljb24oJ3RyYXNoJylcbiAgICAgICAgICAgICAgICAuc2V0VG9vbHRpcCgnXHU0RTIyXHU1RjAzXHU2QjY0XHU0RUZCXHU1MkExJylcbiAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmRhdGEucmV2aXNpb25RdWV1ZS5zcGxpY2UodGhpcy5wbHVnaW4uZGF0YS5yZXZpc2lvblF1ZXVlLmluZGV4T2YodGFzayksIDEpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLmRpc2NhcmRlZFBpbGUucHVzaCh0YXNrKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVBsdWdpbkRhdGEoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uZW5naW5lLnVwZGF0ZVN0YXR1c0JhcigpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uT3BlbigpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuICAgIH1cbiAgICBcbiAgICBwcml2YXRlIHJlbmRlckRpc2NhcmRlZEl0ZW0oY29udGFpbmVyOiBIVE1MRWxlbWVudCwgaXRlbTogc3RyaW5nIHwgVGFza0RhdGEpIHtcbiAgICAgICAgY29uc3QgdGFzayA9IGl0ZW0gYXMgVGFza0RhdGE7XG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lcilcbiAgICAgICAgICAgIC5zZXROYW1lKGBbXHU1REYyXHU0RTIyXHU1RjAzXSAke3Rhc2suaWRlYX1gKVxuICAgICAgICAgICAgLnNldERlc2MoYFx1NjcwMFx1NTQwRVx1NTM5Rlx1NTZFMDogJHt0YXNrLnJlYXNvbiB8fCAnXHU2NzJBXHU3N0U1J31gKVxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidG4gPT4gYnRuXG4gICAgICAgICAgICAgICAgLnNldEljb24oJ3JlZnJlc2gtY3cnKVxuICAgICAgICAgICAgICAgIC5zZXRUb29sdGlwKCdcdTkxQ0RcdTY1QjBcdTYzOTJcdTk2MUYgKFx1NjUzRVx1NTZERVx1NzUxRlx1NjIxMFx1OTYxRlx1NTIxNyknKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5kaXNjYXJkZWRQaWxlLnNwbGljZSh0aGlzLnBsdWdpbi5kYXRhLmRpc2NhcmRlZFBpbGUuaW5kZXhPZih0YXNrKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmVuZ2luZS5hZGRDb25jZXB0c1RvUXVldWUoW3Rhc2suaWRlYV0pOyAvLyBcdTRGN0ZcdTc1MjggZW5naW5lIFx1NzY4NFx1NjVCOVx1NkNENVxuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uT3BlbigpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBOb3RpY2UsIFRGaWxlLCBURm9sZGVyLCBub3JtYWxpemVQYXRoLCBBcHAgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgS25vd2xlZGdlR3JhcGhQbHVnaW4gZnJvbSAnLi9tYWluJztcbmltcG9ydCB7IEFQSUhhbmRsZXIsIEFsbE1vZGVsc0ZhaWxlZEVycm9yIH0gZnJvbSAnLi9hcGlIYW5kbGVyJztcbmltcG9ydCB7IENyaXRpYyB9IGZyb20gJy4vY3JpdGljJztcbmltcG9ydCB7IFJldmlzZXIgfSBmcm9tICcuL3JldmlzZXInO1xuaW1wb3J0IHsgc2FuaXRpemVGaWxlbmFtZSwgZXh0cmFjdE5ld0lkZWFzLCBjbGVhbk1hcmtkb3duT3V0cHV0IH0gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQgeyBUYXNrRGF0YSB9IGZyb20gJy4vdHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgRW5naW5lIHtcbiAgICBwbHVnaW46IEtub3dsZWRnZUdyYXBoUGx1Z2luO1xuICAgIGFwcDogQXBwO1xuICAgIGFwaUhhbmRsZXI6IEFQSUhhbmRsZXI7XG4gICAgY3JpdGljOiBDcml0aWM7XG4gICAgcmV2aXNlcjogUmV2aXNlcjtcbiAgICBwcml2YXRlIGlzUnVubmluZzogYm9vbGVhbiA9IGZhbHNlO1xuICAgIHByaXZhdGUgdGltZXJJZDogTm9kZUpTLlRpbWVvdXQgfCBudWxsID0gbnVsbDtcblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogS25vd2xlZGdlR3JhcGhQbHVnaW4pIHtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgICAgIHRoaXMuYXBwID0gcGx1Z2luLmFwcDtcbiAgICAgICAgdGhpcy5hcGlIYW5kbGVyID0gbmV3IEFQSUhhbmRsZXIocGx1Z2luKTtcbiAgICAgICAgdGhpcy5jcml0aWMgPSBuZXcgQ3JpdGljKHBsdWdpbik7XG4gICAgICAgIHRoaXMucmV2aXNlciA9IG5ldyBSZXZpc2VyKHBsdWdpbik7XG4gICAgfVxuXG4gICAgLy8gLS0tIFB1YmxpYyBDb250cm9scyAtLS1cblxuICAgIHB1YmxpYyB0b2dnbGVFbmdpbmVTdGF0ZSgpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNSdW5uaW5nKSB7XG4gICAgICAgICAgICB0aGlzLnN0b3AoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc3RhcnQoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBhZGRDb25jZXB0VG9RdWV1ZShjb25jZXB0OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgYWRkZWQgPSB0aGlzLmFkZENvbmNlcHRzVG9RdWV1ZShbY29uY2VwdF0pO1xuICAgICAgICBpZiAoYWRkZWQgPiAwKSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKGAnJHtjb25jZXB0fScgXHU1REYyXHU2REZCXHU1MkEwXHU1MjMwXHU3NTFGXHU2MjEwXHU5NjFGXHU1MjE3XHUzMDAyYCk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVN0YXR1c0JhcigpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgbmV3IE5vdGljZShgJyR7Y29uY2VwdH0nIFx1NURGMlx1NUI1OFx1NTcyOFx1NEU4RVx1OTYxRlx1NTIxN1x1NjIxNlx1NEVEM1x1NUU5M1x1NEUyRFx1RkYwQ1x1NjcyQVx1NkRGQlx1NTJBMFx1MzAwMmApO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgcHVibGljIGFkZENvbmNlcHRzVG9RdWV1ZShjb25jZXB0czogc3RyaW5nW10pOiBudW1iZXIge1xuICAgICAgICBjb25zdCBjdXJyZW50UXVldWUgPSBuZXcgU2V0KHRoaXMucGx1Z2luLmRhdGEuZ2VuZXJhdGlvblF1ZXVlKTtcbiAgICAgICAgY29uc3QgZXhpc3RpbmdGaWxlcyA9IG5ldyBTZXQodGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpLm1hcChmID0+IGYuYmFzZW5hbWUpKTtcblxuICAgICAgICBsZXQgYWRkZWRDb3VudCA9IDA7XG4gICAgICAgIGZvciAoY29uc3QgY29uY2VwdCBvZiBjb25jZXB0cykge1xuICAgICAgICAgICAgY29uc3Qgc2FuaXRpemVkID0gc2FuaXRpemVGaWxlbmFtZShjb25jZXB0KTtcbiAgICAgICAgICAgIGlmICghY3VycmVudFF1ZXVlLmhhcyhjb25jZXB0KSAmJiAhZXhpc3RpbmdGaWxlcy5oYXMoc2FuaXRpemVkKSkge1xuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmRhdGEuZ2VuZXJhdGlvblF1ZXVlLnB1c2goY29uY2VwdCk7XG4gICAgICAgICAgICAgICAgY3VycmVudFF1ZXVlLmFkZChjb25jZXB0KTtcbiAgICAgICAgICAgICAgICBhZGRlZENvdW50Kys7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoYWRkZWRDb3VudCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVQbHVnaW5EYXRhKCk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVN0YXR1c0JhcigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhZGRlZENvdW50O1xuICAgIH1cblxuICAgIC8vIC0tLSBDb3JlIExvb3AgLS0tXG5cbiAgICBwcml2YXRlIGFzeW5jIHN0YXJ0KCkge1xuICAgICAgICBpZiAodGhpcy5pc1J1bm5pbmcpIHJldHVybjtcbiAgICAgICAgdGhpcy5pc1J1bm5pbmcgPSB0cnVlO1xuICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLnN0YXR1cyA9ICdydW5uaW5nJztcbiAgICAgICAgbmV3IE5vdGljZSgnXHU3N0U1XHU4QkM2XHU1NkZFXHU4QzMxXHU1RjE1XHU2NENFXHU1REYyXHU1NDJGXHU1MkE4XHVGRjAxJyk7XG4gICAgICAgIHRoaXMudXBkYXRlU3RhdHVzQmFyKCk7XG4gICAgICAgIHRoaXMudGljaygpO1xuICAgIH1cblxuICAgIHByaXZhdGUgc3RvcCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzUnVubmluZykgcmV0dXJuO1xuICAgICAgICB0aGlzLmlzUnVubmluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLnN0YXR1cyA9ICdwYXVzZWQnO1xuICAgICAgICBpZiAodGhpcy50aW1lcklkKSB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lcklkKTtcbiAgICAgICAgICAgIHRoaXMudGltZXJJZCA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgbmV3IE5vdGljZSgnXHU3N0U1XHU4QkM2XHU1NkZFXHU4QzMxXHU1RjE1XHU2NENFXHU1REYyXHU2NjgyXHU1MDVDXHUzMDAyJyk7XG4gICAgICAgIHRoaXMudXBkYXRlU3RhdHVzQmFyKCk7XG4gICAgICAgIHRoaXMucGx1Z2luLnNhdmVQbHVnaW5EYXRhKCk7IC8vIFx1NTcyOFx1NTA1Q1x1NkI2Mlx1NjVGNlx1NEZERFx1NUI1OFx1NzJCNlx1NjAwMVxuICAgIH1cblxuICAgIHByaXZhdGUgc2NoZWR1bGVOZXh0VGljaygpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzUnVubmluZykgcmV0dXJuO1xuICAgICAgICBjb25zdCBkZWxheSA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnJlcXVlc3RfZGVsYXkgKiAxMDAwO1xuICAgICAgICB0aGlzLnRpbWVySWQgPSBzZXRUaW1lb3V0KCgpID0+IHRoaXMudGljaygpLCBkZWxheSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyB0aWNrKCkge1xuICAgICAgICBpZiAoIXRoaXMuaXNSdW5uaW5nKSByZXR1cm47XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGxldCB0YXNrUHJvY2Vzc2VkID0gZmFsc2U7XG5cbiAgICAgICAgICAgIC8vIFx1NEYxOFx1NTE0OFx1NTkwNFx1NzQwNlx1NEZFRVx1OEJBMlx1OTYxRlx1NTIxN1xuICAgICAgICAgICAgaWYgKHRoaXMucGx1Z2luLmRhdGEucmV2aXNpb25RdWV1ZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgdGFza1Byb2Nlc3NlZCA9IGF3YWl0IHRoaXMucnVuUmV2aXNpb25QaGFzZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gXHU3MTM2XHU1NDBFXHU1OTA0XHU3NDA2XHU1QkExXHU2ODM4XHU5NjFGXHU1MjE3XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLnBsdWdpbi5kYXRhLnJldmlld1F1ZXVlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICB0YXNrUHJvY2Vzc2VkID0gYXdhaXQgdGhpcy5ydW5Dcml0aWNQaGFzZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gXHU2NzAwXHU1NDBFXHU1OTA0XHU3NDA2XHU3NTFGXHU2MjEwXHU5NjFGXHU1MjE3XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLnBsdWdpbi5kYXRhLmdlbmVyYXRpb25RdWV1ZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgdGFza1Byb2Nlc3NlZCA9IGF3YWl0IHRoaXMucnVuR2VuZXJhdGlvblBoYXNlKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFx1NTk4Mlx1Njc5Q1x1NjI0MFx1NjcwOVx1OTYxRlx1NTIxN1x1OTBGRFx1N0E3QVx1NEU4Nlx1RkYwQ1x1NTIxOVx1NTA1Q1x1NkI2Mlx1NUYxNVx1NjRDRVxuICAgICAgICAgICAgaWYgKCF0YXNrUHJvY2Vzc2VkICYmXG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5nZW5lcmF0aW9uUXVldWUubGVuZ3RoID09PSAwICYmXG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5yZXZpZXdRdWV1ZS5sZW5ndGggPT09IDAgJiZcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLnJldmlzaW9uUXVldWUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnXHVEODNDXHVERjg5IFx1NjI0MFx1NjcwOVx1NEVGQlx1NTJBMVx1NUI4Q1x1NjIxMFx1RkYwMVx1NUYxNVx1NjRDRVx1NURGMlx1NTA1Q1x1NkI2Mlx1MzAwMicpO1xuICAgICAgICAgICAgICAgIHRoaXMuaXNSdW5uaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5zdGF0dXMgPSAnaWRsZSc7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVTdGF0dXNCYXIoKTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlUGx1Z2luRGF0YSgpOyAvLyBcdTRGRERcdTVCNThcdTY3MDBcdTdFQzhcdTcyQjZcdTYwMDFcbiAgICAgICAgICAgICAgICByZXR1cm47IC8vIFx1NTA1Q1x1NkI2MiB0aWNrIFx1NUZBQVx1NzNBRlxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiXHU1RjE1XHU2NENFIFRpY2sgXHU1M0QxXHU3NTFGXHU0RTI1XHU5MUNEXHU5NTE5XHU4QkVGOlwiLCBlcnJvcik7XG4gICAgICAgICAgICBuZXcgTm90aWNlKFwiXHU1RjE1XHU2NENFXHU5MDQ3XHU1MjMwXHU5NTE5XHU4QkVGXHVGRjBDXHU1REYyXHU2NjgyXHU1MDVDXHUzMDAyXHU4QkY3XHU2OEMwXHU2N0U1XHU2M0E3XHU1MjM2XHU1M0YwXHUzMDAyXCIpO1xuICAgICAgICAgICAgdGhpcy5zdG9wKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnNjaGVkdWxlTmV4dFRpY2soKTtcbiAgICB9XG5cbiAgICAvLyAtLS0gUGhhc2VzIC0tLVxuXG4gICAgcHJpdmF0ZSBhc3luYyBydW5HZW5lcmF0aW9uUGhhc2UoKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgICAgIGNvbnN0IHF1ZXVlID0gdGhpcy5wbHVnaW4uZGF0YS5nZW5lcmF0aW9uUXVldWU7XG4gICAgICAgIGlmIChxdWV1ZS5sZW5ndGggPT09IDApIHJldHVybiBmYWxzZTtcblxuICAgICAgICBjb25zdCBiYXRjaFNpemUgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW5lcmF0aW9uX2JhdGNoX3NpemU7XG4gICAgICAgIGNvbnN0IGJhdGNoID0gcXVldWUuc3BsaWNlKDAsIE1hdGgubWluKHF1ZXVlLmxlbmd0aCwgYmF0Y2hTaXplKSk7XG5cbiAgICAgICAgdGhpcy51cGRhdGVTdGF0dXNCYXIoKTtcbiAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVBsdWdpbkRhdGEoKTsgLy8gXHU0RkREXHU1QjU4XHU1M0Q2XHU1MUZBXHU2Mjc5XHU2QjIxXHU1NDBFXHU3Njg0XHU3MkI2XHU2MDAxXG5cbiAgICAgICAgY29uc3QgdGFza3MgPSBiYXRjaC5tYXAoaWRlYSA9PiB0aGlzLmdlbmVyYXRpb25UYXNrKGlkZWEpKTtcbiAgICAgICAgYXdhaXQgUHJvbWlzZS5hbGxTZXR0bGVkKHRhc2tzKTtcblxuICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlUGx1Z2luRGF0YSgpOyAvLyBcdTRGRERcdTVCNThcdTYyNzlcdTZCMjFcdTU5MDRcdTc0MDZcdTVCOENcdTYyMTBcdTU0MEVcdTc2ODRcdTcyQjZcdTYwMDFcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0aW9uVGFzayhpZGVhOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgcHJvbXB0ID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvbXB0X2dlbmVyYXRvci5yZXBsYWNlKFwie2NvbmNlcHR9XCIsIGlkZWEpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuYXBpSGFuZGxlci5jYWxsKHByb21wdCk7XG4gICAgICAgICAgICBjb25zdCBjbGVhbmVkQ29udGVudCA9IGNsZWFuTWFya2Rvd25PdXRwdXQoY29udGVudCk7XG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLnJldmlld1F1ZXVlLnB1c2goeyBpZGVhLCBjb250ZW50OiBjbGVhbmVkQ29udGVudCB9KTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBcdTI3MDUgW1x1NzUxRlx1NjIxMFx1NjIxMFx1NTI5Rl06ICR7aWRlYX1gKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBBbGxNb2RlbHNGYWlsZWRFcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYFx1Mjc0QyBbXHU3NTFGXHU2MjEwXHU1OTMxXHU4RDI1XTogJHtpZGVhfSAtICR7ZS5tZXNzYWdlfWApO1xuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmRhdGEuZ2VuZXJhdGlvblF1ZXVlLnVuc2hpZnQoaWRlYSk7IC8vIFx1NTkzMVx1OEQyNVx1NzY4NFx1NEVGQlx1NTJBMVx1NjUzRVx1NTZERVx1OTYxRlx1OTk5NlxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBydW5Dcml0aWNQaGFzZSgpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICAgICAgY29uc3QgcXVldWUgPSB0aGlzLnBsdWdpbi5kYXRhLnJldmlld1F1ZXVlO1xuICAgICAgICBpZiAocXVldWUubGVuZ3RoID09PSAwKSByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgY29uc3QgYmF0Y2hTaXplID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2VuZXJhdGlvbl9iYXRjaF9zaXplO1xuICAgICAgICBjb25zdCB0YXNrc1RvUmV2aWV3ID0gcXVldWUuc3BsaWNlKDAsIE1hdGgubWluKHF1ZXVlLmxlbmd0aCwgYmF0Y2hTaXplKSk7XG5cbiAgICAgICAgdGhpcy51cGRhdGVTdGF0dXNCYXIoKTtcbiAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVBsdWdpbkRhdGEoKTsgLy8gXHU0RkREXHU1QjU4XHU1M0Q2XHU1MUZBXHU2Mjc5XHU2QjIxXHU1NDBFXHU3Njg0XHU3MkI2XHU2MDAxXG5cbiAgICAgICAgbGV0IG5ld0lkZWFzRm91bmQ6IFNldDxzdHJpbmc+ID0gbmV3IFNldCgpO1xuXG4gICAgICAgIGZvciAoY29uc3QgdGFzayBvZiB0YXNrc1RvUmV2aWV3KSB7XG4gICAgICAgICAgICBjb25zdCB7IGlzQXBwcm92ZWQsIHJlYXNvbiB9ID0gYXdhaXQgdGhpcy5jcml0aWMuanVkZ2UodGFzay5jb250ZW50KTtcbiAgICAgICAgICAgIGlmIChpc0FwcHJvdmVkKSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5zYXZlTm90ZSh0YXNrLmlkZWEsIHRhc2suY29udGVudCk7XG4gICAgICAgICAgICAgICAgY29uc3QgaWRlYXMgPSBleHRyYWN0TmV3SWRlYXModGFzay5jb250ZW50KTtcbiAgICAgICAgICAgICAgICBpZGVhcy5mb3JFYWNoKGlkZWEgPT4gbmV3SWRlYXNGb3VuZC5hZGQoaWRlYSkpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBcdUQ4M0RcdURDNEQgW1x1NUJBMVx1NjgzOFx1OTAxQVx1OEZDN106ICR7dGFzay5pZGVhfWApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0YXNrLnJlYXNvbiA9IHJlYXNvbjtcbiAgICAgICAgICAgICAgICB0YXNrLnJldHJpZXMgPSAodGFzay5yZXRyaWVzIHx8IDApICsgMTtcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5kYXRhLnJldmlzaW9uUXVldWUucHVzaCh0YXNrKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFx1RDgzRFx1REM0RSBbXHU1QkExXHU2ODM4XHU2MkQyXHU3RUREXTogJHt0YXNrLmlkZWF9IC0gJHtyZWFzb259YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobmV3SWRlYXNGb3VuZC5zaXplID4gMCkge1xuICAgICAgICAgICAgdGhpcy5hZGRDb25jZXB0c1RvUXVldWUoQXJyYXkuZnJvbShuZXdJZGVhc0ZvdW5kKSk7XG4gICAgICAgIH1cblxuICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlUGx1Z2luRGF0YSgpOyAvLyBcdTRGRERcdTVCNThcdTYyNzlcdTZCMjFcdTU5MDRcdTc0MDZcdTVCOENcdTYyMTBcdTU0MEVcdTc2ODRcdTcyQjZcdTYwMDFcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBydW5SZXZpc2lvblBoYXNlKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgICAgICBjb25zdCBxdWV1ZSA9IHRoaXMucGx1Z2luLmRhdGEucmV2aXNpb25RdWV1ZTtcbiAgICAgICAgaWYgKHF1ZXVlLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgIGNvbnN0IGJhdGNoU2l6ZSA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmdlbmVyYXRpb25fYmF0Y2hfc2l6ZTtcbiAgICAgICAgY29uc3QgdGFza3NUb1JldmlzZSA9IHF1ZXVlLnNwbGljZSgwLCBNYXRoLm1pbihxdWV1ZS5sZW5ndGgsIGJhdGNoU2l6ZSkpO1xuXG4gICAgICAgIHRoaXMudXBkYXRlU3RhdHVzQmFyKCk7XG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVQbHVnaW5EYXRhKCk7IC8vIFx1NEZERFx1NUI1OFx1NTNENlx1NTFGQVx1NjI3OVx1NkIyMVx1NTQwRVx1NzY4NFx1NzJCNlx1NjAwMVxuXG4gICAgICAgIGZvciAoY29uc3QgdGFzayBvZiB0YXNrc1RvUmV2aXNlKSB7XG4gICAgICAgICAgICBpZiAoKHRhc2sucmV0cmllcyB8fCAwKSA+PSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5tYXhfcmV2aXNpb25fcmV0cmllcykge1xuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmRhdGEuZGlzY2FyZGVkUGlsZS5wdXNoKHRhc2spO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYFx1RDgzRFx1REM4MCBbXHU2NTNFXHU1RjAzXHU0RkVFXHU2QjYzXTogJHt0YXNrLmlkZWF9IFx1NURGMlx1OEZCRVx1NjcwMFx1NTkyN1x1OTFDRFx1OEJENVx1NkIyMVx1NjU3MFx1MzAwMmApO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXdhaXQgdGhpcy5yZXZpc2lvblRhc2sodGFzayk7XG4gICAgICAgIH1cblxuICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlUGx1Z2luRGF0YSgpOyAvLyBcdTRGRERcdTVCNThcdTYyNzlcdTZCMjFcdTU5MDRcdTc0MDZcdTVCOENcdTYyMTBcdTU0MEVcdTc2ODRcdTcyQjZcdTYwMDFcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyByZXZpc2lvblRhc2sodGFzazogVGFza0RhdGEpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgcHJvbXB0ID0gdGhpcy5yZXZpc2VyLmNyZWF0ZVJldmlzaW9uUHJvbXB0KHRhc2suaWRlYSwgdGFzay5jb250ZW50LCB0YXNrLnJlYXNvbiB8fCAnXHU2NzJBXHU3N0U1XHU1MzlGXHU1NkUwJyk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBuZXdDb250ZW50ID0gYXdhaXQgdGhpcy5hcGlIYW5kbGVyLmNhbGwocHJvbXB0KTtcbiAgICAgICAgICAgIGNvbnN0IGNsZWFuZWRDb250ZW50ID0gY2xlYW5NYXJrZG93bk91dHB1dChuZXdDb250ZW50KTtcbiAgICAgICAgICAgIGNvbnN0IHJldmlzZWRUYXNrID0geyAuLi50YXNrLCBjb250ZW50OiBjbGVhbmVkQ29udGVudCB9O1xuICAgICAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5yZXZpZXdRdWV1ZS5wdXNoKHJldmlzZWRUYXNrKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBcdUQ4M0RcdUREMDQgW1x1NEZFRVx1NkI2M1x1NUI4Q1x1NjIxMF06ICR7dGFzay5pZGVhfWApO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBcdTI3NEMgW1x1NEZFRVx1NkI2M1x1NTkzMVx1OEQyNV06ICR7dGFzay5pZGVhfSAtICR7ZS5tZXNzYWdlfWApO1xuICAgICAgICAgICAgdGhpcy5wbHVnaW4uZGF0YS5yZXZpc2lvblF1ZXVlLnVuc2hpZnQodGFzayk7IC8vIFx1NTkzMVx1OEQyNVx1NzY4NFx1NEVGQlx1NTJBMVx1NjUzRVx1NTZERVx1OTYxRlx1OTk5NlxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gLS0tIEZpbGUgJiBVSSAtLS1cblxuICAgIHByaXZhdGUgYXN5bmMgc2F2ZU5vdGUoaWRlYTogc3RyaW5nLCBjb250ZW50OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgZmlsZW5hbWUgPSBzYW5pdGl6ZUZpbGVuYW1lKGlkZWEpO1xuICAgICAgICBjb25zdCBmb2xkZXJQYXRoID0gdGhpcy5wbHVnaW4uc2V0dGluZ3Mub3V0cHV0X2RpcjtcblxuICAgICAgICBpZiAoISh0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZm9sZGVyUGF0aCkgaW5zdGFuY2VvZiBURm9sZGVyKSkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5jcmVhdGVGb2xkZXIoZm9sZGVyUGF0aCk7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYFx1NTIxQlx1NUVGQVx1NjU4N1x1NEVGNlx1NTkzOVx1NTkzMVx1OEQyNTogJHtmb2xkZXJQYXRofWAsIGVycm9yKTtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKGBcdTY1RTBcdTZDRDVcdTUyMUJcdTVFRkFcdThGOTNcdTUxRkFcdTY1ODdcdTRFRjZcdTU5Mzk6ICR7Zm9sZGVyUGF0aH1gKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBmaWxlUGF0aCA9IG5vcm1hbGl6ZVBhdGgoYCR7Zm9sZGVyUGF0aH0vJHtmaWxlbmFtZX0ubWRgKTtcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlUGF0aCk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgY29udGVudCk7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShgXHU3QjE0XHU4QkIwXHU1REYyXHU2NkY0XHU2NUIwOiAke2ZpbGVuYW1lfWApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5jcmVhdGUoZmlsZVBhdGgsIGNvbnRlbnQpO1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYFx1N0IxNFx1OEJCMFx1NURGMlx1NTIxQlx1NUVGQTogJHtmaWxlbmFtZX1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYFx1NEZERFx1NUI1OFx1N0IxNFx1OEJCMFx1NTkzMVx1OEQyNTogJHtmaWxlUGF0aH1gLCBlcnJvcik7XG4gICAgICAgICAgICBuZXcgTm90aWNlKGBcdTY1RTBcdTZDRDVcdTRGRERcdTVCNThcdTdCMTRcdThCQjA6ICR7ZmlsZW5hbWV9YCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgdXBkYXRlU3RhdHVzQmFyKCkge1xuICAgICAgICBpZiAoIXRoaXMucGx1Z2luLnN0YXR1c0JhckVsKSByZXR1cm47XG4gICAgICAgIGNvbnN0IHsgZ2VuZXJhdGlvblF1ZXVlLCByZXZpZXdRdWV1ZSwgcmV2aXNpb25RdWV1ZSB9ID0gdGhpcy5wbHVnaW4uZGF0YTtcbiAgICAgICAgY29uc3QgdG90YWwgPSBnZW5lcmF0aW9uUXVldWUubGVuZ3RoICsgcmV2aWV3UXVldWUubGVuZ3RoICsgcmV2aXNpb25RdWV1ZS5sZW5ndGg7XG4gICAgICAgIHRoaXMucGx1Z2luLnN0YXR1c0JhckVsLnNldFRleHQoYEtHOiAke3RoaXMucGx1Z2luLmRhdGEuc3RhdHVzfSB8IEc6JHtnZW5lcmF0aW9uUXVldWUubGVuZ3RofSB8IEM6JHtyZXZpZXdRdWV1ZS5sZW5ndGh9IHwgUjoke3JldmlzaW9uUXVldWUubGVuZ3RofSB8IFRvdGFsOiR7dG90YWx9YCk7XG4gICAgICAgIFxuICAgICAgICAvLyAtLS0tLSBcdTUxNzNcdTk1MkVcdTRGRUVcdTY1MzlcdUZGMUFcdTUyMjBcdTk2NjRcdTRFODZcdThGRDlcdTg4NENcdThDMDNcdTc1MjhcdUZGMENcdTRFRTVcdTkwN0ZcdTUxNERcdThGQzdcdTVFQTZcdTRGRERcdTVCNTggLS0tLS1cbiAgICAgICAgLy8gdGhpcy5wbHVnaW4uc2F2ZVBsdWdpbkRhdGEoKTtcbiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIH1cbn1cbiIsICIvLyBhcGlIYW5kbGVyLnRzIChcdTY3MDBcdTdFQzhcdTRGMThcdTUzMTZcdTcyNDggLSBcdTk2QzZcdTYyMTBcdTdDQkVcdTdFQzZcdTk1MTlcdThCRUZcdTU5MDRcdTc0MDZcdTRFMEVcdTgxRUFcdTUyQThcdTYwNjJcdTU5MEQpXG5cbmltcG9ydCB7IHJlcXVlc3RVcmwsIE5vdGljZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IEtub3dsZWRnZUdyYXBoUGx1Z2luU2V0dGluZ3MsIEtleVVzYWdlU3RhdHVzIH0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQgS25vd2xlZGdlR3JhcGhQbHVnaW4gZnJvbSAnLi9tYWluJztcblxuZXhwb3J0IGNsYXNzIEFwaUtleUV4aGF1c3RlZEVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICAgIGNvbnN0cnVjdG9yKG1lc3NhZ2U6IHN0cmluZykge1xuICAgICAgICBzdXBlcihtZXNzYWdlKTtcbiAgICAgICAgdGhpcy5uYW1lID0gJ0FwaUtleUV4aGF1c3RlZEVycm9yJztcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBBbGxNb2RlbHNGYWlsZWRFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgICBjb25zdHJ1Y3RvcihtZXNzYWdlOiBzdHJpbmcpIHtcbiAgICAgICAgc3VwZXIobWVzc2FnZSk7XG4gICAgICAgIHRoaXMubmFtZSA9ICdBbGxNb2RlbHNGYWlsZWRFcnJvcic7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgQVBJSGFuZGxlciB7XG4gICAgcHJpdmF0ZSBwbHVnaW46IEtub3dsZWRnZUdyYXBoUGx1Z2luO1xuICAgIHByaXZhdGUgc2V0dGluZ3M6IEtub3dsZWRnZUdyYXBoUGx1Z2luU2V0dGluZ3M7XG4gICAgcHJpdmF0ZSBvcGVuYWlfa2V5czogc3RyaW5nW107XG4gICAgcHJpdmF0ZSBnb29nbGVfa2V5czogc3RyaW5nW107XG4gICAgcHJpdmF0ZSBrZXlVc2FnZU9wZW5BSTogTWFwPHN0cmluZywgS2V5VXNhZ2VTdGF0dXM+ID0gbmV3IE1hcCgpO1xuICAgIHByaXZhdGUga2V5VXNhZ2VHb29nbGU6IE1hcDxzdHJpbmcsIEtleVVzYWdlU3RhdHVzPiA9IG5ldyBNYXAoKTtcbiAgICBcbiAgICAvLyBcdTc1MjhcdTRFOEVcdThEREZcdThFMkFcdTY2MkZcdTU0MjZcdTVERjJcdTdFQ0ZcdTkwMUFcdTc3RTVcdThGQzdcdTY1NDVcdTk2OUNcdTUyMDdcdTYzNjJcbiAgICBwcml2YXRlIGhhc05vdGlmaWVkRmFpbG92ZXI6IGJvb2xlYW4gPSBmYWxzZTsgXG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IEtub3dsZWRnZUdyYXBoUGx1Z2luKSB7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gcGx1Z2luLnNldHRpbmdzO1xuICAgICAgICB0aGlzLnVwZGF0ZUtleXMoKTtcbiAgICB9XG5cbiAgICB1cGRhdGVLZXlzKCkge1xuICAgICAgICB0aGlzLm9wZW5haV9rZXlzID0gdGhpcy5zZXR0aW5ncy5vcGVuYWlfYXBpX2tleXMuc3BsaXQoJ1xcbicpLm1hcChrID0+IGsudHJpbSgpKS5maWx0ZXIoQm9vbGVhbik7XG4gICAgICAgIHRoaXMuZ29vZ2xlX2tleXMgPSB0aGlzLnNldHRpbmdzLmdvb2dsZV9hcGlfa2V5cy5zcGxpdCgnXFxuJykubWFwKGsgPT4gay50cmltKCkpLmZpbHRlcihCb29sZWFuKTtcblxuICAgICAgICB0aGlzLm9wZW5haV9rZXlzLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgICAgIGlmICghdGhpcy5rZXlVc2FnZU9wZW5BSS5oYXMoa2V5KSkge1xuICAgICAgICAgICAgICAgIHRoaXMua2V5VXNhZ2VPcGVuQUkuc2V0KGtleSwgeyBmYWlsczogMCwgY29vbGRvd25fdW50aWw6IDAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmdvb2dsZV9rZXlzLmZvckVhY2goa2V5ID0+IHtcbiAgICAgICAgICAgIGlmICghdGhpcy5rZXlVc2FnZUdvb2dsZS5oYXMoa2V5KSkge1xuICAgICAgICAgICAgICAgIHRoaXMua2V5VXNhZ2VHb29nbGUuc2V0KGtleSwgeyBmYWlsczogMCwgY29vbGRvd25fdW50aWw6IDAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgX3NlbGVjdEtleShrZXlzOiBzdHJpbmdbXSwgcHJvdmlkZXI6ICdvcGVuYWknIHwgJ2dvb2dsZScpOiBzdHJpbmcgfCBudWxsIHtcbiAgICAgICAgY29uc3Qga2V5VXNhZ2VNYXAgPSBwcm92aWRlciA9PT0gJ29wZW5haScgPyB0aGlzLmtleVVzYWdlT3BlbkFJIDogdGhpcy5rZXlVc2FnZUdvb2dsZTtcbiAgICAgICAgY29uc3QgY3VycmVudFRpbWUgPSBEYXRlLm5vdygpIC8gMTAwMDtcbiAgICAgICAgXG4gICAgICAgIGZvciAoY29uc3Qga2V5IG9mIGtleXMpIHtcbiAgICAgICAgICAgIGNvbnN0IHVzYWdlID0ga2V5VXNhZ2VNYXAuZ2V0KGtleSk7XG4gICAgICAgICAgICBpZiAodXNhZ2UgJiYgY3VycmVudFRpbWUgPj0gdXNhZ2UuY29vbGRvd25fdW50aWwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ga2V5O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgX2NhbGxPcGVuQUkoa2V5OiBzdHJpbmcsIHByb21wdDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdFVybCh7XG4gICAgICAgICAgICAgICAgdXJsOiBgJHt0aGlzLnNldHRpbmdzLm9wZW5haV9iYXNlX3VybH0vY2hhdC9jb21wbGV0aW9uc2AsXG4gICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgICAgICAgICAgICAgXCJBdXRob3JpemF0aW9uXCI6IGBCZWFyZXIgJHtrZXl9YFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgICAgICBtb2RlbDogdGhpcy5zZXR0aW5ncy5vcGVuYWlfbW9kZWwsXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VzOiBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9XSxcbiAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IHRoaXMuc2V0dGluZ3MuZ2VuZXJhdGlvbl90ZW1wZXJhdHVyZSxcbiAgICAgICAgICAgICAgICAgICAgbWF4X3Rva2VuczogdGhpcy5zZXR0aW5ncy5nZW5lcmF0aW9uX21heF90b2tlbnNcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zdCBkYXRhID0gcmVzcG9uc2UuanNvbjtcbiAgICAgICAgICAgIGNvbnN0IGtleVVzYWdlID0gdGhpcy5rZXlVc2FnZU9wZW5BSS5nZXQoa2V5KTtcbiAgICAgICAgICAgIGlmIChrZXlVc2FnZSkga2V5VXNhZ2UuY29vbGRvd25fdW50aWwgPSAwOyAvLyBcdTYyMTBcdTUyOUZcdTUyMTlcdTZFMDVcdTk2NjRcdTUxQjdcdTUzNzRcblxuICAgICAgICAgICAgLy8gXHUzMDEwXHU2NUIwXHU1ODlFXHUzMDExXHU2MjEwXHU1MjlGXHU4QzAzXHU3NTI4IE9wZW5BSSBBUEkgXHU1NDBFXHVGRjBDXHU5MUNEXHU3RjZFXHU2NTQ1XHU5NjlDXHU1MjA3XHU2MzYyXHU2ODA3XHU1RkQ3XG4gICAgICAgICAgICB0aGlzLmhhc05vdGlmaWVkRmFpbG92ZXIgPSBmYWxzZTtcblxuICAgICAgICAgICAgcmV0dXJuIGRhdGEuY2hvaWNlc1swXS5tZXNzYWdlLmNvbnRlbnQudHJpbSgpO1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYE9wZW5BSSBBUEkgY2FsbCBmYWlsZWQgZm9yIGtleSAuLi4ke2tleS5zbGljZSgtNCl9OmAsIGVycm9yKTtcbiAgICAgICAgICAgIGNvbnN0IGtleVVzYWdlID0gdGhpcy5rZXlVc2FnZU9wZW5BSS5nZXQoa2V5KTtcbiAgICAgICAgICAgIGlmIChrZXlVc2FnZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGh0dHBTdGF0dXMgPSBlcnJvci5zdGF0dXM7XG4gICAgICAgICAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IubWVzc2FnZT8udG9Mb3dlckNhc2UoKSB8fCAnJztcblxuICAgICAgICAgICAgICAgIC8vIFx1NUJGOVx1NEU4RVx1OEJBNFx1OEJDMVx1MzAwMVx1Njc0M1x1OTY1MFx1MzAwMVx1OTg5RFx1NUVBNlx1OTVFRVx1OTg5OFx1RkYwQ1x1NUU5NFx1NzUyOFx1NUI4Q1x1NjU3NFx1NzY4NFx1NTFCN1x1NTM3NFx1NjVGNlx1OTVGNFxuICAgICAgICAgICAgICAgIGlmIChodHRwU3RhdHVzID09PSA0MDEgfHwgaHR0cFN0YXR1cyA9PT0gNDAzIHx8IGh0dHBTdGF0dXMgPT09IDQyOSB8fCBlcnJvck1lc3NhZ2UuaW5jbHVkZXMoJ2luc3VmZmljaWVudF9xdW90YScpIHx8IGVycm9yTWVzc2FnZS5pbmNsdWRlcygncmF0ZSBsaW1pdCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgS2V5IC4uLiR7a2V5LnNsaWNlKC00KX0gZXhoYXVzdGVkLiBBcHBseWluZyBmdWxsIGNvb2xkb3duLmApO1xuICAgICAgICAgICAgICAgICAgICBrZXlVc2FnZS5jb29sZG93bl91bnRpbCA9IERhdGUubm93KCkgLyAxMDAwICsgdGhpcy5zZXR0aW5ncy5mYWlsb3Zlcl9jb29sZG93bl9zZWNvbmRzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBcdTVCRjlcdTRFOEVcdTdGNTFcdTdFRENcdTYyMTZcdTY3MERcdTUyQTFcdTU2NjhcdTRFMzRcdTY1RjZcdTk1RUVcdTk4OThcdUZGMENcdTRFMERcdTVFOTRcdTc1MjhcdTk1N0ZcdTY1RjZcdTk1RjRcdTc2ODRcdTUxQjdcdTUzNzRcbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBLZXkgLi4uJHtrZXkuc2xpY2UoLTQpfSBmYWlsZWQgZHVlIHRvIG5ldHdvcmsvc2VydmVyIGVycm9yLiBObyBjb29sZG93biBhcHBsaWVkLmApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRocm93IG5ldyBBcGlLZXlFeGhhdXN0ZWRFcnJvcihgT3BlbkFJIGtleSBmYWlsZWQuYCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIF9jYWxsR29vZ2xlQVBJKGtleTogc3RyaW5nLCBwcm9tcHQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIGNvbnN0IHVybCA9IGBodHRwczovL2dlbmVyYXRpdmVsYW5ndWFnZS5nb29nbGVhcGlzLmNvbS92MWJldGEvbW9kZWxzLyR7dGhpcy5zZXR0aW5ncy5nb29nbGVfbW9kZWx9OmdlbmVyYXRlQ29udGVudD9rZXk9JHtrZXl9YDtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdFVybCh7XG4gICAgICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxuICAgICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICAgICAgY29udGVudHM6IFt7IHBhcnRzOiBbeyB0ZXh0OiBwcm9tcHQgfV0gfV0sXG4gICAgICAgICAgICAgICAgICAgIGdlbmVyYXRpb25Db25maWc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiB0aGlzLnNldHRpbmdzLmdlbmVyYXRpb25fdGVtcGVyYXR1cmUsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXhPdXRwdXRUb2tlbnM6IHRoaXMuc2V0dGluZ3MuZ2VuZXJhdGlvbl9tYXhfdG9rZW5zXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb25zdCBkYXRhID0gcmVzcG9uc2UuanNvbjtcbiAgICAgICAgICAgIGlmICghZGF0YS5jYW5kaWRhdGVzIHx8IGRhdGEuY2FuZGlkYXRlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBUEkgcmVzcG9uc2UgaXMgbWlzc2luZyBjYW5kaWRhdGVzLiBGdWxsIHJlc3BvbnNlOiBcIiArIEpTT04uc3RyaW5naWZ5KGRhdGEpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGtleVVzYWdlID0gdGhpcy5rZXlVc2FnZUdvb2dsZS5nZXQoa2V5KTtcbiAgICAgICAgICAgIGlmIChrZXlVc2FnZSkga2V5VXNhZ2UuY29vbGRvd25fdW50aWwgPSAwOyAvLyBcdTYyMTBcdTUyOUZcdTUyMTlcdTZFMDVcdTk2NjRcdTUxQjdcdTUzNzRcbiAgICAgICAgICAgIHJldHVybiBkYXRhLmNhbmRpZGF0ZXNbMF0uY29udGVudC5wYXJ0c1swXS50ZXh0LnRyaW0oKTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBHb29nbGUgR2VtaW5pIEFQSSBjYWxsIGZhaWxlZCBmb3Iga2V5IC4uLiR7a2V5LnNsaWNlKC00KX06YCwgZXJyb3IpO1xuICAgICAgICAgICAgY29uc3Qga2V5VXNhZ2UgPSB0aGlzLmtleVVzYWdlR29vZ2xlLmdldChrZXkpO1xuICAgICAgICAgICAgaWYgKGtleVVzYWdlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaHR0cFN0YXR1cyA9IGVycm9yLnN0YXR1cztcbiAgICAgICAgICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBlcnJvci5tZXNzYWdlPy50b0xvd2VyQ2FzZSgpIHx8ICcnO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmIChodHRwU3RhdHVzID09PSA0MDEgfHwgaHR0cFN0YXR1cyA9PT0gNDAzIHx8IGh0dHBTdGF0dXMgPT09IDQyOSB8fCBlcnJvck1lc3NhZ2UuaW5jbHVkZXMoJ3F1b3RhJykgfHwgZXJyb3JNZXNzYWdlLmluY2x1ZGVzKCdwZXJtaXNzaW9uJykpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBHb29nbGUgS2V5IC4uLiR7a2V5LnNsaWNlKC00KX0gZXhoYXVzdGVkLiBBcHBseWluZyBmdWxsIGNvb2xkb3duLmApO1xuICAgICAgICAgICAgICAgICAgICBrZXlVc2FnZS5jb29sZG93bl91bnRpbCA9IERhdGUubm93KCkgLyAxMDAwICsgdGhpcy5zZXR0aW5ncy5mYWlsb3Zlcl9jb29sZG93bl9zZWNvbmRzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBHb29nbGUgS2V5IC4uLiR7a2V5LnNsaWNlKC00KX0gZmFpbGVkIGR1ZSB0byBuZXR3b3JrL3NlcnZlciBlcnJvci4gTm8gY29vbGRvd24gYXBwbGllZC5gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aHJvdyBuZXcgQXBpS2V5RXhoYXVzdGVkRXJyb3IoYEdvb2dsZSBHZW1pbmkga2V5IGZhaWxlZC5gKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBjYWxsKHByb21wdDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICAgICAgdGhpcy51cGRhdGVLZXlzKCk7IC8vIFx1Nzg2RVx1NEZERFx1NEY3Rlx1NzUyOFx1NjcwMFx1NjVCMFx1NzY4NCBrZXlzXG4gICAgICAgIGxldCBsYXN0RXJyb3I6IEVycm9yIHwgbnVsbCA9IG51bGw7XG4gICAgICAgIGxldCBvcGVuQUlLZXlzQXR0ZW1wdGVkID0gZmFsc2U7IFxuXG4gICAgICAgIC8vIDEuIFx1NUMxRFx1OEJENSBPcGVuQUlcbiAgICAgICAgaWYgKHRoaXMub3BlbmFpX2tleXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgb3BlbkFJS2V5c0F0dGVtcHRlZCA9IHRydWU7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMub3BlbmFpX2tleXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBjb25zdCBrZXkgPSB0aGlzLl9zZWxlY3RLZXkodGhpcy5vcGVuYWlfa2V5cywgJ29wZW5haScpO1xuICAgICAgICAgICAgICAgIGlmIChrZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBUcnlpbmcgT3BlbkFJIGtleSAuLi4ke2tleS5zbGljZSgtNCl9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5fY2FsbE9wZW5BSShrZXksIHByb21wdCk7XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RFcnJvciA9IGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKGBPcGVuQUkga2V5IC4uLiR7a2V5LnNsaWNlKC00KX0gZmFpbGVkLiBUcnlpbmcgbmV4dC5gKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIDIuIFx1NUMxRFx1OEJENSBHb29nbGVcbiAgICAgICAgaWYgKHRoaXMuZ29vZ2xlX2tleXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgLy8gXHU1OTgyXHU2NzlDXHU1QzFEXHU4QkQ1XHU4RkM3IE9wZW5BSSBcdTRGNDZcdTkwRkRcdTU5MzFcdThEMjVcdTRFODZcdUZGMENcdTVFNzZcdTRFMTRcdThGRDlcdTY2MkZcdTdCMkNcdTRFMDBcdTZCMjFcdTUyMDdcdTYzNjJcdTUyMzAgR29vZ2xlXHVGRjBDXHU1MjE5XHU5MDFBXHU3N0U1XHU3NTI4XHU2MjM3XG4gICAgICAgICAgICBpZiAob3BlbkFJS2V5c0F0dGVtcHRlZCAmJiAhdGhpcy5oYXNOb3RpZmllZEZhaWxvdmVyKSB7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnQWxsIE9wZW5BSSBrZXlzIGZhaWxlZCBvciB1bmF2YWlsYWJsZS4gU3dpdGNoaW5nIHRvIEdvb2dsZSBHZW1pbmkuLi4nKTtcbiAgICAgICAgICAgICAgICB0aGlzLmhhc05vdGlmaWVkRmFpbG92ZXIgPSB0cnVlOyAvLyBcdTY4MDdcdThCQjBcdTRFM0FcdTVERjJcdTkwMUFcdTc3RTVcdUZGMENcdTkwN0ZcdTUxNERcdTkxQ0RcdTU5MERcdTkwMUFcdTc3RTVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmdvb2dsZV9rZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qga2V5ID0gdGhpcy5fc2VsZWN0S2V5KHRoaXMuZ29vZ2xlX2tleXMsICdnb29nbGUnKTtcbiAgICAgICAgICAgICAgICBpZiAoa2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgVHJ5aW5nIEdvb2dsZSBHZW1pbmkga2V5IC4uLiR7a2V5LnNsaWNlKC00KX1gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLl9jYWxsR29vZ2xlQVBJKGtleSwgcHJvbXB0KTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGFzdEVycm9yID0gZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYEdvb2dsZSBHZW1pbmkga2V5IC4uLiR7a2V5LnNsaWNlKC00KX0gZmFpbGVkLiBUcnlpbmcgbmV4dC5gKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIDMuIFx1NTE2OFx1OTBFOFx1NTkzMVx1OEQyNVxuICAgICAgICB0aHJvdyBuZXcgQWxsTW9kZWxzRmFpbGVkRXJyb3IoYEFsbCBBUEkgcHJvdmlkZXJzIGZhaWxlZC4gTGFzdCBlcnJvcjogJHtsYXN0RXJyb3I/Lm1lc3NhZ2V9YCk7XG4gICAgfVxufVxuIiwgIi8vIGNyaXRpYy50c1xuXG5pbXBvcnQgS25vd2xlZGdlR3JhcGhQbHVnaW4gZnJvbSAnLi9tYWluJztcbmltcG9ydCB7IEFQSUhhbmRsZXIgfSBmcm9tICcuL2FwaUhhbmRsZXInO1xuXG5leHBvcnQgY2xhc3MgQ3JpdGljIHtcbiAgICBwcml2YXRlIHBsdWdpbjogS25vd2xlZGdlR3JhcGhQbHVnaW47XG4gICAgcHJpdmF0ZSBhcGlIYW5kbGVyOiBBUElIYW5kbGVyO1xuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBLbm93bGVkZ2VHcmFwaFBsdWdpbikge1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICAgICAgdGhpcy5hcGlIYW5kbGVyID0gbmV3IEFQSUhhbmRsZXIocGx1Z2luKTsgLy8gQ3JpdGljIGNhbiBoYXZlIGl0cyBvd24gaGFuZGxlciBpZiBuZWVkZWRcbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMganVkZ2UoY29udGVudDogc3RyaW5nKTogUHJvbWlzZTx7IGlzQXBwcm92ZWQ6IGJvb2xlYW4sIHJlYXNvbjogc3RyaW5nIH0+IHtcbiAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmNyaXRpY19tb2RlID09PSAnYWknKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fanVkZ2VCeUFJKGNvbnRlbnQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl9qdWRnZUJ5SGV1cmlzdGljKGNvbnRlbnQpO1xuICAgIH1cblxuICAgIHByaXZhdGUgX2p1ZGdlQnlIZXVyaXN0aWMoY29udGVudDogc3RyaW5nKTogeyBpc0FwcHJvdmVkOiBib29sZWFuLCByZWFzb246IHN0cmluZyB9IHtcbiAgICAgICAgY29uc3QgcmVhc29uczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgY29uc3QgY29udGVudExvd2VyID0gY29udGVudC50b0xvd2VyQ2FzZSgpO1xuXG4gICAgICAgIC8vIDEuIENoZWNrIGZvciByZXF1aXJlZCBoZWFkZXJzXG4gICAgICAgIGNvbnN0IHJlcXVpcmVkSGVhZGVycyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmNyaXRpY19yZXF1aXJlZF9oZWFkZXJzXG4gICAgICAgICAgICAuc3BsaXQoJ1xcbicpLm1hcChoID0+IGgudHJpbSgpLnRvTG93ZXJDYXNlKCkpLmZpbHRlcihCb29sZWFuKTtcbiAgICAgICAgY29uc3QgbWlzc2luZ0hlYWRlcnMgPSByZXF1aXJlZEhlYWRlcnMuZmlsdGVyKGggPT4gIWNvbnRlbnRMb3dlci5pbmNsdWRlcyhoKSk7XG4gICAgICAgIGlmIChtaXNzaW5nSGVhZGVycy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICByZWFzb25zLnB1c2goYFx1N0YzQVx1NUMxMVx1NUZDNVx1OTcwMFx1NzY4NFx1NjgwN1x1OTg5ODogJHttaXNzaW5nSGVhZGVycy5qb2luKCcsICcpfWApO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gMi4gQ2hlY2sgZm9yIG1pbiBsZW5ndGhcbiAgICAgICAgaWYgKGNvbnRlbnQubGVuZ3RoIDwgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3JpdGljX21pbl9jb250ZW50X2xlbmd0aCkge1xuICAgICAgICAgICAgcmVhc29ucy5wdXNoKGBcdTUxODVcdTVCQjlcdThGQzdcdTc3RUQgKFx1NUY1M1x1NTI0RDogJHtjb250ZW50Lmxlbmd0aH0sIFx1ODk4MVx1NkM0MjogJHt0aGlzLnBsdWdpbi5zZXR0aW5ncy5jcml0aWNfbWluX2NvbnRlbnRfbGVuZ3RofSlgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIDMuIENoZWNrIGZvciByZWZ1c2FsIHBhdHRlcm5zXG4gICAgICAgIGNvbnN0IHJlZnVzYWxQYXR0ZXJucyA9IFtcIlx1NEY1Q1x1NEUzQVx1NEUwMD9cdTRFMkFBSVwiLCBcIlx1NEY1Q1x1NEUzQVx1OEJFRFx1OEEwMFx1NkEyMVx1NTc4QlwiLCBcIlx1NjIxMVx1NEUwRFx1ODBGRFwiLCBcIlx1NjIxMVx1NjVFMFx1NkNENVwiLCBcIlx1NUY4OFx1NjJCMVx1NkI0OVwiXTtcbiAgICAgICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIHJlZnVzYWxQYXR0ZXJucykge1xuICAgICAgICAgICAgaWYgKG5ldyBSZWdFeHAocGF0dGVybiwgJ2knKS50ZXN0KGNvbnRlbnQpKSB7XG4gICAgICAgICAgICAgICAgcmVhc29ucy5wdXNoKGBcdTUzMDVcdTU0MkJBSVx1NjJEMlx1N0VERFx1OEJFRCAoXHU1MzM5XHU5MTREOiAnJHtwYXR0ZXJufScpYCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpc0FwcHJvdmVkOiByZWFzb25zLmxlbmd0aCA9PT0gMCxcbiAgICAgICAgICAgIHJlYXNvbjogcmVhc29ucy5sZW5ndGggPiAwID8gcmVhc29ucy5qb2luKCc7ICcpIDogXCJcdTkwMUFcdThGQzdcdTYyNDBcdTY3MDlcdTU0MkZcdTUzRDFcdTVGMEZcdTg5QzRcdTUyMTlcdTY4QzBcdTY3RTVcdTMwMDJcIlxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgX2p1ZGdlQnlBSShjb250ZW50OiBzdHJpbmcpOiBQcm9taXNlPHsgaXNBcHByb3ZlZDogYm9vbGVhbiwgcmVhc29uOiBzdHJpbmcgfT4ge1xuICAgICAgICBjb25zdCBwcm9tcHQgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9tcHRfY3JpdGljLnJlcGxhY2UoJ3tjb250ZW50fScsIGNvbnRlbnQpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmFwaUhhbmRsZXIuY2FsbChwcm9tcHQpO1xuICAgICAgICAgICAgY29uc3QgZGVjaXNpb25NYXRjaCA9IHJlc3BvbnNlLm1hdGNoKC9ERUNJU0lPTjpcXHMqKEtFRVB8RElTQ0FSRCkvaSk7XG4gICAgICAgICAgICBjb25zdCByZWFzb25NYXRjaCA9IHJlc3BvbnNlLm1hdGNoKC9cXFtSRUFTT046XFxzKihbXlxcXV0rKVxcXS8pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCBpc0FwcHJvdmVkID0gZGVjaXNpb25NYXRjaCA/IGRlY2lzaW9uTWF0Y2hbMV0udG9VcHBlckNhc2UoKSA9PT0gJ0tFRVAnIDogZmFsc2U7XG4gICAgICAgICAgICBjb25zdCByZWFzb24gPSByZWFzb25NYXRjaCA/IHJlYXNvbk1hdGNoWzFdLnRyaW0oKSA6IChpc0FwcHJvdmVkID8gXCJBSSBcdTYyNzlcdTUxQzZcIiA6IFwiQUkgXHU2MkQyXHU3RUREXHVGRjBDXHU2NzJBXHU2M0QwXHU0RjlCXHU2NjBFXHU3ODZFXHU3NDA2XHU3NTMxXCIpO1xuXG4gICAgICAgICAgICByZXR1cm4geyBpc0FwcHJvdmVkLCByZWFzb24gfTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJBSSBDcml0aWMgY2FsbCBmYWlsZWQ6XCIsIGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiB7IGlzQXBwcm92ZWQ6IGZhbHNlLCByZWFzb246IGBBSSBcdTVCQTFcdTY4MzhcdTU2NjhcdThDMDNcdTc1MjhcdTU5MzFcdThEMjU6ICR7ZXJyb3IubWVzc2FnZX1gIH07XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCAiLy8gcmV2aXNlci50c1xuXG5pbXBvcnQgS25vd2xlZGdlR3JhcGhQbHVnaW4gZnJvbSAnLi9tYWluJztcblxuZXhwb3J0IGNsYXNzIFJldmlzZXIge1xuICAgIHByaXZhdGUgcGx1Z2luOiBLbm93bGVkZ2VHcmFwaFBsdWdpbjtcblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogS25vd2xlZGdlR3JhcGhQbHVnaW4pIHtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0ZVJldmlzaW9uUHJvbXB0KGlkZWE6IHN0cmluZywgb3JpZ2luYWxDb250ZW50OiBzdHJpbmcsIHJlamVjdGlvblJlYXNvbjogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgbGV0IHByb21wdCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnByb21wdF9yZXZpc2VyO1xuICAgICAgICBwcm9tcHQgPSBwcm9tcHQucmVwbGFjZSgne2NvbmNlcHR9JywgaWRlYSk7XG4gICAgICAgIHByb21wdCA9IHByb21wdC5yZXBsYWNlKCd7b3JpZ2luYWxfY29udGVudH0nLCBvcmlnaW5hbENvbnRlbnQpO1xuICAgICAgICBwcm9tcHQgPSBwcm9tcHQucmVwbGFjZSgne3JlamVjdGlvbl9yZWFzb259JywgcmVqZWN0aW9uUmVhc29uKTtcbiAgICAgICAgcmV0dXJuIHByb21wdDtcbiAgICB9XG59XG4iLCAiLy8gdXRpbHMudHMgKFx1NTM5Rlx1NTlDQlx1N0EzM1x1NUI5QVx1NzI0OClcblxuZXhwb3J0IGZ1bmN0aW9uIHNhbml0aXplRmlsZW5hbWUobmFtZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAvLyBcdTc5RkJcdTk2NjRcdTYyRUNcdTUzRjdcdTUzQ0FcdTUxNzZcdTUxODVcdTVCQjlcbiAgICBsZXQgY2xlYW5OYW1lID0gbmFtZS5yZXBsYWNlKC9cXHMqXFwoLipcXCkvZywgJycpLnRyaW0oKTtcbiAgICAvLyBcdTc5RkJcdTk2NjRcdTY1ODdcdTRFRjZcdTdDRkJcdTdFREZcdTRFMERcdTUxNDFcdThCQjhcdTc2ODRcdTVCNTdcdTdCMjZcbiAgICBjbGVhbk5hbWUgPSBjbGVhbk5hbWUucmVwbGFjZSgvW1xcXFwvKj86XCI8PnxdL2csIFwiXCIpO1xuICAgIC8vIFx1OTY1MFx1NTIzNlx1OTU3Rlx1NUVBNlxuICAgIHJldHVybiBjbGVhbk5hbWUuc2xpY2UoMCwgMTAwKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGV4dHJhY3ROZXdJZGVhcyhjb250ZW50OiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgbWF0Y2hlcyA9IGNvbnRlbnQubWF0Y2goL1xcW1xcWyhbXlxcXV0rKVxcXVxcXS9nKTtcbiAgICBpZiAoIW1hdGNoZXMpIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICAvLyBcdTRFQ0UgW1tMaW5rfEFsaWFzXV0gXHU2MjE2IFtbTGlua11dIFx1NEUyRFx1NjNEMFx1NTNENiBcIkxpbmtcIlxuICAgIGNvbnN0IGlkZWFzID0gbWF0Y2hlcy5tYXAobWF0Y2ggPT4ge1xuICAgICAgICByZXR1cm4gbWF0Y2guc2xpY2UoMiwgLTIpLnNwbGl0KCd8JylbMF0udHJpbSgpO1xuICAgIH0pO1xuICAgIHJldHVybiBbLi4ubmV3IFNldChpZGVhcyldOyAvLyBcdThGRDRcdTU2REVcdTUzQkJcdTkxQ0RcdTU0MEVcdTc2ODRcdTdFRDNcdTY3OUNcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFuTWFya2Rvd25PdXRwdXQoY29udGVudDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBjb25zdCB0cmltbWVkID0gY29udGVudC50cmltKCk7XG4gICAgaWYgKHRyaW1tZWQuc3RhcnRzV2l0aChcImBgYG1hcmtkb3duXCIpICYmIHRyaW1tZWQuZW5kc1dpdGgoXCJgYGBcIikpIHtcbiAgICAgICAgbGV0IGNsZWFuZWQgPSB0cmltbWVkLnN1YnN0cmluZyhcImBgYG1hcmtkb3duXCIubGVuZ3RoLCB0cmltbWVkLmxlbmd0aCAtIFwiYGBgXCIubGVuZ3RoKTtcbiAgICAgICAgcmV0dXJuIGNsZWFuZWQudHJpbSgpO1xuICAgIH1cbiAgICByZXR1cm4gdHJpbW1lZDtcbn1cbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxJQUFBQSxtQkFBc0U7OztBQ0V0RSxJQUFBQyxtQkFBdUQ7OztBQ0F2RCxzQkFBNEM7QUFJckMsSUFBTSx1QkFBTixjQUFtQyxzQkFBTTtBQUFBLEVBbUI1QyxZQUFZLEtBQVUsUUFBOEI7QUFDaEQsVUFBTSxHQUFHO0FBaEJiO0FBQUEsU0FBUSxjQUF5QztBQUFBLE1BQzdDLEtBQUs7QUFBQSxNQUNMLEtBQUs7QUFBQSxNQUNMLEtBQUs7QUFBQSxNQUNMLEtBQUs7QUFBQSxJQUNUO0FBR0E7QUFBQSxTQUFRLGlCQUE2QztBQUFBLE1BQ2pELEtBQUs7QUFBQTtBQUFBLE1BQ0wsS0FBSztBQUFBO0FBQUEsTUFDTCxLQUFLO0FBQUE7QUFBQSxNQUNMLEtBQUs7QUFBQTtBQUFBLElBQ1Q7QUFJSSxTQUFLLFNBQVM7QUFBQSxFQUNsQjtBQUFBLEVBRUEsU0FBUztBQUNMLFVBQU0sRUFBRSxVQUFVLElBQUk7QUFDdEIsY0FBVSxNQUFNO0FBQ2hCLGNBQVUsU0FBUyxVQUFVO0FBQzdCLGNBQVUsU0FBUyxNQUFNLEVBQUUsTUFBTSw2Q0FBVSxDQUFDO0FBRTVDLFVBQU0sU0FBUyxLQUFLLE9BQU8sS0FBSztBQUNoQyxVQUFNLGFBQWEsaUJBQU8sT0FBTyxZQUFZLE9BQU8sS0FBSyxPQUFPLFlBQVksUUFBUTtBQUdwRixRQUFJLHdCQUFRLFNBQVMsRUFDaEIsUUFBUSxXQUFXLFlBQVksbUNBQVUsZ0NBQU8sRUFD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LGVBQU87QUFBQSxNQUNYO0FBQUEsSUFDSixDQUFDO0FBRUQsWUFBUSxJQUFJLDhEQUFZO0FBQUEsRUFDNUI7QUFBQSxFQUVBLFdBQVc7QUFDUCxZQUFRLElBQUksOERBQVk7QUFBQSxFQUM1QjtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQU9BLE1BQU0sZUFBZTtBQUNqQixVQUFNLGlCQUFpQixNQUFNLGtCQUFrQjtBQUUvQyxVQUFNLFlBQVksTUFBTSxLQUFLLFNBQVM7QUFFdEMsVUFBTSxnQkFBZ0IsYUFBYSxDQUFDO0FBR3BDLFNBQUssV0FBVyxPQUFPLE9BQU8sQ0FBQyxHQUFHLGtCQUFrQixnQkFBZ0IsYUFBYTtBQUFBLEVBQ3JGO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQU1BLE1BQU0sZUFBZTtBQUNqQixVQUFNLGFBQWEsRUFBRSxHQUFHLEtBQUssVUFBVSxhQUFhLEtBQUssS0FBSztBQUM5RCxVQUFNLEtBQUssU0FBUyxVQUFVO0FBQUEsRUFDbEM7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBTUEsTUFBTSxpQkFBaUI7QUFFbkIsVUFBTSxZQUFZLE1BQU0sS0FBSyxTQUFTO0FBRXRDLFVBQU0sY0FBYSx1Q0FBVyxnQkFBZSxDQUFDO0FBRzlDLFNBQUssT0FBTyxPQUFPLE9BQU8sQ0FBQyxHQUFHLHFCQUFxQixVQUFVO0FBQUEsRUFDakU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFPQSxNQUFNLGlCQUFpQjtBQUNuQixVQUFNLEtBQUssYUFBYTtBQUFBLEVBQzVCO0FBQ0o7IiwKICAibmFtZXMiOiBbImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiJdCn0K
